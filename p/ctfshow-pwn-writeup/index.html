<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="二进制漏洞与利用，PWN_wrtieup，会员套餐360题">
<title>ctfshow-pwn-writeup</title>

<link rel='canonical' href='https://expl0rer.top/p/ctfshow-pwn-writeup/'>

<link rel="stylesheet" href="/scss/style.min.2c77b19359813276c65acd84dec34da71ed0ee906a8812f34e2c2899887b4ce7.css"><meta property='og:title' content="ctfshow-pwn-writeup">
<meta property='og:description' content="二进制漏洞与利用，PWN_wrtieup，会员套餐360题">
<meta property='og:url' content='https://expl0rer.top/p/ctfshow-pwn-writeup/'>
<meta property='og:site_name' content='Expl0rer.Ct'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-08-27T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-08-28T17:05:53&#43;08:00'/><meta property='og:image' content='https://expl0rer.top/p/ctfshow-pwn-writeup/ctfshow.png' />
<meta name="twitter:title" content="ctfshow-pwn-writeup">
<meta name="twitter:description" content="二进制漏洞与利用，PWN_wrtieup，会员套餐360题"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://expl0rer.top/p/ctfshow-pwn-writeup/ctfshow.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<div class="loading">
     
    <div id="ghost">
        <div id="red">
            <div id="pupil"></div>
            <div id="pupil1"></div>
            <div id="eye"></div>
            <div id="eye1"></div>
            <div id="top0"></div>
            <div id="top1"></div>
            <div id="top2"></div>
            <div id="top3"></div>
            <div id="top4"></div>
            <div id="st0"></div>
            <div id="st1"></div>
            <div id="st2"></div>
            <div id="st3"></div>
            <div id="st4"></div>
            <div id="st5"></div>
            <div id="an1"></div>
            <div id="an2"></div>
            <div id="an3"></div>
            <div id="an4"></div>
            <div id="an5"></div>
            <div id="an6"></div>
            <div id="an7"></div>
            <div id="an8"></div>
            <div id="an9"></div>
            <div id="an10"></div>
            <div id="an11"></div>
            <div id="an12"></div>
            <div id="an13"></div>
            <div id="an14"></div>
            <div id="an15"></div>
            <div id="an16"></div>
            <div id="an17"></div>
            <div id="an18"></div>
        </div>
        <div id="shadow"></div>
    </div>
</div>

<style>
    .loading {
        position: fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        background-color: #f5f5fa;
        transition: opacity 0.5s ease;
    }
	
      
#ghost {
  position: relative;
  scale: 0.8;
}

#red {
  animation: upNDown infinite 1s;
  position: relative;
  width: 140px;
  height: 140px;
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  grid-template-rows: repeat(14, 1fr);
  grid-column-gap: 0px;
  grid-row-gap: 0px;
  grid-template-areas:
    "a1  a2  a3  a4  a5  top0  top0  top0  top0  a10 a11 a12 a13 a14"
    "b1  b2  b3  top1 top1 top1 top1 top1 top1 top1 top1 b12 b13 b14"
    "c1 c2 top2 top2 top2 top2 top2 top2 top2 top2 top2 top2 c13 c14"
    "d1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 d14"
    "e1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 e14"
    "f1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 f14"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "st0 st0 an4 st1 an7 st2 an10 an10 st3 an13 st4 an16 st5 st5"
    "an1 an2 an3 an5 an6 an8 an9 an9 an11 an12 an14 an15 an17 an18";
}

@keyframes upNDown {
  0%,
  49% {
    transform: translateY(0px);
  }
  50%,
  100% {
    transform: translateY(-10px);
  }
}

#top0,
#top1,
#top2,
#top3,
#top4,
#st0,
#st1,
#st2,
#st3,
#st4,
#st5 {
  background-color: red;
}

#top0 {
  grid-area: top0;
}

#top1 {
  grid-area: top1;
}

#top2 {
  grid-area: top2;
}

#top3 {
  grid-area: top3;
}

#top4 {
  grid-area: top4;
}

#st0 {
  grid-area: st0;
}

#st1 {
  grid-area: st1;
}

#st2 {
  grid-area: st2;
}

#st3 {
  grid-area: st3;
}

#st4 {
  grid-area: st4;
}

#st5 {
  grid-area: st5;
}

#an1 {
  grid-area: an1;
  animation: flicker0 infinite 1s;
}

#an18 {
  grid-area: an18;
  animation: flicker0 infinite 1s;
}

#an2 {
  grid-area: an2;
  animation: flicker1 infinite 1s;
}

#an17 {
  grid-area: an17;
  animation: flicker1 infinite 1s;
}

#an3 {
  grid-area: an3;
  animation: flicker1 infinite 1s;
}

#an16 {
  grid-area: an16;
  animation: flicker1 infinite 1s;
}

#an4 {
  grid-area: an4;
  animation: flicker1 infinite 1s;
}

#an15 {
  grid-area: an15;
  animation: flicker1 infinite 1s;
}

#an6 {
  grid-area: an6;
  animation: flicker0 infinite 1s;
}

#an12 {
  grid-area: an12;
  animation: flicker0 infinite 1s;
}

#an7 {
  grid-area: an7;
  animation: flicker0 infinite 1s;
}

#an13 {
  grid-area: an13;
  animation: flicker0 infinite 1s;
}

#an9 {
  grid-area: an9;
  animation: flicker1 infinite 1s;
}

#an10 {
  grid-area: an10;
  animation: flicker1 infinite 1s;
}

#an8 {
  grid-area: an8;
  animation: flicker0 infinite 1s;
}

#an11 {
  grid-area: an11;
  animation: flicker0 infinite 1s;
}

@keyframes flicker0 {
  0%,
  49% {
    background-color: red;
  }
  50%,
  100% {
    background-color: transparent;
  }
}

@keyframes flicker1 {
  0%,
  49% {
    background-color: transparent;
  }
  50%,
  100% {
    background-color: red;
  }
}

#eye {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  left: 10px;
}

#eye::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#eye1 {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  right: 30px;
}

#eye1::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye1::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#pupil {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  left: 10px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

#pupil1 {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  right: 50px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

@keyframes eyesMovement {
  0%,
  49% {
    transform: translateX(0px);
  }
  50%,
  99% {
    transform: translateX(10px);
  }
  100% {
    transform: translateX(0px);
  }
}

#shadow {
  background-color: black;
  width: 140px;
  height: 140px;
  position: absolute;
  border-radius: 50%;
  transform: rotateX(80deg);
  filter: blur(20px);
  top: 80%;
  animation: shadowMovement infinite 1s;
}

@keyframes shadowMovement {
  0%,
  49% {
    opacity: 0.5;
  }
  50%,
  100% {
    opacity: 0.2;
  }
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script>	
    function initLoading() {
        let loading = document.querySelector(".loading");
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(() => {
                loading.style.opacity = "0";
                
                setTimeout(() => {
                    loading.style.display = "none";
                }, 500);
            }, 500); 
        });
    }

    initLoading();
</script>


<link
  rel="stylesheet"
  href="https://cdn-font.hyperos.mi.com/font/css?family=MiSans:400:Chinese_Simplify,Latin&display=swap"
/>



<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreenr.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreenr.css" />


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1a3c99934e119e1b.png" width="300"
                            height="268" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">🫡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Expl0rer.Ct</a></h1>
            <h2 class="site-description">吾将上下而求索</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/695179979?spm_id_from=333.40138.0.0'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Expl0rer-Ct'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页 | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于 | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档 | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索 | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E6%8A%80%E6%9C%AF%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>技术链接 | Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <!--
tags: [temperature, hot, wheater, thermometer, forecast]
category: Weather
version: "1.73"
unicode: "f236"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#ff9500"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-sun-high"
>
  <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" />
  <path d="M6.343 17.657l-1.414 1.414" />
  <path d="M6.343 6.343l-1.414 -1.414" />
  <path d="M17.657 6.343l1.414 -1.414" />
  <path d="M17.657 17.657l1.414 1.414" />
  <path d="M4 12h-2" />
  <path d="M12 4v-2" />
  <path d="M20 12h2" />
  <path d="M12 20v2" />
</svg>

                        <!--
tags: [night, dark mode]
category: Weather
version: "1.21"
unicode: "ece7"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#8d6e63"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-moon-stars"
>
  <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
  <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2" />
  <path d="M19 11h2m-1 -1v2" />
</svg>

                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#test_your_nc">Test_your_nc</a>
      <ol>
        <li><a href="#pwn_000">PWN_000</a>
          <ol>
            <li><a href="#解题过程">解题过程</a></li>
          </ol>
        </li>
        <li><a href="#pwn_001">PWN_001</a></li>
        <li><a href="#pwn_002">PWN_002</a></li>
        <li><a href="#pwn_003">PWN_003</a></li>
        <li><a href="#pwn_004">PWN_004</a></li>
      </ol>
    </li>
    <li><a href="#前置基础">前置基础</a>
      <ol>
        <li><a href="#pwn_005">PWN_005</a></li>
        <li><a href="#pwn_006">PWN_006</a></li>
        <li><a href="#pwn_007">PWN_007</a></li>
        <li><a href="#pwn_008">PWN_008</a></li>
        <li><a href="#pwn_009">PWN_009</a></li>
        <li><a href="#pwn_010">PWN_010</a></li>
        <li><a href="#pwn_011">PWN_011</a></li>
        <li><a href="#pwn_012">PWN_012</a></li>
        <li><a href="#pwn_013">PWN_013</a></li>
        <li><a href="#pwn_014">PWN_014</a></li>
        <li><a href="#pwn_015">PWN_015</a></li>
        <li><a href="#pwn_016">PWN_016</a></li>
        <li><a href="#pwn_017">PWN_017</a></li>
        <li><a href="#pwn_018">PWN_018</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/ctfshow-pwn-writeup/">
                <img src="/p/ctfshow-pwn-writeup/ctfshow_hu_2da768fbb28f8f82.png"
                        srcset="/p/ctfshow-pwn-writeup/ctfshow_hu_2da768fbb28f8f82.png 800w, /p/ctfshow-pwn-writeup/ctfshow_hu_ecf2a63f33ea59e3.png 1600w"
                        width="800" 
                        height="405" 
                        loading="lazy"
                        alt="Featured image of post ctfshow-pwn-writeup" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf_writeup/" style="background-color: #2a9d8f; color: #fff;">
                CTF_writeup
            </a>
        
            <a href="/categories/ctfpwn/" style="background-color: #2a9d8f; color: #fff;">
                CTFpwn
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/ctfshow-pwn-writeup/">ctfshow-pwn-writeup</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            二进制漏洞与利用，PWN_wrtieup，会员套餐360题
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-08-27</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>[TOC]</p>
<p><strong>前文：以下是我<a class="link" href="https://ctf.show/challenges"  target="_blank" rel="noopener"
    >ctfshow</a>的PWN做题记录，欢迎各位前来观看，小弟领教！</strong></p>
<p>前文：每题我都放了链接，供下载，要靶场的题不能做，PWN_005 <del>PWN_016，PWN_20~~PWN_022，PWN_026</del>PWN_029不需要靶场是可以做的，供大家食用PWN。</p>
<h2 id="test_your_nc">Test_your_nc
</h2><h3 id="pwn_000">PWN_000
</h3><p><a class="link" href="https://pan.baidu.com/s/1wHPhZ7XOouFU6KgyOiSfLQ"  target="_blank" rel="noopener"
    >专用虚拟机镜像</a>，全套在这里，提取码show；虚拟机镜像，用户名为ctfshow，密码是ctfshow。</p>
<p>看了课也啥都不会或者工具不会下看这&ndash;&gt;<a class="link" href="https://ctf-wiki.org/pwn/linux/user-mode/environment/"  target="_blank" rel="noopener"
    >CTF Wiki-PWN</a></p>
<h4 id="解题过程">解题过程
</h4><p>ssh连接（记得给虚拟机kali\Ubuntu或者主机设置打开SSH）：</p>
<p><code>ssh ctfshow@pwn.challenge.ctf.show -pxxxx</code></p>
<p>一开始会让你输入yes/no的，直接yes，然后输入密码，等进程结束会有个交互shell</p>
<p><img src="/p/ctfshow-pwn-writeup/1.png"
	width="1184"
	height="570"
	srcset="/p/ctfshow-pwn-writeup/1_hu_dff3e732402d7aaa.png 480w, /p/ctfshow-pwn-writeup/1_hu_5121a93a292ddbe4.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="207"
		data-flex-basis="498px"
	
></p>
<p>用命令ls打开看一下有啥文件，看到有个ctfshow_flag的文件，猜是个装flag的文件夹，直接用cat命令打开就好。注意斜杠/。</p>
<h3 id="pwn_001">PWN_001
</h3><p>题目 <a class="link" href="PWN_001" >PWN_001</a> ：提供后门函数，连上即可得到flag</p>
<p>这里有用到“<a class="link" href="https://ctf.xidian.edu.cn/wiki/13"  target="_blank" rel="noopener"
    ><code>nc</code></a>”连接，可以了解一下，方便后续做题。当然Kali自带nc连接的，你用Kali干PWN也行。</p>
<p><img src="/p/ctfshow-pwn-writeup/2.png"
	width="826"
	height="310"
	srcset="/p/ctfshow-pwn-writeup/2_hu_d89a142dd65a19e2.png 480w, /p/ctfshow-pwn-writeup/2_hu_5516dc48b2b77e6e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="266"
		data-flex-basis="639px"
	
></p>
<p>这题送分的，nc连接一下就爆flag了。</p>
<p>不过说实话我是真不知道PWN_001文件给来干嘛的，直接nc交互一下就出flag了，这题没搞懂ctfshow意图在哪。</p>
<p><img src="/p/ctfshow-pwn-writeup/3.png"
	width="1010"
	height="246"
	srcset="/p/ctfshow-pwn-writeup/3_hu_e6fbe5354a4e4e53.png 480w, /p/ctfshow-pwn-writeup/3_hu_9234984ec0f35806.png 1024w"
	loading="lazy"
	
		alt="checksec解析elf格式信息、二进制文件保护配置"
	
	
		class="gallery-image" 
		data-flex-grow="410"
		data-flex-basis="985px"
	
></p>
<p>不过我用了下刚学的指令checksec看了看ELF文件信息，发现是没开canary保护的，可以利用栈溢出漏洞&hellip;</p>
<p>可以看到是64位仅关闭Canary保护。</p>
<p>接着用64位IDA打开查看main函数（按F5进入反汇编）：</p>
<p><img src="/p/ctfshow-pwn-writeup/4.png"
	width="1375"
	height="790"
	srcset="/p/ctfshow-pwn-writeup/4_hu_2ae06a810be6f21f.png 480w, /p/ctfshow-pwn-writeup/4_hu_8b6f5df4cd345cc8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="174"
		data-flex-basis="417px"
	
></p>
<p>怪不得直接爆flag出来呢。后门system函数直接运行了。</p>
<h3 id="pwn_002">PWN_002
</h3><p>题目： <a class="link" href="PWN_002" >PWN_002</a> 给你一个shell，这次需要你自己去获得flag</p>
<p>到这里度过新手期了。</p>
<p><img src="/p/ctfshow-pwn-writeup/5.png"
	width="765"
	height="260"
	srcset="/p/ctfshow-pwn-writeup/5_hu_e343e2a59c5e743.png 480w, /p/ctfshow-pwn-writeup/5_hu_4937eed7794a387b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="294"
		data-flex-basis="706px"
	
></p>
<p>这里需要我们输入指令了，一般来说做题习惯看到这样直接ls秒的，不过像我这样入门级别的还得用IDA琢磨琢磨：</p>
<p><img src="/p/ctfshow-pwn-writeup/8.png"
	width="640"
	height="160"
	srcset="/p/ctfshow-pwn-writeup/8_hu_5bc43d6c8900b4ef.png 480w, /p/ctfshow-pwn-writeup/8_hu_e468d492633fbadf.png 1024w"
	loading="lazy"
	
		alt="checksec分析"
	
	
		class="gallery-image" 
		data-flex-grow="400"
		data-flex-basis="960px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/6.png"
	width="1374"
	height="555"
	srcset="/p/ctfshow-pwn-writeup/6_hu_540555b971908944.png 480w, /p/ctfshow-pwn-writeup/6_hu_a88e21f83ae2c018.png 1024w"
	loading="lazy"
	
		alt="IDA-x64位main程序的反编译"
	
	
		class="gallery-image" 
		data-flex-grow="247"
		data-flex-basis="594px"
	
></p>
<p>可以看到是没canary保护的</p>
<p><img src="/p/ctfshow-pwn-writeup/7.png"
	width="909"
	height="484"
	srcset="/p/ctfshow-pwn-writeup/7_hu_6dedf0753937e2ce.png 480w, /p/ctfshow-pwn-writeup/7_hu_4bed3d833e192498.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="450px"
	
></p>
<p>看到这里有个疑问，为什么system有这么大威力？，这次system里边是一个/bin/sh的软链接，很类似我们的文件地址</p>
<blockquote class="alert alert-note">
    <blockquote>
<p><code>system(&quot;/bin/sh&quot;);</code> 是漏洞利用中获取系统 shell 的核心操作，其工作原理涉及<strong>函数调用</strong>、<strong>系统调用</strong>和<strong>进程创建</strong>三个层次，本质是通过标准库函数 <code>system</code> 启动一个 <code>/bin/sh</code> 进程（即命令行解释器），让攻击者获得交互权限。</p></blockquote></blockquote>
<p><code>system</code> 是 C 标准库（libc）中的函数，原型为：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">system</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">command</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote class="alert alert-error">
    <blockquote>
<p>它的功能是<strong>执行参数 <code>command</code> 指向的字符串作为系统命令</strong>，相当于在终端中输入该命令并执行。</p></blockquote></blockquote>
<p>system()函数先fork一个子进程，在这个子进程中调用/bin/sh -c来执行command指定的命令。/bin/sh在系统中一般是个软链接，指向dash或者bash等常用的shell，-c选项是告诉shell从字符串command中读取要执行的命令（shell将扩展command中的任何特殊字符）。父进程则调用waitpid()函数来为变成僵尸的子进程收尸，获得其结束状态，然后将这个结束状态返回给system()函数的调用者。</p>
<blockquote class="alert alert-note">
    <blockquote>
<p><code>system(&quot;/bin/sh&quot;)</code> 的工作原理可简化为：
<strong>通过 <code>system</code> 函数创建子进程 → 子进程执行 <code>/bin/sh</code> 程序 → 启动交互式 shell 环境</strong>。</p>
<p>这也是漏洞利用中最常用的<strong>获取权限</strong>的方式 —— 无论通过栈溢出、ROP 还是 ret2libc，最终目标都是让程序执行这条语句（或等效的系统调用）。</p></blockquote></blockquote>
<h3 id="pwn_003">PWN_003
</h3><p>题目： <a class="link" href="PWN_003" >PWN_003</a> 哪一个函数才能读取flag？</p>
<p><img src="/p/ctfshow-pwn-writeup/9.png"
	width="835"
	height="485"
	srcset="/p/ctfshow-pwn-writeup/9_hu_cf2d18ee43fc45c9.png 480w, /p/ctfshow-pwn-writeup/9_hu_4af22d79b2909177.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="172"
		data-flex-basis="413px"
	
></p>
<p>通过前面的分析，我们可以很明显的看出来选项”6”为我们所需要的后门函数，其他的均不会得到我们所想要的flag，在system函数里面的命令都是在终端执行的，赋予system权限较大，在我所写的文章里，包括PWN入门知识讲解和操作系统都明确指出SYSTEM是与操作系统内核接触的，比Administrators的权限还要稍大。</p>
<p>直接选6秒了，但除这种送分的，其实还需要搞清运行的逻辑：</p>
<p><img src="/p/ctfshow-pwn-writeup/10.png"
	width="1390"
	height="554"
	srcset="/p/ctfshow-pwn-writeup/10_hu_c9707c3fe7bf59e8.png 480w, /p/ctfshow-pwn-writeup/10_hu_b592fb61e24a27ee.png 1024w"
	loading="lazy"
	
		alt="IDAx64位程序反编译"
	
	
		class="gallery-image" 
		data-flex-grow="250"
		data-flex-basis="602px"
	
></p>
<p>跟进一下menu函数里边：</p>
<p><img src="/p/ctfshow-pwn-writeup/11.png"
	width="726"
	height="280"
	srcset="/p/ctfshow-pwn-writeup/11_hu_3d734164c38877e4.png 480w, /p/ctfshow-pwn-writeup/11_hu_685776f269a503fb.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="259"
		data-flex-basis="622px"
	
></p>
<p>回到main跟进一下这个“6”的函数，看看里头是不是真在执行system后门函数：</p>
<p><img src="/p/ctfshow-pwn-writeup/12.png"
	width="744"
	height="240"
	srcset="/p/ctfshow-pwn-writeup/12_hu_9db861ef6fbcf71d.png 480w, /p/ctfshow-pwn-writeup/12_hu_9d996ee2d6fc5f89.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="310"
		data-flex-basis="744px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/13.png"
	width="501"
	height="119"
	srcset="/p/ctfshow-pwn-writeup/13_hu_b70d12fb710b2ef9.png 480w, /p/ctfshow-pwn-writeup/13_hu_c960f6a7ed96e8b6.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="421"
		data-flex-basis="1010px"
	
></p>
<p>可以看到，确实是执行了。那么我们也就能得到我们需要的flag。</p>
<h3 id="pwn_004">PWN_004
</h3><p>题目： <a class="link" href="PWN_004" >PWN_004</a> 或许需要先得到某个神秘字符</p>
<p>真够阴间的，啥也不给了，才第几道啊就上强度了。</p>
<p><img src="/p/ctfshow-pwn-writeup/14.png"
	width="1060"
	height="574"
	srcset="/p/ctfshow-pwn-writeup/14_hu_fb649637a5b6a11b.png 480w, /p/ctfshow-pwn-writeup/14_hu_c8ef954931f877ea.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="184"
		data-flex-basis="443px"
	
></p>
<p>checksec看看，然后IDA反编译看看：</p>
<p><img src="/p/ctfshow-pwn-writeup/15.png"
	width="481"
	height="159"
	srcset="/p/ctfshow-pwn-writeup/15_hu_5f0f4805cec82d66.png 480w, /p/ctfshow-pwn-writeup/15_hu_e21b6ee28222ffbe.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="302"
		data-flex-basis="726px"
	
></p>
<p>64位二进制保护全开&hellip;</p>
<p><img src="/p/ctfshow-pwn-writeup/16.png"
	width="753"
	height="341"
	srcset="/p/ctfshow-pwn-writeup/16_hu_ca7b56f27f75a918.png 480w, /p/ctfshow-pwn-writeup/16_hu_6ad185fb146bb9a2.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="220"
		data-flex-basis="529px"
	
></p>
<p>可以看到有几个似曾相识的函数：strcpy（复制函数把xx复制给s1，也可起到赋值的作用）、strcmp（比较函数，对比，判断作用）、execve（）；我曾说过汇编语言的cmp就有比较作用，这也算是类比吧，回想起来的，不过用AI搜一下也行。</p>
<p>来说下execve吧，上题讲过system函数，这个也应该知道的：</p>
<p><code>execve</code> 是 Unix/Linux 系统中最核心的<strong>系统调用（system call）</strong> 之一，用于<strong>在当前进程中加载并执行一个新的程序</strong>，替换当前进程的代码、数据和堆栈，实现进程 “变身”。它是所有程序启动和替换的底层基础，包括 <code>system</code> 函数、shell 执行命令等最终都会依赖 <code>execve</code> 完成。</p>
<p>看到这段代码，大致意思是，让s1等于“CTFshowPWN”这段字符串，然后到if判断语句这进行比较：<strong>如果s1和s2相等</strong>（这里的！不是我们C语言中的“不”的意思啊），就执行execve函数，启动交互权限，从而得到flag。</p>
<p><img src="/p/ctfshow-pwn-writeup/17.png"
	width="890"
	height="506"
	srcset="/p/ctfshow-pwn-writeup/17_hu_cb606be9be72c140.png 480w, /p/ctfshow-pwn-writeup/17_hu_e8a05d11d9a5f65f.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="175"
		data-flex-basis="422px"
	
></p>
<p>至此：下一节就开始前置基础了，开始应用<a class="link" href="https://expl0rer.top/p/pwn-1/"  target="_blank" rel="noopener"
    >PWN-1</a>、<a class="link" href="https://expl0rer.top/p/pwn-2/"  target="_blank" rel="noopener"
    >PWN-2</a>、<a class="link" href="https://expl0rer.top/p/pwn-3/"  target="_blank" rel="noopener"
    >PWN-3</a>所学的知识了。</p>
<h2 id="前置基础">前置基础
</h2><h3 id="pwn_005">PWN_005
</h3><p>题目：运行此文件，将得到的字符串以ctfshow{xxxxx}提交。</p>
<p>如：运行文件后 输出的内容为 Hello_World</p>
<p>提交的flag值为：ctfshow{Hello_World}</p>
<p><strong>注：计组原理题型后续的flag中地址字母大写</strong></p>
<p><a class="link" href="PWN_005%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_005%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<p>Welcome_to_CTFshow.asm文本打开后发现是汇编语言文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="k">section</span> <span class="nv">.data</span>
</span></span><span class="line"><span class="cl">    <span class="nf">msg</span> <span class="nv">db</span> <span class="s">&#34;Welcome_to_CTFshow_PWN&#34;</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">section</span> <span class="nv">.text</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">_start</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nl">_start:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 立即寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">11</span>         <span class="c1">; 将11赋值给eax</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">114504</span>     <span class="c1">; eax加上114504</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; eax减去1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 寄存器寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="mh">0x36d</span>      <span class="c1">; 将0x36d赋值给ebx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="nb">ebx</span>        <span class="c1">; 将ebx的值赋值给edx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 直接寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>      <span class="c1">; 将msg的地址赋值给ecx</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 寄存器间接寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">esi</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 将msg的地址赋值给esi</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">esi</span><span class="p">]</span>      <span class="c1">; 将esi所指向的地址的值赋值给eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 寄存器相对寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 将msg的地址赋值给ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; 将ecx加上4</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span><span class="p">]</span>      <span class="c1">; 将ecx所指向的地址的值赋值给eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 基址变址寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 将msg的地址赋值给ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">2</span>          <span class="c1">; 将2赋值给edx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span> <span class="o">+</span> <span class="nb">edx</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>  <span class="c1">; 将ecx+edx*2所指向的地址的值赋值给eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 相对基址变址寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 将msg的地址赋值给ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; 将1赋值给edx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">8</span>          <span class="c1">; 将ecx加上8</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span> <span class="o">+</span> <span class="nb">edx</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1">; 将ecx+edx*2-6所指向的地址的值赋值给eax</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 输出字符串</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; 系统调用号4代表输出字符串</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; 文件描述符1代表标准输出</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 要输出的字符串的地址</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">22</span>         <span class="c1">; 要输出的字符串的长度</span>
</span></span><span class="line"><span class="cl">    <span class="nf">int</span> <span class="mh">0x80</span>            <span class="c1">; 调用系统调用</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">; 退出程序</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; 系统调用号1代表退出程序</span>
</span></span><span class="line"><span class="cl">    <span class="nf">xor</span> <span class="nb">ebx</span><span class="p">,</span> <span class="nb">ebx</span>        <span class="c1">; 返回值为0</span>
</span></span><span class="line"><span class="cl">    <span class="nf">int</span> <span class="mh">0x80</span>            <span class="c1">; 调用系统调用</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>checksec一下这个PWN文件：</p>
<p><img src="/p/ctfshow-pwn-writeup/18.png"
	width="560"
	height="160"
	srcset="/p/ctfshow-pwn-writeup/18_hu_b88e80be1380d264.png 480w, /p/ctfshow-pwn-writeup/18_hu_edb93148c7d1aae7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="350"
		data-flex-basis="840px"
	
></p>
<p>ohoh这个保护全关的！IDA的x32位</p>
<p><img src="/p/ctfshow-pwn-writeup/19.png"
	width="986"
	height="270"
	srcset="/p/ctfshow-pwn-writeup/19_hu_5a1e69eadca2a8dd.png 480w, /p/ctfshow-pwn-writeup/19_hu_94c08c2f6f98fd2d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="365"
		data-flex-basis="876px"
	
></p>
<p>这个没main函数，那我们回看那段汇编语言asm，这段汇编语言更像是在帮助我们了解汇编语言的逻辑语法规则的，在<a class="link" href="https://expl0rer.top/p/pwn-1/"  target="_blank" rel="noopener"
    >PWN-1</a>文章中就有讲过汇编语言，这里就直接跳过详解</p>
<p>这题开始就有点变样了，“Welcome_to_CTFshow.asm”这文件是一个存放汇编语言的文本文件，需要运行一下转换成像exe这样的可执行文件，在PWN-1讲过elf文件：</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>将汇编语言（.asm）文件转换为可执行文件，需要经过<strong>汇编（Assemble）</strong> 和<strong>链接（Link）</strong> 两个核心步骤.</p></blockquote></blockquote>
<p>在Kali/Linux上下载nasm编辑器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt install nasm
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后下载ld链接器（通常自带）：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt install binutils
</span></span></code></pre></td></tr></table>
</div>
</div><p>汇编转换：将 .asm 转换为目标文件（.obj 或 .o）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nasm -f elf Welcome_to_CTFshow.asm
</span></span></code></pre></td></tr></table>
</div>
</div><p>汇编生成可执行文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ld -m elf_i386 -s -o Welcome_to_CTFshow1 Welcome_to_CTFshow.o
</span></span></code></pre></td></tr></table>
</div>
</div><p>（Welcome_to_CTFshow1是可执行文件）</p>
<p>我的建议汇编转换和生成可执行文件的过程都在Kali/Linux/Ubuntu上，比较方便，windows下载比较麻烦。</p>
<p>生成这个可执行文件之后，直接运行就能得到输出结果了，按照题目要求，加个{}包皮去提交就好了。</p>
<p><img src="/p/ctfshow-pwn-writeup/20.png"
	width="765"
	height="230"
	srcset="/p/ctfshow-pwn-writeup/20_hu_9d3cd65ccf046d84.png 480w, /p/ctfshow-pwn-writeup/20_hu_f0e09656aebee87e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="332"
		data-flex-basis="798px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/21.png"
	width="1040"
	height="295"
	srcset="/p/ctfshow-pwn-writeup/21_hu_96a8674a27a83293.png 480w, /p/ctfshow-pwn-writeup/21_hu_adca9e8247769340.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="352"
		data-flex-basis="846px"
	
></p>
<h3 id="pwn_006">PWN_006
</h3><p>题目：立即寻址方式结束后eax寄存器的值为？</p>
<p><a class="link" href="PWN_006%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_006%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<p>按照PWN-005那样去转换生成这个可执行文件</p>
<blockquote>
<p>汇编转换：将 .asm 转换为目标文件（.obj 或 .o）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nasm -f elf Welcome_to_CTFshow.asm
</span></span></code></pre></td></tr></table>
</div>
</div><p>汇编生成可执行文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ld -m elf_i386 -s -o Welcome_to_CTFshow1 Welcome_to_CTFshow.o
</span></span></code></pre></td></tr></table>
</div>
</div><p>（Welcome_to_CTFshow1是可执行文件）</p></blockquote>
<p><img src="/p/ctfshow-pwn-writeup/22.png"
	width="618"
	height="155"
	srcset="/p/ctfshow-pwn-writeup/22_hu_38c3a83cb1d6b3d2.png 480w, /p/ctfshow-pwn-writeup/22_hu_15cc2bc9e2e15087.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="398"
		data-flex-basis="956px"
	
></p>
<p>Welcome_to_CTFshow_PWN???是flag，错了，题目是<strong>立即寻址</strong>方式结束后<strong>eax寄存器的值</strong>为？</p>
<p>那就是得把这个转换出的可执行文件放到IDA上，不过之前记得checksec一下看看是x32还是x64位哦&hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; 立即寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">11</span>        <span class="c1">; 将11赋值给eax</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">114504</span>    <span class="c1">; eax加上114504</span>
</span></span><span class="line"><span class="cl">    <span class="nf">sub</span> <span class="nb">eax</span><span class="p">,</span> <span class="mi">1</span>         <span class="c1">; eax减去1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/23.png"
	width="1153"
	height="151"
	srcset="/p/ctfshow-pwn-writeup/23_hu_d9da713c30313d8.png 480w, /p/ctfshow-pwn-writeup/23_hu_9162e9b7e00f4ccc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="763"
		data-flex-basis="1832px"
	
></p>
<p>那就加减法咯：11+114504-1=114514</p>
<p>ctfshow{114514}</p>
<h3 id="pwn_007">PWN_007
</h3><p>题目：<strong>寄存器寻址方式</strong>结束后<code>edx寄存器</code>的值为？</p>
<p><a class="link" href="PWN_007%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_007%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<p>按照上述方法去得出可执行文件，放入IDA：</p>
<p><img src="/p/ctfshow-pwn-writeup/24.png"
	width="985"
	height="95"
	srcset="/p/ctfshow-pwn-writeup/24_hu_92bd39fab506337a.png 480w, /p/ctfshow-pwn-writeup/24_hu_75d2f4fa5f54ead5.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="1036"
		data-flex-basis="2488px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; 寄存器寻址方式</span>
</span></span><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">ebx</span><span class="p">,</span> <span class="mh">0x36d</span> <span class="c1">; 将0x36d赋值给ebx</span>
</span></span><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="nb">ebx</span> <span class="c1">; 将ebx的值赋值给edx</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>所以ctfshow{0x36D}</p>
<h3 id="pwn_008">PWN_008
</h3><p>题目：直接寻址方式结束后ecx寄存器的值为？</p>
<p><a class="link" href="..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_008%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_008%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; 直接寻址方式</span>
</span></span><span class="line"><span class="cl"><span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="p">[</span><span class="nv">msg</span><span class="p">]</span> <span class="c1">; 将msg的地址赋值给ecx</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>当你编译后发现找不到地址[msg]，然后我们倒回来找题目的Welcome_to_CTFshow文件，用IDA：</p>
<p><img src="/p/ctfshow-pwn-writeup/25.png"
	width="721"
	height="25"
	srcset="/p/ctfshow-pwn-writeup/25_hu_5372def4240b6f53.png 480w, /p/ctfshow-pwn-writeup/25_hu_1d2087bdde9824cc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="2884"
		data-flex-basis="6921px"
	
></p>
<p>故flag:ctfshow{0x80490E8}</p>
<p>其实不用去进行编译的，在题目给的文件就能做，编译出来的其实就是题目给的文件。</p>
<h3 id="pwn_009">PWN_009
</h3><p>题目：<strong>寄存器间接寻址</strong>方式结束后eax寄存器的值为？</p>
<p><a class="link" href="..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_009%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="..%5c..%5c..%5c..%5c..%5cLegion22%5cCTF-CTFshow%e7%a7%81%e6%95%99-PWN%5c02_%e5%89%8d%e7%bd%ae%e5%9f%ba%e7%a1%80%5cpwn_009%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; 寄存器间接寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">esi</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 将msg的地址赋值给esi</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">esi</span><span class="p">]</span>      <span class="c1">; 将esi所指向的地址的值赋值给eax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/26.png"
	width="650"
	height="175"
	srcset="/p/ctfshow-pwn-writeup/26_hu_db95f2c70775bfb6.png 480w, /p/ctfshow-pwn-writeup/26_hu_6e7577b16306137d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="371"
		data-flex-basis="891px"
	
></p>
<p>不是80490E8哈别被误导了，这是<strong>虚拟地址</strong>哦</p>
<p>点击跟进：</p>
<p><img src="/p/ctfshow-pwn-writeup/27.png"
	width="659"
	height="25"
	srcset="/p/ctfshow-pwn-writeup/27_hu_2f879014412c83d2.png 480w, /p/ctfshow-pwn-writeup/27_hu_a9abfa63d7183e7a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="2636"
		data-flex-basis="6326px"
	
></p>
<p><strong><code>dd 636C6557h</code></strong>：<code>dd</code> 是汇编指令中的伪操作符，意为 “定义双字（define double word）”，表示在当前地址处存放一个 4 字节的数值。这里存放的数值是 <code>636C6557h</code>（十六进制）。</p>
<p>flag:ctfshow{0x636C6557}</p>
<h3 id="pwn_010">PWN_010
</h3><p>题目：<strong>寄存器相对寻址</strong>方式结束后eax寄存器的值为？</p>
<p><a class="link" href="PWN_010%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_010%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; 寄存器相对寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 将msg的地址赋值给ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">4</span>          <span class="c1">; 将ecx加上4</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span><span class="p">]</span>      <span class="c1">; 将ecx所指向的地址的值赋值给eax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/28.png"
	width="845"
	height="154"
	srcset="/p/ctfshow-pwn-writeup/28_hu_e162f950e4f701a0.png 480w, /p/ctfshow-pwn-writeup/28_hu_fc64a86acf95c0c7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="548"
		data-flex-basis="1316px"
	
></p>
<p>然后我们跟进看一下地址：</p>
<p><img src="/p/ctfshow-pwn-writeup/29.png"
	width="770"
	height="110"
	srcset="/p/ctfshow-pwn-writeup/29_hu_8e18458aaf2629b0.png 480w, /p/ctfshow-pwn-writeup/29_hu_265416ee1eefcac9.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="700"
		data-flex-basis="1680px"
	
></p>
<p>也就是这里将msg的地址（0x80490E8）+ 4 处所执向的地址的值赋给eax</p>
<p>4是十进制的，地址是16进制的，记得转换一下：</p>
<p>hex(0x80490E8+4)&ndash;&gt; 080490EC</p>
<p>对应地址得值是ome_to_CTFshow_PWN</p>
<p>故flag:ctfshow{ome_to_CTFshow_PWN}</p>
<h3 id="pwn_011">PWN_011
</h3><p>题目：<strong>基址变址寻址</strong>方式结束后的eax寄存器的值为？</p>
<p><a class="link" href="PWN_011%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_011%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; 基址变址寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 将msg的地址赋值给ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">2</span>          <span class="c1">; 将2赋值给edx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span> <span class="o">+</span> <span class="nb">edx</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>  <span class="c1">; 将ecx+edx*2所指向的地址的值赋值给eax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>同样的，放到IDA上找这个基址变址寻址方式：</p>
<p><img src="/p/ctfshow-pwn-writeup/30.png"
	width="780"
	height="60"
	srcset="/p/ctfshow-pwn-writeup/30_hu_901c17825a17f8ed.png 480w, /p/ctfshow-pwn-writeup/30_hu_668a6173f2e3ecb2.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="1300"
		data-flex-basis="3120px"
	
></p>
<p>双击点dword去跟进到地址：</p>
<p><img src="/p/ctfshow-pwn-writeup/31.png"
	width="820"
	height="135"
	srcset="/p/ctfshow-pwn-writeup/31_hu_15a7389171b58f28.png 480w, /p/ctfshow-pwn-writeup/31_hu_750b9884b38e7964.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="607"
		data-flex-basis="1457px"
	
></p>
<p>计算最终也是 [0x80490E8 + 2*2 ] = [0X80490EC]</p>
<p>其实也是和PWN_010一样：hex(0x80490E8+4)</p>
<p>就是说hex(0x80490E8 + 2*2 )=0X80490EC，对应的是“ome_to_CTFshow_PWN”。</p>
<p>flag：ctfshow{ome_to_CTFshow_PWN}</p>
<h3 id="pwn_012">PWN_012
</h3><p>题目：相对基址变址寻址方式结束后eax寄存器的值为？</p>
<p><a class="link" href="PWN_012%5cWelcome_to_CTFshow" >Welcome_to_CTFshow</a></p>
<p><a class="link" href="PWN_012%5cWelcome_to_CTFshow.asm" >Welcome_to_CTFshow.asm</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="c1">; 相对基址变址寻址方式</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">ecx</span><span class="p">,</span> <span class="nv">msg</span>        <span class="c1">; 将msg的地址赋值给ecx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">edx</span><span class="p">,</span> <span class="mi">1</span>          <span class="c1">; 将1赋值给edx</span>
</span></span><span class="line"><span class="cl">    <span class="nf">add</span> <span class="nb">ecx</span><span class="p">,</span> <span class="mi">8</span>          <span class="c1">; 将ecx加上8</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mov</span> <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ecx</span> <span class="o">+</span> <span class="nb">edx</span><span class="o">*</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1">; 将ecx+edx*2-6所指向的地址的值赋值给eax</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/32.png"
	width="770"
	height="164"
	srcset="/p/ctfshow-pwn-writeup/32_hu_99e9e101810244d0.png 480w, /p/ctfshow-pwn-writeup/32_hu_f807a9c980e1f370.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="469"
		data-flex-basis="1126px"
	
></p>
<p>跟进offset dword_80490E8：</p>
<p><img src="/p/ctfshow-pwn-writeup/33.png"
	width="856"
	height="105"
	srcset="/p/ctfshow-pwn-writeup/33_hu_3157e877f3a9f1c1.png 480w, /p/ctfshow-pwn-writeup/33_hu_77b09f0915eccfa5.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="815"
		data-flex-basis="1956px"
	
></p>
<p>那就是：[8 + 0x80490E8 + 1*2 - 6] = [0x80490EC]</p>
<p>故flag:ctfshow{ome_to_CTFshow_PWN}</p>
<h3 id="pwn_013">PWN_013
</h3><p>题目：如何使用GCC？编译运行后即可获得flag  <a class="link" href="PWN_013%5cPWN_013.c" >PWN_013.c</a></p>
<p>学过C语言都会安装配置编译器环境的，我这里使用的是<strong>visual-studio-code</strong>。</p>
<p><img src="/p/ctfshow-pwn-writeup/34.png"
	width="1534"
	height="466"
	srcset="/p/ctfshow-pwn-writeup/34_hu_a2d59cd0ef0b2014.png 480w, /p/ctfshow-pwn-writeup/34_hu_a654e108c81c213e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="329"
		data-flex-basis="790px"
	
></p>
<p>这段代码是一个简单的 C 程序，它使用字符数组 flag 存储了一个加密的字符串，并通过 printf函数将其打印出来。</p>
<p>在这段代码中， flag 数组存储了一串整数值，这些整数值代表了字符的 ASCII 码。通过将这些整数值转换为相应的字符，就可以还原出原始的字符串。</p>
<p>运行该程序， printf 函数使用 %s 格式字符串将 flag 数组作为参数进行打印。由于 flag 数组的最后一个元素为零（NULL 字符）， printf 函数会将其之前的字符依次打印，直到遇到 NULL 字符为止。根据给定的整数值数组，还原出的字符串为： ctfshow{hOw_t0_us3_GCC?} 。</p>
<h3 id="pwn_014">PWN_014
</h3><p>题目：请你阅读以下源码，<strong>给定key为”CTFshow”</strong>，编译运行即可获得flag。 <a class="link" href="PWN_014%5cPWN_014.c" >PWN_014.c</a></p>
<p>这个文件有强度了，直接编译运行会说nothing is here，不给flag，先读一下这个C语言文件在干什么的：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">;</span>                  <span class="c1">// 文件指针，用于操作文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="n">BUFFER_SIZE</span><span class="p">];</span>  <span class="c1">// 缓冲区，存储从文件读取的二进制数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">size_t</span> <span class="n">n</span><span class="p">;</span>                  <span class="c1">// 记录每次实际读取的字节数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">fp</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="s">&#34;key&#34;</span><span class="p">,</span> <span class="s">&#34;rb&#34;</span><span class="p">);</span>   <span class="c1">// 以二进制只读方式打开名为 &#34;key&#34; 的文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 检查文件是否成功打开
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">fp</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">perror</span><span class="p">(</span><span class="s">&#34;Nothing here!&#34;</span><span class="p">);</span>  <span class="c1">// 若打开失败，打印错误信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 输出缓冲区：大小为 BUFFER_SIZE*9 + 12（预留足够空间存储二进制字符串和分隔符）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">char</span> <span class="n">output</span><span class="p">[</span><span class="n">BUFFER_SIZE</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">12</span><span class="p">];</span> 
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">// 记录 output 中当前已使用的位置（偏移量）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 先在 output 开头写入 &#34;ctfshow{&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34;ctfshow{&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 循环读取文件内容：每次最多读 BUFFER_SIZE 字节，直到文件结束
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">((</span><span class="n">n</span> <span class="o">=</span> <span class="nf">fread</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">),</span> <span class="n">BUFFER_SIZE</span><span class="p">,</span> <span class="n">fp</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 遍历本次读取的每个字节
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 将当前字节拆分为 8 位二进制（从高位到低位）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// (buffer[i] &gt;&gt; j) &amp; 1：获取第 j 位（0 或 1），并写入 output
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34;%d&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 除了最后一个字节，每个字节的二进制后加下划线 &#34;_&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34;_&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 若未到文件末尾，在本次缓冲区数据后加空格 &#34; &#34;（分隔不同批次的读取）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nf">feof</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 在 output 末尾写入 &#34;}&#34;，完成格式包裹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">offset</span> <span class="o">+=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="n">output</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s">&#34;}&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 打印最终生成的字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">output</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>  <span class="c1">// 关闭文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>也就是说我们需要一个名为key的文件，让这个程序知道，然后他就能把flag字符串吐出来了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s2">&#34;CTFshow&#34;</span>&gt; key  <span class="c1">#创建一个名为key得文件，向内输入“CTFshow”的字符串</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/ctfshow-pwn-writeup/35.png"
	width="1145"
	height="336"
	srcset="/p/ctfshow-pwn-writeup/35_hu_df60cb17ad88303e.png 480w, /p/ctfshow-pwn-writeup/35_hu_aca6ec48c69a455b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="340"
		data-flex-basis="817px"
	
></p>
<p>答案是ctfshow{01000011_01010100_01000110_01110011_01101000_01101111_01110111_00001010}</p>
<p>题目要求在key里加CTFshow字符串，加其它是错的，输出结果不同。</p>
<h3 id="pwn_015">PWN_015
</h3><p>题目：编译汇编代码到可执行文件，即可拿到flag。 <a class="link" href="PWN_015%5cflag.asm" >flag.asm</a></p>
<p>汇编转换：将 .asm 转换为目标文件（.obj 或 .o）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nasm -f elf flag.asm
</span></span></code></pre></td></tr></table>
</div>
</div><p>汇编生成可执行文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ld -m elf_i386 -s -o flag1 flag.o
</span></span></code></pre></td></tr></table>
</div>
</div><p>（flag1是可执行文件）</p>
<p><img src="/p/ctfshow-pwn-writeup/36.png"
	width="624"
	height="165"
	srcset="/p/ctfshow-pwn-writeup/36_hu_fda5333d80d87b82.png 480w, /p/ctfshow-pwn-writeup/36_hu_4d6103555c03c502.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="378"
		data-flex-basis="907px"
	
></p>
<p>比较简单，和<a class="link" href="https://expl0rer.top/p/ctfshow-pwn-writeup/#pwn_005"  target="_blank" rel="noopener"
    >PWN_005</a>很类似，都是汇编语言编译运行之类的。</p>
<p>ctfshow{@ss3mb1y_1s_3@sy}</p>
<h3 id="pwn_016">PWN_016
</h3><p>题目：使用gcc将其编译为可执行文件。 <a class="link" href="PWN_016%5cflag.s" >flag.s</a></p>
<p><img src="/p/ctfshow-pwn-writeup/37.png"
	width="646"
	height="104"
	srcset="/p/ctfshow-pwn-writeup/37_hu_b3e8aef3e1ef05a0.png 480w, /p/ctfshow-pwn-writeup/37_hu_af79549354799dd4.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="621"
		data-flex-basis="1490px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc flag.s -o flag
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以使用 gcc 命令直接编译汇编语言源文件（ .s 文件）并将其链接为可执行文件。 gcc 命令具有适用于多种语言的编译器驱动程序功能，它可以根据输入文件的扩展名自动选择适当的编译器和链接器。</p>
<p>故flag：ctfshow{daniuniuda}</p>
<h3 id="pwn_017">PWN_017
</h3><p>题目：有些命令好像有点不一样？不要一直等，可能那样永远也等不到flag。</p>
<p><img src="/p/ctfshow-pwn-writeup/38.png"
	width="930"
	height="325"
	srcset="/p/ctfshow-pwn-writeup/38_hu_7d79a6ffed12bd13.png 480w, /p/ctfshow-pwn-writeup/38_hu_bffb150ab5d0f0e3.png 1024w"
	loading="lazy"
	
		alt="进程3"
	
	
		class="gallery-image" 
		data-flex-grow="286"
		data-flex-basis="686px"
	
></p>
<p>比较奇葩的是，这里选择3的话，一直在loading的，可能是不通的，我换到主机的nc也不行，那就是选2进程的</p>
<p><img src="/p/ctfshow-pwn-writeup/39.png"
	width="879"
	height="536"
	srcset="/p/ctfshow-pwn-writeup/39_hu_feeea272629e1334.png 480w, /p/ctfshow-pwn-writeup/39_hu_cc955cd53b60ba21.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="393px"
	
></p>
<p>选了2后，程序开始发癫了&hellip;.，一直循环搞得我Kali虚拟机卡死了，进到IDAx64去看：</p>
<p><img src="/p/ctfshow-pwn-writeup/40.png"
	width="1160"
	height="423"
	srcset="/p/ctfshow-pwn-writeup/40_hu_4ec1173fad870b57.png 480w, /p/ctfshow-pwn-writeup/40_hu_9873e66f0cb6080d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="274"
		data-flex-basis="658px"
	
></p>
<p>这个case2的read函数只读取10字节以内的，也就是说ctfshow_flag（12byte）这串是超字节限制了。不过之前学了那个指令有通配符的cat ctf*（因为当你选择”ls ./“，打开全部文件后，发现只有一个ctfshow_flag时由ctf字眼的，那我们正好可以绕过超字节的限制了）</p>
<p>搜索打开由ctf这串字符的文件内容：</p>
<p><img src="/p/ctfshow-pwn-writeup/41.png"
	width="691"
	height="231"
	srcset="/p/ctfshow-pwn-writeup/41_hu_fc1a2ff65540e4c9.png 480w, /p/ctfshow-pwn-writeup/41_hu_6ea90f86dc5d2b36.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="299"
		data-flex-basis="717px"
	
></p>
<h3 id="pwn_018">PWN_018
</h3><p>题目：仔细看看源码，或许有惊喜；假作真时真亦假，真作假时假亦真。 <a class="link" href="PWN_018" >PWN_018</a></p>
<p>连接nc后一上来就问：</p>
<p><img src="/p/ctfshow-pwn-writeup/42.png"
	width="754"
	height="275"
	srcset="/p/ctfshow-pwn-writeup/42_hu_b8edf74f377f50dc.png 480w, /p/ctfshow-pwn-writeup/42_hu_48a1d4051a0ee6e8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="274"
		data-flex-basis="658px"
	
></p>
<p>这我哪知道啊？去看IDAx64：</p>
<p><img src="/p/ctfshow-pwn-writeup/43.png"
	width="736"
	height="230"
	srcset="/p/ctfshow-pwn-writeup/43_hu_a7c9b35aa1d7b9e4.png 480w, /p/ctfshow-pwn-writeup/43_hu_566fc56e89492c97.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="320"
		data-flex-basis="768px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/44.png"
	width="905"
	height="370"
	srcset="/p/ctfshow-pwn-writeup/44_hu_c4fb8fcadd3dd78e.png 480w, /p/ctfshow-pwn-writeup/44_hu_1ce437554407a80a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="587px"
	
></p>
<p><img src="/p/ctfshow-pwn-writeup/45.png"
	width="751"
	height="315"
	srcset="/p/ctfshow-pwn-writeup/45_hu_5e1d20db51249b2d.png 480w, /p/ctfshow-pwn-writeup/45_hu_acaf9b3fd36a04e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="238"
		data-flex-basis="572px"
	
></p>

</section>


    <footer class="article-footer">
    

    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            最后更新于 2025-08-28
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/pwn-3/">
        
        
            <div class="article-image">
                <img src="/p/pwn-3/PWN3.4afa5f5bde601dbc35b64aebcb8c25e3_hu_a61ad70f238c03c4.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-3"
                        
                        data-hash="md5-SvpfW95gHbw1tkrry4wl4w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-3</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-2/">
        
        
            <div class="article-image">
                <img src="/p/pwn-2/PWN2.ec0b8de7542727a390b799ae24c64af8_hu_ed10e985448522e2.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-2"
                        
                        data-hash="md5-7AuN51QnJ6OQt5muJMZK&#43;A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-2</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-1/">
        
        
            <div class="article-image">
                <img src="/p/pwn-1/PWN.f98719505e350e475520e79f81d73a1d_hu_fb4f51a67c6d3b57.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-1"
                        
                        data-hash="md5-&#43;YcZUF41DkdVIOefgdc6HQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-1</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/misc/">
        
        

        <div class="article-details">
            <h2 class="article-title">MISC</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5/">
        
        
            <div class="article-image">
                <img src="/p/%E7%BD%91%E5%AE%89%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5/%E5%B0%81%E9%9D%A2.5d92b0f978b2a3d5f8f5c87b90b35a11_hu_a3be8ec01e92cdbf.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 第一阶段"
                        data-key="网安学习第一阶段" 
                        data-hash="md5-XZKw&#43;Xiyo9X49ch7kLNaEQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">第一阶段</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Expl0rer-Ct/Expl0rer.Ct-s-Blog"
    data-repo-id="R_kgDOPd0X7g"
    data-category="Announcements"
    data-category-id="DIC_kwDOPd0X7s4CuMr6"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    
<script defer src="https://events.vercount.one/js"></script>
<footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Expl0rer.Ct
    </section>
    
    <section class="powerby">
        



        























        
<section class="wordcount">
  <div class="wordcount-row">
    <p>博主发布了7篇文章  ||</p>
    <p>总共65.02k 字</p>
  </div>
</section>
        
  


<a>总访客数: </a><span id='busuanzi_value_site_uv'>别急在加载中了...</span> <a> | </a> <a>总访问量: </a><span id='busuanzi_value_site_pv'>加载中...</span></br>



<div class="site-uptime-container">
  <span id="timeDate" class="site-uptime-text">载入天数...</span>
  <span id="times" class="site-uptime-text">载入时分秒...</span>
</div>

<script language="javascript"> 
    var now = new Date();
    function createtime(){
        now.setTime(now.getTime()+250); 
        var grt= new Date("2025/08/01 00:00:00"); 
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;}
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){snum = "0" + snum;}

        document.getElementById("timeDate").innerHTML = "本站已稳定运行"+dnum+" 天 ";document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"
    }
    setInterval("createtime()",250); 
</script> 

<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/node-vibrant/3.1.6/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script><script type="text/javascript" src="/ts/custom.89d9bb2c3c071ae8a261f67661c22b84ef67ba7b7a885dabd2bbd9ebef84ed40.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<head>
  
  <link rel="preconnect" href="https://fonts.font.im" crossorigin>
  <link 
    href="https://fonts.font.im/css?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-cn"
  >
  
  
  <link 
    href="https://fonts.googleapis.com/css2?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-en"
    disabled
  >
  
  <script>
    
    document.querySelector('#font-cn').addEventListener('load', function() {
      document.querySelector('#font-en').disabled = true;
    }).addEventListener('error', function() {
      document.querySelector('#font-en').disabled = false;
      document.querySelector('#font-en').media = 'all';
    });
  </script>
  
  <noscript>
    <link 
      href="https://fonts.font.im/css?family=PT+Sans" 
      rel="stylesheet"
    >
  </noscript>
</head>

<style>
    #TableOfContents > ul ul,
    #TableOfContents > ul ol,
    #TableOfContents > ol ul,
    #TableOfContents > ol ol {
        display: none;
    }
    #TableOfContents > ul .open,
    #TableOfContents > ol .open {
        display: block;
    }
</style>

<script>
    function initTocHide() {
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        window.addEventListener('scroll', function() {
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                const parent = ul.parentElement;
                ul = parent ? parent.parentElement : null;
            } while (ul && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://expl0rer.top/icons/backTop.svg);
    }
</style>

<script>
    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        window.addEventListener('scroll', function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        });
    }

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
    }

    .code-show {
        max-height: none !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer !important;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    let codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) {
      return;
    }
    codeBlocks.forEach(codeBlock => {
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
        return;
      }
      let codeMoreBox = document.createElement('div');
      codeMoreBox.classList.add('code-more-box');
      let codeMoreBtn = document.createElement('span');
      codeMoreBtn.classList.add('code-more-btn');
      codeMoreBtn.addEventListener('click', () => {
        codeBlock.classList.add('code-show');
        codeMoreBox.style.display = 'none';
        window.dispatchEvent(new Event('resize'))
      })
      let img = document.createElement('img');
      img.classList.add('code-more-img');
      img.src = "https:\/\/expl0rer.top\/icons\/codeMore.png"
      codeMoreBtn.appendChild(img);
      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox)
    })
  }
  
  initCodeMoreBox();
</script>






<script>
    function showHideView() {
        let viewCounts = document.querySelectorAll("#viewCount");
        if (viewCounts) {
            let article =  document.querySelector(".article-page");
            if (!article) {
                viewCounts.forEach(ele => {
                    ele.style.display = 'none';
                });
            }
        }
    }
    
    showHideView();
</script>

<script src="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.css" crossorigin="anonymous" />
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>


<script>
    var pjax = new pjax({
        selectors: [
            ".main-container"
        ]
    })

</script>

<script>
    pjax._handleResponse = pjax.handleResponse;
    pjax.handleResponse = function(responseText, request, href, options) {
        if (request.responseText.match("<html")) {
            if (responseText) {
                let newDom = new DOMParser().parseFromString(responseText, 'text/html');
                let bodyClass = newDom.body.className;
                document.body.setAttribute("class", bodyClass)
            }
            pjax._handleResponse(responseText, request, href, options);
        } else {
        }
    }
</script>



<script>
    document.addEventListener('pjax:complete', () => {
        if (window.Stack && typeof window.Stack.init === 'function') {
            window.Stack.init();
        }
    })
</script>

<div id="particles-js"></div>

<script src="https://expl0rer.top/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', "https:\/\/expl0rer.top\/background\/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>


<script src="https://expl0rer.top/background/sakura.js"></script>

    </body>
</html>
