<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨â€”â€”å †åˆ©ç”¨">
<title>PWN-3</title>

<link rel='canonical' href='https://expl0rer.top/p/pwn-3/'>

<link rel="stylesheet" href="/scss/style.min.84f4364fa3a5758ecded3430d054d555b355a8e9efd1baf1e03c18d73802579f.css"><meta property='og:title' content="PWN-3">
<meta property='og:description' content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨â€”â€”å †åˆ©ç”¨">
<meta property='og:url' content='https://expl0rer.top/p/pwn-3/'>
<meta property='og:site_name' content='Expl0rer.Ct'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-09-07T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-10-28T16:52:22&#43;00:00'/><meta property='og:image' content='https://expl0rer.top/p/pwn-3/PWN3.png' />
<meta name="twitter:title" content="PWN-3">
<meta name="twitter:description" content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨â€”â€”å †åˆ©ç”¨"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://expl0rer.top/p/pwn-3/PWN3.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<div class="loading">
     
    <div id="ghost">
        <div id="red">
            <div id="pupil"></div>
            <div id="pupil1"></div>
            <div id="eye"></div>
            <div id="eye1"></div>
            <div id="top0"></div>
            <div id="top1"></div>
            <div id="top2"></div>
            <div id="top3"></div>
            <div id="top4"></div>
            <div id="st0"></div>
            <div id="st1"></div>
            <div id="st2"></div>
            <div id="st3"></div>
            <div id="st4"></div>
            <div id="st5"></div>
            <div id="an1"></div>
            <div id="an2"></div>
            <div id="an3"></div>
            <div id="an4"></div>
            <div id="an5"></div>
            <div id="an6"></div>
            <div id="an7"></div>
            <div id="an8"></div>
            <div id="an9"></div>
            <div id="an10"></div>
            <div id="an11"></div>
            <div id="an12"></div>
            <div id="an13"></div>
            <div id="an14"></div>
            <div id="an15"></div>
            <div id="an16"></div>
            <div id="an17"></div>
            <div id="an18"></div>
        </div>
        <div id="shadow"></div>
    </div>
</div>

<style>
    .loading {
        position: fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        background-color: #f5f5fa;
        transition: opacity 0.5s ease;
    }
	
      
#ghost {
  position: relative;
  scale: 0.8;
}

#red {
  animation: upNDown infinite 1s;
  position: relative;
  width: 140px;
  height: 140px;
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  grid-template-rows: repeat(14, 1fr);
  grid-column-gap: 0px;
  grid-row-gap: 0px;
  grid-template-areas:
    "a1  a2  a3  a4  a5  top0  top0  top0  top0  a10 a11 a12 a13 a14"
    "b1  b2  b3  top1 top1 top1 top1 top1 top1 top1 top1 b12 b13 b14"
    "c1 c2 top2 top2 top2 top2 top2 top2 top2 top2 top2 top2 c13 c14"
    "d1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 d14"
    "e1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 e14"
    "f1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 f14"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "st0 st0 an4 st1 an7 st2 an10 an10 st3 an13 st4 an16 st5 st5"
    "an1 an2 an3 an5 an6 an8 an9 an9 an11 an12 an14 an15 an17 an18";
}

@keyframes upNDown {
  0%,
  49% {
    transform: translateY(0px);
  }
  50%,
  100% {
    transform: translateY(-10px);
  }
}

#top0,
#top1,
#top2,
#top3,
#top4,
#st0,
#st1,
#st2,
#st3,
#st4,
#st5 {
  background-color: red;
}

#top0 {
  grid-area: top0;
}

#top1 {
  grid-area: top1;
}

#top2 {
  grid-area: top2;
}

#top3 {
  grid-area: top3;
}

#top4 {
  grid-area: top4;
}

#st0 {
  grid-area: st0;
}

#st1 {
  grid-area: st1;
}

#st2 {
  grid-area: st2;
}

#st3 {
  grid-area: st3;
}

#st4 {
  grid-area: st4;
}

#st5 {
  grid-area: st5;
}

#an1 {
  grid-area: an1;
  animation: flicker0 infinite 1s;
}

#an18 {
  grid-area: an18;
  animation: flicker0 infinite 1s;
}

#an2 {
  grid-area: an2;
  animation: flicker1 infinite 1s;
}

#an17 {
  grid-area: an17;
  animation: flicker1 infinite 1s;
}

#an3 {
  grid-area: an3;
  animation: flicker1 infinite 1s;
}

#an16 {
  grid-area: an16;
  animation: flicker1 infinite 1s;
}

#an4 {
  grid-area: an4;
  animation: flicker1 infinite 1s;
}

#an15 {
  grid-area: an15;
  animation: flicker1 infinite 1s;
}

#an6 {
  grid-area: an6;
  animation: flicker0 infinite 1s;
}

#an12 {
  grid-area: an12;
  animation: flicker0 infinite 1s;
}

#an7 {
  grid-area: an7;
  animation: flicker0 infinite 1s;
}

#an13 {
  grid-area: an13;
  animation: flicker0 infinite 1s;
}

#an9 {
  grid-area: an9;
  animation: flicker1 infinite 1s;
}

#an10 {
  grid-area: an10;
  animation: flicker1 infinite 1s;
}

#an8 {
  grid-area: an8;
  animation: flicker0 infinite 1s;
}

#an11 {
  grid-area: an11;
  animation: flicker0 infinite 1s;
}

@keyframes flicker0 {
  0%,
  49% {
    background-color: red;
  }
  50%,
  100% {
    background-color: transparent;
  }
}

@keyframes flicker1 {
  0%,
  49% {
    background-color: transparent;
  }
  50%,
  100% {
    background-color: red;
  }
}

#eye {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  left: 10px;
}

#eye::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#eye1 {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  right: 30px;
}

#eye1::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye1::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#pupil {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  left: 10px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

#pupil1 {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  right: 50px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

@keyframes eyesMovement {
  0%,
  49% {
    transform: translateX(0px);
  }
  50%,
  99% {
    transform: translateX(10px);
  }
  100% {
    transform: translateX(0px);
  }
}

#shadow {
  background-color: black;
  width: 140px;
  height: 140px;
  position: absolute;
  border-radius: 50%;
  transform: rotateX(80deg);
  filter: blur(20px);
  top: 80%;
  animation: shadowMovement infinite 1s;
}

@keyframes shadowMovement {
  0%,
  49% {
    opacity: 0.5;
  }
  50%,
  100% {
    opacity: 0.2;
  }
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script>	
    function initLoading() {
        let loading = document.querySelector(".loading");
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(() => {
                loading.style.opacity = "0";
                
                setTimeout(() => {
                    loading.style.display = "none";
                }, 500);
            }, 500); 
        });
    }

    initLoading();
</script>


<link
  rel="stylesheet"
  href="https://cdn-font.hyperos.mi.com/font/css?family=MiSans:400:Chinese_Simplify,Latin&display=swap"
/>



<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreenr.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreenr.css" />


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1a3c99934e119e1b.png" width="300"
                            height="268" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ«¡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Expl0rer.Ct</a></h1>
            <h2 class="site-description">å¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/695179979?spm_id_from=333.40138.0.0'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Expl0rer-Ct'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£ | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢ | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E6%8A%80%E6%9C%AF%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>æŠ€æœ¯é“¾æ¥ | Links</span>
            </a>
        </li>
        
        
        <li >
            <a href='/friends-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥ | Friends Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <!--
tags: [temperature, hot, wheater, thermometer, forecast]
category: Weather
version: "1.73"
unicode: "f236"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#ff9500"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-sun-high"
>
  <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" />
  <path d="M6.343 17.657l-1.414 1.414" />
  <path d="M6.343 6.343l-1.414 -1.414" />
  <path d="M17.657 6.343l1.414 -1.414" />
  <path d="M17.657 17.657l1.414 1.414" />
  <path d="M4 12h-2" />
  <path d="M12 4v-2" />
  <path d="M20 12h2" />
  <path d="M12 20v2" />
</svg>

                        <!--
tags: [night, dark mode]
category: Weather
version: "1.21"
unicode: "ece7"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#8d6e63"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-moon-stars"
>
  <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
  <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2" />
  <path d="M19 11h2m-1 -1v2" />
</svg>

                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#linuxåŠ¨æ€å†…å­˜ç®¡ç†æœºåˆ¶">LinuxåŠ¨æ€å†…å­˜ç®¡ç†æœºåˆ¶</a>
      <ol>
        <li><a href="#å †çš„å†…å­˜ç®¡ç†æœºåˆ¶">å †çš„å†…å­˜ç®¡ç†æœºåˆ¶</a>
          <ol>
            <li><a href="#å †å—ä»‹ç»">å †å—ä»‹ç»</a></li>
          </ol>
        </li>
        <li><a href="#å †å—çš„ç®¡ç†">å †å—çš„ç®¡ç†</a></li>
        <li><a href="#å †å—çš„åˆå¹¶æ“ä½œ">å †å—çš„åˆå¹¶æ“ä½œ</a></li>
        <li><a href="#ç»“æ„ä½“">ç»“æ„ä½“</a></li>
        <li><a href="#å„ç§å†…å­˜å—ä»‹ç»">å„ç§å†…å­˜å—ä»‹ç»</a>
          <ol>
            <li><a href="#fastbin">Fastbin</a></li>
            <li><a href="#unsortedbin">Unsortedbin</a></li>
            <li><a href="#smallbin">Smallbin</a></li>
            <li><a href="#largebin">Largebin</a></li>
          </ol>
        </li>
        <li><a href="#mallocè¿è¡Œæµç¨‹">Mallocè¿è¡Œæµç¨‹</a></li>
        <li><a href="#å †åŠ¨æ€ä¿æŠ¤æœºåˆ¶çš„å°æ€»ç»“">å †åŠ¨æ€ä¿æŠ¤æœºåˆ¶çš„å°æ€»ç»“</a></li>
      </ol>
    </li>
    <li><a href="#å †çš„è°ƒè¯•æ–¹æ³•">å †çš„è°ƒè¯•æ–¹æ³•</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/pwn-3/">
                <img src="/p/pwn-3/PWN3_hu_817e5a93f218a6e2.png"
                        srcset="/p/pwn-3/PWN3_hu_817e5a93f218a6e2.png 800w, /p/pwn-3/PWN3_hu_22548379e62858b4.png 1600w"
                        width="800" 
                        height="450" 
                        loading="lazy"
                        alt="Featured image of post PWN-3" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/pwn%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86/" style="background-color: #2a9d8f; color: #fff;">
                PWNå‰ç½®çŸ¥è¯†
            </a>
        
            <a href="/categories/ctfpwn/" style="background-color: #2a9d8f; color: #fff;">
                CTFpwn
            </a>
        
            <a href="/categories/ctf%E5%85%A5%E9%97%A8/" >
                CTFå…¥é—¨
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/pwn-3/">PWN-3</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨â€”â€”å †åˆ©ç”¨
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-09-07</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>[TOC]</p>
<p><strong>å‰æ–‡ï¼šä»¥ä¸‹æ˜¯æˆ‘å…¥é—¨PWNçš„è®°å½•ï¼Œæ¬¢è¿å„ä½å‰æ¥è§‚çœ‹ï¼Œå°å¼Ÿé¢†æ•™ï¼</strong></p>
<p>åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç²—ç•¥çš„äº†è§£äº†æ ˆç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼š
ROPã€shellcodeã€æ ˆè½¬ç§»ç­‰ã€‚</p>
<p>å†…å­˜ä¸­è¿˜æœ‰ä¸€å—åŒºåŸŸå«åšå †ï¼ˆheapï¼‰ã€‚</p>
<p>æ¥ä¸‹æ¥çš„ä¸€æ•´ç« çš„å†…å®¹ï¼Œæˆ‘ä»¬å°±æ¥è®²å †ã€‚</p>
<blockquote class="alert alert-tip">
    <blockquote>
<p>å †ç« èŠ‚æ¯”è¾ƒæŠ½è±¡ï¼Œæˆ‘è¿˜åˆ»æ„åŠ äº†å¾ˆå¤šå›¾ï¼Œä½†ä¾æ—§æ¯”æ ˆç« èŠ‚è¦æ›´åŠ æŠ½è±¡&hellip;ï¼Œä»¥è‡³äºä½œè€…ä¹Ÿå­¦çš„è¿·è¿·ç³Šç³Šï¼Œçœ‹ä¸æ‡‚çš„æ¬¢è¿æ¥è¯„è®ºåŒºè®¨è®ºã€‚</p>
</blockquote></blockquote>
<h2 id="linuxåŠ¨æ€å†…å­˜ç®¡ç†æœºåˆ¶">LinuxåŠ¨æ€å†…å­˜ç®¡ç†æœºåˆ¶
</h2><p>ä»€ä¹ˆæ˜¯å †ï¼Ÿ+</p>
<p>å †æ˜¯ç¨‹åºç”¨äºåˆ†é…åŠ¨æ€å†…å­˜çš„ä¸€æ®µå†…å­˜åŒºåŸŸã€‚
ä»–ç‹¬ç«‹çš„å­˜åœ¨äºå†…å­˜ä¸­ï¼Œä»‹äºç¨‹åºå†…å­˜ åŸºåœ°å€å’Œlibcåœ°å€ä¹‹é—´ï¼Œ<strong>ä»ä½åœ°å€å‘é«˜åœ°å€ç”Ÿé•¿</strong>ï¼Œä¸ç”¨æˆ·æ‰“äº¤é“æœ€å¤šã€‚</p>
<p>å¸¦ä½ ä¸¾ä¸ªä¾‹å­ç†è§£åŠ¨æ€åˆ†é…å†…å­˜ï¼š</p>
<p>å¼€ä¸€ä¸ªç»Ÿè®¡è¡¨æ ¼ï¼Œæ¯äººæœ€å¤šè¾“å…¥çš„æœ€å¤§å†…å­˜é•¿åº¦æ˜¯4096ä¸ªå­—èŠ‚ï¼ŒæŒ‰ç…§ä»¥å¾€æƒ¯æ€§æ€ç»´å»åˆ†é…çš„è¯ï¼Œä½ æ˜¯ä¸æ˜¯åº”è¯¥æ¯äººéƒ½åœ¨ä¹‹å‰å¡«è¡¨æ—¶å°±å·²ç»åˆ†å¥½äº†å†…å­˜ç»™ä»–ä»¬äº†ï¼Œä½†ä¸æ˜¯æ¯ä¸ªäººéƒ½èƒ½ç”¨å®Œè¿™4096ä¸ªå­—èŠ‚çš„ï¼Œæœ‰äº›äººåªè¾“å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œé‚£å°±æ„å‘³ç€å°±æœ‰4095ä¸ªå­—èŠ‚çš„å†…å­˜åŒºåŸŸè¢«æµªè´¹ï¼Œå¦‚æœæ¯ä¸ªäººéƒ½è¿™æ ·åšæˆ–è¾“å…¥å°‘äºæœ€å¤§å­—èŠ‚é•¿åº¦çš„å†…å­˜çš„æ•°æ®ï¼Œæ˜¯ä¸æ˜¯æµªè´¹æ›´å¤šï¼Ÿ</p>
<p>å¯¹äºè¿™ç§ç°è±¡çš„ä¸‹ä¸€æ­¥åº”è¯¥æ˜¯å›æ”¶ï¼Œæ€ä¹ˆå›æ”¶ï¼Ÿ</p>
<p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œèƒ½è®©ç¨‹åºæ ¹æ®ç”¨æˆ·æ‰€éœ€è¦çš„å†…å­˜é•¿åº¦å¤§å°æ¥åˆ†é…å†…å­˜å‘¢ï¼Ÿå¹¶ä¸”ä¸éœ€è¦æˆ‘ä»¬ç®¡ç†å†…å­˜å‘¢ï¼Ÿæœ‰çš„ï¼Œåœ¨libcä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>malloc(size)</code>æ¥ç»™ç”¨æˆ·åˆ†é…ä¸€æ®µé•¿åº¦ä¸ºsizeçš„å†…å­˜ï¼Œé€šè¿‡<code>free(ptr)</code>æ¥é‡Šæ”¾è¿™æ®µå†…å­˜åŒºåŸŸã€‚
è¿™äº›æ•°æ®ï¼Œè¢«ç»Ÿä¸€çš„å­˜æ”¾åœ¨äº†å †ä¸­ï¼Œç»´æŠ¤è¿™äº›æ•°æ®çš„è¿è¡Œæœºåˆ¶åœ¨glibcä¸­ï¼Œç§°ä¹‹ä¸º<code>ptmalloc</code>ã€‚</p>
<h3 id="å †çš„å†…å­˜ç®¡ç†æœºåˆ¶">å †çš„å†…å­˜ç®¡ç†æœºåˆ¶
</h3><p>å †æ˜¯çœŸæ— æ•Œæ¶å¿ƒ&hellip;.å †çš„ç®¡ç†æœºåˆ¶ç›¸æ¯”äºæ ˆååˆ†å¤æ‚ï¼Œå¯ä»¥ç®—æ˜¯å¯¹æˆ‘è¿™æ ·0åŸºç¡€çš„èŒæ–°æ€æ‰‹ã€‚</p>
<p>ä½†æ˜¯å †çš„æ¼æ´æ¯”æ ˆæœ‰æ›´å¤šçš„å½¢å¼å’Œåˆ©ç”¨æ–¹å¼ï¼Œè€Œä¸”å †æ¼æ´æ‰€éœ€è¦çš„æ¡ä»¶æ¯”æ ˆæ›´
å°‘ã€‚
ä¸€èˆ¬æƒ…å†µä¸‹æ ˆæº¢å‡ºèµ·ç éœ€è¦16ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è‡³å°‘æº¢å‡ºåˆ°è¿”å›åœ°å€æ‰èƒ½åˆ©ç”¨ï¼Œä½†æ˜¯å †çš„è¯åªéœ€è¦ä¸€ä¸ªå­—èŠ‚å°±å¯å®Œæˆåˆ©ç”¨ï¼Œç”šè‡³è¿™ä¸ªå­—èŠ‚å¯ä»¥æ˜¯ä¸ª\x00,ä¹Ÿå°±æ˜¯ç©ºå­—èŠ‚ï¼Œnullbyteã€‚</p>
<blockquote class="alert alert-tip">
    <blockquote>
<p>æ ˆçš„è¯åŸºæœ¬éƒ½ä¼šå…³é—­ä¸€ä¸¤ä¸ªä¿æŠ¤æœºåˆ¶ï¼Œå †çš„è¯ä¸€èˆ¬å…¨å¼€ã€‚</p>
<p>CTFpwnçš„ä¸»æµæ˜¯å †åˆ©ç”¨ã€‚</p>
</blockquote></blockquote>
<h4 id="å †å—ä»‹ç»">å †å—ä»‹ç»
</h4><h5 id="chunk">chunk
</h5><p>åœ¨äº†è§£ptmallocçš„å†…å­˜ç®¡ç†æœºåˆ¶å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å †å—åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å½¢å¼ã€‚åœ¨å†…å­˜ä¸­ï¼Œå †æ˜¯ä»¥ä¸€ä¸ªä¸ªå †å—æ„æˆçš„,è¿™äº›å †å—ç§°ä¹‹ä¸ºchunkã€‚</p>
<p>åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œå †å—çš„å¤§å°æ˜¯8å­—èŠ‚å¯¹é½çš„,ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç”³è¯·ä¸€ä¸ª15å­—èŠ‚é•¿åº¦çš„å †å—ï¼Œå®é™…åˆ°æˆ‘ä»¬æ‰‹ä¸­çš„ç”¨æˆ·å¯æ§çš„æ•°æ®åŒºåŸŸå¤§å°ä¸º16å­—èŠ‚ã€‚</p>
<p>ä½†æ˜¯åœ¨ç®¡ç†ä¸­ï¼Œä¸€ä¸ªå †å—é™¤äº†ç”¨æˆ·æ•°æ®åŒºå¤–ï¼Œè¿˜æœ‰å¤´éƒ¨å­—æ®µï¼Œå¤´éƒ¨å­—æ®µçš„é•¿åº¦ä¸º16å­—èŠ‚ã€‚åŒæ—¶åœ¨64ä½ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªå †å—æœ€å°é•¿åº¦ä¸º32å­—èŠ‚ï¼ˆåŒ…æ‹¬å¤´éƒ¨ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åˆ†é…ä¸€ä¸ª1å­—èŠ‚çš„å †å—ï¼Œä»–çš„å®é™…é•¿åº¦æ˜¯32å­—èŠ‚ã€‚</p>
<p><img src="/p/pwn-3/1.png"
	width="600"
	height="699"
	srcset="/p/pwn-3/1_hu_c6a945343d5e6bd0.png 480w, /p/pwn-3/1_hu_edfe0fe933bf2d3e.png 1024w"
	loading="lazy"
	
		alt="å †å—ç»“æ„å›¾"
	
	
		class="gallery-image" 
		data-flex-grow="85"
		data-flex-basis="206px"
	
></p>
<p>prev_sizeå’Œsizeå­—æ®µåˆ†åˆ«ä»£è¡¨ä¸€ä¸ªchunkå¯¹çš„å¤§å°ï¼Œå¤§å°éƒ½æ˜¯8å­—èŠ‚ï¼Œä¸¤ä¸ªä¸€å…±16å­—èŠ‚ï¼Œç§°ä¹‹ä¸ºchunkçš„å¤´éƒ¨å­—æ®µã€‚åé¢çš„user dataåŒºåŸŸæ˜¯ç”¨æˆ·å¯ä»¥è¾“å…¥æ•°æ®çš„åœ°æ–¹ã€‚</p>
<p>chunkçš„å¤§å°8å­—èŠ‚å¯¹é½ï¼Œæ‰€ä»¥è¯´å¯¹äºåˆ†é…å™¨æ¥è¯´ï¼Œ0x80ã€0x81ã€0x82å¤§å°çš„å †å—éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½ä¸º0x80å¤§å°ã€‚</p>
<blockquote>
<p>å¯èƒ½ä½ ä¸¾å¾—æœ‰ç‚¹æ‡µï¼Œä½†è¿™æ˜¯ä¸€ç§ç®€åŒ–è¡¨è¿°ï¼Œæ ¸å¿ƒæ˜¯<strong>å †å—å¤§å°å¿…é¡»æ»¡è¶³ 8 å­—èŠ‚å¯¹é½</strong>ï¼Œæ‰€ä»¥åˆ†é…å™¨ä¼šæŠŠä¸æ»¡è¶³çš„å¤§å°è°ƒæ•´åˆ°æœ€è¿‘çš„ 8 å­—èŠ‚å¯¹é½çš„å¤§å°ï¼Œè¿™æ ·å°±ä¼šå‡ºç°å¤šä¸ªè¯·æ±‚å¤§å°å¯¹åº”åŒä¸€ä¸ªå®é™…åˆ†é…å¤§å°çš„æƒ…å†µã€‚</p>
</blockquote>
<p>ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå°†sizeçš„æœ€ä½ä¸‰ä¸ªbitè®¾ç½®ä¸ºä¸‰ä¸ªæ ‡å¿—ä½ã€‚</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>ä»é«˜åˆ°ä½åˆ†åˆ«ä¸º<code>non_main_arena</code>ã€<code>is_mmap</code>ã€<code>prev_inuse</code>ï¼Œè¿™é‡Œåˆ†åˆ«è§£é‡Šä¸€ä¸‹ï¼š</p>
<p>non_main_arenaç”¨æ¥è®°å½•å½“å‰chunkæ˜¯å¦ä¸å±äºä¸»çº¿ç¨‹,1è¡¨ç¤ºä¸å±äºï¼Œ0è¡¨ç¤ºå±äºã€‚</p>
<p>is_mmapè¡¨ç¤ºå½“å‰chunkæ˜¯å¦ç”±mmapåˆ†é…çš„ï¼Œ1è¡¨ç¤ºå±äºï¼Œ0è¡¨ç¤ºä¸å±äºã€‚</p>
<p>prev_inuseç”¨æ¥è¡¨ç¤ºå‰é¢ç´§é‚»çš„é‚£ä¸ªchunkæ˜¯å¦æ­£åœ¨ä½¿ç”¨ï¼Œ0è¡¨ç¤ºå‰é¢çš„chunkå·²ç»è¢«é‡Šæ”¾ï¼Œ1è¡¨ç¤ºæ­£åœ¨è¢«ç”¨æˆ·ä½¿ç”¨ã€‚</p>
</blockquote></blockquote>
<p><img src="/p/pwn-3/1.png"
	width="600"
	height="699"
	srcset="/p/pwn-3/1_hu_c6a945343d5e6bd0.png 480w, /p/pwn-3/1_hu_edfe0fe933bf2d3e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="85"
		data-flex-basis="206px"
	
></p>
<p>prevsizeè®°å½•å‰é¢ä¸€ä¸ªchunkçš„å¤§å°ã€‚è¿™é‡Œæ³¨æ„ï¼Œ<strong>prevsizeåªæœ‰åœ¨å‰é¢çš„chunkè¢«freeæ‰çš„æ—¶å€™æ‰ç”Ÿæ•ˆ</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åœ¨prev_inuseä¸º0çš„æ—¶å€™ï¼Œç³»ç»Ÿæ‰æŠŠprev_sizeå­—æ®µå½“ä½œprevsizeã€‚</p>
<p>é‚£ä¹ˆå…¶ä»–æ—¶å€™è¿™ä¸ªå­—æ®µæœ‰ç”¨å—ï¼Ÿæ²¡ç”¨çš„è¯ä¸å°±æµªè´¹äº†å…«ä¸ªå­—èŠ‚ï¼Ÿ</p>
<p>æœ‰ç”¨çš„ï¼å¦‚æœchunkæ­£åœ¨è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆä»–ä¼šæŠŠä¸‹ä¸€ä¸ªchunkçš„prevsizeå­—æ®µå½“ä½œuserdataã€‚å……åˆ†åˆ©ç”¨ç©ºé—´ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬ç”³è¯·ä¸€ä¸ª0x80é•¿åº¦å¤§å°çš„åŒºåŸŸï¼Œç³»ç»Ÿå®é™…ç»™æˆ‘ä»¬0Ã—90å¤§å°ï¼ˆ0x10å¤´éƒ¨ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬ç”³è¯·0x88å¤§å°çš„åŒºåŸŸï¼Œç³»ç»ŸåŒæ ·ä¹Ÿä¼šç»™æˆ‘ä»¬0x90å¤§å°çš„åŒºåŸŸï¼ˆç®—å¤´éƒ¨ï¼‰ï¼Œå‰©ä¸‹çš„8å­—èŠ‚ï¼Œä½¿ç”¨nextchunkçš„prevsizeåŒºåŸŸã€‚å› ä¸ºï¼Œåªæœ‰å½“ä¸€ä¸ªchunkè¢«é‡Šæ”¾çš„æ—¶å€™ï¼Œnextchunkçš„prevsizeæ‰çœŸæ­£ä»£è¡¨å‰ä¸€ä¸ªchunkçš„å¤§å°ï¼Œæ‰€ä»¥å°±è¿™ä¹ˆè®¾è®¡äº†ã€‚</p>
<hr>
<h5 id="topchunk">topchunk
</h5><p>topchunkæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„chunkï¼Œç±»ä¼¼äºbsså­—æ®µæœªè¢«åˆ†é…çš„å†…å­˜ä¸€æ ·ï¼Œæ¯”è¾ƒåŸå§‹çš„ã€‚</p>
<p>æœ€å¼€å§‹æ—¶ï¼Œç¨‹åºçš„å †è¿˜æœªè¢«ä½¿ç”¨ï¼Œæ•´ä¸ªçš„å †åŒºåŸŸå±äºä¸€ä¸ªå¾ˆå¤§çš„å †å—å«åštopchunkã€‚å½“å·²ç»è¢«ä½¿ç”¨çš„ç©ºé—´ä¸å¤Ÿæ—¶ï¼Œç¨‹åºå°±ä¼šä»topchunkä¸­åˆ†å‰²ä¸€å—å‡ºæ¥ä¸ªç¨‹åºä½¿ç”¨ã€‚</p>
<h3 id="å †å—çš„ç®¡ç†">å †å—çš„ç®¡ç†
</h3><p>ä¸ºäº†ä¿è¯ç¨‹åºçš„å¿«é€Ÿè¿è¡Œï¼Œè€Œä¸”æ–¹ä¾¿ç³»ç»Ÿå†…å­˜ç®¡ç†ï¼Œæ‰€ä»¥ptmallocå°†é‡Šæ”¾åçš„å †å—æ ¹æ®å…¶å¤§å°åˆ†æˆä¸åŒçš„binã€‚</p>
<p>fastbinï¼šå¤§å°èŒƒå›´ä»0x20-0Ã—80</p>
<p>smallbinï¼šå¤§å°èŒƒå›´ï¼š0Ã—90-0x400</p>
<p>Large binï¼šå¤§å°èŒƒå›´ï¼š0x410ä»¥ä¸Š</p>
<p>unsortedbinï¼šæœªè¢«å½’ç±»çš„binï¼Œä¸´æ—¶å­˜å‚¨ç”¨ï¼Œå­˜æ”¾çš„å †å—å¤§å°ä¸ä¸€å®šå¤šå¤§ï¼Œåç»­è¯¦ç»†ä»‹ç»ã€‚</p>
<p>chunkè¢«freeä¹‹åå¦‚å›¾ï¼š</p>
<p><img src="/p/pwn-3/2.png"
	width="608"
	height="706"
	srcset="/p/pwn-3/2_hu_9e37b4c47dc91d38.png 480w, /p/pwn-3/2_hu_3d5602cb30b1dc73.png 1024w"
	loading="lazy"
	
		alt="å †é‡Šæ”¾ç¤ºæ„å›¾"
	
	
		class="gallery-image" 
		data-flex-grow="86"
		data-flex-basis="206px"
	
></p>
<p>ç”±äºchunkè¢«freeäº†ï¼Œæ‰€ä»¥æŒ‰å¸¸ç†è¯´ç”¨æˆ·ä¸åº”è¯¥èƒ½å¤Ÿè®¿é—®åˆ°è¿™ä¸ªchunkã€‚äºæ˜¯ä¹åœ¨userdataåŒºåŸŸå­˜æ”¾ä¸€äº›ç”¨äºç®¡ç†å†…å­˜çš„æŒ‡é’ˆä¿¡æ¯ã€‚</p>
<p>fastbinï¼šå•é“¾è¡¨ç»“æ„ï¼Œåªä¼šç”¨åˆ°fdè¿™ä¸ªæŒ‡é’ˆï¼›</p>
<p>small &amp;unsortedbinï¼šåŒå‘é“¾è¡¨ç»“æ„ï¼Œfdå’Œbkéƒ½ç”¨ï¼›</p>
<p>largebinï¼šåŒå‘é“¾è¡¨ï¼Œfdã€bkéƒ½ç”¨ï¼ŒåŒæ—¶è¿˜ä¼šç”¨fd nextsizeå’Œbk nextsizeã€‚</p>
<h3 id="å †å—çš„åˆå¹¶æ“ä½œ">å †å—çš„åˆå¹¶æ“ä½œ
</h3><p>å¦‚æœæˆ‘ä»¬freeæ‰ä¸€ä¸ªå †å—ï¼Œï¼ˆå¯èƒ½ï¼‰ä¼šè§¦å‘å‘å‰åˆå¹¶å’Œå‘ååˆå¹¶ã€‚</p>
<p><img src="/p/pwn-3/2.png"
	width="608"
	height="706"
	srcset="/p/pwn-3/2_hu_9e37b4c47dc91d38.png 480w, /p/pwn-3/2_hu_3d5602cb30b1dc73.png 1024w"
	loading="lazy"
	
		alt="å †"
	
	
		class="gallery-image" 
		data-flex-grow="86"
		data-flex-basis="206px"
	
></p>
<p>å‘å‰åˆå¹¶ï¼šæ£€æŸ¥å½“å‰chunkçš„prev inuseä½ï¼Œå¦‚æœä¸º0ï¼Œåˆ™æ ¹æ®å½“å‰chunkçš„prev sizeæ‰¾åˆ°prev chunkçš„å¤´ï¼Œä¸¤ä¸ªå †å—åˆå¹¶ï¼›</p>
<p>å‘ååˆå¹¶ï¼šæ£€æŸ¥å½“å‰chunkçš„next next chunkçš„prev inuseä½ï¼ˆå› ä¸ºä¸€ä¸ªå †å—çš„çŠ¶æ€ç”±ä»–åé¢chunkçš„prev inuseä½å†³å®šï¼Œæ‰€ä»¥ç¡®å®šnext chunkçš„çŠ¶æ€éœ€è¦æ£€æŸ¥next next chunkçš„prev inuseä½ï¼Œæ€ä¹ˆæ‰¾? sizeå°±è¡Œï¼‰ï¼Œç„¶åæ ¹æ®next chunkçš„çŠ¶æ€å†³å®šæ˜¯å¦åˆå¹¶ã€‚</p>
<p>å˜åŒ–ç¤ºæ„å›¾ï¼š</p>
<p><img src="/p/pwn-3/3.png"
	width="549"
	height="690"
	srcset="/p/pwn-3/3_hu_3e940d845dbc5926.png 480w, /p/pwn-3/3_hu_312b3e9f07d6e5d2.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="79"
		data-flex-basis="190px"
	
></p>
<hr>
<p><img src="/p/pwn-3/4.png"
	width="514"
	height="700"
	srcset="/p/pwn-3/4_hu_4c5c79d1e71a5cc8.png 480w, /p/pwn-3/4_hu_394cc2401ee65f45.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="73"
		data-flex-basis="176px"
	
></p>
<hr>
<p><img src="/p/pwn-3/5.png"
	width="435"
	height="701"
	srcset="/p/pwn-3/5_hu_6f7258d5a1b19d23.png 480w, /p/pwn-3/5_hu_4f4b1d7c5324c890.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="62"
		data-flex-basis="148px"
	
></p>
<hr>
<p>è¿™å››å¼ å›¾çœ‹å¾—æœ‰ç‚¹æ‡µï¼Ÿè¯´äººè¯å°±æ˜¯prev_inuse=0è¯´æ˜å‰é¢chunkè¢«é‡Šæ”¾äº†ï¼Œå‘ƒèº«ä½“éƒ½æ²¡äº†ä½ è¦å¤´æœ‰ä»€ä¹ˆç”¨ï¼Ÿæˆ‘çš„è¯è¿‡é‡äº†&hellip;èº«ä½“ï¼ˆchunkï¼‰è¢«é‡Šæ”¾freeæ²¡äº†åº”è¯¥å¤´ä¹Ÿè·Ÿç€ä¸€èµ·ç°é£çƒŸç­ï¼ï¼ä¸€èµ·æ¶ˆå¤±æ‰ï¼Œå’Œå…¶å®ƒå †åˆå¹¶ã€‚ï¼ˆ<strong>å…ˆå‘å‰åˆå¹¶å†è€ƒè™‘å‘ååˆå¹¶</strong>ï¼‰</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>â€œåˆå¹¶â€ çš„å…³ç³»</p>
<p>å‘å‰åˆå¹¶ï¼ˆå…³é”®å…³è” <code>prev_inuse = 0</code>ï¼‰</p>
<p>è‹¥å½“å‰å †å—çš„ <code>prev_inuse = 0</code> æ—¶ï¼Œè¯´æ˜<strong>å‰ä¸€ä¸ªå †å—æ˜¯ç©ºé—²çš„</strong>ã€‚æ­¤æ—¶ï¼Œå½“å‰å †å—å¯ä»¥ï¼š</p>
<p>1ã€è¯»å–å‰ä¸€ä¸ªå †å—çš„å¤´éƒ¨ä¿¡æ¯ï¼ˆé€šè¿‡å½“å‰å †å—çš„ <code>prev_size</code> å­—æ®µï¼Œè·å–å‰ä¸€ä¸ªå †å—çš„å¤§å°ï¼‰ã€‚</p>
<p>2ã€å°† â€œå½“å‰å †å—â€ ä¸ â€œå‰ä¸€ä¸ªç©ºé—²å †å—â€ åˆå¹¶ï¼Œå½¢æˆä¸€ä¸ªæ›´å¤§çš„ç©ºé—²å †å—ï¼Œå‡å°‘å†…å­˜ç¢ç‰‡ã€‚</p>
<p>å‘ååˆå¹¶ï¼ˆä¸ <code>prev_inuse</code> æ— ç›´æ¥å…³è”ï¼‰</p>
<p>1ã€â€œå‘ååˆå¹¶â€ æ˜¯æŒ‡<strong>å½“å‰ç©ºé—²å †å—</strong>ä¸<strong>åä¸€ä¸ªç›¸é‚»çš„ç©ºé—²å †å—</strong>åˆå¹¶ï¼Œå…¶åˆ¤æ–­æ¡ä»¶æ˜¯ï¼š<strong>åä¸€ä¸ªå †å—æ˜¯å¦ä¸ºç©ºé—²</strong>ï¼ˆé€šè¿‡æ£€æŸ¥åä¸€ä¸ªå †å—çš„ <code>prev_inuse</code> æ ‡å¿—ï¼‰ã€‚</p>
<p>For instaceï¼Œå½“å‰å †å—æ˜¯ç©ºé—²çš„ï¼Œè‹¥åä¸€ä¸ªå †å—çš„ <code>prev_inuse = 0</code>ï¼ˆè¯´æ˜åä¸€ä¸ªå †å—è®¤ä¸º â€œå‰ä¸€ä¸ªå †å—ï¼ˆå³å½“å‰å †å—ï¼‰æ˜¯ç©ºé—²çš„â€ï¼‰ï¼Œåˆ™å¯ä»¥è¿›è¡Œå‘ååˆå¹¶ã€‚</p>
<p>2ã€å¯è§ï¼Œâ€œå‘ååˆå¹¶â€ çš„æ ¸å¿ƒæ˜¯<strong>åä¸€ä¸ªå †å—çš„ <code>prev_inuse</code> æ ‡å¿—</strong>ï¼Œè€Œéå½“å‰å †å—çš„ <code>prev_inuse</code>ã€‚</p>
<p><strong>è€ƒè™‘åˆ°ç›¸å¯¹å…³ç³»ï¼Œç®€å•æ¥è¯´å¯¹äºå½“å‰ä½ è¦è®¨è®ºçš„å †å¤´éƒ¨æ¥è¯´ï¼Œå®ƒçš„prev_inuse=0æ—¶ï¼Œå®ƒæœ¬èº«å°±åº”è¯¥å’Œå‰é¢çš„chunkåˆå¹¶ã€‚</strong></p>
<p>è€Œâ€œå‘ååˆå¹¶â€ çš„è§¦å‘æ¡ä»¶æ˜¯åä¸€ä¸ªå †å—çš„ prev_inuse = 0ï¼ˆè¡¨ç¤ºåä¸€ä¸ªå †å—å…è®¸ä¸å‰ä¸€ä¸ªå †å— â€”â€” å³å½“å‰å †å— â€”â€” åˆå¹¶ï¼‰ã€‚</p>
</blockquote></blockquote>
<h3 id="ç»“æ„ä½“">ç»“æ„ä½“
</h3><p><code>aren</code></p>
<p>æ˜¯ä¸€å—ç»“æ„ä½“ï¼Œç”¨äºç®¡ç†binsã€‚ä¸»çº¿ç¨‹åˆ›å»ºçš„arenaç§°ä¹‹ä¸ºmain_arena,å…¶ä»–çš„å«threadarenaã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">malloc</span> <span class="n">state</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="cm">/* Serialize access.*/</span>
</span></span><span class="line"><span class="cl">	<span class="kt">mutex_t</span> <span class="n">mutex</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/*Fastbins*/</span>
</span></span><span class="line"><span class="cl">	<span class="n">mfastbinptr</span> <span class="n">fastbinsY</span><span class="p">[</span><span class="n">NFASTBINS</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">	<span class="cm">/* Base of the topmost chunk -- not otherwise kept in a bin*/</span>
</span></span><span class="line"><span class="cl">	<span class="n">mchunkptr</span> <span class="n">top</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="cm">/* The remainder from the most recent split of a small request */</span>
</span></span><span class="line"><span class="cl">	<span class="n">mchunkptr</span> <span class="n">last</span> <span class="n">remainder</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/*Nromal bins packed as described above*/</span>
</span></span><span class="line"><span class="cl">	<span class="n">mchunkptr</span> <span class="n">bins</span><span class="p">[</span><span class="n">NBINS</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/*Bitmap of bins*/</span>
</span></span><span class="line"><span class="cl">	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">binmap</span><span class="p">[</span><span class="n">BINMAPSIZE</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/*Linked list*/</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="n">malloc</span> <span class="n">state</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/*Linked list for free arenas.*/</span>
</span></span><span class="line"><span class="cl">	<span class="k">struct</span> <span class="n">malloc</span> <span class="n">state</span> <span class="o">*</span><span class="n">next_free</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="cm">/* Memory allocated from the system in this arena.*/</span>
</span></span><span class="line"><span class="cl">	<span class="n">INTERNAL_SIZE_T_system_mem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">INTERNAL_SIZE_T_max_system_mem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span><span class="err">ï¼›</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å„ç§å†…å­˜å—ä»‹ç»">å„ç§å†…å­˜å—ä»‹ç»
</h3><p>å„ç§binsï¼š</p>
<p><img src="/p/pwn-3/6.png"
	width="1170"
	height="530"
	srcset="/p/pwn-3/6_hu_356d3d1f41d3a343.png 480w, /p/pwn-3/6_hu_681cc24595ccc945.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="220"
		data-flex-basis="529px"
	
></p>
<h4 id="fastbin">Fastbin
</h4><p>ç®¡ç†fastbin free chunkï¼Œå•é“¾è¡¨ç»“æ„ï¼ŒFILOï¼ˆæœ€åä¸€ä¸ªè¿›å…¥fastbiné“¾è¡¨çš„ï¼Œä¼šè¢«æ”¾åœ¨å¤´éƒ¨ï¼‰æ€»å…±æœ‰åä¸ªfastbiné“¾è¡¨ï¼Œæ¯ä¸ªé“¾è¡¨ä¸­fastbinçš„sizeä¸€æ ·ï¼Œ<code>0x10</code>é€’å¢ã€‚</p>
<p>å¤§å°å±äºfastbinçš„chunkè¢«freeæ‰æ—¶ï¼Œä¸ä¼šæ”¹å˜next chunkçš„prev inuseä½ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šè¢«åˆå¹¶ã€‚</p>
<img src="7.png" alt="Fastbin" style="zoom:175%;" />
<h4 id="unsortedbin">Unsortedbin
</h4><p><strong>ç®¡ç†unsorted chunkï¼Œåªæœ‰ä¸€ä¸ªåŒå‘é“¾
è¡¨</strong>ã€‚æ‰€æœ‰å¤§å°å¤§äºfastbinçš„chunkéƒ½ä¼šå…ˆè¢«æš‚
æ—¶æ”¾å…¥unsortedbinä¸­ï¼Œé“¾è¡¨ä¸­çš„chunkå¤§å°ä¸ä¸€æ ·ã€‚</p>
<p><img src="/p/pwn-3/8.png"
	width="505"
	height="680"
	srcset="/p/pwn-3/8_hu_ede4dba4e4677942.png 480w, /p/pwn-3/8_hu_77246d469abdf9c8.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="74"
		data-flex-basis="178px"
	
></p>
<p>*<strong>æ³¨æ„ï¼šè¿™é‡Œçš„æŒ‡å‘ç®­å¤´æ¯”è¾ƒå¤š</strong></p>
<h4 id="smallbin">Smallbin
</h4><p>ç®¡ç†small chunkï¼Œç”±62ä¸ªåŒå‘é“¾è¡¨ç»„æˆï¼Œ
æ¯ä¸ªé“¾è¡¨ä¸­çš„chunkå¤§å°ä¸€æ ·ï¼Œå¤§å°ä»¥0x10é€’
å¢ã€‚é•¿å¾—å’Œunsortedbinå·®ä¸å¤šçš„ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">+-------------------+      +-------------------+      +-------------------+
</span></span><span class="line"><span class="cl">|     smallbin      | &lt;--&gt; |   free chunk 1    | &lt;--&gt; |   free chunk 2    | &lt;--&gt; ...
</span></span><span class="line"><span class="cl">|  (size = 0x20)    |      |                   |      |                   |
</span></span><span class="line"><span class="cl">+-------------------+      +-------------------+      +-------------------+
</span></span><span class="line"><span class="cl">         |
</span></span><span class="line"><span class="cl">         v
</span></span><span class="line"><span class="cl">+-------------------+      +-------------------+      +-------------------+
</span></span><span class="line"><span class="cl">|     smallbin      | &lt;--&gt; |   free chunk 1    | &lt;--&gt; |   free chunk 2    | &lt;--&gt; ...
</span></span><span class="line"><span class="cl">|  (size = 0x30)    |      |                   |      |                   |
</span></span><span class="line"><span class="cl">+-------------------+      +-------------------+      +-------------------+
</span></span><span class="line"><span class="cl">         |
</span></span><span class="line"><span class="cl">         v
</span></span><span class="line"><span class="cl">       ... (æ›´å¤š smallbinï¼Œå¤§å°é€’å¢)
</span></span><span class="line"><span class="cl">         |
</span></span><span class="line"><span class="cl">         v
</span></span><span class="line"><span class="cl">+-------------------+      +-------------------+      +-------------------+
</span></span><span class="line"><span class="cl">|     smallbin      | &lt;--&gt; |   free chunk 1    | &lt;--&gt; |   free chunk 2    | &lt;--&gt; ...
</span></span><span class="line"><span class="cl">|  (size = 0x3F0)   |      |                   |      |                   |
</span></span><span class="line"><span class="cl">+-------------------+      +-------------------+      +-------------------+
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="largebin">Largebin
</h4><p>ç®¡ç†large chunkï¼Œ63ä¸ªåŒå‘é“¾è¡¨ï¼ŒFIFOã€‚åŒä¸€ä¸ªåŒçº¿é“¾è¡¨ä¸­chunkå¤§å°å¯ä»¥ä¸ä¸€æ ·ï¼Œä½†æ˜¯åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œbinså¤§å°ä»å°åˆ°å¤§æ’åˆ—ã€‚</p>
<blockquote>
<p>åœ¨æ­¤æˆ‘ä»¬å…ˆä¸å­¦ä¹ larbin attackçš„ç›¸å…³å†…å®¹ï¼Œæ‰€ä»¥çœ‹çœ‹å°±è¡Œï¼Œäº†è§£ä¸€ä¸‹ã€‚æ¯”è¾ƒå°‘é‡è§Largebinçš„ç›¸å…³é¢˜ã€‚</p>
</blockquote>
<img src="9.png" style="zoom:150%;" />
<h3 id="mallocè¿è¡Œæµç¨‹">Mallocè¿è¡Œæµç¨‹
</h3><p>äº†è§£å®Œå„ç§binä¹‹åï¼Œç°åœ¨æ¥çœ‹çœ‹è¿™ï¼š</p>
<p>ä¸€ã€å½“æˆ‘ä»¬è°ƒç”¨mallocæ—¶ï¼Œç¨‹åºéƒ½å¹²äº†äº›ä»€ä¹ˆï¼Ÿ</p>
<p>1ã€è®¡ç®—çœŸæ­£çš„å †å—çš„å¤§å°ï¼ˆåŠ ä¸Šå †å¤´éƒ¨é•¿åº¦ã€å¯¹é½ï¼‰ï¼š</p>
<p>åˆ¤æ–­æ˜¯å¦åœ¨fastbinèŒƒå›´å†…ï¼š</p>
<ul>
<li>
<p>ç¡®å®šåœ¨ï¼Œæ£€æŸ¥å¯¹åº”å¤§å°çš„biné“¾è¡¨ä¸­æœ‰æ— chunkã€‚</p>
<ul>
<li>æœ‰ï¼Œé‚£å°±åˆ†é…ç»™ç”¨æˆ·ï¼Œè‡³æ­¤å®Œæˆã€‚</li>
</ul>
</li>
<li>
<p>å¦‚æœä¸åœ¨fastbinèŒƒå›´å†…ï¼Œæˆ–è€…æ²¡ç”¨chunkå¯ç”¨ã€‚ï¼ˆä¸¤è€…æ»¡è¶³ä¸€ä¸ªæˆ–è€…éƒ½æ»¡è¶³çš„è¯ï¼‰</p>
<ul>
<li>
<p>ç»§ç»­åˆ¤æ–­æ˜¯å¦åœ¨smallbinèŒƒå›´å†…ï¼š</p>
<ul>
<li>åœ¨smallbinèŒƒå›´å†…ï¼Œæ£€æŸ¥å¯¹åº”å¤§å°çš„biné“¾è¡¨ä¸­æœ‰æ— chunkã€‚
<ul>
<li>æœ‰chunkï¼Œé‚£å°±å–å‡ºæ¥ç»™ç¨‹åºï¼Œè‡³æ­¤å®Œæˆã€‚</li>
</ul>
</li>
<li>ä¸åœ¨smallbinèŒƒå›´å†…ï¼Œæˆ–è€…smallbiné‡Œé¢ä¹Ÿæ²¡æœ‰chunkã€‚è¿™æ—¶å€™è·³åˆ°unsortedbinçš„æ£€æŸ¥ã€‚</li>
</ul>
</li>
<li>
<p>unsortedbinä¸­æœ‰æ— chunkï¼Ÿ</p>
<ul>
<li>
<p>æœ‰ï¼Œä»å°¾éƒ¨å–å‡ºç¬¬ä¸€ä¸ªchunkï¼Œçœ‹çœ‹å¤§å°æ˜¯å¦æ»¡è¶³éœ€æ±‚ã€‚</p>
<ul>
<li>æ»¡è¶³ï¼Œåˆ‡åˆ†åå¤§å°æ˜¯å¦å¤§äº<strong>minsize</strong>ï¼Ÿ
<ul>
<li>å¤§äºï¼Œå†åˆ‡åˆ†å—ï¼Œè¿”å›ç»™ç”¨æˆ·ï¼Œå‰©ä¸‹çš„å—æ”¾è¿›unsortedbinã€‚</li>
<li>å°äºæˆ–ç­‰äºminsizeï¼Œç›´æ¥è¿”å›ç»™ç”¨æˆ·ï¼Œå®Œæˆã€‚</li>
</ul>
</li>
<li>ä¸æ»¡è¶³å¤§å°éœ€æ±‚ï¼ŒæŠŠè¿™ä¸ªå—æ”¾å…¥smallbin / largebinå¯¹åº”çš„é“¾è¡¨ä¸­ï¼Œç»§ç»­éå†ä¸‹ä¸€ä¸ªå—ã€‚</li>
</ul>
</li>
<li>
<p>æ²¡ã€‚unsortedbinçš„æ‰€æœ‰å—éƒ½ä¸æ»¡è¶³ï¼Œé‚£æ­¤æ—¶å°±åˆ¤æ–­æ˜¯å¦åœ¨largebinèŒƒå›´ã€‚</p>
<ul>
<li>æ˜¯ï¼Œæ£€æŸ¥å¯¹åº”çš„biné“¾è¡¨ä¸­æœ‰æ— ç¬¦åˆçš„chunkã€‚
<ul>
<li>æœ‰ç¬¦åˆçš„ï¼Œæ‰¾åˆ°æ»¡è¶³éœ€æ±‚æœ€å°çš„chunkï¼Œåˆ‡åˆ†å—è¿”å›ï¼Œå‰©ä¸‹çš„æ”¾è¿›unsortedbinä¸­ã€‚</li>
</ul>
</li>
<li>ä¸åœ¨ï¼Œé‚£å°±å†æ¬¡éå†smallbin / largebinæ‰¾best fitçš„chunkã€‚</li>
<li>æˆ‘å»ï¼Ÿè¿˜æ˜¯æ²¡ç”¨ï¼Œé‚£å°±ä»<code>topchunk</code>ä¸­åˆ‡å‰²ã€‚</li>
<li>ï¼Ÿï¼Ÿæä»€ä¹ˆé¬¼ï¼Ÿï¼Ÿtopchunkä¹Ÿä¸å¤Ÿï¼Ÿé‚£å°±<code>mmap</code>ç³»ç»Ÿè°ƒç”¨</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>äºŒã€å½“æˆ‘ä»¬è°ƒç”¨äº†freeæ—¶ï¼Œç¨‹åºéƒ½å¹²äº†äº›ä»€ä¹ˆï¼Ÿ</p>
<p>freeçš„chunkå¤§å°å±äºfastbinå—ï¼Ÿ</p>
<ul>
<li>
<p>æ˜¯ï¼Œæ”¾è¿›fastbinï¼Œè‡³æ­¤å®Œæˆã€‚</p>
</li>
<li>
<p>ä¸å±äºï¼Œé‚£å°±æ¥ç€åˆ¤æ–­è¿™ä¸ªfreeçš„chunkæ˜¯å¦æ˜¯mmapåˆ†é…çš„ã€‚</p>
<ul>
<li>
<p>æ˜¯ï¼Œé‚£å°±è°ƒç”¨munmapå›æ”¶ï¼Œå®Œæˆã€‚</p>
</li>
<li>
<p>ä¸æ˜¯ï¼Œé‚£å°±æ¥ç€åˆ¤æ–­å‰ä¸€ä¸ªchunkæ˜¯å¦æ˜¯ç©ºé—²çš„ã€‚</p>
<ul>
<li>
<p>æ˜¯ï¼Œé‚£å°±<strong>å‘å‰åˆå¹¶</strong></p>
</li>
<li>
<p>ä¸æ˜¯ï¼Œæ¥ç€åˆ¤æ–­ï¼šåä¸€ä¸ªchunkæ˜¯topchunkå—ï¼Ÿ</p>
<ul>
<li>
<p>æ˜¯ï¼Œé‚£å°±å’Œtopchunkåˆå¹¶ï¼Œè‡³æ­¤å®Œæˆã€‚</p>
</li>
<li>
<p>ä¸æ˜¯topchunkï¼Œé‚£å°±åˆ¤æ–­ï¼šåä¸€ä¸ªchunkæ˜¯freeçš„å—ï¼Ÿ</p>
<ul>
<li>æ˜¯ï¼Œé‚£å°±<strong>å‘ååˆå¹¶</strong>ï¼Œç„¶åæ”¾è¿›unsortedbinï¼Œç»ˆäºå®Œæˆäº†ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="å †åŠ¨æ€ä¿æŠ¤æœºåˆ¶çš„å°æ€»ç»“">å †åŠ¨æ€ä¿æŠ¤æœºåˆ¶çš„å°æ€»ç»“
</h3><p>æˆ‘çš„å¦ˆå•Šï¼Œéš¾æ­»æˆ‘äº†ï¼Œå †çš„å†…å­˜ç®¡ç†æœºåˆ¶æ¯”è¾ƒå¤æ‚ï¼Œå¤šåˆ·åˆ·é¢˜å§ï¼Œå—ä¸äº†äº†ï¼Œåˆšå¼€å§‹å°±ä¸Šå¼ºåº¦äº†ğŸ˜«ã€‚</p>
<blockquote>
<p>æˆ‘è¿™é‡Œæœ‰ä¸€ä¸ªå‘è‡ªå†…å¿ƒçš„ç–‘é—®ï¼šå †çš„æœ¬è´¨æ˜¯æŒ‡é’ˆæŒ‡æ¥æŒ‡å»å—ï¼ŸO(âˆ©_âˆ©)O</p>
<p>å †çš„æœ¬è´¨å¯ä»¥ç†è§£ä¸º<strong>é€šè¿‡æŒ‡é’ˆæ“ä½œç®¡ç†åŠ¨æ€å†…å­˜çš„æœºåˆ¶</strong>ï¼Œä½† â€œæŒ‡é’ˆæŒ‡æ¥æŒ‡å»â€ åªæ˜¯å…¶è¡¨ç°å½¢å¼ä¹‹ä¸€ï¼Œæ›´æ·±å±‚çš„æœ¬è´¨æ˜¯<strong>å†…å­˜å—çš„åˆ†é…ã€é‡Šæ”¾å’Œå¤ç”¨è§„åˆ™</strong>ï¼Œä»¥åŠæ”»å‡»è€…é€šè¿‡ç ´åè§„åˆ™å®ç°æ¼æ´åˆ©ç”¨çš„è¿‡ç¨‹ã€‚ç†è§£å †çš„æ ¸å¿ƒåœ¨äºæŒæ¡å†…å­˜å—çš„ç»„ç»‡ç»“æ„ã€å †ç®¡ç†å™¨çš„è¡Œä¸ºé€»è¾‘ï¼Œè€Œéå•çº¯çš„æŒ‡é’ˆæ“ä½œã€‚</p>
</blockquote>
<h2 id="å †çš„è°ƒè¯•æ–¹æ³•">å †çš„è°ƒè¯•æ–¹æ³•
</h2>
</section>


    <footer class="article-footer">
    

    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2025-10-28
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/pwn-4/">
        
        
            <div class="article-image">
                <img src="/p/pwn-4/PWN4.3657bbeb84fdb7f3290e78d3c41b8d4c_hu_d9ba59500c5360b4.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-4"
                        
                        data-hash="md5-Nle764T9t/MpDnjTxBuNTA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-4</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-2/">
        
        
            <div class="article-image">
                <img src="/p/pwn-2/PWN2.ec0b8de7542727a390b799ae24c64af8_hu_ed10e985448522e2.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-2"
                        
                        data-hash="md5-7AuN51QnJ6OQt5muJMZK&#43;A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-2</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-1/">
        
        
            <div class="article-image">
                <img src="/p/pwn-1/PWN.f98719505e350e475520e79f81d73a1d_hu_fb4f51a67c6d3b57.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-1"
                        
                        data-hash="md5-&#43;YcZUF41DkdVIOefgdc6HQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-1</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/ida%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/">
        
        
            <div class="article-image">
                <img src="/p/ida%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/IDA.24e86f15c02689113058084231ff68da_hu_6a8de3be4381c8e4.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post IDAä½¿ç”¨æŒ‡å—"
                        
                        data-hash="md5-JOhvFcAmiREwWAhCMf9o2g==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">IDAä½¿ç”¨æŒ‡å—</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/">
        
        
            <div class="article-image">
                <img src="/p/ctfshow-%E5%85%A5%E9%97%A8pwn-writeup/ctfshow.8c2a966268b078c807772be02e985309_hu_9b3814b0af84762b.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post CTFshow-å…¥é—¨PWN-writeup"
                        
                        data-hash="md5-jCqWYmiweMgHdyvgLphTCQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CTFshow-å…¥é—¨PWN-writeup</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Expl0rer-Ct/Expl0rer.Ct-s-Blog"
    data-repo-id="R_kgDOPd0X7g"
    data-category="Announcements"
    data-category-id="DIC_kwDOPd0X7s4CuMr6"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    
<script defer src="https://events.vercount.one/js"></script>
<footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Expl0rer.Ct
    </section>
    
    <section class="powerby">
        



        









































        
<section class="wordcount">
  <div class="wordcount-row">
    <p>åšä¸»å‘å¸ƒäº†15ç¯‡æ–‡ç«   ||</p>
    <p>æ€»å…±212.78k å­—</p>
  </div>
</section>
        
  


<a>æ€»è®¿å®¢æ•°: </a><span id='busuanzi_value_site_uv'>åˆ«æ€¥åœ¨åŠ è½½ä¸­äº†...</span> <a> | </a> <a>æ€»è®¿é—®é‡: </a><span id='busuanzi_value_site_pv'>åŠ è½½ä¸­...</span></br>



<div class="site-uptime-container">
  <span id="timeDate" class="site-uptime-text">è½½å…¥å¤©æ•°...</span>
  <span id="times" class="site-uptime-text">è½½å…¥æ—¶åˆ†ç§’...</span>
</div>

<script language="javascript"> 
    var now = new Date();
    function createtime(){
        now.setTime(now.getTime()+250); 
        var grt= new Date("2025/08/01 00:00:00"); 
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;}
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){snum = "0" + snum;}

        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²ç¨³å®šè¿è¡Œ"+dnum+" å¤© ";document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"
    }
    setInterval("createtime()",250); 
</script> 

<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/node-vibrant/3.1.6/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script><script type="text/javascript" src="/ts/custom.89d9bb2c3c071ae8a261f67661c22b84ef67ba7b7a885dabd2bbd9ebef84ed40.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<head>
  
  <link rel="preconnect" href="https://fonts.font.im" crossorigin>
  <link 
    href="https://fonts.font.im/css?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-cn"
  >
  
  
  <link 
    href="https://fonts.googleapis.com/css2?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-en"
    disabled
  >
  
  <script>
    
    document.querySelector('#font-cn').addEventListener('load', function() {
      document.querySelector('#font-en').disabled = true;
    }).addEventListener('error', function() {
      document.querySelector('#font-en').disabled = false;
      document.querySelector('#font-en').media = 'all';
    });
  </script>
  
  <noscript>
    <link 
      href="https://fonts.font.im/css?family=PT+Sans" 
      rel="stylesheet"
    >
  </noscript>
</head>

<style>
    #TableOfContents > ul ul,
    #TableOfContents > ul ol,
    #TableOfContents > ol ul,
    #TableOfContents > ol ol {
        display: none;
    }
    #TableOfContents > ul .open,
    #TableOfContents > ol .open {
        display: block;
    }
</style>

<script>
    function initTocHide() {
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        window.addEventListener('scroll', function() {
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                const parent = ul.parentElement;
                ul = parent ? parent.parentElement : null;
            } while (ul && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://expl0rer.top/icons/backTop.svg);
    }
</style>

<script>
    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        window.addEventListener('scroll', function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        });
    }

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
    }

    .code-show {
        max-height: none !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer !important;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    let codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) {
      return;
    }
    codeBlocks.forEach(codeBlock => {
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
        return;
      }
      let codeMoreBox = document.createElement('div');
      codeMoreBox.classList.add('code-more-box');
      let codeMoreBtn = document.createElement('span');
      codeMoreBtn.classList.add('code-more-btn');
      codeMoreBtn.addEventListener('click', () => {
        codeBlock.classList.add('code-show');
        codeMoreBox.style.display = 'none';
        window.dispatchEvent(new Event('resize'))
      })
      let img = document.createElement('img');
      img.classList.add('code-more-img');
      img.src = "https:\/\/expl0rer.top\/icons\/codeMore.png"
      codeMoreBtn.appendChild(img);
      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox)
    })
  }
  
  initCodeMoreBox();
</script>






<script>
    function showHideView() {
        let viewCounts = document.querySelectorAll("#viewCount");
        if (viewCounts) {
            let article =  document.querySelector(".article-page");
            if (!article) {
                viewCounts.forEach(ele => {
                    ele.style.display = 'none';
                });
            }
        }
    }
    
    showHideView();
</script>

<script src="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.css" crossorigin="anonymous" />
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>


<script>
    var pjax = new pjax({
        selectors: [
            ".main-container"
        ]
    })

</script>

<script>
    pjax._handleResponse = pjax.handleResponse;
    pjax.handleResponse = function(responseText, request, href, options) {
        if (request.responseText.match("<html")) {
            if (responseText) {
                let newDom = new DOMParser().parseFromString(responseText, 'text/html');
                let bodyClass = newDom.body.className;
                document.body.setAttribute("class", bodyClass)
            }
            pjax._handleResponse(responseText, request, href, options);
        } else {
        }
    }
</script>



<script>
    document.addEventListener('pjax:complete', () => {
        if (window.Stack && typeof window.Stack.init === 'function') {
            window.Stack.init();
        }
    })
</script>

<div id="particles-js"></div>

<script src="https://expl0rer.top/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', "https:\/\/expl0rer.top\/background\/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>


<script src="https://expl0rer.top/background/sakura.js"></script>

    </body>
</html>
